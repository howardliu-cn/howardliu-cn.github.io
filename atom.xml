<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ²‰æ½œé£åŠ¨</title>
  
  <subtitle>å›å­è—å™¨äºèº«ï¼Œå¾…æ—¶è€ŒåŠ¨ã€‚</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.howardliu.cn/"/>
  <updated>2021-12-25T03:51:38.000Z</updated>
  <id>https://www.howardliu.cn/</id>
  
  <author>
    <name>Howard Liu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mybatis-Plus ç‰ˆæœ¬å†²çªè§¦å‘â€œCould not convert argument value of type [java.lang.String] to required type [java.lang.Class]â€çš„ java.lang.NoClassDefFoundError å¼‚å¸¸</title>
    <link href="https://www.howardliu.cn/mybatis-plus-conflict-noclassdeffounderror/"/>
    <id>https://www.howardliu.cn/mybatis-plus-conflict-noclassdeffounderror/</id>
    <published>2021-12-25T03:51:38.000Z</published>
    <updated>2021-12-25T03:51:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/cover/dog-2963062_1920.jpg" alt="Mybatis-Plus ç‰ˆæœ¬å†²çªè§¦å‘â€œCould not convert argument value of type [java.lang.String] to required type [java.lang.Class]â€çš„ java.lang.NoClassDefFoundError å¼‚å¸¸"></p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>ä»Šå¤©é¡¹ç›®ä¾èµ–äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶ä¹‹åï¼Œå¯åŠ¨å¤±è´¥ï¼Œæ’æŸ¥è¿‡ç¨‹èµ°äº†ä¸€äº›å¼¯è·¯ï¼Œæœ€ç»ˆç¡®è®¤æ˜¯å› ä¸ºä¾èµ–ç»„ä»¶ç‰ˆæœ¬å†²çªé€ æˆäº†<code>java.lang.NoClassDefFoundError</code>å¼‚å¸¸ã€‚ä¸‹é¢æ˜¯æ’æŸ¥è¿‡ç¨‹ï¼Œå¸Œæœ›å¯ä»¥ç»™ä½ æä¾›ä¸€äº›æ€è·¯ã€‚</p><a id="more"></a><h2 id="è§‚å¯Ÿå¼‚å¸¸æ ˆ"><a href="#è§‚å¯Ÿå¼‚å¸¸æ ˆ" class="headerlink" title="è§‚å¯Ÿå¼‚å¸¸æ ˆ"></a>è§‚å¯Ÿå¼‚å¸¸æ ˆ</h2><p>ä¸‹é¢æ˜¯æ‰“å°çš„å¼‚å¸¸æ ˆä¿¡æ¯ï¼Œä»å…¶ä¸­æç‚¼å¯èƒ½çš„å…³é”®ä¿¡æ¯ï¼Œèƒ½å¤Ÿæ‰¾åˆ°â€œCould not convert argument value of type [java.lang.String] to required type [java.lang.Class]â€ï¼Œè¿˜æœ‰â€œUnresolvable class definition for class [cn.howardliu.demo.AddressMapper]â€ã€‚ç»§ç»­ä»å¼‚å¸¸æ ˆä¸­æ‰¾ä¸€ä¸‹å‘ç”Ÿçš„æ—¶æœºï¼Œå¯ä»¥å‘ç°æ˜¯è°ƒç”¨<code>AbstractAutowireCapableBeanFactory.createBeanInstance</code>æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åˆ›å»º Bean å®ä¾‹ã€‚</p><pre><code class="log">è¿™å—æ˜¯å¼‚å¸¸ä¿¡æ¯ï¼ˆgetMessage çš„å†…å®¹ï¼Œæ¨ªå‘å¤ªé•¿ï¼Œæ‰‹åŠ¨æ¢è¡Œäº†ï¼‰ï¼šorg.springframework.beans.factory.UnsatisfiedDependencyException:    Error creating bean with name &#39;methodValidationPostProcessor&#39; defined in class path resource [org/springframework/boot/autoconfigure/validation/ValidationAutoConfiguration.class]:    Unsatisfied dependency expressed through method &#39;methodValidationPostProcessor&#39; parameter 0;    nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException:    Error creating bean with name &#39;addressMapper&#39; defined in file [/Users/liuxinghao/Documents/work/code/cn.howardliu/effective-spring/target/classes/cn/howardliu/demo/AddressMapper.class]:    Unsatisfied dependency expressed through constructor parameter 0:    Could not convert argument value of type [java.lang.String] to required type [java.lang.Class]:    Failed to convert value of type &#39;java.lang.String&#39; to required type &#39;java.lang.Class&#39;;    nested exception is java.lang.IllegalArgumentException:     Unresolvable class definition for class [cn.howardliu.demo.AddressMapper]ä¸‹é¢æ˜¯å¼‚å¸¸æ ˆï¼š    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:799) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:540) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1341) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1181) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:556) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:516) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:324) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:322) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207) ~[spring-beans-5.2.13.RELEASE.jar:5.2.13.RELEASE]å…¶ä»–å¼‚å¸¸æ ˆä¿¡æ¯å¯ä»¥å¿½ç•¥äº†</code></pre><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®ç›®å‰æœ‰æ•ˆçš„ä¿¡æ¯è¿›è¡Œæ’æŸ¥ï¼Œé¦–å…ˆçœ‹ä¸‹æˆ‘ä»¬çš„<code>cn.howardliu.demo.AddressMapper</code>å®šä¹‰æ˜¯å¦æœ‰é—®é¢˜ï¼Œå†çœ‹çœ‹ä¾èµ–å®ƒçš„ Service æœ‰æ²¡æœ‰é—®é¢˜ï¼Œä»€ä¹ˆé—®é¢˜ä¹Ÿæ²¡æœ‰å‘ç°ã€‚ä¸‹ä¸€ä¸ªæ£€æŸ¥ç‚¹æ˜¯é…ç½®ï¼Œæ¯”å¦‚<code>@MapperScan</code>æ˜¯å¦æ­£ç¡®ã€Mapper ç±»ä¸Šæœ‰æ²¡æœ‰åŠ ä¸Š<code>@Mapper</code>æ³¨è§£ï¼Œå‘ç°ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚</p><p>ä»å¼‚å¸¸ä¿¡æ¯æ‰¾ä¸åˆ°æ€è·¯äº†ï¼Œåªèƒ½ä»ä»£ç å…¥æ‰‹äº†ã€‚</p><blockquote><p>è¿™é‡Œéœ€è¦è¯´ä¸€ä¸‹ï¼Œæ‰“å°å¼‚å¸¸ä¿¡æ¯è‡³å…³é‡è¦ï¼Œç›´æ¥å½±å“æˆ‘ä»¬æ’é”™çš„æ€è·¯ã€‚å¦‚æœæ‰“å°çš„ä¿¡æ¯æ²¡æœ‰åŠæ³•å‡†ç¡®å®šä½ï¼Œæˆ‘ä»¬å°†ä¼šèŠ±è´¹å¤§é‡çš„æ—¶é—´æŸ¥æ‰¾çœŸæ­£çš„é”™è¯¯ï¼Œè¿™å°±éœ€è¦èµ°æŸ¥ä»£ç ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦ä¸€äº›ç»éªŒã€‚</p></blockquote><h2 id="å®šä½é—®é¢˜"><a href="#å®šä½é—®é¢˜" class="headerlink" title="å®šä½é—®é¢˜"></a>å®šä½é—®é¢˜</h2><p>æˆ‘ä»¬ç”±å¼‚å¸¸æ ˆ``ConstructorResolver.createArgumentArray(ConstructorResolver.java:799) å…¥æ‰‹ï¼Œè·Ÿç€æ–­ç‚¹å¾€ä¸‹è¿½ï¼Œæœ€ç»ˆä¼šè¿½åˆ°<code>org.springframework.util.ClassUtils#forName</code>æ–¹æ³•ï¼Œå…¶ä¸­ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»£ç æ˜¯ä¸‹é¢è¿™å—ï¼š</p><pre><code class="java">try {    return Class.forName(name, false, clToUse);}catch (ClassNotFoundException ex) {    int lastDotIndex = name.lastIndexOf(PACKAGE_SEPARATOR);    if (lastDotIndex != -1) {        String innerClassName =                name.substring(0, lastDotIndex) + INNER_CLASS_SEPARATOR + name.substring(lastDotIndex + 1);        try {            return Class.forName(innerClassName, false, clToUse);        }        catch (ClassNotFoundException ex2) {            // Swallow - let original exception get through        }    }    throw ex;}</code></pre><p>å‡ºç°é”™è¯¯çš„æ˜¯<code>Class.forName(name, false, clToUse)</code>è¿™å¥ï¼Œ<code>name</code>ä¼ çš„æ˜¯â€cn.howardliu.demo.AddressMapperâ€å­—ç¬¦ä¸²ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸æ˜¯<code>java.lang.NoClassDefFoundError</code>ï¼Œç”±äºä¸æ˜¯<code>ClassNotFoundException</code>å¼‚å¸¸ï¼Œä¸ä¼šè¿›å…¥<code>catch</code>é€»è¾‘ï¼Œä¼šç›´æ¥å‘ä¸ŠæŠ›å‡ºã€‚</p><p>æ‰¾åˆ°é”™è¯¯æˆ‘ä»¬å°±å¥½å®šä½é—®é¢˜äº†ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<code>java.lang.NoClassDefFoundError</code>é”™è¯¯æ˜¯éœ€è¦åŠ è½½çš„ç±»èƒ½å¤Ÿæ‰¾åˆ°ï¼Œä½†æ˜¯åŠ è½½æ—¶å‡ºç°äº†å¼‚å¸¸ï¼Œç®€å•è¯´å°±æ˜¯ï¼Œç±»çš„å®šä¹‰æœ‰é—®é¢˜ã€‚æˆ‘ä»¬å€ŸåŠ© JD-GUI åç¼–è¯‘ä¸€ä¸‹è¿è¡Œ jar åŒ…ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><pre><code class="java">import com.baomidou.mybatisplus.core.mapper.BaseMapper;import cn.howardliu.demo.Address;import org.apache.ibatis.annotations.Mapper;@Mapperpublic interface AddressMapper extends BaseMapper&lt;Address&gt; {}</code></pre><p>è§‚å¯Ÿä»”ç»†çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>import com.baomidou.mybatisplus.core.mapper.BaseMapper;</code>è¿™è¡Œæ²¡æœ‰ä¸‹åˆ’çº¿ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åç¼–è¯‘å·¥å…·ä¸­è¿½æº¯ä¸åˆ°è¿™ä¸ªæ¥å£ï¼Œæ¨æ–­å‡ºæ¥å°±æ˜¯åœ¨è¿è¡Œç¯å¢ƒä¸­ï¼Œæ‰¾ä¸åˆ°<code>BaseMapper</code>è¿™ä¸ªç±»å®šä¹‰ã€‚</p><p>æ‰€ä»¥ï¼Œå½“<code>Class.forName</code>åŠ è½½ç±»çš„æ—¶å€™æŠ›å‡ºäº†<code>java.lang.NoClassDefFoundError</code>å¼‚å¸¸ã€‚</p><h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>å¦‚æœæœ‰ä¸€å®šç»éªŒï¼Œå°±ä¼šç«‹åˆ»æƒ³åˆ°ï¼Œå¤§æ¦‚ç‡å‡ºç°äº†ä¾èµ– jar çš„ç‰ˆæœ¬å†²çªã€‚</p><p>æˆ‘ä»¬å¯ä»¥å€ŸåŠ© maven å‘½ä»¤è¡Œæ‰¾åˆ°ç‰ˆæœ¬å†²çªçš„ä¾èµ–ï¼š</p><pre><code class="shell">mvn dependency:tree -Dverbose | grep conflict</code></pre><p>æ‰“å°ç»“æœä¸ºï¼š</p><pre><code class="log">[INFO] |  +- (com.baomidou:mybatis-plus:jar:3.1.2:compile - omitted for conflict with 2.1.6)</code></pre><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ© IDEA çš„å¯è§†åŒ–å·¥å…·ï¼Œåœ¨ pom.xml ä¸Šæ‰“å¼€ä¾èµ–å›¾ï¼š</p><p><img src="https://static.howardliu.cn/java/EF543BDC-9C35-43CF-A181_20211225114104.png" alt="ä¾èµ–å›¾"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° mybatis-plus çš„çº¢çº¿æŒ‡ç¤ºå‡ºå†²çªä¿¡æ¯ï¼š</p><p><img src="https://static.howardliu.cn/java/F0C16C09-7C27-4D34-99F9-B73B665EF0A3_20211225114132.png" alt="å†²çªä¿¡æ¯"></p><p>ç»“è®ºå°±æ˜¯ Mybatis-Plus ç‰ˆæœ¬å†²çªäº†ï¼Œé¡¹ç›®ä¸­ä¾èµ–äº† mybatis-plus çš„ 2.1.6 å’Œ 3.1.2 ä¸¤ä¸ªç‰ˆæœ¬ï¼Œç”±äº 2.1.6 è·¯å¾„æ›´çŸ­ï¼Œæœ€ç»ˆè¢«é€‰ä¸­ã€‚</p><p>æ­¤æ—¶åªéœ€è¦å°†ä½ç‰ˆæœ¬çš„ä¾èµ–å»æ‰å³å¯ã€‚</p><h2 id="å¤ç›˜é—®é¢˜"><a href="#å¤ç›˜é—®é¢˜" class="headerlink" title="å¤ç›˜é—®é¢˜"></a>å¤ç›˜é—®é¢˜</h2><h3 id="mybatis-plus-çš„ç‰ˆæœ¬é—®é¢˜"><a href="#mybatis-plus-çš„ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="mybatis-plus çš„ç‰ˆæœ¬é—®é¢˜"></a>mybatis-plus çš„ç‰ˆæœ¬é—®é¢˜</h3><p>ä¸ºä»€ä¹ˆä½ç‰ˆæœ¬çš„ mybatis-plus ä¼šé€ æˆç±»åŠ è½½å¤±è´¥å‘¢ï¼Ÿæ˜¯å› ä¸º mybatis-plus è·¨ç‰ˆæœ¬æ›´æ–°æ—¶ï¼ŒæŠŠ<code>BaseMapper</code>çš„åŒ…è·¯å¾„æ”¹äº†ï¼š</p><pre><code class="java">// 3.1.2 ç‰ˆæœ¬import com.baomidou.mybatisplus.core.mapper.BaseMapper;// 2.1.6 ç‰ˆæœ¬import com.baomidou.mybatisplus.mapper.BaseMapper;</code></pre><p>è€Œä¸”è¿˜ä¸æ­¢è¿™ä¸€ä¸ªï¼Œ<code>IService</code>ã€<code>ServiceImpl</code>ã€<code>TableName</code>ã€<code>TableField</code>ã€<code>Model</code>ã€<code>TableField</code>ç­‰ç­‰ï¼Œå¾ˆå¤šå¸¸ç”¨çš„ç±»éƒ½æ”¹äº†ä½ç½®ã€‚æ‰€ä»¥ä¼šé€ æˆæ‰¾ä¸åˆ°ä¾èµ–çš„ç±»ã€‚ç¼–è¯‘æ˜¯ 3.1.2 ä¾èµ–è¿˜åœ¨è¿è¡Œç¯å¢ƒä¸­ï¼Œå°±ä¼šå‡ºç°ç¼–è¯‘æ²¡æœ‰é—®é¢˜ï¼Œæ‰§è¡Œæ—¶å‡ºç°åŠ è½½ç±»å¼‚å¸¸ã€‚</p><p>æƒ³è¦å·¥ç¨‹åŒ–çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºåŸºç¡€çš„ä¾èµ– bom é…ç½®ï¼Œå®šä¹‰å¥½åŸºç¡€ä¾èµ–åŒ…ï¼Œåœ¨é¡¹ç›®ä¸­ä¸åœ¨æŒ‡å®šç‰ˆæœ¬ã€‚è¿™æ ·åšåˆ°ç»Ÿä¸€ç‰ˆæœ¬ï¼Œå¯ä»¥æœ‰æ•ˆçš„é¿å…è¿™ç±»é—®é¢˜ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ CI/CD ä¸­åŠ å…¥å†²çªä¾èµ–æ£€æŸ¥ï¼Œå¦‚æœå‘ç°å†²çªä¾èµ–ï¼Œå°±ç»ˆæ­¢æµæ°´çº¿ã€‚</p><h3 id="çœŸå®å¼‚å¸¸è¢«éšè—é—®é¢˜"><a href="#çœŸå®å¼‚å¸¸è¢«éšè—é—®é¢˜" class="headerlink" title="çœŸå®å¼‚å¸¸è¢«éšè—é—®é¢˜"></a>çœŸå®å¼‚å¸¸è¢«éšè—é—®é¢˜</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹ä¸ºä»€ä¹ˆæ˜æ˜æ˜¯<code>java.lang.NoClassDefFoundError</code>å¼‚å¸¸ï¼Œç»“æœå¼‚å¸¸æ ˆä¸­æ‰“å°çš„æ˜¯ä¸€å †ä¸ç›¸å¹²çš„é”™è¯¯ã€‚ç»§ç»­è·Ÿç€åˆšæ‰çš„æ–­ç‚¹ Debugï¼š</p><p><code>org.springframework.util.ClassUtils#resolveClassName</code>ä¼šæ•æ‰<code>LinkageError</code>é”™è¯¯ï¼Œç„¶ååŒ…è£…æˆ<code>IllegalArgumentException</code>å¼‚å¸¸ï¼Œè¿™ä¸ªæ—¶å€™çœŸæ˜¯å¼‚å¸¸è¿˜æ˜¯ç»§ç»­ä¸ŠæŠ›ã€‚</p><p>ç„¶ååœ¨<code>org.springframework.beans.TypeConverterSupport#convertIfNecessary</code>æ–¹æ³•ä¼šåŒ…è£…æˆ<code>TypeMismatchException</code>å¼‚å¸¸ï¼Œæ­¤æ—¶ï¼ŒçœŸå®å¼‚å¸¸è¿˜åœ¨å¼‚å¸¸<code>cause</code>å‚æ•°ä¸­ï¼Œå¹¶æ²¡æœ‰ä¸¢å¤±ã€‚</p><p>ç­‰å›åˆ°<code>org.springframework.beans.factory.support.ConstructorResolver#createArgumentArray</code>æ–¹æ³•åï¼Œæ•æ‰å¼‚å¸¸çš„æ–¹æ³•æ˜¯ï¼š</p><pre><code class="java">try {    convertedValue = converter.convertIfNecessary(originalValue, paramType, methodParam);}catch (TypeMismatchException ex) {    throw new UnsatisfiedDependencyException(            mbd.getResourceDescription(), beanName, new InjectionPoint(methodParam),            &quot;Could not convert argument value of type [&quot; +                    ObjectUtils.nullSafeClassName(valueHolder.getValue()) +                    &quot;] to required type [&quot; + paramType.getName() + &quot;]: &quot; + ex.getMessage());}</code></pre><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œåœ¨åŒ…è£…æˆ<code>UnsatisfiedDependencyException</code>å¼‚å¸¸çš„æ—¶å€™ï¼Œåªæ˜¯æŠŠæ•æ‰åˆ°çš„<code>TypeMismatchException</code>é€šè¿‡<code>getMessage</code>æ–¹æ³•è¿½åŠ åœ¨å¼‚å¸¸æè¿°åé¢ï¼Œæ­¤æ—¶ç»è¿‡å‰é¢å‡ è½®çš„åŒ…è£…å†åŒ…è£…ï¼ŒçœŸå®çš„å¼‚å¸¸çš„å¼‚å¸¸ä¿¡æ¯ä»…å‰©<code>Unresolvable class definition for class [cn.howardliu.demo.AddressMapper]</code>è¿™æ®µç»è¿‡å¤„ç†çš„ä¿¡æ¯ï¼Œå®Œå…¨æ²¡æœ‰<code>java.lang.NoClassDefFoundError</code>çš„å½±å­äº†ã€‚</p><p>è‡³æ­¤ï¼ŒçœŸå®å¼‚å¸¸æ¶ˆå¤±æ— è¸ªã€‚</p><p>è¿™ä¹Ÿç»™æˆ‘ä»¬ä¸€ä¸ªæé†’ï¼Œæˆ‘ä»¬è¦ä¿è¯å¼‚å¸¸çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¿ç•™æœ‰æ•ˆä¿¡æ¯ï¼Œå¦åˆ™ï¼Œæ’é”™ä¼šéå¸¸éº»çƒ¦ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡æ˜¯æŠ“è™«æ–‡ï¼Œä»é—®é¢˜å‡ºå‘ï¼Œåˆ°è§£å†³é—®é¢˜ï¼Œç»™å‡ºå®Œæ•´çš„æ€è·¯ã€‚<code>java.lang.NoClassDefFoundError</code>ä¸€èˆ¬éƒ½æ˜¯å‡ºç°åœ¨ç‰ˆæœ¬å†²çªçš„æ—¶å€™ï¼Œè¿™ç§å¼‚å¸¸æ˜¯ç¼–è¯‘æ‰“åŒ…æ²¡æœ‰é—®é¢˜ï¼Œåœ¨è¿è¡Œæ—¶åŠ è½½ç±»å¤±è´¥ã€‚åœ¨æœ¬æ–‡ä¸­ä¹‹æ‰€ä»¥æ’æŸ¥æ—¶èµ°äº†ä¸€äº›å¼¯è·¯ï¼Œæ˜¯å› ä¸º<code>Spring</code>éšè—äº†çœŸå®å¼‚å¸¸ï¼Œç»™æˆ‘ä»¬æ’é”™é€ æˆäº†ä¸€äº›é˜»ç¢ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘æ—¶ä¹Ÿè¦é‡è§†å¼‚å¸¸çš„æ˜ç¡®ä¿¡æ¯ï¼Œå¯ä»¥ç»™æˆ‘ä»¬æ’é”™æä¾›å‡†ç¡®çš„ç›®æ ‡ã€‚</p><p>é’å±±ä¸æ”¹ï¼Œç»¿æ°´é•¿æµï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/7f5dcjjKLdBYpzS5p7_v7Q" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 Stream ä¸­ Collectors çš„ 24 ä¸ªæ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/JOLrw7cbVh8z2czePEfLjw" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 çš„ Optional çš„ 6 ç§æ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/Vhw-2lgCvmhNI5aeXOWYNg" target="_blank" rel="noopener">ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½</a></li><li><a href="https://mp.weixin.qq.com/s/Srv6733byTYDg7hTrW_tdw" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ1ï¼‰ï¼šä»‹ç» Java8 ä¸­çš„æ—¶é—´ç±»åŠå¸¸ç”¨ API</a></li><li><a href="https://mp.weixin.qq.com/s/LRydpL89GsjOeTrLrihyYQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ2ï¼‰ï¼šDate ä¸ LocalDate æˆ– LocalDateTime äº’ç›¸è½¬æ¢</a></li><li><a href="https://mp.weixin.qq.com/s/KmBMLG1y73IUwFuSfUKaEQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ3ï¼‰ï¼šå¼€å§‹ä½¿ç”¨ Java8 ä¸­çš„æ—¶é—´ç±»</a></li><li><a href="https://mp.weixin.qq.com/s/PxC0WQMReIeG0Tyl5WiK1Q" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ4ï¼‰ï¼šæ£€æŸ¥æ—¥æœŸå­—ç¬¦ä¸²æ˜¯å¦åˆæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/rjMOq0QAdiWNacKYqHJqXA" target="_blank" rel="noopener">Java8 çš„æ–°ç‰¹æ€§</a></li><li><a href="https://mp.weixin.qq.com/s/FHv963s0Qvh2K5r2tdLATA" target="_blank" rel="noopener">Java9 çš„æ–°ç‰¹æ€§</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/mybatis-plus-conflict-noclassdeffounderror/">Mybatis-Plus ç‰ˆæœ¬å†²çªè§¦å‘â€œCould not convert argument value of type [java.lang.String] to required type [java.lang.Class]â€çš„ java.lang.NoClassDefFoundError å¼‚å¸¸</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/122203746" target="_blank" rel="noopener">Mybatis-Plus ç‰ˆæœ¬å†²çªè§¦å‘â€œCould not convert argument value of type [java.lang.String] to required type [java.lang.Class]â€çš„ java.lang.NoClassDefFoundError å¼‚å¸¸</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      ä»Šå¤©é¡¹ç›®ä¾èµ–äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶ä¹‹åï¼Œå¯åŠ¨å¤±è´¥ï¼Œæ’æŸ¥è¿‡ç¨‹èµ°äº†ä¸€äº›å¼¯è·¯ï¼Œæœ€ç»ˆç¡®è®¤æ˜¯å› ä¸ºä¾èµ–ç»„ä»¶ç‰ˆæœ¬å†²çªé€ æˆäº†`java.lang.NoClassDefFoundError`å¼‚å¸¸ã€‚ä¸‹é¢æ˜¯æ’æŸ¥è¿‡ç¨‹ï¼Œå¸Œæœ›å¯ä»¥ç»™ä½ æä¾›ä¸€äº›æ€è·¯ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Java" scheme="https://www.howardliu.cn/tags/Java/"/>
    
      <category term="NoClassDefFoundError" scheme="https://www.howardliu.cn/tags/NoClassDefFoundError/"/>
    
      <category term="Mybatis-Plus" scheme="https://www.howardliu.cn/tags/Mybatis-Plus/"/>
    
  </entry>
  
  <entry>
    <title>Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava9 çš„æ–°ç‰¹æ€§</title>
    <link href="https://www.howardliu.cn/java-9-features/"/>
    <id>https://www.howardliu.cn/java-9-features/</id>
    <published>2021-12-19T02:09:20.000Z</published>
    <updated>2021-12-19T02:09:20.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/cover/train-g9ee00db77_1920.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava9 çš„æ–°ç‰¹æ€§"></p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><blockquote><p>æœ¬æ–‡æ”¶å½•åœ¨ <a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378#wechat_redirect" target="_blank" rel="noopener">ã€Šä»å°å·¥åˆ°ä¸“å®¶çš„ Java è¿›é˜¶ä¹‹æ—…ã€‹</a> ç³»åˆ—ä¸“æ ä¸­ã€‚</p></blockquote><p>ä» 2017 å¹´å¼€å§‹ï¼ŒJava ç‰ˆæœ¬æ›´æ–°ç­–ç•¥ä»åŸæ¥çš„æ¯ä¸¤å¹´ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œæ”¹ä¸ºæ¯å…­ä¸ªæœˆä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œä»¥å¿«é€ŸéªŒè¯æ–°ç‰¹æ€§ï¼Œæ¨åŠ¨ Java çš„å‘å±•ã€‚ä» <a href="https://res.cloudinary.com/snyk/image/upload/v1623860216/reports/jvm-ecosystem-report-2021.pdf" target="_blank" rel="noopener">ã€ŠJVM Ecosystem Report 2021ã€‹</a> ä¸­å¯ä»¥çœ‹å‡ºï¼Œç›®å‰å¼€å‘ç¯å¢ƒä¸­æœ‰è¿‘åŠçš„ç¯å¢ƒä½¿ç”¨ Java8ï¼Œæœ‰è¿‘åŠçš„äººè½¬ç§»åˆ°äº† Java11ï¼Œéšç€ Java17 çš„å‘å¸ƒï¼Œç›¸ä¿¡æ¯”ä¾‹ä¼šæœ‰æ‰€å˜åŒ–ã€‚</p><p>å› æ­¤ï¼Œå‡†å¤‡å‡ºä¸€ä¸ªç³»åˆ—ï¼Œé…åˆç¤ºä¾‹è®²è§£ï¼Œé˜è¿°å„ä¸ªç‰ˆæœ¬çš„æ–°ç‰¹æ€§ã€‚</p><a id="more"></a><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ç›¸è¾ƒäº <a href="https://mp.weixin.qq.com/s/f0bgOBy1_Hz-HHRD32HSXw" target="_blank" rel="noopener">Java8</a>ï¼ŒJava9 æ²¡æœ‰æ–°å¢è¯­æ³•ç³–ï¼Œä½†æ˜¯å…¶å¢åŠ çš„ç‰¹æ€§ä¹Ÿéƒ½æ˜¯éå¸¸å®ç”¨çš„ï¼Œæ¯”å¦‚ Jigsaw æ¨¡å—åŒ–ã€JShellã€å‘å¸ƒ-è®¢é˜…æ¡†æ¶ã€GC ç­‰ã€‚æœ¬æ–‡å°†å¿«é€Ÿã€é«˜å±‚æ¬¡çš„ä»‹ç»ä¸€äº›æ–°ç‰¹æ€§ï¼Œå®Œæ•´çš„ç‰¹æ€§å¯ä»¥å‚åŠ <a href="https://openjdk.java.net/projects/jdk9/" target="_blank" rel="noopener">https://openjdk.java.net/projects/jdk9/</a>ã€‚</p><blockquote><p>è¿™é‡Œéœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œç”±äº Java9 å¹¶ä¸æ˜¯é•¿æœŸæ”¯æŒç‰ˆï¼Œå½“å‰ä¹Ÿæ˜¯ä»ç°åœ¨çœ‹è¿‡å»ï¼Œæ‰€ä»¥ç¬”è€…å·ä¸ªæ‡’ï¼Œæ–‡ç« çš„ç¤ºä¾‹ä»£ç éƒ½æ˜¯åœ¨ Java11 ä¸‹å†™çš„ï¼Œå¯èƒ½ä¼šä¸ Java9 ä¸­çš„å®šä¹‰æœ‰äº›å‡ºå…¥ï¼Œä¸è¿‡ï¼Œè¿™ä¹Ÿæ²¡å•¥ï¼Œæ¯•ç«Ÿæˆ‘ä»¬çœŸæ­£ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯ä¼˜å…ˆè€ƒè™‘é•¿æœŸæ”¯æŒç‰ˆã€‚</p></blockquote><h2 id="Jigsaw-æ¨¡å—åŒ–"><a href="#Jigsaw-æ¨¡å—åŒ–" class="headerlink" title="Jigsaw æ¨¡å—åŒ–"></a>Jigsaw æ¨¡å—åŒ–</h2><p>æ¨¡å—åŒ–æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ›´æ–°ï¼Œè¿™è®©ä»¥å‰ All-in-One çš„ Java åŒ…æ‹†åˆ†æˆå‡ ä¸ªæ¨¡å—ã€‚è¿™ç§æ¨¡å—åŒ–ç³»ç»Ÿæä¾›äº†ç±»ä¼¼ OSGi æ¡†æ¶ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¤šä¸ªæ¨¡å—å¯ä»¥ç‹¬ç«‹å¼€å‘ï¼ŒæŒ‰éœ€å¼•ç”¨ã€æŒ‰éœ€é›†æˆï¼Œæœ€ç»ˆç»„è£…æˆä¸€ä¸ªå®Œæ•´åŠŸèƒ½ã€‚</p><p>æ¨¡å—å…·æœ‰ä¾èµ–çš„æ¦‚å¿µï¼Œå¯ä»¥å¯¼å‡ºåŠŸèƒ½ APIï¼Œå¯ä»¥éšè—å®ç°ç»†èŠ‚ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å®ç° JVM çš„æŒ‰éœ€ä½¿ç”¨ï¼Œèƒ½å¤Ÿå‡å° Java è¿è¡ŒåŒ…çš„ä½“ç§¯ï¼Œè®© JVM åœ¨å†…å­˜æ›´å°çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚JVM å½“æ—¶çš„åˆè¡·å°±æ˜¯åšç¡¬ä»¶ï¼Œä¹Ÿç®—æ˜¯ä¸å¿˜åˆå¿ƒäº†ã€‚</p><p>å¦å¤–ï¼ŒJVM ä¸­<code>com.sun.*</code>çš„ä¹‹ç±»çš„å†…éƒ¨ APIï¼Œåšäº†æ›´å¼ºçš„å°é—­ï¼Œä¸åœ¨å…è®¸è°ƒç”¨ï¼Œæå‡äº†å†…æ ¸å®‰å…¨ã€‚</p><p>åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ java ä»£ç çš„é¡¶å±‚ç›®å½•ä¸­å®šä¹‰ä¸€ä¸ª<code>module-info.java</code>æ–‡ä»¶ï¼Œç”¨äºæè¿°æ¨¡å—ä¿¡æ¯ï¼š</p><pre><code class="java">module cn.howardliu.java9.modules.car {    requires cn.howardliu.java9.modules.engines;    exports cn.howardliu.java9.modules.car.handling;}</code></pre><p>ä¸Šé¢æè¿°çš„ä¿¡æ¯æ˜¯ï¼šæ¨¡å—<code>cn.howardliu.java9.modules.car</code>éœ€è¦ä¾èµ–æ¨¡å—<code>cn.howardliu.java9.modules.engines</code>ï¼Œå¹¶å¯¼å‡ºæ¨¡å—<code>cn.howardliu.java9.modules.car.handling</code>ã€‚</p><p>æ›´å¤šçš„ä¿¡æ¯å¯ä»¥æŸ¥çœ‹ OpenJDK çš„æŒ‡å¼• <a href="https://openjdk.java.net/projects/jigsaw/quick-startï¼Œåç»­ä¼šå•ç‹¬ä»‹ç»" target="_blank" rel="noopener">https://openjdk.java.net/projects/jigsaw/quick-startï¼Œåç»­ä¼šå•ç‹¬ä»‹ç»</a> Jigsaw æ¨¡å—çš„ä½¿ç”¨ï¼Œå†…å®¹ä¼šè´´åˆ°è¯„è®ºåŒºã€‚</p><h2 id="å…¨æ–°çš„-HTTP-å®¢æˆ·ç«¯"><a href="#å…¨æ–°çš„-HTTP-å®¢æˆ·ç«¯" class="headerlink" title="å…¨æ–°çš„ HTTP å®¢æˆ·ç«¯"></a>å…¨æ–°çš„ HTTP å®¢æˆ·ç«¯</h2><p>è¿™æ˜¯ä¸€ä¸ªåƒå‘¼ä¸‡å”¤å§‹å‡ºæ¥çš„åŠŸèƒ½ï¼Œç»ˆäºæœ‰å®˜æ–¹ API å¯ä»¥æ›¿æ¢è€æ—§éš¾ç”¨çš„<code>HttpURLConnection</code>ã€‚åªä¸è¿‡ï¼Œåœ¨ Java9 ä¸­ï¼Œæ–°ç‰ˆ HTTP å®¢æˆ·ç«¯æ˜¯æ”¾åœ¨å­µåŒ–æ¨¡å—ä¸­ï¼ˆå…·ä½“ä¿¡æ¯å¯ä»¥æŸ¥çœ‹ <a href="https://openjdk.java.net/jeps/110ï¼‰ã€‚" target="_blank" rel="noopener">https://openjdk.java.net/jeps/110ï¼‰ã€‚</a></p><p>è€ç‰ˆ HTTP å®¢æˆ·ç«¯å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œå¤§å®¶å¼€å‘çš„æ—¶å€™åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹ HTTP åº“ï¼Œæ¯”å¦‚ Apache HttpClientã€Nettyã€Jetty ç­‰ã€‚</p><p>æ–°ç‰ˆ HTTP å®¢æˆ·ç«¯çš„ç›®æ ‡å¾ˆå¤šï¼Œæ¯•ç«Ÿè¿™ä¹ˆå¤šç ç‰åœ¨å‰ï¼Œå¦‚æœè¿˜æ˜¯åšæˆä¸€å¨ï¼ŒæŒ‡å®šæ˜¯è¦è¢«ç¬‘æ­»çš„ã€‚æ‰€ä»¥æ–°ç‰ˆ HTTP å®¢æˆ·ç«¯åˆ—å‡ºäº† 16 ä¸ªç›®æ ‡ï¼ŒåŒ…æ‹¬ç®€å•æ˜“ç”¨ã€æ‰“å°å…³é”®ä¿¡æ¯ã€WebSocketã€HTTP/2ã€HTTPS/TLSã€è‰¯å¥½çš„æ€§èƒ½ã€éé˜»å¡ API ç­‰ç­‰ã€‚</p><p>æˆ‘ä»¬å…ˆç®€å•çš„ç…ç…ï¼š</p><pre><code class="java">final String url = &quot;https://postman-echo.com/get&quot;;final HttpRequest request = HttpRequest.newBuilder()        .uri(new URI(url))        .GET()        .build();final HttpResponse&lt;String&gt; response = HttpClient.newHttpClient()        .send(request, HttpResponse.BodyHandlers.ofString());final HttpHeaders headers = response.headers();headers.map().forEach((k, v) -&gt; System.out.println(k + &quot;:&quot; + v));System.out.println(response.statusCode());System.out.println(response.body());</code></pre><blockquote><p>æ–°ç‰ˆ HTTP å®¢æˆ·ç«¯å¯ä»¥åœ¨ Java11 ä¸­æ­£å¸¸ä½¿ç”¨äº†ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯åœ¨ Java11 ä¸­å†™çš„ï¼ŒAPI æ˜¯åœ¨<code>java.net.http</code>åŒ…ä¸­ã€‚</p></blockquote><h2 id="æ”¹è¿›çš„è¿›ç¨‹-API"><a href="#æ”¹è¿›çš„è¿›ç¨‹-API" class="headerlink" title="æ”¹è¿›çš„è¿›ç¨‹ API"></a>æ”¹è¿›çš„è¿›ç¨‹ API</h2><p>åœ¨ Java9 ä¸­æä¾›çš„è¿›ç¨‹ APIï¼Œå¯ä»¥æ§åˆ¶å’Œç®¡ç†æ“ä½œç³»ç»Ÿè¿›ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­ç®¡ç†å½“å‰è¿›ç¨‹ï¼Œç”šè‡³å¯ä»¥é”€æ¯å½“å‰è¿›ç¨‹ã€‚</p><h3 id="è¿›ç¨‹ä¿¡æ¯"><a href="#è¿›ç¨‹ä¿¡æ¯" class="headerlink" title="è¿›ç¨‹ä¿¡æ¯"></a>è¿›ç¨‹ä¿¡æ¯</h3><p>è¿™ä¸ªåŠŸèƒ½æ˜¯ç”±<code>java.lang.ProcessHandle</code>æä¾›çš„ï¼Œæˆ‘ä»¬æ¥ç…ç…æ€ä¹ˆç”¨ï¼š</p><pre><code class="java">final ProcessHandle self = ProcessHandle.current();final long pid = self.pid();System.out.println(&quot;PID: &quot; + pid);final ProcessHandle.Info procInfo = self.info();procInfo.arguments().ifPresent(x -&gt; {    for (String s : x) {        System.out.println(s);    }});procInfo.commandLine().ifPresent(System.out::println);procInfo.startInstant().ifPresent(System.out::println);procInfo.totalCpuDuration().ifPresent(System.out::println);</code></pre><p><code>java.lang.ProcessHandle.Info</code>ä¸­æä¾›äº†ä¸°å¯Œçš„è¿›ç¨‹ä¿¡æ¯</p><h3 id="é”€æ¯è¿›ç¨‹"><a href="#é”€æ¯è¿›ç¨‹" class="headerlink" title="é”€æ¯è¿›ç¨‹"></a>é”€æ¯è¿›ç¨‹</h3><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>java.lang.ProcessHandle#destroy</code>æ–¹æ³•é”€æ¯è¿›ç¨‹ï¼Œæˆ‘ä»¬æ¼”ç¤ºä¸€ä¸‹é”€æ¯å­è¿›ç¨‹ï¼š</p><pre><code class="java">ProcessHandle.current().children()        .forEach(procHandle -&gt; {            System.out.println(procHandle.pid());            System.out.println(procHandle.destroy());        });</code></pre><blockquote><p>ä» Java8 ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç° Java æä¾›çš„ API ä½¿ç”¨äº†<code>Optional</code>ã€<code>Stream</code>ç­‰åŠŸèƒ½ï¼Œ*<em>Eating your own dog food *</em>ä¹Ÿæ˜¯æ¯”è¾ƒå€¼å¾—å­¦ä¹ çš„ã€‚</p></blockquote><h2 id="å…¶ä»–å°æ”¹åŠ¨"><a href="#å…¶ä»–å°æ”¹åŠ¨" class="headerlink" title="å…¶ä»–å°æ”¹åŠ¨"></a>å…¶ä»–å°æ”¹åŠ¨</h2><p>Java9 ä¸­è¿˜å¯¹åšäº†å¯¹å·²æœ‰åŠŸèƒ½åšäº†ç‚¹æ”¹åŠ¨ï¼Œæˆ‘ä»¬æ¥ç…ç…éƒ½æœ‰å“ªäº›ã€‚</p><h3 id="æ”¹è¿›-try-with-resources"><a href="#æ”¹è¿›-try-with-resources" class="headerlink" title="æ”¹è¿› try-with-resources"></a>æ”¹è¿› try-with-resources</h3><p>ä» Java7 å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>try-with-resources</code>è¯­æ³•è‡ªåŠ¨å…³é—­èµ„æºï¼Œæ‰€æœ‰å®ç°äº†<code>java.lang.AutoCloseable</code>æ¥å£ï¼Œå¯ä»¥ä½œä¸ºèµ„æºã€‚ä½†æ˜¯è¿™é‡Œä¼šæœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå°±æ˜¯æ¯ä¸ªèµ„æºéœ€è¦å£°æ˜ä¸€ä¸ªæ–°å˜é‡ã€‚</p><p>ä¹Ÿå°±æ˜¯è¿™æ ·ï¼š</p><pre><code class="java">public static void tryWithResources() throws IOException {    try (FileInputStream in2 = new FileInputStream(&quot;./&quot;)) {        // do something    }}</code></pre><p>å¯¹äºè¿™ç§ç›´æ¥ä½¿ç”¨çš„è¿˜ç®—æ–¹ä¾¿ï¼Œä½†å¦‚æœæ˜¯éœ€è¦ç»è¿‡ä¸€äº›åˆ—æ–¹æ³•å®šä¹‰çš„å‘¢ï¼Ÿå°±å¾—å†™æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><pre><code class="java">final Reader inputString = new StringReader(&quot;www.howardliu.cn çœ‹å±±&quot;);final BufferedReader br = new BufferedReader(inputString);// å…¶ä»–ä¸€äº›é€»è¾‘try (BufferedReader br1 = br) {    System.out.println(br1.lines());}</code></pre><p>åœ¨ Java9 ä¸­ï¼Œå¦‚æœèµ„æºæ˜¯<code>final</code>å®šä¹‰çš„æˆ–è€…ç­‰åŒäº<code>final</code>å˜é‡ï¼Œå°±ä¸ç”¨å£°æ˜æ–°çš„å˜é‡åï¼Œå¯ä»¥ç›´æ¥åœ¨<code>try-with-resources</code>ä¸­ä½¿ç”¨ï¼š</p><pre><code class="java">final Reader inputString = new StringReader(&quot;www.howardliu.cn çœ‹å±±&quot;);final BufferedReader br = new BufferedReader(inputString);// å…¶ä»–ä¸€äº›é€»è¾‘try (br) {    System.out.println(br.lines());}</code></pre><h3 id="æ”¹è¿›é’»çŸ³æ“ä½œç¬¦-Diamond-Operator"><a href="#æ”¹è¿›é’»çŸ³æ“ä½œç¬¦-Diamond-Operator" class="headerlink" title="æ”¹è¿›é’»çŸ³æ“ä½œç¬¦ (Diamond Operator)"></a>æ”¹è¿›é’»çŸ³æ“ä½œç¬¦ (Diamond Operator)</h3><p>é’»çŸ³æ“ä½œç¬¦ï¼ˆä¹Ÿå°±æ˜¯<code>&lt;&gt;</code>ï¼‰æ˜¯ Java7 å¼•å…¥çš„ï¼Œå¯ä»¥ç®€åŒ–æ³›å‹çš„ä¹¦å†™ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">Map&lt;String, List&lt;String&gt;&gt; strsMap = new TreeMap&lt;String, List&lt;String&gt;&gt;();</code></pre><p>å³ä¾§çš„<code>TreeMap</code>ç±»å‹å¯ä»¥æ ¹æ®å·¦ä¾§çš„æ³›å‹å®šä¹‰æ¨æ–­å‡ºæ¥ï¼Œå€ŸåŠ©é’»çŸ³æ“ä½œç¬¦å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><pre><code class="java">Map&lt;String, List&lt;String&gt;&gt; strsMap = new TreeMap&lt;&gt;();</code></pre><p>çœ‹å±±ä¼šç®€æ´å¾ˆå¤šï¼Œ<code>&lt;&gt;</code>çš„å†™æ³•å°±æ˜¯é’»çŸ³æ“ä½œç¬¦ (Diamond Operator)ã€‚</p><p>ä½†æ˜¯è¿™ç§å†™æ³•ä¸é€‚ç”¨äºåŒ¿åå†…éƒ¨ç±»ã€‚æ¯”å¦‚æœ‰ä¸ªæŠ½è±¡ç±»ï¼š</p><pre><code class="java">abstract static class Consumer&lt;T&gt; {    private T content;    public Consumer(T content) {        this.content = content;    }    abstract void accept();    public T getContent() {        return content;    }}</code></pre><p>åœ¨ Java9 ä¹‹å‰ï¼Œæƒ³è¦å®ç°åŒ¿åå†…éƒ¨ç±»ï¼Œå°±éœ€è¦å†™æˆï¼š</p><pre><code class="java">final Consumer&lt;Integer&gt; intConsumer = new Consumer&lt;Integer&gt;(1) {    @Override    void accept() {        System.out.println(getContent());    }};intConsumer.accept();final Consumer&lt;? extends Number&gt; numConsumer = new Consumer&lt;Number&gt;(BigDecimal.TEN) {    @Override    void accept() {        System.out.println(getContent());    }};numConsumer.accept();final Consumer&lt;?&gt; objConsumer = new Consumer&lt;Object&gt;(&quot;çœ‹å±±&quot;) {    @Override    void accept() {        System.out.println(getContent());    }};objConsumer.accept();</code></pre><p>åœ¨ Java9 ä¹‹åå°±å¯ä»¥ä½¿ç”¨é’»çŸ³æ“ä½œç¬¦äº†ï¼š</p><pre><code class="java">final Consumer&lt;Integer&gt; intConsumer = new Consumer&lt;&gt;(1) {    @Override    void accept() {        System.out.println(getContent());    }};intConsumer.accept();final Consumer&lt;? extends Number&gt; numConsumer = new Consumer&lt;&gt;(BigDecimal.TEN) {    @Override    void accept() {        System.out.println(getContent());    }};numConsumer.accept();final Consumer&lt;?&gt; objConsumer = new Consumer&lt;&gt;(&quot;çœ‹å±±&quot;) {    @Override    void accept() {        System.out.println(getContent());    }};objConsumer.accept();</code></pre><h3 id="ç§æœ‰æ¥å£æ–¹æ³•"><a href="#ç§æœ‰æ¥å£æ–¹æ³•" class="headerlink" title="ç§æœ‰æ¥å£æ–¹æ³•"></a>ç§æœ‰æ¥å£æ–¹æ³•</h3><p>å¦‚æœè¯´é’»çŸ³æ“ä½œç¬¦æ˜¯ä»£ç çš„ç®€æ´å¯è¯»ï¼Œé‚£æ¥å£çš„ç§æœ‰æ–¹æ³•å°±æ˜¯æ¯”è¾ƒå®ç”¨çš„ä¸€ä¸ªæ‰©å±•äº†ã€‚</p><p>åœ¨ Java8 ä¹‹å‰ï¼Œæ¥å£åªèƒ½æœ‰å¸¸é‡å’ŒæŠ½è±¡æ–¹æ³•ï¼Œæƒ³è¦æœ‰å…·ä½“çš„å®ç°ï¼Œå°±åªèƒ½å€ŸåŠ©æŠ½è±¡ç±»ï¼Œä½†æ˜¯ Java æ˜¯å•ç»§æ‰¿ï¼Œæœ‰å¾ˆå¤šåœºæ™¯ä¼šå—åˆ°é™åˆ¶ã€‚</p><p>åœ¨ Java8 ä¹‹åï¼Œæ¥å£ä¸­å¯ä»¥å®šä¹‰é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•ï¼Œæä¾›äº†å¾ˆå¤šæ‰©å±•ã€‚ä½†è¿™äº›æ–¹æ³•éƒ½æ˜¯<code>public</code>æ–¹æ³•ï¼Œæ˜¯å®Œå…¨å¯¹å¤–æš´éœ²çš„ã€‚å¦‚æœæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œåªæƒ³åœ¨æ¥å£ä¸­ä½¿ç”¨ï¼Œä¸æƒ³å°†å…¶æš´éœ²å‡ºæ¥ï¼Œå°±æ²¡æœ‰åŠæ³•äº†ã€‚è¿™ä¸ªé—®é¢˜åœ¨ Java9 ä¸­å¾—åˆ°äº†è§£å†³ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>private</code>ä¿®é¥°ï¼Œé™åˆ¶å…¶ä½œç”¨åŸŸã€‚</p><p>æ¯”å¦‚ï¼š</p><pre><code class="java">public interface Metric {    // å¸¸é‡    String NAME = &quot;METRIC&quot;;    // æŠ½è±¡æ–¹æ³•    void info();    // ç§æœ‰æ–¹æ³•    private void append(String tag, String info) {        buildMetricInfo();        System.out.println(NAME + &quot;[&quot; + tag + &quot;]:&quot; + info);        clearMetricInfo();    }    // é»˜è®¤æ–¹æ³•    default void appendGlobal(String message) {        append(&quot;GLOBAL&quot;, message);    }    // é»˜è®¤æ–¹æ³•    default void appendDetail(String message) {        append(&quot;DETAIL&quot;, message);    }    // ç§æœ‰é™æ€æ–¹æ³•    private static void buildMetricInfo() {        System.out.println(&quot;build base metric&quot;);    }    // ç§æœ‰é™æ€æ–¹æ³•    private static void clearMetricInfo() {        System.out.println(&quot;clear base metric&quot;);    }}</code></pre><h2 id="JShell"><a href="#JShell" class="headerlink" title="JShell"></a>JShell</h2><p>JShell å°±æ˜¯ Java è¯­è¨€æä¾›çš„ REPL(Read Eval Print Loopï¼Œäº¤äº’å¼çš„ç¼–ç¨‹ç¯å¢ƒï¼‰ç¯å¢ƒã€‚åœ¨ Pythonã€Node ä¹‹ç±»çš„è¯­è¨€ï¼Œå¾ˆæ—©å°±å¸¦æœ‰è¿™ç§ç¯å¢ƒï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰§è¡Œ Java è¯­å¥ï¼Œå¿«é€ŸéªŒè¯ä¸€äº›è¯­æ³•ã€åŠŸèƒ½ç­‰ã€‚</p><pre><code class="shell">$ jshell|  æ¬¢è¿ä½¿ç”¨ JShell -- ç‰ˆæœ¬ 13.0.9|  è¦å¤§è‡´äº†è§£è¯¥ç‰ˆæœ¬ï¼Œè¯·é”®å…¥ï¼š/help intro</code></pre><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>/help</code>æŸ¥çœ‹å‘½ä»¤</p><pre><code class="shell">jshell&gt; /help|  é”®å…¥ Java è¯­è¨€è¡¨è¾¾å¼ï¼Œè¯­å¥æˆ–å£°æ˜ã€‚|  æˆ–è€…é”®å…¥ä»¥ä¸‹å‘½ä»¤ä¹‹ä¸€ï¼š|  /list [&lt;åç§°æˆ– id&gt;|-all|-start]|      åˆ—å‡ºæ‚¨é”®å…¥çš„æº|  /edit &lt;åç§°æˆ– id&gt;ã€‚å¾ˆå¤šçš„å†…å®¹ï¼Œé‰´äºç¯‡å¹…ï¼Œå…ˆéšè—</code></pre><p>æˆ‘ä»¬çœ‹ä¸‹ä¸€äº›ç®€å•çš„æ“ä½œï¼š</p><pre><code class="shell">jshell&gt; &quot;This is a test.&quot;.substring(5, 10);$2 ==&gt; &quot;is a &quot;jshell&gt; 3+1$3 ==&gt; 4</code></pre><p>ä¹Ÿå¯ä»¥åˆ›å»ºæ–¹æ³•ï¼š</p><pre><code class="shell">jshell&gt; int mulitiTen(int i) { return i*10;}|  å·²åˆ›å»º æ–¹æ³• mulitiTen(int)jshell&gt; mulitiTen(3)$6 ==&gt; 30</code></pre><p>æƒ³è¦é€€å‡º JShell ç›´æ¥è¾“å…¥ï¼š</p><pre><code class="shell">jshell&gt; /exit|  å†è§</code></pre><h2 id="JCMD-æ–°å¢å­å‘½ä»¤"><a href="#JCMD-æ–°å¢å­å‘½ä»¤" class="headerlink" title="JCMD æ–°å¢å­å‘½ä»¤"></a>JCMD æ–°å¢å­å‘½ä»¤</h2><p><code>jcmd</code>æ˜¯ç”¨äºå‘æœ¬åœ° jvm è¿›ç¨‹å‘é€è¯Šæ–­å‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤æ˜¯ä» JDK7 æä¾›çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¸¸ç”¨äºå¿«é€Ÿå®šä½çº¿ä¸Šç¯å¢ƒæ•…éšœã€‚</p><p>åœ¨ JDK9 ä¹‹åï¼Œæä¾›äº†ä¸€äº›æ–°çš„å­å‘½ä»¤ï¼ŒæŸ¥çœ‹ JVM ä¸­åŠ è½½çš„æ‰€æœ‰ç±»åŠå…¶ç»§æ‰¿ç»“æ„çš„åˆ—è¡¨ã€‚æ¯”å¦‚ï¼š</p><pre><code class="shell">$ jcmd 22922 VM.class_hierarchy -i -s java.net.Socket22922:java.lang.Object/null|--java.net.Socket/null|  implements java.io.Closeable/null (declared intf)|  implements java.lang.AutoCloseable/null (inherited intf)|  |--sun.nio.ch.SocketAdaptor/null|  |  implements java.lang.AutoCloseable/null (inherited intf)|  |  implements java.io.Closeable/null (inherited intf)</code></pre><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¿›ç¨‹ IDï¼Œéƒ½æ˜¯é’ˆå¯¹è¿™ä¸ªè¿›ç¨‹æ‰§è¡Œè¯Šæ–­ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>set_vmflag</code>å‚æ•°åœ¨çº¿ä¿®æ”¹ JVM å‚æ•°ï¼Œè¿™ç§æ“ä½œæ— éœ€é‡å¯ JVM è¿›ç¨‹ã€‚</p><p>æœ‰æ—¶å€™è¿˜éœ€è¦æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„è™šæ‹Ÿæœºå‚æ•°é€‰é¡¹å’Œå½“å‰å€¼ï¼š<code>jcmd 22922 VM.flags -all</code>ã€‚</p><h2 id="å¤šåˆ†è¾¨ç‡å›¾åƒ-API"><a href="#å¤šåˆ†è¾¨ç‡å›¾åƒ-API" class="headerlink" title="å¤šåˆ†è¾¨ç‡å›¾åƒ API"></a>å¤šåˆ†è¾¨ç‡å›¾åƒ API</h2><p>åœ¨ Java9 ä¸­å®šä¹‰äº†å¤šåˆ†è¾¨ç‡å›¾åƒ APIï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„æ“ä½œå’Œå±•ç¤ºä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒäº†ã€‚<code>java.awt.image.MultiResolutionImage</code>å°†ä¸€ç»„å…·æœ‰ä¸åŒåˆ†è¾¨ç‡çš„å›¾åƒå°è£…åˆ°å•ä¸ªå¯¹è±¡ä¸­ã€‚<code>java.awt.Graphics</code>ç±»æ ¹æ®å½“å‰æ˜¾ç¤º DPI åº¦é‡å’Œä»»ä½•åº”ç”¨çš„è½¬æ¢ä»å¤šåˆ†è¾¨ç‡å›¾åƒä¸­è·å–å˜é‡ã€‚</p><p>ä»¥ä¸‹æ˜¯å¤šåˆ†è¾¨ç‡å›¾åƒçš„ä¸»è¦æ“ä½œæ–¹æ³•ï¼š</p><ul><li><code>Image getResolutionVariant(double destImageWidth, double destImageHeight)</code>ï¼šè·å–ç‰¹å®šåˆ†è¾¨ç‡çš„å›¾åƒå˜ä½“-è¡¨ç¤ºä¸€å¼ å·²çŸ¥åˆ†è¾¨ç‡å•ä½ä¸º DPI çš„ç‰¹å®šå°ºå¯¸å¤§å°çš„é€»è¾‘å›¾åƒï¼Œå¹¶ä¸”è¿™å¼ å›¾åƒæ˜¯æœ€ä½³çš„å˜ä½“ã€‚</li><li><code>List&lt;Image&gt; getResolutionVariants()</code>ï¼šè¿”å›å¯è¯»çš„åˆ†è¾¨ç‡çš„å›¾åƒå˜ä½“åˆ—è¡¨ã€‚</li></ul><p>æˆ‘ä»¬æ¥çœ‹ä¸‹åº”ç”¨ï¼š</p><pre><code class="java">final List&lt;Image&gt; images = List.of(        ImageIO.read(new URL(&quot;https://static.howardliu.cn/about/kanshanshuo_2.png&quot;)),        ImageIO.read(new URL(&quot;https://static.howardliu.cn/about/hellokanshan.png&quot;)),        ImageIO.read(new URL(&quot;https://static.howardliu.cn/about/evil%20coder.jpg&quot;)));// è¯»å–æ‰€æœ‰å›¾ç‰‡final MultiResolutionImage multiResolutionImage = new BaseMultiResolutionImage(images.toArray(new Image[0]));// è·å–å›¾ç‰‡çš„æ‰€æœ‰åˆ†è¾¨ç‡final List&lt;Image&gt; variants = multiResolutionImage.getResolutionVariants();System.out.println(&quot;Total number of images: &quot; + variants.size());for (Image img : variants) {    System.out.println(img);}// æ ¹æ®ä¸åŒå°ºå¯¸è·å–å¯¹åº”çš„å›¾åƒåˆ†è¾¨ç‡Image variant1 = multiResolutionImage.getResolutionVariant(100, 100);System.out.printf(&quot;\nImage for destination[%d,%d]: [%d,%d]&quot;,        100, 100, variant1.getWidth(null), variant1.getHeight(null));Image variant2 = multiResolutionImage.getResolutionVariant(200, 200);System.out.printf(&quot;\nImage for destination[%d,%d]: [%d,%d]&quot;,        200, 200, variant2.getWidth(null), variant2.getHeight(null));Image variant3 = multiResolutionImage.getResolutionVariant(300, 300);System.out.printf(&quot;\nImage for destination[%d,%d]: [%d,%d]&quot;,        300, 300, variant3.getWidth(null), variant3.getHeight(null));Image variant4 = multiResolutionImage.getResolutionVariant(400, 400);System.out.printf(&quot;\nImage for destination[%d,%d]: [%d,%d]&quot;,        400, 400, variant4.getWidth(null), variant4.getHeight(null));Image variant5 = multiResolutionImage.getResolutionVariant(500, 500);System.out.printf(&quot;\nImage for destination[%d,%d]: [%d,%d]&quot;,        500, 500, variant5.getWidth(null), variant5.getHeight(null));</code></pre><h2 id="å˜é‡å¥æŸ„ï¼ˆVariable-Handlesï¼‰"><a href="#å˜é‡å¥æŸ„ï¼ˆVariable-Handlesï¼‰" class="headerlink" title="å˜é‡å¥æŸ„ï¼ˆVariable Handlesï¼‰"></a>å˜é‡å¥æŸ„ï¼ˆVariable Handlesï¼‰</h2><p>å˜é‡å¥æŸ„ï¼ˆVariable Handlesï¼‰çš„ API ä¸»è¦æ˜¯ç”¨æ¥æ›¿ä»£<code>java.util.concurrent.atomic</code>åŒ…å’Œ<code>sun.misc.Unsafe</code>ç±»çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ç³»åˆ—æ ‡å‡†çš„å†…å­˜å±éšœæ“ä½œï¼Œç”¨æ¥æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶å†…å­˜æ’åºã€‚ä¸€ä¸ªå˜é‡å¥æŸ„æ˜¯ä¸€ä¸ªå˜é‡ï¼ˆä»»ä½•å­—æ®µã€æ•°ç»„å…ƒç´ ã€é™æ€è¡¨é‡Œç­‰ï¼‰çš„ç±»å‹å¼•ç”¨ï¼Œæ”¯æŒåœ¨ä¸åŒè®¿é—®æ¨¡å‹ä¸‹å¯¹è¿™äº›ç±»å‹å˜é‡çš„è®¿é—®ï¼ŒåŒ…æ‹¬ç®€å•çš„ read/write è®¿é—®ï¼Œvolatile ç±»å‹çš„ read/write è®¿é—®ï¼Œå’Œ CAS(compare-and-swap) ç­‰ã€‚</p><blockquote><p>è¿™éƒ¨åˆ†å†…å®¹æ¶‰åŠåå°„ã€å†…è”ã€å¹¶å‘ç­‰å†…å®¹ï¼Œåç»­ä¼šå•ç‹¬ä»‹ç»ï¼Œæ–‡ç« æœ€ç»ˆä¼šå‘å¸ƒåœ¨ <a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378#wechat_redirect" target="_blank" rel="noopener">ä»å°å·¥åˆ°ä¸“å®¶çš„ Java è¿›é˜¶ä¹‹æ—…</a> ä¸­ï¼Œæ•¬è¯·å…³æ³¨ã€‚</p></blockquote><h2 id="å‘å¸ƒ-è®¢é˜…æ¡†æ¶"><a href="#å‘å¸ƒ-è®¢é˜…æ¡†æ¶" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¡†æ¶"></a>å‘å¸ƒ-è®¢é˜…æ¡†æ¶</h2><p>åœ¨ Java9 ä¸­å¢åŠ çš„<code>java.util.concurrent.Flow</code>æ”¯æŒå“åº”å¼ API çš„å‘å¸ƒ-è®¢é˜…æ¡†æ¶ï¼Œä»–ä»¬æä¾›åœ¨ JVM ä¸Šè¿è¡Œçš„è®¸å¤šå¼‚æ­¥ç³»ç»Ÿä¹‹é—´çš„äº’æ“ä½œæ€§ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>SubmissionPublisher</code>å®šåˆ¶ç»„ä»¶ã€‚</p><blockquote><p>å…³äºå“åº”å¼ API çš„å†…å®¹å¯ä»¥å…ˆæŸ¥çœ‹ <a href="http://www.reactive-streams.org/çš„å†…å®¹ï¼Œåç»­å•ç‹¬ä»‹ç»ï¼Œæ–‡ç« æœ€ç»ˆä¼šå‘å¸ƒåœ¨" target="_blank" rel="noopener">http://www.reactive-streams.org/çš„å†…å®¹ï¼Œåç»­å•ç‹¬ä»‹ç»ï¼Œæ–‡ç« æœ€ç»ˆä¼šå‘å¸ƒåœ¨</a> <a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378#wechat_redirect" target="_blank" rel="noopener">ä»å°å·¥åˆ°ä¸“å®¶çš„ Java è¿›é˜¶ä¹‹æ—…</a> ä¸­ï¼Œæ•¬è¯·å…³æ³¨ã€‚æ€ä¹ˆæ„Ÿè§‰ç»™è‡ªå·±åˆ¨äº†è¿™ä¹ˆå¤šå‘ï¼Œå¾—æŠ“ç´§æ—¶é—´å¡«å‘äº†ã€‚</p></blockquote><h2 id="ç»Ÿä¸€-JVM-æ—¥å¿—è®°å½•"><a href="#ç»Ÿä¸€-JVM-æ—¥å¿—è®°å½•" class="headerlink" title="ç»Ÿä¸€ JVM æ—¥å¿—è®°å½•"></a>ç»Ÿä¸€ JVM æ—¥å¿—è®°å½•</h2><p>åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œä¸º JVM çš„æ‰€æœ‰ç»„ä»¶å¼•å…¥äº†ä¸€ä¸ªé€šç”¨çš„æ—¥å¿—ç³»ç»Ÿã€‚å®ƒæä¾›äº†æ—¥å¿—è®°å½•çš„åŸºç¡€ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯é€šè¿‡<code>-Xlog</code>å¯åŠ¨å‚æ•°æŒ‡å®šï¼Œå¹¶ä¸”å®šä¹‰å¾ˆå¤šæ ‡ç­¾ç”¨æ¥å®šä¹‰ä¸åŒç±»å‹æ—¥å¿—ï¼Œæ¯”å¦‚ï¼šgcï¼ˆåƒåœ¾æ”¶é›†ï¼‰ã€compilerï¼ˆç¼–è¯‘ï¼‰ã€threadsï¼ˆçº¿ç¨‹ï¼‰ç­‰ç­‰ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å®šä¹‰<code>debug</code>ç­‰çº§çš„ gc æ—¥å¿—ï¼Œæ—¥å¿—å­˜å‚¨åœ¨<code>gc.log</code>æ–‡ä»¶ä¸­ï¼š</p><pre><code class="shell">java -Xlog:gc=debug:file=gc.log:none</code></pre><p>å› ä¸ºå‚æ•°æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>java -Xlog:help</code>æŸ¥çœ‹å…·ä½“å®šä¹‰å‚æ•°ã€‚è€Œä¸”æ—¥å¿—é…ç½®å¯ä»¥é€šè¿‡<code>jcmd</code>å‘½ä»¤åŠ¨æ€ä¿®æ”¹ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å°†æ—¥å¿—è¾“å‡ºæ–‡ä»¶ä¿®æ”¹ä¸º<code>gc_other.log</code>ï¼š</p><pre><code class="shell">jcmd ${PID} VM.log output=gc_other.log what=gc</code></pre><h2 id="æ–°çš„-API"><a href="#æ–°çš„-API" class="headerlink" title="æ–°çš„ API"></a>æ–°çš„ API</h2><h3 id="ä¸å¯å˜é›†åˆ"><a href="#ä¸å¯å˜é›†åˆ" class="headerlink" title="ä¸å¯å˜é›†åˆ"></a>ä¸å¯å˜é›†åˆ</h3><p>åœ¨ Java9 ä¸­å¢åŠ çš„<code>java.util.List.of()</code>ã€<code>java.util.Set.of()</code>ã€<code>java.util.Map.of()</code>ç³»åˆ—æ–¹æ³•ï¼Œå¯ä»¥ä¸€è¡Œä»£ç åˆ›å»ºä¸å¯å˜é›†åˆã€‚åœ¨ Java9 ä¹‹å‰ï¼Œæˆ‘ä»¬æƒ³è¦åˆå§‹åŒ–ä¸€ä¸ªæœ‰æŒ‡å®šå€¼çš„é›†åˆï¼Œéœ€è¦æ‰§è¡Œä¸€å †<code>add</code>æˆ–<code>put</code>æ–¹æ³•ï¼Œæˆ–è€…ä¾èµ–<code>guava</code>æ¡†æ¶ã€‚</p><p>è€Œä¸”ï¼Œè¿™äº›é›†åˆå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå‡è®¾æˆ‘ä»¬å°†å€¼ä¼ å…¥æŸä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±æ²¡æœ‰åŠæ³•æ§åˆ¶è¿™äº›é›†åˆçš„å€¼ä¸ä¼šè¢«ä¿®æ”¹ã€‚åœ¨ Java9 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>ImmutableCollections</code>ä¸­çš„å®šä¹‰å®ç°åˆå§‹åŒ–ä¸€ä¸ªä¸å¯å˜çš„ã€æœ‰åˆå§‹å€¼çš„é›†åˆäº†ã€‚å¦‚æœå¯¹è¿™äº›å¯¹è±¡è¿›è¡Œä¿®æ”¹ï¼ˆæ–°å¢å…ƒç´ ã€åˆ é™¤å…ƒç´ ï¼‰ï¼Œå°±ä¼šæŠ›å‡º<code>UnsupportedOperationException</code>å¼‚å¸¸ã€‚</p><p>è¿™é‡Œä¸å¾—ä¸æçš„æ˜¯ï¼ŒJava å¼€å‘è€…ä»¬ä¹Ÿæ˜¯è€ƒè™‘äº†æ€§èƒ½ï¼Œé’ˆå¯¹ä¸åŒæ•°é‡çš„é›†åˆï¼Œæä¾›äº†ä¸åŒçš„å®ç°ç±»ï¼š</p><ul><li><code>List12</code>ã€<code>Set12</code>ã€<code>Map1</code>ä¸“é—¨ç”¨äºå°‘é‡ï¼ˆList å’Œ Set æ˜¯ 2 ä¸ªï¼Œå¯¹äº Map æ˜¯ 1 å¯¹ï¼‰å…ƒç´ æ•°é‡çš„åœºæ™¯</li><li><code>ListN</code>ã€<code>SetN</code>ã€<code>MapN</code>ç”¨äºæ•°æ®é‡å¤šï¼ˆList å’Œ Set æ˜¯è¶…è¿‡ 2 ä¸ªï¼Œå¯¹äº Map æ˜¯å¤šä½™ 1 å¯¹ï¼‰çš„åœºæ™¯</li></ul><h3 id="æ”¹è¿›çš„-Optional-ç±»"><a href="#æ”¹è¿›çš„-Optional-ç±»" class="headerlink" title="æ”¹è¿›çš„ Optional ç±»"></a>æ”¹è¿›çš„ Optional ç±»</h3><p>Java9 ä¸­ä¸º<code>Optional</code>æ·»åŠ äº†ä¸‰ä¸ªå®ç”¨æ–¹æ³•ï¼š<code>stream</code>ã€<code>ifPresentOrElse</code>ã€<code>or</code>ã€‚</p><p><code>stream</code>æ˜¯å°†<code>Optional</code>è½¬ä¸ºä¸€ä¸ª<code>Stream</code>ï¼Œå¦‚æœè¯¥<code>Optional</code>ä¸­åŒ…å«å€¼ï¼Œé‚£ä¹ˆå°±è¿”å›åŒ…å«è¿™ä¸ªå€¼çš„<code>Stream</code>ï¼Œå¦åˆ™è¿”å›<code>Stream.empty()</code>ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé›†åˆï¼Œéœ€è¦è¿‡æ»¤éç©ºæ•°æ®ï¼Œåœ¨ Java9 ä¹‹å‰ï¼Œå†™æ³•å¦‚ä¸‹ï¼š</p><pre><code class="java">final List&lt;Optional&lt;String&gt;&gt; list = Arrays.asList(        Optional.empty(),        Optional.of(&quot;çœ‹å±±&quot;),        Optional.empty(),        Optional.of(&quot;çœ‹å±±çš„å°å±‹&quot;));final List&lt;String&gt; filteredList = list.stream()        .flatMap(o -&gt; o.isPresent() ? Stream.of(o.get()) : Stream.empty())        .collect(Collectors.toList());</code></pre><p>åœ¨ Java9 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>stream</code>æ–¹æ³•ï¼š</p><pre><code class="java">final List&lt;String&gt; filteredListJava9 = list.stream()        .flatMap(Optional::stream)        .collect(Collectors.toList());</code></pre><p><code>ifPresentOrElse</code>ï¼šå¦‚æœä¸€ä¸ª<code>Optional</code>åŒ…å«å€¼ï¼Œåˆ™å¯¹å…¶åŒ…å«çš„å€¼è°ƒç”¨å‡½æ•°<code>action</code>ï¼Œå³<code>action.accept(value)</code>ï¼Œè¿™ä¸<code>ifPresent</code>æ–¹æ³•ä¸€è‡´ï¼›å¦‚æœ<code>Optional</code>ä¸åŒ…å«å€¼ï¼Œé‚£ä¼šè°ƒç”¨<code>emptyAction</code>ï¼Œå³<code>emptyAction.run()</code>ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p><pre><code class="java">Optional&lt;Integer&gt; optional = Optional.of(1);optional.ifPresentOrElse(x -&gt; System.out.println(&quot;Value: &quot; + x), () -&gt; System.out.println(&quot;Not Present.&quot;));optional = Optional.empty();optional.ifPresentOrElse(x -&gt; System.out.println(&quot;Value: &quot; + x), () -&gt; System.out.println(&quot;Not Present.&quot;));// è¾“å‡ºç»“æœä¸ºï¼š// ä½œè€…ï¼šçœ‹å±±// ä½šå</code></pre><p><code>or</code>ï¼šå¦‚æœå€¼å­˜åœ¨ï¼Œè¿”å›<code>Optional</code>æŒ‡å®šçš„å€¼ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé¢„è®¾çš„å€¼ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p><pre><code class="java">Optional&lt;String&gt; optional1 = Optional.of(&quot;çœ‹å±±&quot;);Supplier&lt;Optional&lt;String&gt;&gt; supplierString = () -&gt; Optional.of(&quot;ä½šå&quot;);optional1 = optional1.or(supplierString);optional1.ifPresent(x -&gt; System.out.println(&quot;ä½œè€…ï¼š&quot; + x));optional1 = Optional.empty();optional1 = optional1.or(supplierString);optional1.ifPresent(x -&gt; System.out.println(&quot;ä½œè€…ï¼š&quot; + x));// è¾“å‡ºç»“æœä¸ºï¼š// ä½œè€…ï¼šçœ‹å±±// ä½œè€…ï¼šä½šå</code></pre><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»‹ç»äº† Java9 æ–°å¢çš„ç‰¹æ€§ï¼Œå®Œæ•´çš„ç‰¹æ€§æ¸…å•å¯ä»¥ä»<a href="https://openjdk.java.net/projects/jdk9/" target="_blank" rel="noopener">https://openjdk.java.net/projects/jdk9/</a>æŸ¥çœ‹ã€‚æ–‡ä¸­ä¹Ÿç»™è‡ªå·±åˆ¨äº†å‡ ä¸ªå‘ï¼Œç¢äºç¯‡å¹…ï¼Œæ²¡æœ‰åŠæ³•å±•å¼€ï¼Œæ‰€æœ‰è¿™äº›éœ€è¦å±•å¼€çš„åŠŸèƒ½ç»†è¿°ï¼Œéƒ½ä¼šåœ¨ Java8 åˆ° Java17 çš„æ–°ç‰¹æ€§ç³»åˆ—å®Œæˆåè¡¥å……ï¼Œåšæ–‡ä¼šå‘å¸ƒåœ¨ <a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378#wechat_redirect" target="_blank" rel="noopener">ä»å°å·¥åˆ°ä¸“å®¶çš„ Java è¿›é˜¶ä¹‹æ—…</a> ç³»åˆ—ä¸“æ ä¸­ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/7f5dcjjKLdBYpzS5p7_v7Q" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 Stream ä¸­ Collectors çš„ 24 ä¸ªæ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/JOLrw7cbVh8z2czePEfLjw" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 çš„ Optional çš„ 6 ç§æ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/Vhw-2lgCvmhNI5aeXOWYNg" target="_blank" rel="noopener">ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½</a></li><li><a href="https://mp.weixin.qq.com/s/Srv6733byTYDg7hTrW_tdw" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ1ï¼‰ï¼šä»‹ç» Java8 ä¸­çš„æ—¶é—´ç±»åŠå¸¸ç”¨ API</a></li><li><a href="https://mp.weixin.qq.com/s/LRydpL89GsjOeTrLrihyYQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ2ï¼‰ï¼šDate ä¸ LocalDate æˆ– LocalDateTime äº’ç›¸è½¬æ¢</a></li><li><a href="https://mp.weixin.qq.com/s/KmBMLG1y73IUwFuSfUKaEQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ3ï¼‰ï¼šå¼€å§‹ä½¿ç”¨ Java8 ä¸­çš„æ—¶é—´ç±»</a></li><li><a href="https://mp.weixin.qq.com/s/PxC0WQMReIeG0Tyl5WiK1Q" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ4ï¼‰ï¼šæ£€æŸ¥æ—¥æœŸå­—ç¬¦ä¸²æ˜¯å¦åˆæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/rjMOq0QAdiWNacKYqHJqXA" target="_blank" rel="noopener">Java8 çš„æ–°ç‰¹æ€§</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/java-9-features/">Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava9 çš„æ–°ç‰¹æ€§</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava9 çš„æ–°ç‰¹æ€§</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      Java9 çš„æ–°ç‰¹æ€§ã€‚Java9 å‘å¸ƒäº 2017 å¹´ 9 æœˆ 22 æ—¥ï¼Œå¸¦æ¥äº†å¾ˆå¤šæ–°ç‰¹æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬Jigsawæ¨¡å—åŒ–ã€æ–°çš„HTTPå®¢æˆ·ç«¯ï¼ˆJava9ä¸­å¤„äºå­µåŒ–ä¸­ï¼Œåˆ°Java11å¯ä»¥æ­£å¼ä½¿ç”¨ï¼‰ã€è¿›ç¨‹APIã€JShellã€JCMDæ–°å¢å­å‘½ä»¤ã€å¤šåˆ†è¾¨ç‡å›¾åƒAPIã€å˜é‡å¥æŸ„ã€å‘å¸ƒ-è®¢é˜…æ¡†æ¶ã€ç»Ÿä¸€JVMæ—¥å¿—ç­‰ç­‰ï¼Œè¿˜æœ‰å¾ˆå¤šå°åŠŸèƒ½ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Java" scheme="https://www.howardliu.cn/tags/Java/"/>
    
      <category term="Java9" scheme="https://www.howardliu.cn/tags/Java9/"/>
    
  </entry>
  
  <entry>
    <title>å¾®æœåŠ¡æ¶æ„çš„é™·é˜±ï¼šä»å•ä½“åˆ°åˆ†å¸ƒå¼å•ä½“</title>
    <link href="https://www.howardliu.cn/avoid-the-distributed-monolith/"/>
    <id>https://www.howardliu.cn/avoid-the-distributed-monolith/</id>
    <published>2021-12-12T14:32:20.000Z</published>
    <updated>2021-12-12T14:32:20.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/cover/squirrel-6846096_1920.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="å¾®æœåŠ¡æ¶æ„çš„é™·é˜±ï¼šä»å•ä½“åˆ°åˆ†å¸ƒå¼å•ä½“"></p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å‰é¢å’±ä»¬èŠäº†æ¶æ„çš„æ¼”è¿›è¿‡ç¨‹ï¼Œæåˆ°å•ä½“æ¶æ„ã€SOA æ¶æ„ã€å¾®æœåŠ¡æ¶æ„ã€æ— æœåŠ¡æ¶æ„ã€‚æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://static.howardliu.cn/microservice/architect-gogogo.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="æ¶æ„æ¼”è¿›è¿‡ç¨‹ï¼šå•ä½“æ¶æ„ã€æ—©æœŸæœåŠ¡åŒ–ã€SOA æ¶æ„ã€å¾®æœåŠ¡æ¶æ„"></p><p>ç›®å‰æ— æœåŠ¡æ¶æ„è¿˜æœªæˆç†Ÿï¼Œåªèƒ½æ»¡è¶³ä¸€äº›ç®€å•åœºæ™¯ã€‚æ‰€ä»¥å¤§å®¶åœ¨è®¾è®¡è½¯ä»¶æ¶æ„æ—¶ï¼Œé¦–é€‰è¿˜æ˜¯å¾®æœåŠ¡æ¶æ„ã€‚ç„¶åæˆ‘ä»¬åˆèŠäº†èŠå¦‚ä½•æŠŠå•ä½“æ¶æ„æ”¹é€ ä¸ºå¾®æœåŠ¡æ¶æ„ï¼Œæ¨èé‡‡ç”¨ç»æ€æ¨¡å¼ï¼Œä¸€æ­¥ä¸€æ­¥çš„å®ç°ç³»ç»Ÿå¾®æœåŠ¡åŒ–ã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°å¾®æœåŠ¡æ¶æ„çš„ä¸€ä¸ªå¤§å‘ï¼šåˆ†å¸ƒå¼é”™è§‰ï¼Œå³å°†åˆ†å¸ƒå¼å½“æˆäº†å¾®æœåŠ¡çš„å…¨éƒ¨ï¼ˆå……è¦æ¡ä»¶ï¼‰ã€‚</p><a id="more"></a><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><p>å‡ºç°åˆ†å¸ƒå¼å•ä½“çš„ä¸»è¦åŸå› åœ¨äºï¼Œåªæ˜¯ç”¨è¿›ç¨‹é—´çš„è¿œç¨‹è°ƒç”¨æ›¿æ¢è¿›ç¨‹å†…çš„æ–¹æ³•è°ƒç”¨ã€‚</p><p><img src="https://static.howardliu.cn/microservice/monolitic-microservice-call.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="æ¨¡å— A ä¸æ¨¡å— B ä¹‹é—´çš„é€šä¿¡æ–¹å¼"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå•ä½“æ¶æ„åœ¨æ¨¡å— A ä¸æ¨¡å— B ä¹‹é—´çš„è¯·æ±‚æ˜¯é€šè¿‡è¿›ç¨‹å†…é€šä¿¡ï¼ˆé€šå¸¸æ˜¯æ–¹æ³•è°ƒç”¨ï¼‰å®ç°çš„ï¼›åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸¤è€…ä¹‹é—´æ˜¯é€šè¿‡ REST æˆ– RPC è°ƒç”¨ã€‚æŠ›å¼€è¿›ç¨‹å’Œæ¶ˆæ¯é€šçŸ¥æœºåˆ¶çš„å·®å¼‚ï¼Œä¸¤ç§æ¶æ„ä¸­æ¨¡å— A ä¸æ¨¡å— B ä¹‹é—´çš„é€šä¿¡å½¢å¼å®Œå…¨ä¸€è‡´ï¼š</p><p><img src="https://static.howardliu.cn/microservice/monolitic-microservice-call2.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="å•ä½“/å¾®æœåŠ¡æ¶æ„ä¸­æ¨¡å—é—´é€šä¿¡æ–¹å¼"></p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨¡å— A ä¸æ¨¡å— B è€¦åˆåœ¨ä¸€èµ·ï¼Œä»»ä½•ä¸€æ–¹å˜æ›´è¯·æ±‚å¥‘çº¦ï¼ˆæ–¹æ³•ç­¾åæˆ–æ¥å£å‚æ•°ï¼‰ï¼Œå¦å¤–ä¸€ä¸ªéƒ½å¿…é¡»åŒæ­¥ä¿®æ”¹ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œç”±äºå¾®æœåŠ¡æ¶æ„æœåŠ¡ä¹‹é—´æ˜¯é€šè¿‡ç½‘ç»œé€šä¿¡ï¼Œç”±äºå…¶ä¸å¯é æ€§å’Œä¸ç¨³å®šæ€§ï¼Œå¤§å¤§å¢åŠ äº†å‡ºé”™çš„æ¦‚ç‡ï¼Œä½¿æ¨¡å—ä¹‹é—´çš„è°ƒç”¨å…³ç³»æ›´åŠ è„†å¼±ã€‚</p><p>æ¨¡å— A ä¸æ¨¡å— B ä¹‹é—´çš„ç½‘ç»œè¯·æ±‚æ˜¯åŒæ­¥è°ƒç”¨ï¼Œè¯·æ±‚è¿‡ç¨‹ä¸­ä¼šå ç”¨ä¸€ä¸ªç½‘ç»œè¿æ¥å’Œè‡³å°‘ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœæ¨¡å— A ä¸æ¨¡å— B æ‰€åœ¨çš„æœåŠ¡çš„æ‰¿å‹èƒ½åŠ›ä¸åŒï¼Œå¾ˆæœ‰å¯èƒ½æ¨¡å— B æ‰€åœ¨æœåŠ¡è¢«æ‰“æ»¡ï¼Œåç»­æ¨¡å— A çš„è¯·æ±‚ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°è¯·æ±‚è¶…æ—¶ã€‚</p><p>é‚£åˆæ˜¯ä»€ä¹ˆåŸå› è®©å¤§å®¶æ²¡æœ‰æ„è¯†åˆ°è¿™ç§æ–¹å¼ä¸å¦¥å‘¢ï¼ŸåŸå› æœ‰ä¸¤ä¸ªï¼š</p><ol><li>æƒ³è¦åœ¨å¾®æœåŠ¡æ¶æ„ä¸­å®ç°å•ä½“æ¶æ„ä¸­æ¨¡å—é—´çš„å…³ç³»ï¼›</li><li>æƒ³è¦åœ¨åˆ†å¸ƒå¼åº”ç”¨ä¸­å®ç°æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚</li></ol><p>é’ˆå¯¹äºå¾®æœåŠ¡æ¶æ„ä¸­çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒ <a href="https://mp.weixin.qq.com/s?__biz=MzI4OTU5NTA1Ng==&mid=2247484752&idx=1&sn=38e19e269e6609ab14b69d68d5e77529" target="_blank" rel="noopener">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬é‡ç‚¹è¯´è¯´å¦‚æœè§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚</p><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p>å¯¹äºæ¨¡å—ä¹‹é—´çš„å…³ç³»ï¼Œä¸»è¦åœ¨äºé€šä¿¡æ¨¡å¼ï¼Œå¯¹äºæŸ¥è¯¢è¯·æ±‚ï¼Œç”±äºæ•°æ®ä¾èµ–ï¼Œæ¨¡å—ä¹‹é—´çš„è€¦åˆæ˜¯å¤©ç„¶çš„ï¼Œæˆ‘ä»¬è¿™é‡Œè¦è§£è€¦çš„æ˜¯æ•°æ®å˜æ›´ï¼ˆå¢ã€åˆ ã€æ”¹ï¼‰æ—¶çš„æ¨¡å—è°ƒç”¨ã€‚</p><p>ç±»æ¯”ä¸€ä¸‹ç°å®ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦é€šçŸ¥æŸäº›äººä¸€ä¸ªæ¶ˆæ¯ï¼Œä¼šæ€ä¹ˆå¤„ç†ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>ç‚¹å¯¹ç‚¹ä¸»åŠ¨é€šçŸ¥ï¼Œç›´æ¥æ‰¾åˆ°è¿™ä¸ªäººï¼Œç»™è¿™ä¸ªäººæ‰“ç”µè¯ï¼Œä¸é€šç»§ç»­æ‰“ï¼Œä¿è¯å¯¹æ–¹èƒ½å¤Ÿæ”¶åˆ°æ¶ˆæ¯ï¼›</li><li>ç‚¹å¯¹é¢å¹¿æ’­é€šçŸ¥ï¼Œæ¯”å¦‚ï¼Œç¾¤é‡Œå‘ç»™å…¬å‘Šã€å…¬å¸çš„å‘Šç¤ºæ ç­‰ï¼Œè¿™ç§æ–¹å¼éœ€è¦æ¶ˆæ¯æ¥å—è€…ä¸»åŠ¨æŸ¥çœ‹å…¬å‘Šä¿¡æ¯ã€‚</li></ol><p>è¿™ä¸¤ç§æ–¹å¼å¯¹åº”äº†æˆ‘ä»¬ç³»ç»Ÿè®¾è®¡ä¸­æ¶ˆæ¯ä¼ é€’çš„ä¸¤ä¸ªæ¨¡å¼ï¼šæŒ‡ä»¤ï¼ˆCommandï¼‰ã€äº‹ä»¶ï¼ˆEventï¼‰ã€‚</p><h3 id="æŒ‡ä»¤ï¼ˆCommandï¼‰å’Œäº‹ä»¶ï¼ˆEventï¼‰"><a href="#æŒ‡ä»¤ï¼ˆCommandï¼‰å’Œäº‹ä»¶ï¼ˆEventï¼‰" class="headerlink" title="æŒ‡ä»¤ï¼ˆCommandï¼‰å’Œäº‹ä»¶ï¼ˆEventï¼‰"></a>æŒ‡ä»¤ï¼ˆCommandï¼‰å’Œäº‹ä»¶ï¼ˆEventï¼‰</h3><p><img src="https://static.howardliu.cn/microservice/command_event.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="command ä¸ eventï¼ŒæŒ‡ä»¤ä¸äº‹ä»¶"></p><p>æŒ‡ä»¤ï¼ˆCommandï¼‰æ˜¯è¡¨ç¤ºä»å‘èµ·è€…ï¼ˆsourceï¼‰å‘æ‰§è¡Œè€…ï¼ˆdestinationï¼‰ä¼ é€’ï¼ˆsendï¼‰ä¸€ä¸ªå¿…é¡»æ‰§è¡ŒæŸä¸ªåŠ¨ä½œï¼ˆactionï¼‰çš„è¯·æ±‚ï¼ˆrequestï¼‰ã€‚è¿™ä¸ªæ¨¡å¼æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>æ˜ç¡®çš„çŸ¥é“å‘èµ·è€…å’Œæ‰§è¡Œè€…ï¼Œå‘èµ·è€…ä¾èµ–æ‰§è¡Œè€…ï¼›</li><li>è¯·æ±‚å‘é€æ–¹å¼ä¸€èˆ¬æ˜¯ç‚¹å¯¹ç‚¹åŒæ­¥è¯·æ±‚ï¼Œä¸€èˆ¬æ˜¯ RPC è¯·æ±‚ï¼›</li><li>åŠ¨ä½œå·²å‘ç”Ÿæˆ–å³å°†å‘ç”Ÿï¼Œæœ‰å¯èƒ½ç”±äºæ‰§è¡Œè€…æ‹’ç»æ‰§è¡Œè€Œå–æ¶ˆï¼›</li><li>æ‰§è¡Œè€…æœ‰å¯èƒ½æ‹’ç»æ‰§è¡Œï¼›</li><li>æ‰§è¡Œè€…ä¼šå¾ˆæ˜ç¡®çš„å‘ŠçŸ¥å‘èµ·è€…æŒ‡ä»¤æ‰§è¡Œæƒ…å†µï¼šæ‹’ç»ã€æˆåŠŸã€å¤±è´¥ç­‰ã€‚</li><li>ä¸ºäº†ä¿è¯æŒ‡ä»¤çš„æœ‰æ•ˆè§¦è¾¾ï¼Œå‘èµ·è€…åœ¨ç½‘ç»œè¶…æ—¶æ—¶ä¼šé‡å¤è°ƒç”¨æ‰§è¡Œè€…ï¼Œæ‰€ä»¥æ‰§è¡Œè€…éœ€è¦å®ç°è¯·æ±‚å¹‚ç­‰ï¼›</li><li>æ‰§è¡Œè€…å¯èƒ½ä¼šæˆä¸ºä¸‹ä¸€ä¸ªæŒ‡ä»¤çš„å‘èµ·è€…ã€‚</li></ul><p>äº‹ä»¶ï¼ˆeventï¼‰æ˜¯è¡¨ç¤ºç”±ç”Ÿäº§è€…ï¼ˆproducerï¼‰å‘å¸ƒï¼ˆpublicï¼‰ä¸€ä¸ªå·²ç»å‘ç”Ÿçš„äº‹æƒ…ï¼Œè¡¨ç¤ºè¡Œä¸ºï¼ˆactionï¼‰å·²ç»å‘ç”Ÿï¼ŒæŸäº›çŠ¶æ€ï¼ˆstatusï¼‰å‘ç”Ÿäº†æ”¹å˜ï¼Œæ¶ˆè´¹è€…ï¼ˆconsumerï¼‰è®¢é˜…è¿™äº›äº‹ä»¶ï¼Œç„¶ååšå‡ºå“åº”ã€‚è¿™ä¸ªæ¨¡å¼æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>äº‹ä»¶æœ‰æ˜ç¡®çš„ç”Ÿäº§è€…ï¼Œä½†æ˜¯æ¶ˆè´¹è€…ä¸æ˜ç¡®ï¼Œç”šè‡³å¯èƒ½ä¸å­˜åœ¨ï¼›</li><li>ä¸€èˆ¬å€ŸåŠ©æ¶ˆæ¯ä¸­é—´ä»¶å®ç°äº‹ä»¶å‘é€ã€å­˜å‚¨ã€ä¼ é€’ç­‰ï¼›</li><li>è¡Œä¸ºå·²ç»å‘ç”Ÿï¼Œä¸å¯æ”¹å˜ï¼Œä¸å¯é€†ï¼Œäº‹ä»¶æ˜¯å¯¹å·²ç»å‘ç”Ÿäº‹æƒ…çš„å®¢è§‚æè¿°ï¼›</li><li>æ¶ˆè´¹è€…æ ¹æ®æ¶ˆæ¯é€‰æ‹©å¤„ç†æ–¹å¼ï¼šæ‰§è¡Œã€æŠ›å¼ƒç­‰ï¼›</li><li>æ¶ˆè´¹è€…å¤„ç†å®Œæˆåï¼Œä¸éœ€è¦å›å¤ç”Ÿäº§è€…ï¼›</li><li>ä¸€èˆ¬æ¶ˆæ¯ä¸­é—´ä»¶é‡‡ç”¨â€œè‡³å°‘ä¸€æ¬¡â€é€šçŸ¥æœºåˆ¶ï¼Œæ‰€ä»¥æ¶ˆè´¹è€…éœ€è¦å®ç°æ¶ˆæ¯å¤„ç†çš„å¹‚ç­‰ï¼›</li><li>æ¶ˆè´¹è€…å¯èƒ½ä¼šæˆä¸ºä¸‹ä¸€ä¸ªäº‹ä»¶çš„ç”Ÿäº§è€…ã€‚</li></ul><p><img src="https://static.howardliu.cn/microservice/command-and-event.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="æŒ‡ä»¤ä¸äº‹ä»¶ä¹‹é—´çš„åŒºåˆ«"></p><p>ç”±äºè¯·æ±‚æ¨¡å¼çš„ä¸åŒï¼Œåœ¨ä¾èµ–å…³ç³»ä¸Šå°±ä¼šå‘ç”Ÿæ”¹å˜ï¼š</p><p>åœ¨æŒ‡ä»¤æ¨¡å¼ä¸­ï¼Œæ¨¡å— A è°ƒç”¨æ¨¡å— Bï¼Œå±äºç›´æ¥è°ƒç”¨ï¼Œæ¨¡å— A éœ€è¦ä¾èµ–æ¨¡å— Bï¼›åœ¨äº‹ä»¶æ¨¡å¼ä¸­ï¼Œæ¨¡å— A æŠŠäº‹ä»¶å‘é€ç»™æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå…¶ä»–éœ€è¦è®¢é˜…äº‹ä»¶çš„æœåŠ¡ï¼Œç›´æ¥ä»æ¶ˆæ¯ä¸­é—´ä»¶è·å–ï¼Œè¿™ç§ä¼šäº§ç”Ÿä¾èµ–å€’ç½®ï¼Œæ¨¡å— B ä¾èµ–æ¨¡å— Aã€‚è¿™æ˜¯è§£è€¦æ¨¡å— A ä¸æ¨¡å— B å¾ˆå¥½çš„æ–¹å¼ã€‚</p><h3 id="é‡æ–°å®šä¹‰å¾®æœåŠ¡"><a href="#é‡æ–°å®šä¹‰å¾®æœåŠ¡" class="headerlink" title="é‡æ–°å®šä¹‰å¾®æœåŠ¡"></a>é‡æ–°å®šä¹‰å¾®æœåŠ¡</h3><p>æˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹çœ‹æˆ‘ä»¬çš„é—®é¢˜ï¼š</p><p><img src="https://static.howardliu.cn/microservice/monolitic-microservice-call2.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="å•ä½“/å¾®æœåŠ¡æ¶æ„ä¸­æ¨¡å—é—´é€šä¿¡æ–¹å¼"></p><p>æ­¤æ—¶æˆ‘ä»¬ä¼šæ¯”è¾ƒæ¸…æ™°ï¼Œç”±äºå…¨ç³»ç»Ÿä¸­ä½¿ç”¨äº†æŒ‡ä»¤æ¨¡å¼ï¼Œä¸Šæ¬¡è°ƒç”¨è€…ä¾èµ–ä¸‹å±‚ï¼Œç”±äºæ˜¯åŒæ­¥è¯·æ±‚ï¼Œä¾èµ–ä¼šå‘ç”Ÿä¼ é€’ï¼Œè¿™ç§ä¾èµ–ä¼ é€’ï¼Œå°†æ•´ä¸ªç³»ç»Ÿè€¦åˆåœ¨ä¸€èµ·ï¼Œä¸€å¤„ä¿®æ”¹ï¼Œå¤„å¤„å˜åŠ¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨æŠ¨å‡»å•ä½“æ¶æ„æ—¶å¸¸è¯´çš„ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©äº‹ä»¶æ¨¡å¼ï¼Œå°†ä¾èµ–é“¾æ¡æ‰“æ–­ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„ï¼Œä¸è¦çŸ«æ‰è¿‡æ­£çš„å…¨éƒ¨æ”¹ä¸ºäº‹ä»¶æ¨¡å¼ï¼Œé‚£å°†ä¼šæ˜¯å¦ä¸€ä¸ªç«å‘ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šå°†ç³»ç»Ÿæ”¹é€ æˆä¸‹é¢çš„æ ·å­ï¼š</p><p><img src="https://static.howardliu.cn/microservice/refactor-monolitic.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="é‡æ–°å®šä¹‰å¾®æœåŠ¡"></p><p>æ ¹æ®ä¸šåŠ¡å…·ä½“æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å½’çº³ä¸€ä¸‹æ”¹é€ ç»“æœï¼š</p><ol><li>æœåŠ¡ A æ¥åˆ°çš„è¯·æ±‚å¯èƒ½æ˜¯äº‹ä»¶æˆ–æŒ‡ä»¤ï¼›</li><li>æœåŠ¡ A ä¼šå‘æœåŠ¡ B å‘é€æŒ‡ä»¤ï¼Œä¹Ÿä¼šå‘æ¶ˆæ¯ä¸­é—´ä»¶å‘é€äº‹ä»¶ï¼›</li><li>æœåŠ¡ B æ¥åˆ°æŒ‡ä»¤åå¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œå¯èƒ½ä¼šå‘æ¶ˆæ¯ä¸­é—´ä»¶å‘é€äº‹ä»¶ï¼›</li><li>æœåŠ¡ C å®šäºäº‹ä»¶ï¼Œä»æ¶ˆæ¯ä¸­é—´ä»¶æ¥åˆ°æ¶ˆæ¯åå¤„ç†ï¼Œå®ƒå¯èƒ½å‘é€äº‹ä»¶æˆ–æŒ‡ä»¤ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ªæœåŠ¡å†…éƒ¨è¿˜æœ‰æœ‰ä¸€äº›æ“ä½œã€‚æŠ½è±¡ä¸€ä¸‹ï¼Œæ•´ä¸ªç³»ç»Ÿä¸­çš„æŒ‡ä»¤ã€äº‹ä»¶ã€æ“ä½œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://static.howardliu.cn/microservice/command-event-definition.jpg?imageView2/0/q/75%7Cwatermark/2/text/aG93YXJkbGl1LmNuIOeci-WxsQ==/font/5a6L5L2T/fontsize/240/fill/I0IyQjJCMg==/dissolve/60/gravity/South/dx/10/dy/10" alt="æŒ‡ä»¤å’Œäº‹ä»¶çš„å®šä¹‰"></p><ul><li>è¾“å…¥ï¼šä»¥ä¸€ä¸ªæŒ‡ä»¤æˆ–äº‹ä»¶ä½œä¸ºè¾“å…¥ï¼Œå¼€å§‹æ•´ä¸ªä¸šåŠ¡æ‰§è¡Œï¼›</li><li>æœåŠ¡å†…éƒ¨æ“ä½œï¼šæœåŠ¡å†…éƒ¨ä¼šæœ‰æ‰§è¡Œé€»è¾‘ï¼Œæ¯”å¦‚æ“ä½œæ•°æ®åº“ã€è®¿é—®ç¼“å­˜æœåŠ¡ç­‰ã€‚å¯é€‰ï¼Œ0-N ä¸ªï¼›</li><li>æŒ‡ä»¤è°ƒç”¨ï¼šåŒæ­¥è°ƒç”¨ä¾èµ–æœåŠ¡ï¼Œå‘é€æŒ‡ä»¤ï¼Œè·å¾—ç»“æœã€‚å¯é€‰ï¼Œ0-N ä¸ªï¼›</li><li>å‘å¸ƒäº‹ä»¶ï¼šä»¥æ¶ˆæ¯å½¢å¼å‘å¸ƒäº‹ä»¶ï¼Œä¸€èˆ¬å‘å¸ƒåˆ°æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå…¶ä»–å‘å¸ƒè®¢é˜…æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæ‰§è¡Œäº‹ä»¶éœ€è¦çš„è¡Œä¸ºã€‚å¯é€‰ï¼Œäº‹ä»¶ä¸€èˆ¬æ˜¯ 0-1 ä¸ªã€‚</li></ul><p>æ¶æ„è®¾è®¡çš„è¿‡ç¨‹ä¸æ˜¯éæ­¤å³å½¼ï¼Œå…¨éƒ¨æŒ‡ä»¤ä¼šé€ æˆè€¦åˆï¼Œå…¨éƒ¨äº‹ä»¶ä¼šè‡´ä½¿å¼€å‘éš¾åº¦æå‡ä»¥åŠè¾¹ç•Œä¸æ¸…ã€‚æˆ‘ä»¬éœ€è¦ç†æ€§çš„çœ‹å¾…ä¸¤ç§æ¨¡å¼ï¼Œåšåˆ°ä¸åä¸å€šã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»åˆ†å¸ƒå¼å•ä½“é™·é˜±å±•å¼€ï¼Œè®²è¿°äº†åˆ†å¸ƒå¼é”™è§‰å¸¦æ¥çš„é—®é¢˜ï¼Œç„¶åé€šè¿‡äº‹ä»¶ã€æŒ‡ä»¤ä¸¤ç§æ¨¡å¼ç›¸ç»“åˆçš„æ–¹å¼è§£å†³é—®é¢˜ã€‚å¾®æœåŠ¡æ˜¯ç›®å‰æ¯”è¾ƒå®Œå–„çš„æ¶æ„é£æ ¼ï¼Œä»å•ä½“åˆ°å¾®æœåŠ¡æ¶æ„ï¼Œæ˜¯è¦å®ç°æ¶æ„çš„å‡çº§ï¼Œæ‰€ä»¥è°ƒç”¨æ¨¡å¼ä¸ä¼šä¸€æˆä¸å˜ã€‚è¿™ä¸ªé™·é˜±ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åœ¨åšæ–°ç³»ç»Ÿæ—¶éœ€è¦é¿å…çš„ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/09ILTzijUr3knHBj13t_kQ" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/n1eKTlLP_BbyBkKG4OyLSw" target="_blank" rel="noopener">å¾®æœåŠ¡ç¼–ç¨‹èŒƒå¼</a></li><li><a href="https://mp.weixin.qq.com/s/sRkYdrAwvn8UrGSraAURpA" target="_blank" rel="noopener">å¾®æœåŠ¡çš„åŸºå»ºå·¥ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/sRX04UhPiFWSDOazTSXuXw" target="_blank" rel="noopener">å¾®æœåŠ¡ä¸­æœåŠ¡æ³¨å†Œå’Œå‘ç°çš„å¯è¡Œæ€§æ–¹æ¡ˆ</a></li><li><a href="https://mp.weixin.qq.com/s/NcftJ1jNAd-DHpzBXKk8RA" target="_blank" rel="noopener">ä»å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„</a></li><li><a href="https://mp.weixin.qq.com/s/gSWFUsFnaqRKyGXVgdUqew" target="_blank" rel="noopener">é™¤äº†å¾®æœåŠ¡ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–é€‰æ‹©å—ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/M0sla4LVvp2lEiFpzwyVrA" target="_blank" rel="noopener">å¦‚ä½•åœ¨å¾®æœåŠ¡å›¢é˜Ÿä¸­é«˜æ•ˆä½¿ç”¨ Git ç®¡ç†ä»£ç ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/apHFXB2cUqDALpJJebNp9A" target="_blank" rel="noopener">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a></li><li><a href="https://mp.weixin.qq.com/s/AE0n4d_zRZOEeYEQt-rSKw" target="_blank" rel="noopener">å®ç° DevOps çš„ä¸‰æ­¥å·¥ä½œæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/mMjbafRIhia3u9DmXPSfPQ" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹å¦‚ä½•è®¾è®¡ä¸€ä¸ªçŸ­é“¾æœåŠ¡</a></li><li><a href="https://mp.weixin.qq.com/s/mtt_wsUChGIwnR-Nz5BE4g" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹ä»»åŠ¡é˜Ÿåˆ—</a></li><li><a href="https://mp.weixin.qq.com/s/_PI5jRP99ktPs3lxCbBLSg" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-ç¼“å­˜æŠ€æœ¯</a></li><li><a href="https://mp.weixin.qq.com/s/668L2NK7LWo3c8U8ZI_1ng" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-äº‹ä»¶é©±åŠ¨æ¶æ„</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/avoid-the-distributed-monolith/">å¾®æœåŠ¡æ¶æ„çš„é™·é˜±ï¼šä»å•ä½“åˆ°åˆ†å¸ƒå¼å•ä½“</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/121944074" target="_blank" rel="noopener">å¾®æœåŠ¡æ¶æ„çš„é™·é˜±ï¼šä»å•ä½“åˆ°åˆ†å¸ƒå¼å•ä½“</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      ç›®å‰æ— æœåŠ¡æ¶æ„è¿˜æœªæˆç†Ÿï¼Œåªèƒ½æ»¡è¶³ä¸€äº›ç®€å•åœºæ™¯ã€‚æ‰€ä»¥å¤§å®¶åœ¨è®¾è®¡è½¯ä»¶æ¶æ„æ—¶ï¼Œé¦–é€‰è¿˜æ˜¯å¾®æœåŠ¡æ¶æ„ã€‚ç„¶åæˆ‘ä»¬åˆèŠäº†èŠå¦‚ä½•æŠŠå•ä½“æ¶æ„æ”¹é€ ä¸ºå¾®æœåŠ¡æ¶æ„ï¼Œæ¨èé‡‡ç”¨ç»æ€æ¨¡å¼ï¼Œä¸€æ­¥ä¸€æ­¥çš„å®ç°ç³»ç»Ÿå¾®æœåŠ¡åŒ–ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°å¾®æœåŠ¡æ¶æ„çš„ä¸€ä¸ªå¤§å‘ï¼šåˆ†å¸ƒå¼é”™è§‰ï¼Œå³å°†åˆ†å¸ƒå¼å½“æˆäº†å¾®æœåŠ¡çš„å…¨éƒ¨ï¼ˆå……è¦æ¡ä»¶ï¼‰ã€‚
    
    </summary>
    
    
      <category term="microservice" scheme="https://www.howardliu.cn/categories/microservice/"/>
    
    
      <category term="å¾®æœåŠ¡" scheme="https://www.howardliu.cn/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    
      <category term="æ¶æ„" scheme="https://www.howardliu.cn/tags/%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„çš„èœ•å˜ï¼Ÿ</title>
    <link href="https://www.howardliu.cn/from-monolith-to-microservices-2/"/>
    <id>https://www.howardliu.cn/from-monolith-to-microservices-2/</id>
    <published>2021-12-05T14:40:49.000Z</published>
    <updated>2021-12-05T14:40:49.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/cover/rose-leaf-6831355_1920.jpg" alt="å¦‚ä½•å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„çš„èœ•å˜ï¼Ÿ" title="å¦‚ä½•å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„çš„èœ•å˜ï¼Ÿ"></p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å‰æ–‡æˆ‘ä»¬èŠäº†ä»‹ç»äº†å•ä½“æ¶æ„ã€SOA æ¶æ„ã€å¾®æœåŠ¡æ¶æ„ã€æ— æœåŠ¡æ¶æ„ã€‚å¦‚æœåŸæ¥æ˜¯å•ä½“æ¶æ„ï¼Œæƒ³è¦åˆ‡æ¢åˆ°å¾®æœåŠ¡æ¶æ„ï¼Œè¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿæœ¬æ–‡æ¥èŠèŠè¿™ä¸ªè¯é¢˜ï¼Œè§£å†³â€œä»€ä¹ˆæ—¶å€™ï¼ˆWHENï¼‰ã€æ€æ ·åšï¼ˆHOWï¼‰â€ã€‚</p><a id="more"></a><h2 id="ä»€ä¹ˆæ—¶å€™"><a href="#ä»€ä¹ˆæ—¶å€™" class="headerlink" title="ä»€ä¹ˆæ—¶å€™"></a>ä»€ä¹ˆæ—¶å€™</h2><p>å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œä¸“æ³¨äºè½¯ä»¶ç ”å‘æ•ˆèƒ½ï¼Œä¸»è¦åŒ…æ‹¬å•ä½æ—¶é—´å†…å®ç°æ›´å¤šåŠŸèƒ½ï¼Œæˆ–è€…è½¯ä»¶ä»æƒ³æ³•åˆ°ä¸Šçº¿çš„æ•´ä¸ªæŒç»­äº¤ä»˜çš„è¿‡ç¨‹ã€‚åœ¨å½“å‰çš„äº’è”ç½‘ç¯å¢ƒä¸­ï¼Œä¸šåŠ¡å˜åŒ–è¿…é€Ÿï¼Œä½¿ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œå¯ä»¥è®©å›¢é˜Ÿè¿…é€Ÿååº”ï¼Œå¿«é€Ÿå®æ–½ï¼Œåœ¨æ–¹æ¡ˆæ²¡æœ‰è¿‡æœŸä¹‹å‰å·²ç»ä¸Šçº¿è¿è¡Œï¼Œç»å—å¸‚åœºè€ƒå¯Ÿå’Œè€ƒéªŒã€‚</p><p>ç›®å‰å›½å†…å¤§å¤šæ•°å…¬å¸æ­£åœ¨è¿è¡Œçš„ç³»ç»Ÿéƒ½æ˜¯å•ä½“æ¶æ„ç³»ç»Ÿï¼Œä¸å¯å¦è®¤ï¼Œè¿™äº›ç³»ç»Ÿåœ¨å…¬å¸å‘å±•è¿‡ç¨‹ä¸­ï¼Œå‘æŒ¥äº†ä¸å¯æ›¿ä»£çš„ä½œç”¨ï¼Œä¿éšœäº†å…¬å¸æ­£å¸¸è¿è¡Œï¼Œåˆ›é€ äº†å¾ˆå¤šä»·å€¼ã€‚ä½†æ˜¯ï¼Œéšç€ç³»ç»Ÿçš„æ—¥æ¸è†¨èƒ€ï¼Œé›†æˆçš„åŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œå¼€å‘æ•ˆç‡å˜å¾—è¶Šæ¥è¶Šä½ï¼Œä¸€ä¸ªåŠŸèƒ½ä»æƒ³æ³•åˆ°å®ç°ï¼Œéœ€è¦èŠ±è´¹è¶Šæ¥è¶Šé•¿çš„æ—¶é—´ã€‚æ›´ä¸¥é‡çš„æ˜¯ï¼Œç”±äºä»£ç æ¨¡å—çº ç»“åœ¨ä¸€èµ·ï¼Œå¾ˆå¤šå·²ç»è€åŒ–çš„æ¶æ„æˆ–è€…åºŸå¼ƒçš„åŠŸèƒ½ï¼Œå·²ç»æˆä¸ºæ–°åŠŸèƒ½çš„é˜»ç¢ã€‚</p><p><img src="https://static.howardliu.cn/microservice/737565-20181016193114922-488026211.png" alt="å•ä½“æ¶æ„ä¸å¾®æœåŠ¡æ¶æ„çš„æˆæœ¬" title="å•ä½“æ¶æ„ä¸å¾®æœåŠ¡æ¶æ„çš„æˆæœ¬"></p><p>ä¸Šå›¾ä¸­ï¼ŒX è½´æ˜¯ä¸šåŠ¡å¤æ‚åº¦ï¼ŒY è½´æ˜¯å•ä½æ•ˆç›Šã€‚ç»¿è‰²çº¿æ¡ä»£è¡¨å•ä½“æ¶æ„ï¼Œè“è‰²çº¿æ¡ä»£è¡¨å¾®æœåŠ¡æ¶æ„ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸šåŠ¡å‘å±•åˆæœŸï¼Œç³»ç»Ÿå¤æ‚åº¦ä¸é«˜ï¼Œä¸šåŠ¡ä¸å¤Ÿæˆç†Ÿï¼Œæˆ‘ä»¬ä¸»è¦ç»å†åœ¨äºä¸šåŠ¡è¯•é”™ã€‚å¦‚æœé‡‡ç”¨å•ä½“æ¶æ„ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„åŠŸèƒ½ã€æ¨¡å—æ”¾åœ¨ä¸€ä¸ªè¿›ç¨‹ï¼›å¦‚æœæ­¤æ—¶é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘è¿›ç¨‹é—´é€šä¿¡ã€ä¸å¯é ç½‘ç»œæ•…éšœç­‰ï¼Œè¿˜éœ€è¦å®ç°å¾®æœåŠ¡çš„åŸºç¡€ç»„ä»¶ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå•ä½“æ¶æ„çš„å•ä½æ•ˆç›Šæ˜¯é«˜äºå¾®æœåŠ¡æ¶æ„çš„ã€‚</p><p>éšç€ä¸šåŠ¡å‘å±•ï¼Œç³»ç»Ÿæ‰¿è½½çš„åŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œå•ä½“æ¶æ„çš„åŠ£åŠ¿å‡¸æ˜¾ï¼Œæ¯”å¦‚ï¼š</p><ol><li>ç¡¬ä»¶èƒ½åŠ›éš¾ä»¥è·Ÿä¸Šæ€¥é€Ÿå‘å±•çš„ä¸šåŠ¡ï¼›</li><li>ç³»ç»Ÿéš”ç¦»æ€§å·®ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œä¸€ä¸ªåŠŸèƒ½çš„å¼‚å¸¸å¯èƒ½å½±å“å…¶ä»–åŠŸèƒ½ï¼›</li><li>ä»£ç å¤æ‚åº¦æå‡ï¼Œå›¢é˜Ÿåˆä½œè¶Šæ¥è¶Šéš¾ï¼Œä»£ç å†²çªçš„å¯èƒ½æ€§è¶Šæ¥è¶Šé«˜ï¼›</li><li>åºå¤§çš„ä»£ç é‡ï¼Œåœ¨æ—¥å¸¸å¼€å‘ã€æµ‹è¯•æ—¶ï¼ŒIDE éš¾ä»¥æ”¯æŒï¼›</li><li>ç³»ç»Ÿæ„å»ºã€éƒ¨ç½²æ—¶é—´å»¶é•¿ï¼›</li><li>æŠ€æœ¯ç»‘å®šï¼Œæ²¡æœ‰åŠæ³•æ ¹æ®ç³»ç»ŸåŠŸèƒ½éœ€è¦çµæ´»ä½¿ç”¨ä¸åŒæŠ€æœ¯ï¼›</li><li>â€¦â€¦</li></ol><p>æ€»è€Œè¨€ä¹‹ï¼Œå•ä½“æ¶æ„éšç€åŠŸèƒ½å¢å¤šï¼Œä¸å¯é¿å…çš„æ˜¯ç ”å‘æ•ˆèƒ½çš„é™ä½ï¼šç ”å‘å‘¨æœŸå˜é•¿ã€ç ”å‘èµ„æºå ç”¨å¢å¤šã€‚ä»è€Œå¼•å‘çš„æƒ…å†µæ˜¯ï¼šæ–°å‘˜å·¥åŸ¹è®­æ—¶é—´å¢å¤šã€å‘˜å·¥åŠ ç­æ—¶é—´å˜é•¿ã€å‘˜å·¥è¦æ±‚æ¶¨è–ªæˆ–è€…è·³æ§½ã€‚</p><p>å½“è¾¾åˆ°å›¾ä¸­çš„äº¤å‰ç‚¹æ—¶ï¼Œè¯´æ˜å•ä½“æ¶æ„å·²ç»ä¸èƒ½å¤Ÿæ»¡è¶³ä¼ä¸šå‘å±•éœ€è¦ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦å‡çº§æ¶æ„æ¥æå‡ç ”å‘æ•ˆèƒ½ï¼Œæ¯”å¦‚å¾®æœåŠ¡æ¶æ„ã€‚</p><p>æœ‰äººä¼šé—®ï¼Œè¿™ä¸ªæ—¶é—´ç‚¹ä¸å¤ªå¥½æŠŠæ¡ã€‚æˆ‘ä»¬åªéœ€è¦è€ƒè™‘ä¸‰ä¸ªé—®é¢˜å³å¯ï¼š</p><ol><li>äº§å“æ˜¯å¦å·²ç»ç»è¿‡å¸‚åœºè€ƒéªŒï¼Ÿ</li><li>æ˜¯å¦éœ€è¦è¶…è¿‡ä¸€ä¸ªå›¢é˜Ÿæ¥ä¿è¯äº§å“å‘å¸ƒï¼Ÿ</li><li>ç³»ç»Ÿæ˜¯å¦å¯¹å¯é æ€§ã€å¯ä¼¸ç¼©æ€§æœ‰è¾ƒé«˜è¦æ±‚ï¼Ÿ</li></ol><p>å¦‚æœéƒ½æ˜¯è‚¯å®šå›ç­”ï¼Œé‚£å°±è¯¥ç€æ‰‹å‡†å¤‡å°†å•ä½“æ¶æ„åˆ‡æ¢ä¸ºå¾®æœåŠ¡æ¶æ„äº†ã€‚</p><h2 id="æ€æ ·åš"><a href="#æ€æ ·åš" class="headerlink" title="æ€æ ·åš"></a>æ€æ ·åš</h2><p>ä»å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼Œä»ä¸€ä¸ªå¤§ä¸€ç»Ÿçš„ç³»ç»Ÿï¼Œæ‹†åˆ†æˆä¸€ä¸ªä¸€ä¸ªå•ç‹¬çš„å°æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦æŠ•å…¥ç²¾åŠ›ï¼ŒåšåŸºç¡€çš„å‡†å¤‡ï¼š</p><ol><li>å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯æœåŠ¡ã€è¯¥æ€ä¹ˆæ‹†åˆ†ï¼›</li><li>ç„¶åéœ€è¦æ­å»ºåŸºç¡€è®¾æ–½ï¼Œä¸ºæ‹†åˆ†å‡ºæ¥çš„æœåŠ¡åšå¥½åå‹¤ä¿éšœï¼›</li><li>æœ€åæ‰æ˜¯ä¸€æ­¥ä¸€æ­¥å®Œæˆæ¶æ„åˆ‡æ¢ã€‚</li></ol><h3 id="è®¤è¯†æœåŠ¡"><a href="#è®¤è¯†æœåŠ¡" class="headerlink" title="è®¤è¯†æœåŠ¡"></a>è®¤è¯†æœåŠ¡</h3><p>é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„å‘¢ï¼Ÿé€šä¿—çš„å®šä¹‰æ˜¯ï¼šâ€œä¸€ç»„å›´ç»•ä¸šåŠ¡é¢†åŸŸå»ºæ¨¡çš„ã€å°è€Œè‡ªæ²»çš„ã€å½¼æ­¤ååŒå·¥ä½œçš„æœåŠ¡ã€‚â€</p><p>å¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡ï¼Œæ˜¯æ ¹æ®ä¸šåŠ¡èƒ½åŠ›æŠ½å–çš„ä¸šåŠ¡æ¨¡å—ï¼Œç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²ï¼Œä½†æ˜¯éœ€è¦å½¼æ­¤é…åˆå®Œæˆæ•´ä¸ªä¸šåŠ¡åŠŸèƒ½ã€‚æœåŠ¡ä¸æ˜¯å•çº¯çš„æ•°æ®å­˜å‚¨ç»„ä»¶ï¼Œä¹Ÿä¸æ˜¯å•çº¯çš„é€»è¾‘å‡½å•å…ƒã€‚åªæœ‰åŒæ—¶åŒ…æ‹¬æ•°æ®+é€»è¾‘ï¼Œæ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„æœåŠ¡ã€‚</p><p>æœåŠ¡æ‹†è§£è¿‡ç¨‹ä¸­ï¼ŒDDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰å¯ä»¥ä½œä¸ºå¾®æœåŠ¡æ¶æ„çš„æŒ‡å¯¼æ–¹é’ˆã€‚å› ä¸ºå¾®æœåŠ¡æ˜¯å›´ç»•ä¸šåŠ¡åŠŸèƒ½å®šä¹‰æœåŠ¡ï¼Œæ ¹æ®æœåŠ¡å®šä¹‰å›¢é˜Ÿï¼Œè¿™ä¸ DDD å°†ä¸šåŠ¡åŸŸæ‹†è§£ä¸ºä¸šåŠ¡å­åŸŸã€å®šä¹‰é™å®šä¸Šä¸‹æ–‡çš„æ–¹æ³•è®ºå¦‚å‡ºä¸€è¾™ï¼Œäºæ˜¯ DDD ä½œä¸ºå¾®æœåŠ¡çš„æŒ‡å¯¼æ–¹é’ˆï¼Œå¿«é€Ÿå®šä¹‰å„ä¸ªæœåŠ¡ç»„ä»¶ï¼Œå®Œæˆä»å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„çš„è¿ç§»ã€‚</p><p><img src="https://static.howardliu.cn/microservice/121148382613129.jpg" alt="é¢†åŸŸé©±åŠ¨è®¾è®¡" title="é¢†åŸŸé©±åŠ¨è®¾è®¡"></p><p>Alberto Brandolini æå‡ºè¯†åˆ«æœåŠ¡ä¸Šä¸‹æ–‡çš„æ–¹å¼å«åšâ€œEvent Stormingâ€ã€‚ç¬¬ä¸€æ­¥æ˜¯è¯†åˆ«ä¸šåŠ¡åŸŸä¸­å‘ç”Ÿçš„äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„å…³æ³¨ç‚¹æ˜¯è¡Œä¸ºï¼Œä¸æ˜¯æ•°æ®ç»“æ„ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œç³»ç»Ÿä¸­ä¸åŒæœåŠ¡ä¹‹é—´æ˜¯æ¾æ•£è€¦åˆå…³ç³»ï¼Œè€Œä¸”å•ä¸ªæœåŠ¡èƒ½å¤Ÿè‡ªæ²»ã€‚</p><p>å®šä¹‰å¥½äº†æœåŠ¡è¾¹ç•Œï¼Œè¿˜éœ€è¦å®šä¹‰äº‹åŠ¡è¾¹ç•Œã€‚è¿‡å»ï¼Œæˆ‘ä»¬çš„æœåŠ¡åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œåé¢æŒ‚ç€ä¸€ä¸ªæ•°æ®åº“ï¼Œäº‹åŠ¡å¯ä»¥é€‰æ‹©å¼ºä¸€è‡´æ€§äº‹åŠ¡ï¼Œä¹Ÿå°±æ˜¯ ACIDã€‚å½“æœåŠ¡å¢å¤šï¼Œå½¼æ­¤é…åˆï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨æœ€ç»ˆä¸€è‡´æ€§äº‹åŠ¡ï¼Œä¹Ÿå°±æ˜¯ BASEã€‚ä¸åŒäº ACIDï¼ŒBASE æ›´åŠ çµæ´»ï¼Œåªè¦æ•°æ®åœ¨æœ€ç»ˆèƒ½å¤Ÿä¿æŒä¸€è‡´å°±å¯ä»¥äº†ã€‚è¿™ä¸ªæœ€ç»ˆçš„æ—¶é—´èŒƒå›´ï¼Œæ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä¸åŒï¼Œå¯èƒ½æ˜¯åˆ†é’Ÿã€å°æ—¶ã€å¤©ï¼Œç”šè‡³æ˜¯å‘¨æˆ–è€…æœˆã€‚</p><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>å¾®æœåŠ¡æ¶æ„æ„¿æ™¯ç¾å¥½ï¼Œå±äºé‡å‹æ­¦å™¨ï¼Œä¼˜ç‚¹ä¼—å¤šï¼Œç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ã€‚æœåŠ¡å¢å¤šï¼Œè¿ç»´éš¾åº¦å¢å¤§ï¼Œé”™è¯¯è°ƒè¯•éš¾åº¦å¢å¤§ã€‚æ‰€ä»¥éœ€è¦è‡ªåŠ¨åŒ–æ„å»ºã€é…ç½®ã€æµ‹è¯•å’Œéƒ¨ç½²ï¼Œéœ€è¦æ—¥å¿—æ”¶é›†ã€æŒ‡æ ‡ç›‘æ§ã€è°ƒç”¨é“¾ç›‘æ§ç­‰å·¥å…·ï¼Œä¹Ÿå°±æ˜¯éœ€è¦ DevOps å®è·µã€‚<a href="https://www.howardliu.cn/the-three-ways-principles-underpinning-devops/">å®ç° DevOps çš„ä¸‰æ­¥å·¥ä½œæ³•</a> ä¸­è¯´æ˜äº†å®ç° DevOps æ–‡åŒ–çš„ä¸‰ä¸ªæ­¥éª¤ã€‚</p><p>é™¤äº†ä¸Šé¢æåˆ°çš„åŸºç¡€ï¼Œè¿˜éœ€è¦åœ¨æ—©æœŸç¡®å®šæœåŠ¡ä¹‹é—´å¦‚ä½•é›†æˆå’Œå½¼æ­¤è°ƒç”¨æ–¹å¼ï¼Œè¿˜éœ€è¦ç¡®å®šæ•°æ®ä½“ç³»ï¼ŒåŒ…æ‹¬äº‹åŠ¡ä¸€è‡´æ€§å’Œæ•°æ®å¯é æ€§æ–¹æ³•ã€‚éšç€æœåŠ¡å¢å¤šï¼Œè¿˜éœ€è¦é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ç­‰ä¼—å¤šç»„ä»¶ã€‚å…·ä½“éœ€è¦çš„åŸºç¡€ç»„ä»¶å¯ä»¥å‚è€ƒ <a href="https://www.howardliu.cn/the-base-of-microservice/">å¾®æœåŠ¡çš„åŸºå»ºå·¥ä½œ</a>ã€‚</p><p><img src="https://static.howardliu.cn/microservice/microservice-architecture.png" alt="å¾®æœåŠ¡æ¶æ„ä¸­çš„åŸºç¡€ç»„ä»¶" title="å¾®æœåŠ¡æ¶æ„ä¸­çš„åŸºç¡€ç»„ä»¶"></p><p>è¿™äº›åŸºç¡€çš„æœåŠ¡å’Œè®¾è®¡ï¼Œæœ€å¥½åœ¨æ—©æœŸå®šä¹‰ï¼Œå¦åˆ™ï¼ŒåæœŸéœ€è¦èŠ±è´¹æ›´å¤šçš„èµ„æºæ‰èƒ½å¤Ÿå®Œå–„æ¶æ„ã€‚å¦‚æœå‰æœŸç¼ºå¤±ï¼ŒåæœŸä¹Ÿæ²¡æœ‰è¡¥è¶³ï¼Œé€ æˆçš„åæœå°±æ˜¯å¾®æœåŠ¡æ¶æ„è¿ç§»å¤±è´¥ï¼Œæœ€åçš„ç³»ç»Ÿä¹Ÿåªæ˜¯æŠ«ç€å¾®æœåŠ¡å¤–è¡£çš„å•ä½“æ¶æ„ã€‚</p><h3 id="å¼€å§‹åŠ¨æ‰‹"><a href="#å¼€å§‹åŠ¨æ‰‹" class="headerlink" title="å¼€å§‹åŠ¨æ‰‹"></a>å¼€å§‹åŠ¨æ‰‹</h3><p>å½“æˆ‘ä»¬ç¡®å®šå¼€å§‹ä½¿ç”¨å¾®æœåŠ¡æ¶æ„æ—¶ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯åº”è¯¥æ€ä¹ˆåšï¼Ÿæ˜¯é€æ­¥è¿›åŒ–æ›´æ–°ç³»ç»Ÿã€è¿˜æ˜¯ç ´é‡œæ²‰èˆŸé‡æ„æ•´ä¸ªç³»ç»Ÿã€‚</p><p>ç¬¬äºŒç§æ–¹å¼å¾ˆè¯±äººï¼Œæ¯”è¾ƒç¬¦åˆå¤§å¤šæ•°æŠ€æœ¯äººçš„æ€ç»´ï¼Œç³»ç»Ÿä¸è¡Œï¼Œæ¨å€’é‡æ¥ï¼Œåä¸ºé‡æ„ã€‚ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹å¼ä¸èƒ½è¢«å…è®¸ï¼Œå› ä¸ºå¸‚åœºå˜åŒ–è¿…é€Ÿã€ç«äº‰æ¿€çƒˆï¼Œå¤§å¤šæ•°å…¬å¸ä¸ä¼šåœæ­¢ä¸šåŠ¡ï¼Œå»ç­‰å¾…é‡æ„ä¸€ä¸ªèƒ½å¤Ÿè¿è¡Œã€åªæ˜¯æœ‰äº›ç¼ºç‚¹çš„ç³»ç»Ÿã€‚æ‰€ä»¥ï¼Œé€æ­¥æ›¿æ¢æ›´æ–°ç³»ç»Ÿæ‰æ˜¯ç‹é“ï¼Œå¤§å¤šæ•°å…¬å¸ä¹Ÿèƒ½æ¥å—ã€‚è¿™ç§æ–¹å¼åˆè¢«ç§°ä¸ºç»æ€æ¨¡å¼ã€‚</p><p>è¯¥å¦‚ä½•é€æ­¥è¿‡æ¸¡åˆ°å¾®æœåŠ¡æ¶æ„ï¼Ÿä¸‹é¢ä¸€æ­¥æ­¥è¿›è¡Œå±•ç¤ºï¼š</p><p><img src="https://static.howardliu.cn/microservice/from_monolith_to_microservice_0.jpg" alt="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šå•ä½“æ¶æ„" title="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šå•ä½“æ¶æ„"></p><p>ç¬¬ä¸€æ­¥ï¼Œå°†è§†å›¾å±‚ä¸æœåŠ¡å±‚éƒ¨åˆ†é€»è¾‘è¿›è¡Œåˆ†ç¦»ã€‚ä¸šåŠ¡é€»è¾‘å§”æ‰˜ç»™æœåŠ¡å±‚ï¼Œæ”¯æŒé¡µé¢å±•ç¤ºçš„æŸ¥è¯¢å®šå‘åˆ°æ•°æ®åº“ã€‚è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬ä¸ä¿®æ”¹æ•°æ®åº“æœ¬èº«ã€‚</p><p><img src="https://static.howardliu.cn/microservice/from_monolith_to_microservice_1.jpg" alt="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šéƒ¨åˆ†æ‹†åˆ†è§†å›¾å’Œä¸šåŠ¡é€»è¾‘" title="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šéƒ¨åˆ†æ‹†åˆ†è§†å›¾å’Œä¸šåŠ¡é€»è¾‘"></p><p>ç¬¬äºŒæ­¥ï¼Œç”¨æˆ·è§†å›¾å±‚ä¸æ•°æ®åº“å®Œå…¨åˆ†ç¦»ï¼Œä¾èµ–äºæœåŠ¡å±‚æ“ä½œæ•°æ®åº“ã€‚</p><p><img src="https://static.howardliu.cn/microservice/from_monolith_to_microservice_2.jpg" alt="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šå®Œå…¨æ‹†åˆ†è§†å›¾å’Œä¸šåŠ¡é€»è¾‘" title="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šå®Œå…¨æ‹†åˆ†è§†å›¾å’Œä¸šåŠ¡é€»è¾‘"></p><p>ç¬¬ä¸‰æ­¥ï¼Œå°†ç”¨æˆ·è§†å›¾å±‚ä¸æœåŠ¡å±‚æ‹†åˆ†ä¸ºä¸åŒæœåŠ¡ï¼Œå¹¶åœ¨æœåŠ¡å±‚åˆ›å»ºä¸€ä¸ª API å±‚ï¼Œç”¨äºè§†å›¾å±‚ä¸æœåŠ¡å±‚ä¹‹é—´é€šä¿¡ã€‚</p><p><img src="https://static.howardliu.cn/microservice/from_monolith_to_microservice_3.jpg" alt="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šç‰©ç†æ‹†åˆ†è§†å›¾å’Œä¸šåŠ¡é€»è¾‘" title="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šç‰©ç†æ‹†åˆ†è§†å›¾å’Œä¸šåŠ¡é€»è¾‘"></p><p>ç¬¬å››æ­¥ï¼Œæ‹†åˆ†æ•°æ®åº“ï¼Œå°†ä¸åŒä¸šåŠ¡æ•°æ®æ‹†åˆ†åˆ°ä¸åŒçš„æ•°æ®åº“ä¸­ï¼ŒåŒæ—¶å¯¹åº”ä¸šåŠ¡æœåŠ¡å±‚æ‹†åˆ†åˆ°ä¸åŒçš„æœåŠ¡ã€‚ç”¨æˆ·è§†å›¾å±‚é€šè¿‡ API ç½‘å…³ä¸ä¸åŒä¸šåŠ¡æœåŠ¡å±‚çš„ API ç»„ä»¶é€šä¿¡ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦æ³¨æ„ï¼Œå¦‚æœå›¢é˜Ÿæ²¡æœ‰å¾®æœåŠ¡å¼€å‘ç»éªŒï¼Œå¯ä»¥åœ¨è¿™ä¸€æ­¥åŸºç¡€ä½¿ç”¨ç»æ€æ–¹å¼ï¼Œå…ˆæŠ½å–ç®€å•ä¸šåŠ¡åŸŸæœåŠ¡ï¼Œå› ä¸ºä¸šåŠ¡ç®€å•ï¼Œå®ç°ç®€å•ï¼Œå¯ä»¥ç»ƒæ‰‹ï¼Œç§¯ç´¯ç»éªŒã€‚</p><p><img src="https://static.howardliu.cn/microservice/from_monolith_to_microservice_4.jpg" alt="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šä¸šåŠ¡æœåŠ¡å±‚æ‹†åˆ†ã€å‚ç›´æ‹†åˆ†æ•°æ®åº“" title="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šä¸šåŠ¡æœåŠ¡å±‚æ‹†åˆ†ã€å‚ç›´æ‹†åˆ†æ•°æ®åº“"></p><p>æœ€åä¸€æ­¥ï¼Œæ‹†åˆ†ç”¨æˆ·è§†å›¾å±‚ã€‚</p><p><img src="https://static.howardliu.cn/microservice/from_monolith_to_microservice_5.jpg" alt="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šæ‹†åˆ†ç”¨æˆ·è§†å›¾å±‚" title="å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ï¼šæ‹†åˆ†ç”¨æˆ·è§†å›¾å±‚"></p><p>ç»æ€æ¨¡å¼çš„ä¼˜åŠ¿å°±åœ¨äºï¼Œæˆ‘ä»¬å¯ä»¥éšç€ä¸šåŠ¡å˜åŒ–éšæ—¶è°ƒæ•´æ–¹æ¡ˆï¼Œä¸ä¼šé€ æˆæ•´ä¸ªä¸šåŠ¡è¿›åŒ–è¿‡ç¨‹çš„åœæ‘†ã€‚</p><h2 id="æˆåŠŸæ ‡å‡†"><a href="#æˆåŠŸæ ‡å‡†" class="headerlink" title="æˆåŠŸæ ‡å‡†"></a>æˆåŠŸæ ‡å‡†</h2><p><img src="https://static.howardliu.cn/Illustration/measuring-success-with-guavabox.jpg" alt="If you cannot measure it, you cannot manage it!" title="If you cannot measure it, you cannot manage it!"></p><p><strong>If you cannot measure it, you cannot manage it!</strong></p><p>å¼•å…¥å¾®æœåŠ¡çš„ç›®çš„é¦–å…ˆæ˜¯æ”¹å–„å¼€å‘æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„æŒ‡æ ‡æ¥è¡¡é‡ï¼š</p><ul><li>å¼€å‘å‘¨æœŸï¼šä»æ¦‚å¿µåˆ°ä¸Šçº¿æŒç»­çš„æ—¶é—´</li><li>å¼€å‘æ•ˆèƒ½ï¼šå•ä½æ—¶é—´å†…å›¢é˜Ÿæˆ–ä¸ªäººå®Œæˆçš„åŠŸèƒ½æˆ–ç”¨æˆ·æ•…äº‹</li><li>ç³»ç»Ÿå¯ä¼¸ç¼©æ€§ï¼šç³»ç»Ÿçš„æ°´å¹³ã€å‚ç›´æ‰©å±•èƒ½åŠ›</li><li>å¹³å‡ç»´ä¿®æ—¶é—´ï¼šæŸ¥æ‰¾å’Œæ’é™¤æ•…éšœæ‰€éœ€æ—¶é—´</li></ul><p>é€šè¿‡å¯¹æ¯”è€æ¶æ„å’Œæ–°æ¶æ„çš„è¿™äº›ç‰¹æ€§å€¼ï¼Œå¯ä»¥è¯„ä¼°å‡çº§è¿‡ç¨‹å–å¾—çš„æ•ˆæœã€‚æˆ‘ä»¬è¦æ—¶åˆ»å…³æ³¨è¿™äº›æŒ‡æ ‡ï¼Œåªæœ‰ä¸€ä¸ªä¸ªå°é˜¶æ®µçš„èƒœåˆ©ï¼Œæ‰èƒ½ç»„æˆæœ€ç»ˆå®Œæ•´çš„èƒœåˆ©ã€‚å¦‚æœå†æŸä¸ªé˜¶æ®µå¤±è´¥äº†ï¼Œå¯èƒ½è¾¾ä¸åˆ°æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„ï¼Œæˆ–è€…åŸ‹ä¸‹æŠ€æœ¯å€ºåŠ¡ï¼ŒåæœŸä¸å¾—ä¸èŠ±æ›´å¤§çš„ä»£ä»·è¡¥å¿ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æƒ³è¦è¯´æ˜å¾®æœåŠ¡æ¶æ„çš„å¥½å¤„ï¼Œå¯ä»¥æ¥ä¸€ä¸ªæ¯”å–»ã€‚æˆ‘ä»¬å»ºäº†ä¸€ä¸ªç©ºé—´ç«™ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†äººã€è´§ç‰©å’Œè®¾å¤‡è¿è¾“åˆ°ç©ºé—´ç«™ä¸­ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè¿è½½ç«ç®­æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ï¼Œå°½ç®¡è¿è½½ç«ç®­é€ ä»·ä¹Ÿæ¯”è¾ƒé«˜ï¼Œä½†æ˜¯å‡ ä¸ªæœˆå‘å°„ä¸€æ¬¡ï¼Œä¹Ÿèƒ½å¤Ÿæ»¡è¶³éœ€æ±‚ã€‚éšç€ç©ºé—´ç«™çš„æ‰©å¤§ï¼Œç«ç®­å‘å°„çš„é—´éš”å˜çŸ­ï¼Œè¿è¾“æˆæœ¬é«˜çš„ç¦»è°±ï¼Œè€Œä¸”è¶Šæ¥è¶Šæ²¡æ³•æ»¡è¶³ç©ºé—´ç«™è¿è½¬éœ€æ±‚ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥å°è¯•å¦å¤–ä¸€ç§æ–¹å¼ï¼Œæ¯”å¦‚ï¼Œå¤ªç©ºç”µæ¢¯ã€‚å½“ç„¶å¤ªç©ºç”µæ¢¯çš„é€ ä»·æˆæœ¬é«˜äºä¸€æ¬¡é£è¡Œçš„è´¹ç”¨ï¼Œä½†æ˜¯åªè¦å»ºæˆï¼Œä»¥åçš„æˆæœ¬å°±é™ä½äº†å¾ˆå¤šã€‚</p><p>è¿™ä¸ªæ¯”å–»ä¹Ÿæ˜¯è¯´æ˜äº†å¾®æœåŠ¡å¸¦æ¥çš„ç¾å¥½æœŸæœ›ï¼ŒåŒæ—¶ä¹Ÿè¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼Œå®æ–½å¾®æœåŠ¡æ¶æ„ä¼šå¸¦æ¥å·¨å¤§çš„æŠ•èµ„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨å»ºé€ å¤ªç©ºç”µæ¢¯ä¹‹å‰éœ€è¦æƒ³å¥½ï¼Œæˆ‘ä»¬çœŸçš„éœ€è¦è¿™ç§æŠ•å…¥ï¼Œå¦åˆ™åªèƒ½æ˜¯ä¸€ç§æµªè´¹ã€‚</p><p>ä½œä¸ºæ”»åŸç‹®ï¼Œæˆ‘ä»¬ä¸ºèƒ½å¤Ÿè§£å†³æˆ–æ”¹å–„å‘¨å›´ä¸–ç•Œè€Œè‡ªè±ªï¼Œç€è¿·äºæä¾›è§£å†³æ–¹æ¡ˆã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿè¦æ„è¯†åˆ°ï¼Œæˆ‘ä»¬ä»˜å‡ºçš„æ¯ä¸€ä»½åŠªåŠ›ï¼Œéƒ½è¦æœ‰å›æŠ¥ã€‚å¦‚æœä¸èƒ½å¸¦æ¥ä»»ä½•å›æŠ¥çš„é‡æ„å‡çº§ï¼Œéƒ½æ˜¯æµªè´¹æ—¶é—´ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/09ILTzijUr3knHBj13t_kQ" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/n1eKTlLP_BbyBkKG4OyLSw" target="_blank" rel="noopener">å¾®æœåŠ¡ç¼–ç¨‹èŒƒå¼</a></li><li><a href="https://mp.weixin.qq.com/s/sRkYdrAwvn8UrGSraAURpA" target="_blank" rel="noopener">å¾®æœåŠ¡çš„åŸºå»ºå·¥ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/sRX04UhPiFWSDOazTSXuXw" target="_blank" rel="noopener">å¾®æœåŠ¡ä¸­æœåŠ¡æ³¨å†Œå’Œå‘ç°çš„å¯è¡Œæ€§æ–¹æ¡ˆ</a></li><li><a href="https://mp.weixin.qq.com/s/NcftJ1jNAd-DHpzBXKk8RA" target="_blank" rel="noopener">ä»å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„</a></li><li><a href="https://mp.weixin.qq.com/s/M0sla4LVvp2lEiFpzwyVrA" target="_blank" rel="noopener">å¦‚ä½•åœ¨å¾®æœåŠ¡å›¢é˜Ÿä¸­é«˜æ•ˆä½¿ç”¨ Git ç®¡ç†ä»£ç ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/apHFXB2cUqDALpJJebNp9A" target="_blank" rel="noopener">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a></li><li><a href="https://mp.weixin.qq.com/s/AE0n4d_zRZOEeYEQt-rSKw" target="_blank" rel="noopener">å®ç°DevOpsçš„ä¸‰æ­¥å·¥ä½œæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/mMjbafRIhia3u9DmXPSfPQ" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹å¦‚ä½•è®¾è®¡ä¸€ä¸ªçŸ­é“¾æœåŠ¡</a></li><li><a href="https://mp.weixin.qq.com/s/mtt_wsUChGIwnR-Nz5BE4g" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹ä»»åŠ¡é˜Ÿåˆ—</a></li><li><a href="https://mp.weixin.qq.com/s/_PI5jRP99ktPs3lxCbBLSg" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-ç¼“å­˜æŠ€æœ¯</a></li><li><a href="https://mp.weixin.qq.com/s/668L2NK7LWo3c8U8ZI_1ng" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-äº‹ä»¶é©±åŠ¨æ¶æ„</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/from-monolith-to-microservices-2/">å¦‚ä½•å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„çš„èœ•å˜ï¼Ÿ</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">å¦‚ä½•å®ç°å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„çš„èœ•å˜ï¼Ÿ</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      å¦‚æœåŸæ¥æ˜¯å•ä½“æ¶æ„ï¼Œæƒ³è¦åˆ‡æ¢åˆ°å¾®æœåŠ¡æ¶æ„ï¼Œè¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿæœ¬æ–‡æ¥èŠèŠè¿™ä¸ªè¯é¢˜ï¼Œè§£å†³â€œä»€ä¹ˆæ—¶å€™ï¼ˆWHENï¼‰ã€æ€æ ·åšï¼ˆHOWï¼‰â€ã€‚
    
    </summary>
    
    
      <category term="microservice" scheme="https://www.howardliu.cn/categories/microservice/"/>
    
    
      <category term="å¾®æœåŠ¡" scheme="https://www.howardliu.cn/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    
      <category term="å•ä½“æ¶æ„" scheme="https://www.howardliu.cn/tags/%E5%8D%95%E4%BD%93%E6%9E%B6%E6%9E%84/"/>
    
      <category term="é‡æ„" scheme="https://www.howardliu.cn/tags/%E9%87%8D%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>é™¤äº†å¾®æœåŠ¡ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–é€‰æ‹©å—ï¼Ÿ</title>
    <link href="https://www.howardliu.cn/do-we-have-any-other-options-besides-microservices/"/>
    <id>https://www.howardliu.cn/do-we-have-any-other-options-besides-microservices/</id>
    <published>2021-12-05T14:25:56.000Z</published>
    <updated>2021-12-05T14:25:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/cover/bird-6720306_1920.jpg" alt="é™¤äº†å¾®æœåŠ¡ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–é€‰æ‹©å—ï¼Ÿ"></p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å‰é¢æˆ‘ä»¬èŠäº†å¾®æœåŠ¡çš„è¯é¢˜ï¼Œç°åœ¨å¾®æœåŠ¡å·²ç»æ˜¯ä¸šå†…é€šè¯†ã€‚ä½†å‡¡ç³»ç»Ÿå¼€å‘ã€ç³»ç»Ÿè®¾è®¡ï¼Œå¿…ç„¶é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæˆ–è€…å®£ç§°æ˜¯å¾®æœåŠ¡æ¶æ„ã€‚</p><p>ä½†å¤§å®¶æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¾®æœåŠ¡æ¶æ„ä¸æ˜¯ä¸€å¼€å§‹å°±æœ‰çš„ã€‚å¦‚æœè¿½æº¯å†å²ï¼Œå¾®æœåŠ¡æœ€æ—©åœ¨ 2005 çš„äº‘è®¡ç®—åšè§ˆä¼šï¼Œç”± Peter Rodgers åšå£«æå‡ºï¼ˆé‚£æ—¶å€™ç§°ä¸ºå¾® Web æœåŠ¡ï¼ˆMicro-Web-Serviceï¼‰ï¼‰ã€‚åˆ°äº† 2014 å¹´ï¼ŒMartin Fowler ä¸ James Lewis å…±åŒæå‡ºå¾®æœåŠ¡ï¼ˆMicron-Serviceï¼‰çš„æ¦‚å¿µï¼Œç®—æ˜¯å¯¹æ¦‚å¿µå½’çº³æ€»ç»“ï¼Œå¤©ä¸‹ä¸€ç»Ÿã€‚è¿™ä¸€å¹´ä¹Ÿè¢«ç§°ä¸ºå¾®æœåŠ¡å…ƒå¹´ã€‚</p><p><img src="https://static.howardliu.cn/Illustration/1565046133.jpg" alt="çœ‹å±±çš„å°å±‹"></p><p>é‚£å°±è¦é—®äº†ï¼Œåœ¨ 2014 å¹´ä¹‹å‰å‘¢ï¼Ÿå¤§å®¶ç”¨å•¥æ¶æ„ï¼Ÿå†å¾€å‰å‘¢ï¼Ÿä¸Šæ¬¡äº’è”ç½‘å¤§æ½®çš„æ—¶å€™ï¼Œå¤§å®¶åˆæ˜¯ç”¨å•¥ï¼Ÿæˆ‘ä»¬ä»Šå¤©æ¥èŠèŠè¿™æ®µå†å²ï¼Œå¯èƒ½ä½ ä¼šå¯¹ç°åœ¨ä¹ ä»¥ä¸ºå¸¸çš„æ¶æ„ï¼Œäº§ç”Ÿä¸€äº›æ–°çš„çœ‹æ³•ã€‚åœ¨æ¶æ„ä¸Šï¼Œå¯ä»¥æœ‰æ›´å¤šçš„é€‰æ‹©ã€‚</p><a id="more"></a><h2 id="äººäººå–Šæ‰“çš„å•ä½“æ¶æ„"><a href="#äººäººå–Šæ‰“çš„å•ä½“æ¶æ„" class="headerlink" title="äººäººå–Šæ‰“çš„å•ä½“æ¶æ„"></a>äººäººå–Šæ‰“çš„å•ä½“æ¶æ„</h2><blockquote><p>å•ä½“æ¶æ„ï¼Œäººäººéƒ½è¯´è¿™ç§æ¶æ„ä¸å¥½ï¼Œä¸ºä»€ä¹ˆä¸å¥½å‘¢ï¼ŸçœŸçš„ä¸å¥½å—ï¼Ÿå¯èƒ½çœŸç›¸å¹¶ä¸æ˜¯ä½ è®¤ä¸ºçš„é‚£æ ·ç®€å•ã€‚</p></blockquote><p>å½“å‰æ¥è¯´ï¼Œå¦‚æœæœ‰äººè¯´æŸä¸ªç³»ç»Ÿæ˜¯å•ä½“æ¶æ„ï¼Œä¸€å®šä¼šæœ‰äººæŠ•æ¥æ€€ç–‘çš„çœ¼ç¥ï¼Œæœ‰çš„ä¼šå¸¦ç€äº›è®¸ä¸å¯æ€è®®ï¼Œç”šè‡³å¸¦æœ‰ä¸€ä¸é„™å¤·ã€‚ä½†æ˜¯ä¸å¾—ä¸è¯´ï¼Œå•ä½“æ¶æ„ï¼ˆåˆç§°å·¨çŸ³ç³»ç»Ÿï¼ŒMonolithicï¼‰æ˜¯æ•´ä¸ªè½¯ä»¶å‘å±•è¿‡ç¨‹ä¸­ï¼Œå‡ºç°æ—¶é—´æœ€æ—©ã€åº”ç”¨èŒƒå›´æœ€å¹¿çš„ä¸€ç§æ¶æ„é£æ ¼ã€‚ä»å¦ä¸€ä¸ªæ–¹é¢ï¼ŒåŸæ¥æœ¬æ²¡æœ‰å•ä½“æ¶æ„è¿™ä¸ªç§°å‘¼ï¼Œåªæ˜¯åæ¥æœ‰äº†å¾®æœåŠ¡æ¶æ„ï¼Œä¸ºäº†åŒºåˆ†ï¼Œæ‰æŠŠæ‰€æœ‰â€œè‡ªåŒ…å«â€çš„ç³»ç»Ÿç§°ä¸ºå•ä½“æ¶æ„ã€‚</p><p><img src="https://static.howardliu.cn/microservice/699473-20171125103303375-138169041.png" alt="äººäººå–Šæ‰“çš„å•ä½“æ¶æ„æ„"></p><p>ä¸Šé¢è¿™ä¸ªå›¾å°±æ˜¯å•ä½“æ¶æ„ï¼Œæ‰€è°“â€œè‡ªåŒ…å«â€ï¼Œç®€å•è¯´å°±æ˜¯è‡ªç»™è‡ªè¶³ï¼Œæ‰€æœ‰ä¸šåŠ¡åŠŸèƒ½é è‡ªå·±ï¼Œä¸ä¾èµ–å…¶ä»–ä¸šåŠ¡ç³»ç»Ÿã€‚å…¶ä¼˜ç‚¹æœ‰ä¸‹é¢è¿™äº›ï¼š</p><ul><li>ä¸æ¶‰åŠè¿›ç¨‹é—´é€šä¿¡ï¼Œæ•ˆç‡å¯æ§ï¼›</li><li>ä¸ä¾èµ–ç½‘ç»œé€šè®¯ï¼Œå¯ä»¥è§„é¿ä¸å¯é çš„ç½‘ç»œé€šè®¯å¸¦æ¥éš¾ä»¥é¢„çŸ¥çš„æ•…éšœï¼›</li><li>å¼€å‘ç”Ÿæ€è‰¯å¥½ï¼Œç›®å‰çš„ IDE å¯¹å•ä½“æ¶æ„çš„æ”¯æŒæ›´å¥½ï¼›</li><li>ç¼–ç é‡æ„å®¹æ˜“ï¼Œå•ä½“æ¶æ„å®Œå…¨çš„è‡ªæ§åˆ¶ï¼Œåªè¦ä¿®æ”¹è‡ªå·±å³å¯ï¼Œä¸éœ€è¦ä¸Šä¸‹æ¸¸æ”¯æŒï¼›</li><li>ç«¯åˆ°ç«¯æµ‹è¯•ç®€å•ï¼Œå› ä¸ºæ²¡æœ‰ä¸Šä¸‹æ¸¸ä¾èµ–ï¼Œæµ‹è¯•èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼Œéƒ¨ç½²ä¸€å¥—ç¯å¢ƒï¼Œå°±å¯ä»¥å®ç°å½“å‰åŠŸèƒ½çš„å®Œå…¨æµ‹è¯•ï¼›</li><li>éƒ¨ç½²ç®€å•ï¼Œåªè¦æ‰“åŒ…æˆ EARã€WARã€JAR ç­‰éœ€è¦çš„è¿è¡ŒåŒ…ï¼Œæ‰”è¿›æœåŠ¡å™¨å°±èƒ½è·‘ï¼›</li><li>è¿ç»´ç®€å•ï¼Œä¸€ä¸ªè¿›ç¨‹è¿è¡Œçš„æœåŠ¡ï¼Œæ— è®ºæ˜¯æ—¥å¿—è¿˜æ˜¯è¿è¡Œæ€ï¼Œéƒ½èƒ½å¤Ÿå¾ˆç®€å•çš„ç›‘æ§ï¼›</li><li>æ¨ªå‘æ‰©å±•å®¹æ˜“ï¼Œå‰é¢ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨åšä»£ç†ï¼Œåé¢å¯ä»¥æ— é™æ‰©å±•ã€‚</li></ul><p>ä»è¿™ä¸ªè§’åº¦ï¼Œåªè¦å•æœºä¼˜åŠ¿æ˜æ˜¾ï¼Œå°±ä¸è¯¥æŠŠå•ä½“æ¶æ„è§†ä¸ºåœ°ç‹±ã€‚</p><p>æ‰€è°“â€œæˆä¹Ÿè§ä½•è´¥ä¹Ÿè§ä½•â€ï¼Œç»Ÿä¸€â€œé›†ä¸­â€æˆå°±äº†å•ä½“æ¶æ„ï¼Œéš¾ä»¥â€œéš”ç¦»â€ä¹Ÿæˆä¸ºäº†å•ä½“æ¶æ„æœ€å¤§çš„å¼Šç«¯ã€‚è¿™é‡Œå°†éš”ç¦»ç®€å•åˆ†ä¸ºå¼€å‘æœŸéš”ç¦»å’Œè¿è¡ŒæœŸéš”ç¦»ã€‚</p><p>å•ä½“æ¶æ„çœå»äº†è¿›ç¨‹é—´é€šä¿¡ã€æ€§èƒ½æŸå¤±è¿™äº›éº»çƒ¦äº‹ï¼Œä½†å› ä¸ºåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­æ‰§è¡Œï¼Œå¦‚æœå†…éƒ¨çš„æŸå¤„é€»è¾‘å¼‚å¸¸ï¼Œå¯èƒ½ä¼šé€ æˆæ•´ä¸ªç³»ç»Ÿçš„å´©æºƒã€‚æœ€å¸¸è§çš„å†…å­˜æº¢å‡ºï¼Œå¯èƒ½ä»…ä»…æ˜¯ä¸€ä¸ªä¸ç›¸å¹²çš„åŠŸèƒ½æŸ¥äº†å…¨è¡¨ï¼Œæ•´ä¸ªç³»ç»Ÿéƒ½éƒ½ä¼šå®•æ‰ã€‚</p><p><img src="https://static.howardliu.cn/Illustration/300.jpeg" alt="ç³»ç»Ÿå´©æºƒ"></p><p>è¿è¡ŒæœŸæ²¡æœ‰åŠæ³•éš”ç¦»ï¼Œå‡çº§çš„æ—¶å€™ä¹Ÿæ²¡æœ‰åŠæ³•éš”ç¦»ã€‚æƒ³è¦å¯¹æŸäº›æ¨¡å—åŠŸèƒ½å‡çº§ï¼Œåªèƒ½é‡å¯æ•´ä¸ªæœåŠ¡ã€‚è¿˜è¦æ‹…å¿ƒä¼šä¸ä¼šæœ‰æ²¡æœ‰è¦†ç›–æµ‹è¯•çš„ç‚¹ï¼Œæå‰åšå¥½é¢„æ¡ˆï¼ŒæŒ‚å¥½åœæœºç»´æŠ¤é¡µã€‚</p><p>å› æ­¤ï¼Œä¸€ä¸ªæˆåŠŸçš„å•ä½“æ¶æ„ç³»ç»Ÿéšå«äº†ä¸€ä¸ªè¦æ±‚ï¼Œéœ€è¦ä¸€ä¸ªå¯¹ç³»ç»Ÿå®Œå…¨äº†è§£çš„å¤§è„‘ï¼ˆä¸€ä¸ªäººæˆ–ä¸€ç»„äººï¼‰ï¼Œå¤§è„‘å¯ä»¥æ€»æ§ç³»ç»Ÿçš„å¼€å‘ã€å‡çº§ã€è¿è¡Œï¼ŒæŠŠæ§è¿™ä¸ªç³»ç»Ÿçš„æ¯ä¸ªç»†èŠ‚ï¼Œå®ç°ç³»ç»Ÿä¸­çš„å„ä¸ªç»„ä»¶ã€æ¨¡å—æœ‰å¾ˆé«˜çš„å“è´¨ï¼Œä»è€Œä¿éšœç³»ç»Ÿå¯åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…å¯ä»¥ç¨³å®šçš„è¿è¡Œã€‚</p><p>æ¯”å¦‚ï¼ŒSAP å’Œ Hyperionï¼Œå¦¥å¦¥çš„å•ä½“æ¶æ„ï¼Œä½œä¸ºå›½é™…åŒ–çš„è½¯ä»¶å…¬å¸ï¼Œä¸ºä»€ä¹ˆä¸å¯¹å®ƒä»¬å‡çº§æ”¹é€ ï¼Ÿæ˜¯èƒ½åŠ›ä¸è¡Œï¼Œè¿˜æ˜¯æŠ€æœ¯ä¸è¡Œï¼Ÿæ˜¯æ²¡æœ‰å¿…è¦ã€‚æ‰€ä»¥ï¼Œå•ä½“æ¶æ„ä¹Ÿä¸æ˜¯ä¸€æ— æ˜¯å¤„ï¼Œä¸€åˆ‡éƒ½è¦åœ¨åˆé€‚çš„å‰æä¸‹è¯„ä»·ã€‚</p><h2 id="å¼€ç–†æ‹“åœŸçš„-SOA-æ¶æ„"><a href="#å¼€ç–†æ‹“åœŸçš„-SOA-æ¶æ„" class="headerlink" title="å¼€ç–†æ‹“åœŸçš„ SOA æ¶æ„"></a>å¼€ç–†æ‹“åœŸçš„ SOA æ¶æ„</h2><blockquote><p>éƒ½è¯´ SOA æ¶æ„å¤ªé‡ï¼Œä½†ä»–æ˜¯å¼€åˆ›æœåŠ¡åŒ–æ±Ÿå±±çš„é¼»ç¥–ã€‚</p></blockquote><p><img src="https://static.howardliu.cn/microservice/Enterprise-service-bus-architecture.png" alt="å¼€ç–†æ‹“åœŸçš„ SOA æ¶æ„"></p><p>å•ä½“æ¶æ„å¯¹å›¢é˜Ÿçš„è¦æ±‚è¾ƒé«˜ï¼Œéšç€å›¢é˜Ÿçš„æ‰©å¤§ï¼Œå¿…ç„¶ä¼šæœ‰çŸ­æ¿æˆ–è–„å¼±çš„ç¯èŠ‚ï¼Œæˆ–è€…æ˜¯ç»„ç»‡ã€æˆ–è€…æ˜¯ä¸ªäººï¼Œè¿™æ ·å°±ä¼šç»™ç³»ç»Ÿä»£ç†é£é™©ã€‚äºæ˜¯ï¼Œå¾ˆå¤šå‰è¾ˆå°±å¼€å§‹æ€è€ƒï¼Œä¸€ä¸ªåºç„¶å¤§ç‰©éš¾ä»¥ç»´æŠ¤ï¼Œé‚£å°±åˆ†ä¸ºæ²»ä¹‹ï¼Œæ‹†åˆ†æˆå¤šä¸ªè§„æ¨¡å°ä¸€äº›çš„å•ä½“æ¶æ„ï¼Œå½¼æ­¤ä¹‹é—´é€šè¿‡æŸç§æ–¹å¼äº¤äº’ã€‚è¿™ç§æ–¹æ¡ˆè¢«ç§°ä¸ºé¢å‘æœåŠ¡æ¶æ„ï¼ˆSOAï¼ŒService-Oriented Architectureï¼‰ã€‚</p><p>SOA åœ¨ 1994 å¹´å°±è¢«æå‡ºï¼Œè¿™ç§æ¶æ„é£æ ¼æ˜¯è‡ªç„¶æ¼”åŒ–æ¥çš„ã€‚åªä¸è¿‡å½“æ—¶æ²¡æœ‰è¶³å¤Ÿçš„æ¡ä»¶æ”¯æŒï¼Œä¸€ç›´åªèƒ½å¤„äºç†è®ºé˜¶æ®µã€‚åæ¥éšç€ webservice ç­‰æŠ€æœ¯çš„æå‡ºï¼Œæ‰æœ‰äº†æŠ€æœ¯æ”¯æ’‘ã€‚åˆ° 2006 å¹´ï¼ŒOSOA æˆç«‹ï¼Œå…±åŒåˆ¶å®š SOA æ¶æ„ç›¸å…³è¡Œä¸šæ ‡å‡†ï¼Œè¿™å¥—æ¶æ„æœ‰äº†ç†è®ºã€æŠ€æœ¯ã€è§„èŒƒç­‰ä¸€ç³»åˆ—çº¦å®šï¼Œä»è€ŒçœŸæ­£è½åœ°ã€‚</p><p>SOA æ¶æ„å¼€ç–†æ‹“åœŸï¼Œå¼€åˆ›äº†å¾ˆå¤šç›®å‰ä¹Ÿåœ¨ä½¿ç”¨çš„æ¦‚å¿µï¼Œæ¯”å¦‚æœåŠ¡æ³¨å†Œ/å‘ç°ã€æœåŠ¡æ²»ç†ã€ç³»ç»Ÿéš”ç¦»ã€æœåŠ¡ç¼–æ’ç­‰ã€‚æ˜¯ä¸æ˜¯è§‰å¾—è¿™äº›æ¦‚å¿µå¾ˆç†Ÿæ‚‰ï¼Œæ˜¯çš„ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒåŒæ ·æœ‰è¿™äº›æ¦‚å¿µçš„èº«å½±ã€‚SOA æ¶æ„æœ‰è‡ªå·±çš„ä¸€å¥—é£æ ¼ï¼Œä½¿ç”¨ä¸‹é¢ä¸€äº›ç»„ä»¶å®ç°æ™®é€‚çš„æ–¹æ³•è®ºï¼š</p><ol><li>é‡‡ç”¨ SOAP ä½œä¸ºè¿œç¨‹è°ƒç”¨çš„åè®®ï¼›</li><li>åˆ©ç”¨ ESBï¼ˆEnterprise Service Busï¼Œä¼ä¸šæœåŠ¡æ€»çº¿ï¼‰å®ç°å„ä¸ªå­ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡äº¤äº’ï¼›</li><li>ä½¿ç”¨ BPMï¼ˆBusiness Process Managementï¼Œä¸šåŠ¡æµç¨‹ç®¡ç†ç³»ç»Ÿï¼‰å®ç°ä¸šåŠ¡æµç¨‹ç¼–æ’ï¼›</li><li>ä½¿ç”¨ SDOï¼ˆService Data Objectï¼ŒæœåŠ¡æ•°æ®å¯¹è±¡ï¼‰æ¥è®¿é—®å’Œè¡¨ç¤ºæ•°æ®ï¼›</li><li>ä½¿ç”¨ SCAï¼ˆService Component Architectureï¼ŒæœåŠ¡ç»„ä»¶æ¶æ„ï¼‰æ¥å®šä¹‰æœåŠ¡å°è£…çš„å½¢å¼å’ŒæœåŠ¡è¿è¡Œçš„å®¹å™¨ï¼›</li><li>â€¦â€¦</li></ol><p>SOA æ¶æ„æ˜¯å„å¤§è½¯ä»¶æœåŠ¡å•†å…±åŒæ„¿æ™¯ä¸‹çš„äº§ç‰©ï¼Œæ€»ç»“å‡ºäº†ä¸€å¥—è‡ªä¸Šè€Œä¸‹çš„è½¯ä»¶ç ”å‘æ–¹æ³•è®ºï¼ŒæœŸæœ›èƒ½å¤Ÿè§£å†³è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„æ‰€æœ‰é—®é¢˜ã€‚æœ‰äº›ç±»ä¼¼äºå…«è‚¡æ–‡ï¼Œè§„å®šå¥½èµ·æ‰¿è½¬åˆï¼Œåªè¦æŒ‰ç…§è¦æ±‚æ¥ï¼Œç³»ç»Ÿå°±ä¸ä¼šå‡ºç°å¤ªå¤šé—®é¢˜ã€‚</p><p>æ„¿æ™¯è™½å¥½ï¼Œä½†æ˜¯å´å¿½ç•¥äº†ä¸€ç‚¹ï¼Œä¸€å¥—å¤§è€Œå…¨çš„æ¶æ„ä½“ç³»ï¼Œä¸æ˜¯æ‰€æœ‰å…¬å¸éƒ½èƒ½å¤Ÿæ”¯æ’‘èµ·æ¥çš„ã€‚æœ‰æ—¶å€™ï¼Œå¤§è€Œå…¨ä¸å¦‚å°è€Œç¾ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½å¦è®¤ SOA æ¶æ„å¯¹äºé¢å‘æœåŠ¡ç†è®ºçš„è´¡çŒ®ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹çš„ä¼ä¸šå†…éƒ¨ï¼ŒSOA æ˜¯èƒ½å¤Ÿå¿«é€Ÿæ‰“ç ´ä¿¡æ¯å­¤å²›çš„é‡è¦æ‰‹æ®µã€‚</p><h2 id="å¦ç«‹é—¨æˆ·çš„å¾®æœåŠ¡æ¶æ„"><a href="#å¦ç«‹é—¨æˆ·çš„å¾®æœåŠ¡æ¶æ„" class="headerlink" title="å¦ç«‹é—¨æˆ·çš„å¾®æœåŠ¡æ¶æ„"></a>å¦ç«‹é—¨æˆ·çš„å¾®æœåŠ¡æ¶æ„</h2><blockquote><p>æœ¬æ¥æ˜¯ä½œä¸º SOA çš„ä¸€ç§ç®€åŒ–æ–¹æ¡ˆï¼Œç»“æœç›´æ¥å‘åŠ¨å®£æ­¦é—¨ä¹‹å˜ï¼Œé€¼ç€ SAO ç¦…è®©ã€‚</p></blockquote><p><img src="https://static.howardliu.cn/microservice/microservice-architecture.png" alt="å¦ç«‹é—¨æˆ·çš„å¾®æœåŠ¡æ¶æ„"></p><p>å¦‚å¼€ç¯‡æ‰€è¯´ï¼Œå¾®æœåŠ¡æ¶æ„æ˜¯åœ¨ 2005 å¹´æå‡ºï¼Œåœ¨ 2014 å¹´å´›èµ·ã€‚ç»å†äº†å°†è¿‘ 10 å¹´çš„æ—¶é—´ï¼Œä¹‹æ‰€ä»¥æ²¡æœ‰å¾—åˆ°å¤ªå¤šé‡è§†ï¼Œæ˜¯å› ä¸º 2014 å¹´ä¹‹å‰ï¼Œå¾®æœåŠ¡åªæ˜¯åœ¨ä½œä¸º SOA æ¶æ„çš„ç®€åŒ–ç‰ˆå‡ºç°ã€‚ç›´åˆ° 2014 å¹´æ‰ä½œä¸ºç‹¬ç«‹çš„æ¶æ„é£æ ¼ï¼Œä¸ SOA æ¶æ„åˆ’æ¸…ç•Œé™ã€‚</p><p>Martin Fowler ä¸ James Lewis åœ¨åˆå†™çš„ <a href="https://martinfowler.com/articles/microservices.html" target="_blank" rel="noopener">ã€ŠMicroservicesã€‹</a> å¯¹å¾®æœåŠ¡ä¸‹äº†å®šä¹‰ï¼šâ€œå¾®æœåŠ¡æ˜¯ä¸€ç§é€šè¿‡å¤šä¸ªå°å‹æœåŠ¡ç»„åˆæ¥æ„å»ºå•ä¸ªåº”ç”¨çš„æ¶æ„é£æ ¼ï¼Œè¿™äº›æœåŠ¡å›´ç»•ä¸šåŠ¡èƒ½åŠ›è€Œéç‰¹å®šçš„æŠ€æœ¯æ ‡å‡†æ¥æ„å»ºã€‚å„ä¸ªæœåŠ¡å¯ä»¥é‡‡ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ï¼Œè¿è¡Œåœ¨ä¸åŒçš„è¿›ç¨‹ä¹‹ä¸­ã€‚æœåŠ¡é‡‡å–è½»é‡çº§çš„é€šä¿¡æœºåˆ¶å’Œè‡ªåŠ¨åŒ–çš„éƒ¨ç½²æœºåˆ¶å®ç°é€šä¿¡ä¸è¿ç»´ã€‚â€</p><p>æ–‡ä¸­è¿˜æå‡ºäº†å¾®æœåŠ¡æ¶æ„çš„ 9 ä¸ªæ ¸å¿ƒç‰¹å¾ï¼š</p><ol><li>é€šè¿‡æœåŠ¡æ¥å®ç°ç‹¬ç«‹è‡ªæ²»çš„ç»„ä»¶ï¼ˆComponentization via Servicesï¼‰</li><li>å›´ç»•ä¸šåŠ¡èƒ½åŠ›æ„å»ºï¼ˆOrganized around Business Capabilityï¼‰</li><li>äº§å“åŒ–æ€ç»´ï¼ˆProducts not Projectsï¼‰</li><li>å¼ºç»ˆç«¯å¼±ç®¡é“ï¼ˆSmart Endpoint and Dumb Pipeï¼‰</li><li>åˆ†æ•£æ²»ç†ï¼ˆDecentralized Governanceï¼‰</li><li>æ•°æ®å»ä¸­å¿ƒåŒ–ï¼ˆDecentralized Data Managementï¼‰</li><li>åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ–ï¼ˆInfrastructure Automationï¼‰</li><li>å®¹é”™æ€§è®¾è®¡ï¼ˆDesign for Failureï¼‰</li><li>æ¼”è¿›å¼è®¾è®¡ï¼ˆEvolutionary Designï¼‰</li></ol><p>ç”±äºå¾®æœåŠ¡æ¶æ„æ˜¯ä» SOA æ¶æ„ä¸­æ¼”åŒ–è€Œæ¥ï¼Œæ‰€ä»¥å¾ˆå¤šçš„è¡¨ç°å½¢å¼éƒ½æ˜¯ä¸€è‡´çš„ã€‚ä»ã€ŠMicroservicesã€‹å¯¹å¾®æœåŠ¡æ¶æ„å…¨é¢ç»†è‡´é˜è¿°ä¹‹åï¼Œä¹Ÿç®—æ˜¯å°†å¾®æœåŠ¡æ¶æ„ä¸ SOA æ¶æ„å½»åº•åˆ’æ¸…ç•Œé™ã€‚</p><p>åœ¨ç¬”è€…çœ‹æ¥ï¼Œå¾®æœåŠ¡æ¶æ„ä¸ SOA æ¶æ„æœ€å¤§çš„ä¸åŒåœ¨äºå¯¹äºå®ç°çš„çº¦æŸï¼ŒSOA æ¶æ„æœ‰ä¸€å¥—å®Œæ•´çš„è§„çº¦ï¼Œå¾®æœåŠ¡æ¶æ„åªæœ‰å»ºè®®ï¼Œè¿½æ±‚çš„æ˜¯æ ¹æ®å®é™…æƒ…å†µè‡ªç”±å˜åŒ–ï¼Œç®€å•çš„ç†è§£å°±æ˜¯â€œæƒ³æ€ä¹ˆç©å°±æ€ä¹ˆç©â€ã€‚æ¯”å¦‚é€šä¿¡åè®®ï¼ŒSOA æ¶æ„æ˜ç¡®è¦æ±‚ä½¿ç”¨ SOAP é€šä¿¡åè®®ï¼›å¾®æœåŠ¡æ¶æ„åªè¦æ±‚ä½¿ç”¨è½»é‡çº§çš„ RPC åè®®ï¼Œè¿™ä¸ªé€‰æ‹©å°±æ¯”è¾ƒå®½æ³›äº†ï¼Œå¸¸è§çš„å°±æœ‰ HTTPï¼ˆä¸€èˆ¬é‡‡ç”¨ Restful é£æ ¼ï¼‰ã€gRPCã€Dubboã€Thriftã€Motan2 ç­‰ç­‰ã€‚</p><p>è‡ªç”±æ„å‘³ç€å¯ä»¥æ ¹æ®å®é™…æƒ…å†µå˜åŒ–ï¼Œéœ€è¦ä»€ä¹ˆå¼•å…¥ä»€ä¹ˆï¼Œå“ªç§æŠ€æœ¯èƒ½æ›´å¥½çš„è§£å†³é—®é¢˜å°±ä½¿ç”¨å“ªç§æŠ€æœ¯ã€‚åœ¨ Java æ ˆä¸­ï¼Œä¹Ÿå‡ºç°äº† SpringCloud Netflix å’Œ SpringCloud Alibaba ä¹‹ç±»çš„å…¨å®¶æ¡¶ç»„ä»¶ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œåªéœ€è¦åœ¨éœ€è¦çš„æ—¶å€™æ·»åŠ ä¾èµ–å³å¯ã€‚</p><p>ä»æ¶æ„å¸ˆçš„è§’åº¦ï¼Œè‡ªç”±å¸¦æ¥çš„æ˜¯çº¦æŸåŠ›çš„ä¸‹é™ï¼ŒåŒæ—¶ä¹Ÿç¼ºå°‘äº†è§„çº¦çš„æŒ‡å¯¼æ€§ã€‚æˆ‘ä»¬éœ€è¦æ›´åŠ äº†è§£ç³»ç»Ÿæœ¬èº«ï¼Œä¹Ÿè¦æ›´åŠ äº†è§£å„ç§æŠ€æœ¯çš„ä¼˜ç¼ºç‚¹ï¼Œæ‰èƒ½å¤Ÿåœ¨æ¶æ„è®¾è®¡æ—¶ï¼Œæ›´å¥½çš„æƒè¡¡åˆ©å¼Šï¼Œåšå¥½å–èˆã€‚åŠ æ²¹ï¼Œå°‘å¹´ã€‚</p><p><img src="https://static.howardliu.cn/Illustration/jiayou.jpg" alt="æ¶æ„å¸ˆå…»æˆè®¡åˆ’"></p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹å¾®æœåŠ¡ä¸­çš„åŸºç¡€ç»„ä»¶ï¼šå¼¹æ€§ä¼¸ç¼©ã€æœåŠ¡å‘ç°ã€é…ç½®ä¸­å¿ƒã€æœåŠ¡ç½‘å…³ã€è´Ÿè½½å‡è¡¡ã€æœåŠ¡å®‰å…¨ã€è·Ÿè¸ªç›‘æ§ã€é™çº§ç†”æ–­ç­‰ç­‰ï¼Œå…¶å®ä»æœ¬è´¨æ¥è¯´ï¼Œè¿™äº›ç»„ä»¶éƒ½æ˜¯ä¸šåŠ¡æ— å…³çš„ã€‚å®ç°è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å°†è¿™äº›ä¸ä¸šåŠ¡éš”ç¦»å¼€ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œé€æ˜åŒ–â€ã€‚</p><p>æ¯”å¦‚æœåŠ¡å‘ç°ï¼Œå¯é€‰çš„æ–¹æ¡ˆåŒ…æ‹¬ Nginxã€HAProxyã€DNSã€Eurekaã€Nacosã€KubeDNSï¼Œä½†æ˜¯æˆ‘ä»¬çœŸçš„å…³å¿ƒå—ï¼Ÿä¸éœ€è¦ï¼Œåªéœ€è¦çŸ¥é“æˆ‘ä»¬è¦è¿›è¡Œç½‘ç»œè°ƒç”¨ï¼Œæœ‰ä¸€ä¸ªç›®æ ‡å³å¯ï¼Œè‡³äºè¿™ä¸ªç›®æ ‡æ˜¯é€šè¿‡å“ªç§æ–¹å¼å‘ç°ã€ä¼ è¾“ã€å¯»å€ï¼Œéƒ½ä¸æˆ‘ä»¬è¦å®ç°çš„åŠŸèƒ½æ— å…³ã€‚é‚£å°±å°†æœåŠ¡å‘ç°ä¸ä¸šåŠ¡å‰¥ç¦»ï¼Œé€šè¿‡æ‰¿è½½æœåŠ¡çš„è¿è¡Œç¯å¢ƒå¤„ç†ã€‚è¿™å°±æ˜¯æ‰€è°“çš„è¾¹è½¦æ¨¡å‹ã€‚</p><p><img src="https://static.howardliu.cn/microservice/service-mesh-with-side-car.png" alt="è¾¹è½¦æ¨¡å‹"></p><p>å¾®æœåŠ¡ä¹‹æ‰€ä»¥åº”ç”¨æ™®åŠï¼Œä¸ä»…ä»…åœ¨äºå…¶ç‹¬ç‰¹ä¼˜åŠ¿ï¼Œè¿˜ä¸å®¹å™¨åŒ–æŠ€æœ¯çš„æ™®åŠæœ‰å¯†åˆ‡å…³ç³»ã€‚å¾®æœåŠ¡ä¸ Docker è™šæ‹ŸåŒ–çš„é«˜æ•ˆç»“åˆï¼Œç›¸å½“äºç»™äº†å¾®æœåŠ¡äºŒæ¬¡åŠ é€Ÿçš„åŠ¨åŠ›ï¼Œèµ„æºè°ƒåº¦ Kubernetes çš„æˆåŠŸï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ç›´æ¥å®ç°äº†æ›²é€Ÿæ¨è¿›ã€‚å…ˆè¿›çš„ç†å¿µè¿˜éœ€è¦å…ˆè¿›çš„æŠ€æœ¯å®ç°ã€‚</p><h2 id="æœ‰å¾…æˆç†Ÿçš„æ— æœåŠ¡æ¶æ„"><a href="#æœ‰å¾…æˆç†Ÿçš„æ— æœåŠ¡æ¶æ„" class="headerlink" title="æœ‰å¾…æˆç†Ÿçš„æ— æœåŠ¡æ¶æ„"></a>æœ‰å¾…æˆç†Ÿçš„æ— æœåŠ¡æ¶æ„</h2><blockquote><p>åˆæƒ³è¦å¿«ï¼Œè¿˜æƒ³è¦ç®€å•ã€‚é‚£å°±ä¸è¦æœåŠ¡äº†ï¼Œéšä¾¿å†™ä¸ªå‡½æ•°è·‘è·‘å¾—äº†ã€‚</p></blockquote><p><img src="https://static.howardliu.cn/microservice/Serverless_Architecture.png" alt="æœ‰å¾…æˆç†Ÿçš„æ— æœåŠ¡æ¶æ„"></p><p>å°±ç›®å‰è€Œè¨€ï¼Œç»å¤§éƒ¨åˆ†çš„ç³»ç»Ÿå¼€å‘éƒ½æ˜¯ä¸ºäº†è§£å†³ä¸šåŠ¡é—®é¢˜ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€äº›ä¸šåŠ¡æ— å…³çš„æŠ€æœ¯ç»„ä»¶ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å—é™äºç ”å‘ç¯å¢ƒï¼Œéœ€è¦çš„æŸç§æŠ€æœ¯ç»„ä»¶ä¸å­˜åœ¨æ—¶ï¼Œéœ€è¦é‡‡è´­éƒ¨ç½²ï¼Œæˆ–è€…ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆã€‚è¿™å°±ä¼šåˆ†æ•£æˆ‘ä»¬çš„æ³¨æ„åŠ›ã€‚</p><p>äºæ˜¯ï¼Œå¾ˆå¤šäº‘æœåŠ¡å•†æå‡ºäº†æ— æœåŠ¡æ¶æ„ã€‚æ— æœåŠ¡æ¶æ„å°†ç³»ç»Ÿå¼€å‘æ¶‰åŠçš„èµ„æºåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šåç«¯è®¾æ–½ï¼ˆBackendï¼‰ã€å‡½æ•°ï¼ˆFunctionï¼‰ï¼Œå¯¹åº”çš„å°±æ˜¯ BaaSï¼ˆBackend as a Serviceï¼Œåç«¯å³æœåŠ¡ï¼‰å’Œ FaaSï¼ˆFunction as a Serviceï¼Œå‡½æ•°å³æœåŠ¡ï¼‰ã€‚</p><p>è¿™ç§ä¸èƒ½ç®—æ˜¯æ¶æ„é£æ ¼ï¼Œåªèƒ½ç®—æ˜¯ä¸€ç§ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­çš„ç¾å¥½æ„¿æ™¯ã€‚è®©å¼€å‘è€…åªéœ€è¦å…³æ³¨ä¸šåŠ¡ï¼Œéœ€è¦çš„åŸºç¡€è®¾æ–½å…¨éƒ¨ç”±äº‘æœåŠ¡æä¾›ï¼Œä¸éœ€è¦è€ƒè™‘è¿è¡Œå®¹å™¨ã€åŸºç¡€è®¾æ–½çš„éƒ¨ç½²ã€æœåŠ¡å™¨è¿è¡Œèƒ½åŠ›ç­‰ã€‚åªè¦å°†å¼€å‘å¥½çš„ä»£ç ä¸Šä¼ ï¼Œå°±å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªå¯è¿è¡Œçš„ç³»ç»Ÿã€‚</p><p>ä½†æ˜¯æ„¿æ™¯è™½å¥½ï¼Œä½†æ˜¯ä¸è‡ªå·±æŒæ§éƒ¨ç½²çš„åŒºåˆ«ä»…åœ¨äºå¯¹äºåŸºç¡€è®¾æ–½çš„ç®¡æ§ç¨‹åº¦ä¸Šã€‚é™¤éå‡ºç°é‡å¤§å˜é©ï¼Œå¦åˆ™è¿™ç§æ¶æ„å¾ˆéš¾åƒå¾®æœåŠ¡æ¶æ„ä¸€æ ·æ™®é€‚ã€‚ä½†æ˜¯å¯¹äºå°ç¨‹åºã€å°å‹ web ç½‘ç«™ã€å’¨è¯¢å¹³å°ç­‰æ¨¡æ¿åŒ–çš„å°å‹ç³»ç»Ÿï¼Œé‡‡ç”¨è¿™ç§æ¶æ„è¿˜æ˜¯æœ‰å¾ˆå¤§ä¼˜åŠ¿çš„ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»æ¶æ„æ¼”è¿›çš„è§’åº¦åˆ†æäº†å•ä½“æ¶æ„ã€SOA æ¶æ„ã€å¾®æœåŠ¡æ¶æ„ã€æ— æœåŠ¡æ¶æ„çš„é€‚ç”¨åœºæ™¯ï¼Œä½œä¸ºæ¶æ„å¸ˆï¼Œæˆ‘ä»¬åœ¨é€‰æ‹©æ¶æ„å¸ˆï¼Œä¸åº”è¯¥ä¸€å‘³è¿½æ±‚ä¸»æµï¼Œä¹Ÿä¸èƒ½ç›²ä»å¤§å‚çš„æ€è·¯ã€‚æˆ‘ä»¬è¦æ ¹æ®è‡ªèº«æƒ…å†µæƒè¡¡åˆ©å¼Šï¼Œæ‰¾åˆ°é€‚åˆçš„æ¶æ„é£æ ¼ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/09ILTzijUr3knHBj13t_kQ" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/n1eKTlLP_BbyBkKG4OyLSw" target="_blank" rel="noopener">å¾®æœåŠ¡ç¼–ç¨‹èŒƒå¼</a></li><li><a href="https://mp.weixin.qq.com/s/sRkYdrAwvn8UrGSraAURpA" target="_blank" rel="noopener">å¾®æœåŠ¡çš„åŸºå»ºå·¥ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/sRX04UhPiFWSDOazTSXuXw" target="_blank" rel="noopener">å¾®æœåŠ¡ä¸­æœåŠ¡æ³¨å†Œå’Œå‘ç°çš„å¯è¡Œæ€§æ–¹æ¡ˆ</a></li><li><a href="https://mp.weixin.qq.com/s/NcftJ1jNAd-DHpzBXKk8RA" target="_blank" rel="noopener">ä»å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„</a></li><li><a href="https://mp.weixin.qq.com/s/M0sla4LVvp2lEiFpzwyVrA" target="_blank" rel="noopener">å¦‚ä½•åœ¨å¾®æœåŠ¡å›¢é˜Ÿä¸­é«˜æ•ˆä½¿ç”¨ Git ç®¡ç†ä»£ç ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/apHFXB2cUqDALpJJebNp9A" target="_blank" rel="noopener">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a></li><li><a href="https://mp.weixin.qq.com/s/AE0n4d_zRZOEeYEQt-rSKw" target="_blank" rel="noopener">å®ç°DevOpsçš„ä¸‰æ­¥å·¥ä½œæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/mMjbafRIhia3u9DmXPSfPQ" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹å¦‚ä½•è®¾è®¡ä¸€ä¸ªçŸ­é“¾æœåŠ¡</a></li><li><a href="https://mp.weixin.qq.com/s/mtt_wsUChGIwnR-Nz5BE4g" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹ä»»åŠ¡é˜Ÿåˆ—</a></li><li><a href="https://mp.weixin.qq.com/s/_PI5jRP99ktPs3lxCbBLSg" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-ç¼“å­˜æŠ€æœ¯</a></li><li><a href="https://mp.weixin.qq.com/s/668L2NK7LWo3c8U8ZI_1ng" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-äº‹ä»¶é©±åŠ¨æ¶æ„</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/do-we-have-any-other-options-besides-microservices/">é™¤äº†å¾®æœåŠ¡ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–é€‰æ‹©å—ï¼Ÿ</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/121760358" target="_blank" rel="noopener">é™¤äº†å¾®æœåŠ¡ï¼Œæˆ‘ä»¬è¿˜æœ‰å…¶ä»–é€‰æ‹©å—ï¼Ÿ</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      ä»å•ä½“æ¶æ„ã€SOAæ¶æ„ï¼Œåˆ°å¾®æœåŠ¡æ¶æ„ï¼Œå†åˆ°å®¹å™¨åŒ–ã€æ— æœåŠ¡æ¶æ„ï¼Œæˆ‘ä»¬çš„é€‰æ‹©å¾ˆå¤šï¼Œæ²¡æœ‰å¿…è¦éåœ¨ä¸€æ£µæ ‘ä¸ŠåŠæ­»ã€‚
    
    </summary>
    
    
      <category term="microservice" scheme="https://www.howardliu.cn/categories/microservice/"/>
    
    
      <category term="å¾®æœåŠ¡" scheme="https://www.howardliu.cn/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    
      <category term="æ¶æ„" scheme="https://www.howardliu.cn/tags/%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava8 çš„æ–°ç‰¹æ€§</title>
    <link href="https://www.howardliu.cn/java-8-features/"/>
    <id>https://www.howardliu.cn/java-8-features/</id>
    <published>2021-11-24T23:53:04.000Z</published>
    <updated>2021-11-24T23:53:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/fruits-6786607_1920.jpg" alt="Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava8 çš„æ–°ç‰¹æ€§"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/visionpics-4638469/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6786607" target="_blank" rel="noopener">Alexandr Podvalny</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6786607" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><blockquote><p>æœ¬æ–‡æ”¶å½•åœ¨ <a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378#wechat_redirect" target="_blank" rel="noopener">ã€ŠJava è¿›é˜¶ã€‹</a> ç³»åˆ—ä¸“æ ä¸­ã€‚</p></blockquote><p>ä» 2017 å¹´å¼€å§‹ï¼ŒJava ç‰ˆæœ¬æ›´æ–°ç­–ç•¥ä»åŸæ¥çš„æ¯ä¸¤å¹´ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œæ”¹ä¸ºæ¯å…­ä¸ªæœˆä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œä»¥å¿«é€ŸéªŒè¯æ–°ç‰¹æ€§ï¼Œæ¨åŠ¨ Java çš„å‘å±•ã€‚ä» <a href="https://res.cloudinary.com/snyk/image/upload/v1623860216/reports/jvm-ecosystem-report-2021.pdf" target="_blank" rel="noopener">ã€ŠJVM Ecosystem Report 2021ã€‹</a> ä¸­å¯ä»¥çœ‹å‡ºï¼Œç›®å‰å¼€å‘ç¯å¢ƒä¸­ä»æœ‰è¿‘åŠçš„ç¯å¢ƒä½¿ç”¨ Java8ï¼Œæœ‰è¿‘åŠçš„äººè½¬ç§»åˆ°äº† Java11ï¼Œéšç€ Java17 çš„å‘å¸ƒï¼Œç›¸ä¿¡æ¯”ä¾‹ä¼šæœ‰æ‰€å˜åŒ–ã€‚</p><p>å› æ­¤ï¼Œå‡†å¤‡å‡ºä¸€ä¸ªç³»åˆ—ï¼Œé…åˆç¤ºä¾‹è®²è§£ï¼Œé˜è¿°ä» Java8 å¼€å§‹å„ä¸ªç‰ˆæœ¬çš„æ–°ç‰¹æ€§ã€‚</p><h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><p>Java8 ä» 2014 å¹´é—®ä¸–ï¼Œåˆ°ç°åœ¨å·²æ˜¯æ•°ä¸ªå¹´å¤´ã€‚è¿™ä¸ªç‰ˆæœ¬æ–°å¢äº† Stream APIã€Lambda è¡¨è¾¾å¼ã€æ–°æ—¶é—´ API ç­‰å„ç§æ–°ç‰¹æ€§ï¼Œç›¸æ¯”å¾ˆå¤šæ–°å…´è¯­è¨€ä¹Ÿä¸é‘å¤šè®©ã€‚ä»Šå¤©å°±æ¥èŠèŠ Java8 ä¸­å¥½ç©å¥½ä½¿çš„ç‰¹æ€§åŠŸèƒ½ï¼ˆå®Œæ•´ç‰¹æ€§è¯·å‚è§ <a href="https://openjdk.java.net/projects/Java8/features" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼‰ã€‚</p><h2 id="æ¥å£æ–¹æ³•"><a href="#æ¥å£æ–¹æ³•" class="headerlink" title="æ¥å£æ–¹æ³•"></a>æ¥å£æ–¹æ³•</h2><p>åœ¨ Java8 ä¹‹å‰ï¼Œæ¥å£åªèƒ½å¤Ÿå®šä¹‰<code>public abstract</code>æ–¹æ³•ï¼Œé»˜è®¤å¯ä»¥ä¸å†™ä¿®é¥°ç¬¦ã€‚å½“åœ¨æ¥å£ä¸­æ–°å¢æ–¹æ³•å®šä¹‰ï¼Œè¯¥æ¥å£çš„æ‰€æœ‰å®ç°ç±»éƒ½éœ€è¦æ–°å¢è¿™ä¸ªæ–¹æ³•çš„å®ç°ï¼Œè¿™æ ·å¯¹äºå‡çº§æ‰©å±•å¾ˆä¸å‹å¥½ã€‚</p><p>ä» Java8 å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•äº†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰å…·æœ‰å…·ä½“æ“ä½œè¡Œä¸ºçš„æ–¹æ³•å®šä¹‰ï¼Œè¿™æ ·æ¥å£çš„å®ç°ç±»å¯ä»¥æœ‰é€‰æ‹©çš„å®ç°æ¥å£æ–¹æ³•ã€‚</p><h3 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h3><p>Java8 ä¹‹å‰ï¼Œé™æ€æ–¹æ³•æ˜¯ç±»çš„ä¸“å±æŠ€èƒ½ï¼Œè¿™æ ·ä¼šå¼•èµ·æ¦‚å¿µä¸Šçš„ä¸€äº›æ­§ä¹‰ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç”Ÿäº§è€…<code>Producer</code>æ¥å£ï¼Œæ‰€æœ‰ç”Ÿäº§è€…éƒ½ç»§æ‰¿è¯¥æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé™æ€æ–¹æ³•æä¾›<code>Producer</code>çš„åå­—ã€‚è¿™ä¸ªæ—¶å€™ï¼Œåœ¨å•ç‹¬å®šä¹‰ä¸€ä¸ªç±»æä¾›ä¸€ä¸ªé™æ€æ–¹æ³•æä¾›åå­—ï¼Œå¯ä»¥å®ç°åŠŸèƒ½ï¼Œä½†æ˜¯ç•¥æ˜¾å¤æ‚ã€‚</p><p>ç°åœ¨æˆ‘ä»¬ç›´æ¥åœ¨<code>Producer</code>ç”Ÿäº§è€…æ¥å£ä¸­å®šä¹‰é™æ€æ–¹æ³•å³å¯ï¼š</p><pre><code class="java">static String producer() {    return &quot;target: &quot; + System.currentTimeMillis();}</code></pre><p>æ²¿ç”¨çº¦å®šçš„é™å®šèŒƒå›´ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ–¹æ³•å‰é¢åŠ <code>public</code>ã€‚è¿™ä¸ªé™æ€æ–¹æ³•åªèƒ½é€šè¿‡æ¥å£è°ƒç”¨ï¼Œæˆ–è€…åœ¨æ¥å£å†…éƒ¨ç›´æ¥å¼•ç”¨ã€‚æ¯”å¦‚ï¼š</p><pre><code class="java">final String target = Producer.producer();</code></pre><h3 id="é»˜è®¤æ–¹æ³•"><a href="#é»˜è®¤æ–¹æ³•" class="headerlink" title="é»˜è®¤æ–¹æ³•"></a>é»˜è®¤æ–¹æ³•</h3><p>æ¥å£çš„é»˜è®¤æ–¹æ³•å®šä¹‰éœ€è¦ä½¿ç”¨<code>default</code>å…³é”®å­—ï¼Œæ¥å£ä¸­å®šä¹‰çš„é»˜è®¤æ–¹æ³•å¯ä»¥åœ¨å®ç°ç±»ä¸­é‡å†™ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„ç”Ÿäº§è€…<code>Producer</code>éœ€è¦ç”Ÿäº§ä¸œè¥¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰ä¸€ä¸ªé»˜è®¤æ–¹æ³•ï¼š</p><pre><code class="java">default String produce() {    return &quot;NULL&quot;;}</code></pre><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰<code>Producer</code>çš„å®ç°ç±»æ˜¯<code>Hamburger</code>ï¼Œå¯ä»¥é€‰æ‹©é‡å†™æ¥å£çš„é»˜è®¤æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨é‡å†™ã€‚æ¯”å¦‚ï¼š</p><pre><code class="java">public class Hamburger implements Producer {}</code></pre><p>ä½¿ç”¨çš„æ—¶å€™ç›´æ¥è°ƒç”¨ï¼š</p><pre><code class="java">final Producer producer = new Hamburger();System.out.println(producer.produce());</code></pre><p>è¿™ä¸ªæ—¶å€™ä¼šæ‰“å°â€œNULLâ€ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨<code>Hamburger</code>ä¸­é‡å†™<code>produce</code>æ–¹æ³•ï¼š</p><pre><code class="java">@Overridepublic String produce() {    return &quot;HAMBURGER&quot;;}</code></pre><p>è¿™ä¸ªæ—¶å€™ä¼šæ‰“å°â€œHAMBURGERâ€ã€‚</p><h2 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h2><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ Lambda è¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼Œä½¿è¡¨è¾¾å¼æ›´çŸ­ã€æ›´æ˜“è¯»ã€‚æ–¹æ³•å¼•ç”¨æœ‰å››ç§è¡¨è¾¾å½¢å¼ï¼š</p><ul><li>é™æ€æ–¹æ³•å¼•ç”¨</li><li>å®ä¾‹æ–¹æ³•å¼•ç”¨</li><li>ç‰¹å®šç±»å‹çš„å®ä¾‹æ–¹æ³•å¼•ç”¨</li><li>æ„é€ æ–¹æ³•å¼•ç”¨</li></ul><p>ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«è¯´ä¸€ä¸‹ã€‚</p><h3 id="é™æ€æ–¹æ³•å¼•ç”¨"><a href="#é™æ€æ–¹æ³•å¼•ç”¨" class="headerlink" title="é™æ€æ–¹æ³•å¼•ç”¨"></a>é™æ€æ–¹æ³•å¼•ç”¨</h3><p>é™æ€æ–¹æ³•å¼•ç”¨è¯­æ³•æ˜¯ï¼š<code>ç±»åï¼š: æ–¹æ³•å</code>ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ª<code>List&lt;String&gt;</code>é˜Ÿåˆ—ä¸­æ‰€æœ‰å…ƒç´ æ˜¯å¦ä¸ºç©ºï¼Œé€šè¿‡ Stream API æˆ‘ä»¬å¯ä»¥è¿™æ ·åˆ¤æ–­ï¼š</p><pre><code class="java">final List&lt;String&gt; list = Lists.newArrayList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, null, &quot;4&quot;);final boolean hasNullElement = list.stream()        .anyMatch(x -&gt; Objects.isNull(x));System.out.println(hasNullElement);</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>anyMath</code>æ–¹æ³•ä¸­åªè°ƒç”¨äº†<code>Objects.isNull</code>æ–¹æ³•ï¼Œè€Œä¸”æ–¹æ³•çš„å…¥å‚ç›´æ¥æ˜¯åˆ—è¡¨ä¸­çš„å…ƒç´ ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨é™æ€æ–¹æ³•å¼•ç”¨ï¼Œå°†ä»£ç æ”¹å†™ä¸€ä¸‹ï¼š</p><pre><code class="java">final boolean hasNullElementAlso = list.stream().anyMatch(Objects::isNull);</code></pre><p>è¿™æ ·çœ‹èµ·æ¥æ¸…çˆ½å¤šäº†ã€‚</p><h3 id="å®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#å®ä¾‹æ–¹æ³•å¼•ç”¨" class="headerlink" title="å®ä¾‹æ–¹æ³•å¼•ç”¨"></a>å®ä¾‹æ–¹æ³•å¼•ç”¨</h3><p>å®ä¾‹æ–¹æ³•å¼•ç”¨è¯­æ³•æ˜¯ï¼š<code>å®ä¾‹ï¼š: æ–¹æ³•å</code>ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåˆ—è¡¨ä¸­å…¨æ˜¯<code>LocalDate</code>ç±»å‹æ•°æ®ï¼Œç°åœ¨éœ€è¦å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p><pre><code class="java">final DateTimeFormatter fmt = DateTimeFormatter.ISO_LOCAL_DATE;final List&lt;LocalDate&gt; dates = Lists.newArrayList(        LocalDate.MIN,        LocalDate.now(),        LocalDate.MAX);final List&lt;String&gt; dateStrs = dates.stream()        .map(d -&gt; fmt.format(d))        .collect(Collectors.toList());</code></pre><p><code>map</code>æ–¹æ³•ä¸­é€šè¿‡<code>DateTimeFormatter</code>çš„å®ä¾‹å¯¹è±¡è°ƒç”¨äº†<code>format</code>æ–¹æ³•ï¼Œå…¥å‚ä¹Ÿæ˜¯ Lambda è¡¨è¾¾å¼ä¸­çš„å…ƒç´ ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨å®ä¾‹æ–¹æ³•å¼•ç”¨ï¼Œä»£ç å¯ä»¥æ”¹å†™ä¸ºï¼š</p><pre><code class="java">final List&lt;String&gt; dateStrList = dates.stream()        .map(fmt::format)        .collect(Collectors.toList());</code></pre><p>è¿™æ ·å†™èµ·æ¥é¡ºæ‰‹å¤šäº†ã€‚</p><h3 id="ç‰¹å®šç±»å‹çš„å®ä¾‹æ–¹æ³•å¼•ç”¨"><a href="#ç‰¹å®šç±»å‹çš„å®ä¾‹æ–¹æ³•å¼•ç”¨" class="headerlink" title="ç‰¹å®šç±»å‹çš„å®ä¾‹æ–¹æ³•å¼•ç”¨"></a>ç‰¹å®šç±»å‹çš„å®ä¾‹æ–¹æ³•å¼•ç”¨</h3><p>è¿™ç§æ–¹æ³•å¼•ç”¨æœ‰ä¸€ä¸ªå‰ææ¡ä»¶ï¼Œå°±æ˜¯å¿…é¡»æ˜¯ Lambda è¡¨è¾¾å¼å…ƒç´ ç±»å‹å¯¹åº”çš„æ–¹æ³•ã€‚è¯­æ³•æ˜¯ï¼š<code>ç‰¹å®šç±»å‹ï¼š: æ–¹æ³•å</code>ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…¨éƒ½ä¸ä¸º<code>null</code>çš„å­—ç¬¦ä¸²åˆ—è¡¨ä¸­ï¼Œç©ºå­—ç¬¦çš„æ•°é‡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code class="java">final List&lt;String&gt; nonNullList = Lists.newArrayList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;&quot;, &quot;4&quot;, &quot;&quot;);final long emptyCount = nonNullList.stream()        .filter(x -&gt; x.isEmpty())        .count();</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>filter</code>æ–¹æ³•ä¸­å¼•ç”¨çš„å‡½æ•°æ˜¯åˆ©ç”¨ Lambda è¡¨è¾¾å¼å…ƒç´ å¯¹è±¡çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°†ä»£ç æ”¹å†™ä¸ºï¼š</p><pre><code class="java">final long emptyElementCount = nonNullList.stream()        .filter(String::isEmpty)        .count();</code></pre><p>è¿™æ ·èƒ½å¤Ÿæ¸…æ™°çš„çœ‹å‡ºæ˜¯å“ªä¸ªç±»çš„æ–¹æ³•äº†ã€‚</p><h3 id="æ„é€ æ–¹æ³•å¼•ç”¨"><a href="#æ„é€ æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ„é€ æ–¹æ³•å¼•ç”¨"></a>æ„é€ æ–¹æ³•å¼•ç”¨</h3><p>æ„é€ æ–¹æ³•å¼•ç”¨çš„è¯­æ³•æ˜¯ï¼š<code>ç±»åï¼š:new</code>ã€‚åœ¨ Java ä¸­ï¼Œæ„é€ æ–¹æ³•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œæ‰€ä»¥æ„é€ æ–¹æ³•çš„å¼•ç”¨ä¸ä¸Šé¢å‡ ç§æ–¹æ³•ç±»ä¼¼ã€‚æ¯”å¦‚ï¼Œæƒ³è¦å°†å­—ç¬¦ä¸²åˆ—è¡¨ä¸­çš„å…ƒç´ å…¨éƒ¨è½¬æ¢ä¸º<code>Integer</code>æ ¼å¼ï¼š</p><pre><code class="java">final List&lt;String&gt; allIntList = Lists.newArrayList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;);final List&lt;Integer&gt; ints = allIntList.stream()        .map(x -&gt; new Integer(x))        .collect(Collectors.toList());</code></pre><p>æˆ‘ä»¬å¯ä»¥æ”¹å†™ä¸ºï¼š</p><pre><code class="java">final List&lt;Integer&gt; intList = allIntList.stream()        .map(Integer::new)        .collect(Collectors.toList());</code></pre><h2 id="Optional-ç¥å™¨"><a href="#Optional-ç¥å™¨" class="headerlink" title="Optional ç¥å™¨"></a>Optional ç¥å™¨</h2><p>ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆNullPointExceptionï¼ŒNPEï¼‰æ˜¯ç‰¹åˆ«ä½çº§ä½†åˆå¾ˆéš¾é¿å…çš„å¼‚å¸¸ï¼Œè¯´ä»–ä½çº§æ˜¯å› ä¸ºåªè¦çœ‹åˆ°è¿™ä¸ªå¼‚å¸¸ï¼Œå°±èƒ½å¤Ÿå¾ˆå®¹æ˜“çš„ä¿®å¤ï¼Œä½†æ˜¯æˆ‘ä»¬å¾ˆéš¾ç™¾åˆ†ä¹‹ç™¾çš„é¿å…è¿™ä¸ªå¼‚å¸¸çš„å­˜åœ¨ã€‚åœ¨ Java8 ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡ç±»ä¼¼<code>obj != null</code>è¿™ç§æ¨¡æ¿å¼æ–¹æ³•åˆ¤æ–­ã€‚åœ¨ Java8 æ–°å¢çš„ç¥å™¨<code>Optional</code>å¯ä»¥æ›´åŠ ä¼˜é›…çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="åˆ›å»º-Optional"><a href="#åˆ›å»º-Optional" class="headerlink" title="åˆ›å»º Optional"></a>åˆ›å»º Optional</h3><p><code>Optional</code>çš„æ„é€ æ–¹æ³•æ˜¯ä½¿ç”¨<code>private</code>ä¿®é¥°çš„ï¼Œå…¶æä¾›äº†ä¸‰ä¸ªé™æ€æ–¹æ³•ï¼Œç”¨äºåˆ›å»º<code>Optional</code>å®ä¾‹ï¼Œåˆ†åˆ«æ˜¯<code>empty</code>ã€<code>of</code>ã€<code>ofNullable</code>ï¼Œåˆ›å»ºä¹‹åï¼Œ<code>Optional</code>æ˜¯ä¸å¯å˜çš„ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>empty</code>å®šä¹‰ä¸€ä¸ªå…·æœ‰ç©ºå€¼çš„<code>Optional</code>å¯¹è±¡ï¼š</p><pre><code class="java">final Optional&lt;String&gt; optional = Optional.empty();</code></pre><p>ä½¿ç”¨<code>of</code>å®šä¹‰ä¸€ä¸ªä¸ä¸ºç©ºçš„å¯¹è±¡ï¼š</p><pre><code class="java">final String str = &quot;value&quot;;final Optional&lt;String&gt; optional = Optional.of(str);</code></pre><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œ<code>of</code>æ–¹æ³•èµ‹å€¼æ—¶ï¼Œä½¿ç”¨<code>Objects.requireNonNull</code>éªŒè¯å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºå°±ä¼šæŠ›å‡º<code>NullPointerException</code>å¼‚å¸¸ã€‚</p><p>å¦‚æœä¸å¤ªç¡®å®šæ˜¯å¦ä¸ºç©ºï¼Œå¯ä»¥ä½¿ç”¨<code>ofNullable</code>åˆ›å»ºå¯¹è±¡ï¼š</p><pre><code class="java">final String str = getSomeStr();final Optional&lt;String&gt; optional = Optional.ofNullable(str);</code></pre><h3 id="ä½¿ç”¨-Optional"><a href="#ä½¿ç”¨-Optional" class="headerlink" title="ä½¿ç”¨ Optional"></a>ä½¿ç”¨ Optional</h3><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨<code>List&lt;String&gt;</code>ï¼Œå½“ç»“æœæ˜¯<code>null</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿”å›è¿”å›<code>new ArrayList&lt;&gt;()</code>ã€‚å¦‚æœæ˜¯åœ¨ Java8 ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—è¿™æ ·å†™ï¼š</p><pre><code class="java">List&lt;String&gt; list = getList();List&lt;String&gt; listOpt = list != null ? list : new ArrayList&lt;&gt;();</code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>Optional</code>çš„èƒ½åŠ›ï¼š</p><pre><code class="java">List&lt;String&gt; listOpt = Optional.ofNullable(getList())        .orElse(new ArrayList&lt;&gt;());</code></pre><p>å°è¯•ç‰›åˆ€ï¼Œè¿˜ä¸é”™ï¼Œä¸‹é¢æ”¾å¤§æ‹›ã€‚</p><p><img src="https://static.howardliu.cn/20211124232900.jpeg" alt="å‰æ–¹é«˜èƒ½ï¼Œè¯·æ³¨æ„"></p><p>å‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª<code>User</code>ç±»ï¼Œå†…éƒ¨æœ‰ä¸ª<code>Address</code>ç±»ï¼Œåœ¨å†…éƒ¨æœ‰ä¸ª<code>street</code>å±æ€§ï¼Œæˆ‘ä»¬ç°åœ¨æƒ³è¦è·å–ä¸€ä¸ª<code>User</code>å¯¹è±¡çš„<code>street</code>å€¼ã€‚å¦‚æœæ˜¯ä»¥å‰ï¼Œæˆ‘ä»¬éœ€è¦å„ç§åˆ¤æ–­æ˜¯å¦æ˜¯<code>null</code>ï¼Œä»£ç ä¼šå†™æˆè¿™æ ·ï¼š</p><pre><code class="java">User user = getUser();if (user != null) {    Address address = user.getAddress();    if (address != null) {        String street = address.getStreet();        if (street != null) {            return street;        }    }}return &quot;not specified&quot;;</code></pre><p>æ˜¯ä¸æ˜¯ä¼¼æ›¾ç›¸è¯†ï¼Œæˆ–è€…ä»¥å‰äº²æ‰‹å†™è¿‡ã€‚ç°åœ¨æœ‰äº†<code>Optional</code>ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦è¿™ä¹ˆéº»çƒ¦äº†ï¼š</p><pre><code class="java">String result = Optional.ofNullable(getUser())        .map(User::getAddress)        .map(Address::getStreet)        .orElse(&quot;not specified&quot;);</code></pre><p>æ˜¯ä¸æ˜¯ç›¸å½“çš„ä¼˜é›…ï¼Œ<code>map</code>æ–¹æ³•è¿”å›çš„ä¹Ÿæ˜¯<code>Optional</code>å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ— é™å¤„ç†ä¸‹å»ã€‚</p><p>å¦‚æœ<code>User</code>ç±»ä¸­çš„<code>getAddress</code>æ–¹æ³•è¿”å›çš„æœ¬èº«å°±æ˜¯<code>Optional</code>å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>flatMap</code>æ›¿æ¢<code>map</code>ã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æˆ‘ä»¬éœ€è¦æ•æ‰ NPE çš„æƒ…å†µï¼Œä½†æ˜¯éœ€è¦åŒ…è£…ä¸ºå…¶ä»–è‡ªå®šä¹‰å¼‚å¸¸ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<code>orElseThrow</code>æ–¹æ³•ï¼š</p><pre><code class="java">String value = null;Optional&lt;String&gt; valueOpt = Optional.ofNullable(value);String result = valueOpt.orElseThrow(CustomException::new).toUpperCase();</code></pre><p>è¿™é‡Œåªæ˜¯ç®€å•ç»™å‡ºå‡ ä¸ªä¾‹å­ï¼Œæ›´å¤šåŠŸèƒ½å¯ä»¥å‚è§ <a href="https://mp.weixin.qq.com/s/JOLrw7cbVh8z2czePEfLjw" target="_blank" rel="noopener">ã€Šä¸€æ–‡æŒæ¡ Java8 çš„ Optional çš„ 6 ç§æ“ä½œã€‹</a>ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ç»™å‡ºäº† Java8 ä¸­å‡ ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ç‰¹æ€§ï¼Œå®Œæ•´çš„ç‰¹æ€§æ¸…å•å¯ä»¥ä»<a href="https://openjdk.java.net/projects/Java8/features" target="_blank" rel="noopener">https://openjdk.java.net/projects/Java8/features</a>æŸ¥çœ‹ã€‚</p><p>æœ¬æ–‡æ‰€æœ‰ä»£ç éƒ½å¯ä»¥é€šè¿‡åœ¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤â€œjavaâ€è·å–ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/7f5dcjjKLdBYpzS5p7_v7Q" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 Stream ä¸­ Collectors çš„ 24 ä¸ªæ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/JOLrw7cbVh8z2czePEfLjw" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 çš„ Optional çš„ 6 ç§æ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/Vhw-2lgCvmhNI5aeXOWYNg" target="_blank" rel="noopener">ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½</a></li><li><a href="https://mp.weixin.qq.com/s/Srv6733byTYDg7hTrW_tdw" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ1ï¼‰ï¼šä»‹ç» Java8 ä¸­çš„æ—¶é—´ç±»åŠå¸¸ç”¨ API</a></li><li><a href="https://mp.weixin.qq.com/s/LRydpL89GsjOeTrLrihyYQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ2ï¼‰ï¼šDate ä¸ LocalDate æˆ– LocalDateTime äº’ç›¸è½¬æ¢</a></li><li><a href="https://mp.weixin.qq.com/s/KmBMLG1y73IUwFuSfUKaEQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ3ï¼‰ï¼šå¼€å§‹ä½¿ç”¨ Java8 ä¸­çš„æ—¶é—´ç±»</a></li><li><a href="https://mp.weixin.qq.com/s/PxC0WQMReIeG0Tyl5WiK1Q" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ4ï¼‰ï¼šæ£€æŸ¥æ—¥æœŸå­—ç¬¦ä¸²æ˜¯å¦åˆæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/rjMOq0QAdiWNacKYqHJqXA" target="_blank" rel="noopener">Java8 çš„æ–°ç‰¹æ€§</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/java-8-features/">Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava8 çš„æ–°ç‰¹æ€§</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/121529334" target="_blank" rel="noopener">Java æ¯åŠå¹´å°±ä¼šæ›´æ–°ä¸€æ¬¡æ–°ç‰¹æ€§ï¼Œå†ä¸æŒæ¡å°±è¦è½ä¼äº†ï¼šJava8 çš„æ–°ç‰¹æ€§</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      Java8 ä» 2014 å¹´é—®ä¸–ï¼Œåˆ°ç°åœ¨å·²æ˜¯æ•°ä¸ªå¹´å¤´ã€‚è¿™ä¸ªç‰ˆæœ¬æ–°å¢äº† Stream APIã€Lambda è¡¨è¾¾å¼ã€æ–°æ—¶é—´ API ç­‰å„ç§æ–°ç‰¹æ€§ï¼Œç›¸æ¯”å¾ˆå¤šæ–°å…´è¯­è¨€ä¹Ÿä¸é‘å¤šè®©ã€‚ä»Šå¤©å°±æ¥èŠèŠ Java8 ä¸­å¥½ç©å¥½ä½¿çš„ç‰¹æ€§åŠŸèƒ½
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Java" scheme="https://www.howardliu.cn/tags/Java/"/>
    
      <category term="Java8" scheme="https://www.howardliu.cn/tags/Java8/"/>
    
      <category term="optional" scheme="https://www.howardliu.cn/tags/optional/"/>
    
  </entry>
  
  <entry>
    <title>äººäººéƒ½ä¼šè®¾è®¡æ¨¡å¼ï¼šç­–ç•¥æ¨¡å¼</title>
    <link href="https://www.howardliu.cn/strategy-pattern/"/>
    <id>https://www.howardliu.cn/strategy-pattern/</id>
    <published>2021-11-15T15:05:51.000Z</published>
    <updated>2021-11-15T15:05:51.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/autumn-6752841_1920.jpg" alt="äººäººéƒ½ä¼šè®¾è®¡æ¨¡å¼ï¼šç­–ç•¥æ¨¡å¼"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/daschorsch-1537217/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6752841" target="_blank" rel="noopener">daschorsch</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6752841" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><blockquote><p>æœ¬æ–‡æ”¶å½•åœ¨<a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1750195552933199874&scene=126&devicetype=iOS15.0.2&version=18000f2a&lang=zh_CN&nettype=WIFI&ascene=59&session_us=gh_9bcfdc303e2f&fontScale=100&wx_header=1" target="_blank" rel="noopener">ã€Šä¸€ä¸ªæ¶æ„å¸ˆçš„èŒä¸šç´ å…»ã€‹</a>ä¸“æ ï¼Œæ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æã€‚</p></blockquote><a id="more"></a><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>ç­–ç•¥æ¨¡å¼ï¼Œè‹±æ–‡å…¨ç§°æ˜¯ Strategy Design Patternã€‚åœ¨ GoF çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­ï¼Œå®ƒæ˜¯è¿™æ ·å®šä¹‰çš„ï¼š</p><blockquote><p>Define a family of algorithms, encapsulate each one, and make them interchangeable. Strategy lets the algorithm vary independently from clients that use it.</p></blockquote><p>ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ï¼šå®šä¹‰ä¸€æ—ç®—æ³•ç±»ï¼Œå°†æ¯ä¸ªç®—æ³•åˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼å¯ä»¥ä½¿ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„å®¢æˆ·ç«¯ã€‚</p><p>è¿™é‡Œæ‰€è¯´çš„å®¢æˆ·ç«¯ä»£æŒ‡ä½¿ç”¨ç®—æ³•çš„ä»£ç ã€‚</p><p>æ ¹æ®ä½¿ç”¨åœºæ™¯åˆ†ç±»ï¼Œç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºå‹æ¨¡å¼ï¼Œç”¨äºè¿è¡Œæ—¶æ§åˆ¶ç±»çš„è¡Œä¸ºæˆ–ç®—æ³•ã€‚</p><p>ä½¿ç”¨ä¸Šçš„ç›´è§‚æ„Ÿå—æ˜¯ï¼Œç­–ç•¥æ¨¡å¼å¯ä»¥å‡å°‘äº† if-else/switch åˆ†æ”¯ä»£ç ã€‚é‚£å‡å°‘åˆ†æ”¯ä»£ç æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ</p><ol><li>è§£è€¦ä»£ç ï¼Œç­–ç•¥æ¨¡å¼å°±æ˜¯è§£è€¦ä¸åŒç®—æ³•å®ç°ï¼›</li><li>å‡å°‘ bug äº§ç”Ÿæ¦‚ç‡ï¼Œå‡å°‘åˆ†æ”¯ï¼Œå°±æ˜¯å‡å°‘ bug å‘ç”Ÿæ¦‚ç‡ã€‚</li></ol><p>æœ‰ç¼–ç¨‹ç»éªŒçš„éƒ½çŸ¥é“ï¼Œå¾ˆå¤š bug éƒ½æ˜¯ä»åˆ†æ”¯é€»è¾‘äº§ç”Ÿçš„ã€‚æˆ‘åˆšå¼€å§‹å·¥ä½œæ—¶æ™šä¸Š 12 ç‚¹å¼€å§‹æŠ“è™«ï¼Œä¸€ç›´æŠ“åˆ°å‡Œæ™¨ 2 ç‚¹å¤šï¼Œæœ€åå‘ç°æ˜¯æœ‰ä¸€ä¸ª if-else åˆ†æ”¯ä¸­ï¼Œåœ¨æŸä¸ª if å‰é¢å°‘å†™äº†ä¸€ä¸ª elseã€‚ä¸‹é¢æ˜¯ç¤ºä¾‹ï¼Œå®é™…ä»£ç æ¯”è¿™ä¸ªå¤æ‚å¾ˆå¤šï¼š</p><pre><code class="java">if (a &lt; 1) {} else if (a &lt; 2) {} else if (a &lt; 3) {}</code></pre><p>ç»“æœå†™æˆäº†ï¼š</p><pre><code class="java">if (a &lt; 1) {} else if (a &lt; 2) {} if (a &lt; 3) {}</code></pre><p>ä»£ç ç¼–è¯‘ä¸ä¼šé”™ï¼Œä½†æ˜¯åœ¨æ‰§è¡Œæ—¶ï¼ŒæŸäº› case ä¼šä¸ç¬¦åˆé¢„æœŸã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æˆ‘ä»¬æ¥çœ‹çœ‹ç­–ç•¥æ¨¡å¼å‡ºç°çš„åœºæ™¯ã€‚</p><p>ä»¥ç”µå•†ç³»ç»Ÿçš„æ”¯ä»˜åŠŸèƒ½ä¸ºä¾‹ï¼Œæœ€æ—©çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¸ºäº†æ›´å¿«ä¸Šçº¿ï¼Œé€‰æ‹©ä¸€ä¸ªè¾ƒå¤šäººä½¿ç”¨çš„æ”¯ä»˜æ–¹å¼ï¼Œæ¯”å¦‚å¾®ä¿¡æ”¯ä»˜ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯æ”¯ä»˜å®æ”¯ä»˜ï¼Œæ ¹æ®å”®å–åœºæ™¯ä¸åŒåŒºåˆ†ï¼‰ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­ç”¨æˆ·æ˜¯ä» PC é¡µé¢è¿›å…¥è¿˜æ˜¯ H5 è¿›å…¥å³å¯ã€‚</p><p>åæ¥ï¼Œä¸šåŠ¡å‘å±•æ¯”è¾ƒå¥½ï¼Œæ¶‰åŠäººç¾¤æ›´å¤šäº†ï¼Œäºæ˜¯éœ€è¦å¯¹æ¥æ”¯ä»˜å®æ”¯ä»˜ã€‚æ”¯ä»˜å®æ”¯ä»˜ä¹Ÿåˆ†ä¸ºäº†å¤šç§çš„æ”¯ä»˜åœºæ™¯ï¼Œå¯¹æ¥æ¥å£å˜å¤šäº†ï¼Œä½†æ˜¯ä¹Ÿåœ¨å¯æ§èŒƒå›´å†…ã€‚</p><p>å†åæ¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¥é“¶è”æ”¯ä»˜ã€å¯¹æ¥å„é“¶è¡Œæ¥å£ï¼Œç­‰ç­‰ï¼Œæ”¯ä»˜æ¥å£å˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿ã€‚äºæ˜¯ï¼Œæ¯å¯¹æ¥ä¸€ç§æ”¯ä»˜æ–¹å¼ï¼Œæ”¯ä»˜ç›¸å…³æ¥å£å°±ä¼šå¢åŠ ä¸€å€ã€‚æ­¤æ—¶ï¼Œè¿™å¨è‡ƒè‚¿çš„ä»£ç ï¼Œæ— è®ºæ˜¯ä¿®å¤ç®€å•çš„ bugï¼Œè¿˜æ˜¯å¾®è°ƒä¼ è¾“å‚æ•°ï¼Œéƒ½ä¼šå½±å“æ•´ä¸ªæ”¯ä»˜é€»è¾‘ï¼Œä»è€Œå¢åŠ äº†åœ¨å·²æœ‰æ­£å¸¸è¿è¡Œä»£ç ä¸­å¼•å…¥é”™è¯¯çš„é£é™©ã€‚</p><p><img src="https://static.howardliu.cn/20211116075137.jpeg" alt="è¶Šæ¥è¶Šè‡ƒè‚¿çš„ç³»ç»Ÿ"></p><p>å¦‚æœæ˜¯å¤šäººåä½œå¼€å‘ï¼Œæˆ‘ä»¬è¿˜ä¼šé™·å…¥ä»£ç åˆå¹¶æ—¶åº”ä»˜å„ç§å†²çªçš„æƒ…å†µã€‚ç»ˆäºï¼Œåœ¨æŸä¸€æ—¶åˆ»ï¼Œæˆ‘ä»¬çœ‹ç€è¿™ä¸€å¨ä»£ç ï¼Œå·²ç»æ— ä»ä¸‹æ‰‹ç»´æŠ¤äº†ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸Šé¢çš„åœºæ™¯ï¼Œä¸å˜çš„æ˜¯ç³»ç»Ÿå†…éƒ¨çš„æ”¯ä»˜ä¸šåŠ¡é€»è¾‘ï¼Œå˜åŒ–çš„æ˜¯æ”¯ä»˜æ–¹å¼ã€‚</p><p>æ”¯ä»˜æ–¹å¼çš„å¯å˜æ€§åœ¨äºï¼Œå¯èƒ½ä¼šä¸å¤šç§æ”¯ä»˜æ–¹å¼å¯¹æ¥ï¼Œå¯¹æ¥å‚æ•°ã€åè®®ã€åœ°å€ç­‰éƒ½ä¼šä¸åŒã€‚æ ¹æ®è®¾è®¡æ¨¡å¼çš„æ•´ä½“æ€æƒ³ï¼Œæˆ‘ä»¬å°†å˜åŒ–çš„å•ç‹¬å‡ºå»ï¼Œå°†ä¸å˜çš„ç¨³å®šä¸‹æ¥ã€‚</p><p>è¿™ç§å¤„ç†æ–¹å¼å°±æ˜¯ç­–ç•¥æ¨¡å¼å»ºè®®çš„ï¼šæ‰¾å‡ºè´Ÿè´£ç”¨è®¸å¤šä¸åŒæ–¹å¼å®Œæˆç‰¹å®šä»»åŠ¡çš„ç±»ï¼Œç„¶åå°†å…¶ä¸­çš„ç®—æ³•æŠ½å–åˆ°ä¸€æ—è¢«ç§°ä¸ºç­–ç•¥çš„ç‹¬ç«‹ç±»ä¸­ã€‚</p><p>è°ƒç”¨è¿™äº›ç­–ç•¥ç±»çš„æ˜¯è°ƒç”¨ä¸Šä¸‹æ–‡ï¼Œå®ƒæŒæœ‰å¯¹æ‰€æœ‰ç­–ç•¥ç±»çš„å¼•ç”¨ã€‚ä¸Šä¸‹æ–‡ä¸æ‰§è¡Œä»»åŠ¡ï¼Œå®ƒæ˜¯ä»»åŠ¡çš„æŒ‡æŒ¥è€…ï¼Œå°†å·¥ä½œå§”æ´¾ç»™å·²è¿æ¥çš„ç­–ç•¥å¯¹è±¡ã€‚å…³ç³»å¦‚ä¸‹ï¼š</p><p><img src="https://static.howardliu.cn/20211116075124.png" alt="ç­–ç•¥æ¨¡å¼ç±»å›¾"></p><p>å¾ˆå¤šæ•™ç¨‹åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¦‚æœä½ èƒ½å¤Ÿçœ‹åˆ°è¿™é‡Œï¼Œè€Œä¸”è¿˜ç”¨å¿ƒçœ‹äº†ï¼Œä½ å°±ä¼šå‘ç°ä¸€ä¸ä¸çš„ä¸ä¸€æ ·ã€‚</p><p>æ ¹æ®è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLODï¼ŒLaw of Demeterï¼‰ï¼Œä¸Šä¸‹æ–‡ä¸éœ€è¦çŸ¥é“å…·ä½“ç­–ç•¥ç±»çš„åŠŸèƒ½ï¼Œåªéœ€è¦é€šè¿‡ç‰¹å®šçš„æ¥å£ï¼Œç”¨äºè§¦å‘é€‰ä¸­ç­–ç•¥å³å¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®Œæ•´çš„ç­–ç•¥æ¨¡å¼ï¼Œåº”è¯¥æœ‰å…·ä½“çš„ç­–ç•¥åˆ¤æ–­æ˜¯å¦ç”±è¯¥ç­–ç•¥æ‰§è¡Œï¼Œä¸Šä¸‹æ–‡åªéœ€è¦çŸ¥é“æœ‰å“ªäº›ç­–ç•¥å°±è¡Œäº†ã€‚è¿™æ ·æ”¹åŠ¨ä¹‹åï¼Œä¸Šä¸‹æ–‡è¿˜èƒ½å¤Ÿä¸å·¥å‚æ¨¡å¼ç»“åˆã€‚å¦‚æœç­–ç•¥æ˜¯æ— çŠ¶æ€ç­–ç•¥ï¼Œè¿˜å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ä¸­å¼•å…¥å•ä¾‹æ¨¡å¼ã€‚</p><h2 id="é€‚ç”¨ä¸ä¸é€‚ç”¨"><a href="#é€‚ç”¨ä¸ä¸é€‚ç”¨" class="headerlink" title="é€‚ç”¨ä¸ä¸é€‚ç”¨"></a>é€‚ç”¨ä¸ä¸é€‚ç”¨</h2><p>æ ¹æ®ä¸Šé¢çš„å®šä¹‰ï¼Œç­–ç•¥æ¨¡å¼æ˜¯å›´ç»•å¯ä»¥äº’æ¢çš„ç®—æ³•æ¥åˆ›å»ºä¸šåŠ¡çš„ã€‚ç®€å•çš„è¯´å°±æ˜¯ï¼Œåˆ†æ”¯é€»è¾‘éš”ç¦»ã€‚</p><ol><li>å½“ä½ æƒ³ä½¿ç”¨å„ç§ä¸åŒç®—æ³•å˜ä½“ï¼Œä¸”èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶åˆ‡æ¢ç®—æ³•ã€‚ç­–ç•¥æ¨¡å¼å¯ä»¥å°†å¯¹è±¡å…³è”åˆ°ä¸åŒå®ç°æ–¹å¼çš„ä¸åŒå­ä»»åŠ¡ä¸­ï¼Œå¯ä»¥é—´æ¥çš„ä¿®æ”¹å¯¹è±¡ï¼›</li><li>åªæœ‰åœ¨æ‰§è¡Œæ—¶æœ‰äº›è®¸ä¸åŒçš„ç›¸ä¼¼ç®—æ³•ã€‚å¯ä»¥å°†ä¸åŒçš„è¡Œä¸ºæŠ½è±¡åˆ°ç‹¬ç«‹çš„ç±»ä¸­ï¼Œåœ¨åŸæ¥çš„ç±»ä¸­è°ƒç”¨è¿™äº›ç‹¬ç«‹çš„ç®—æ³•ï¼›</li><li>ç®—æ³•åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ä¸æ˜¯ç‰¹åˆ«é‡è¦ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç­–ç•¥æ¨¡å¼å°†ç®—æ³•ã€æ•°æ®ã€ä¾èµ–ç­‰æŠ½ç¦»å‡ºæ¥ï¼Œåœ¨è¿è¡Œæ—¶è°ƒç”¨å³å¯ã€‚</li></ol><p>è®¾è®¡æ¨¡å¼åªæ˜¯è§£å†³é—®é¢˜çš„ä¼˜é›…å®ç°ï¼Œå¹¶ä¸ä¸€å®šé€‚ç”¨æ‰€æœ‰æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢è¿™å‡ ç§ï¼Œå°±å¯ä»¥ä¸ç”¨éå¾—å®ç°ç­–ç•¥æ¨¡å¼ï¼š</p><ol><li>å¦‚æœç®—æ³•æå°‘å˜åŒ–ï¼Œå°±æ²¡æœ‰ä»»ä½•ç†ç”±å¼•å…¥æ–°çš„ç±»å’Œæ¥å£ã€‚</li><li>å¦‚æœä½¿ç”¨äº† Java8 ä¹‹åçš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹ï¼Œæœ‰æ—¶å€™å°±ä½¿ç”¨ Lambda è¡¨è¾¾å¼æˆ–è€…åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼å®ç°å…·ä½“ç®—æ³•å³å¯ã€‚</li></ol><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><p>è¿˜æ˜¯ä»¥æ”¯ä»˜ä¸ºä¾‹ï¼Œå› ä¸ºéƒ½æ˜¯æ¼”ç¤ºï¼Œä¸€åˆ‡ä»ç®€ã€‚æˆ‘æ›¾ç»ä¸»å¯¼è¿‡æ”¯ä»˜ä¸­å°ï¼Œå¦‚æœæƒ³è¦å…·ä½“å®ç°ï¼Œå¯ä»¥å…·ä½“èŠä¸€ä¸‹ã€‚</p><p>é¦–å…ˆå®šä¹‰æ”¯ä»˜ç­–ç•¥æ¥å£ï¼š</p><pre><code class="java">public interface PayStrategy {    String payType();    void callPay(BigDecimal amount);}</code></pre><p><code>payType()</code>æ˜¯åœ¨å…·ä½“çš„ç­–ç•¥å®ç°ä¸­å®šä¹‰ç­–ç•¥å¯æ‰§è¡Œçš„æ”¯ä»˜æ–¹å¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¼ å‚æ•°çš„æ–¹å¼è¿”å›<code>boolean</code>ç±»å‹ç”¨äºåˆ¤æ–­æ˜¯å¦å¯æ‰§è¡Œã€‚</p><p>ç„¶åæ˜¯å¾®ä¿¡æ”¯ä»˜å’Œæ”¯ä»˜å®æ”¯ä»˜åˆ†åˆ«å®ç°æ”¯ä»˜ç­–ç•¥æ¥å£ï¼š</p><pre><code class="java">public class WxpayPayStrategy implements PayStrategy {    @Override    public String payType() {        return &quot;WXPAY&quot;;    }    @Override    public void callPay(BigDecimal amount) {        // å¾®ä¿¡æ”¯ä»˜æ¥å£        // è¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œå³ä½¿éƒ½æ˜¯å¾®ä¿¡æ”¯ä»˜ï¼Œä¹Ÿä¼šåˆ†ä¸åŒçš„æ¥å£        System.out.println(&quot;è°ƒç”¨å¾®ä¿¡æ”¯ä»˜æ¥å£&quot;);    }}public class AlipayPayStrategy implements PayStrategy {    @Override    public String payType() {        return &quot;ALIPAY&quot;;    }    @Override    public void callPay(BigDecimal amount) {        // è°ƒç”¨æ”¯ä»˜å®æ”¯ä»˜æ¥å£        // è¿™é‡Œåªæ˜¯æ¼”ç¤ºï¼Œå³ä½¿éƒ½æ˜¯æ”¯ä»˜å®æ”¯ä»˜ï¼Œä¹Ÿä¼šåˆ†ä¸åŒçš„æ¥å£        System.out.println(&quot;è°ƒç”¨æ”¯ä»˜å®æ”¯ä»˜æ¥å£&quot;);    }}</code></pre><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹æŒæœ‰ç­–ç•¥ç®—æ³•çš„ä¸Šä¸‹æ–‡ï¼š</p><pre><code class="java">public class StrategyContext {    private static final Map&lt;String, PayStrategy&gt; PAY_STRATEGY_MAP = new HashMap&lt;&gt;();    static {        final AlipayPayStrategy alipayPayStrategy = new AlipayPayStrategy();        final WxpayPayStrategy wxpayPayStrategy = new WxpayPayStrategy();        PAY_STRATEGY_MAP.put(alipayPayStrategy.payType(), alipayPayStrategy);        PAY_STRATEGY_MAP.put(wxpayPayStrategy.payType(), wxpayPayStrategy);    }    public void pay(String payType, BigDecimal amount) {        final PayStrategy payStrategy = PAY_STRATEGY_MAP.get(payType);        payStrategy.callPay(amount);    }}</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šä¸‹æ–‡åªéœ€è¦çŸ¥é“ç­–ç•¥ç®—æ³•çš„å­˜åœ¨ï¼Œè‡³äºç®—æ³•æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œç”±ç®—æ³•è‡ªå·±åˆ¤æ–­ã€‚</p><p>è°ƒç”¨å°±æ¯”è¾ƒç®€å•äº†ï¼š</p><pre><code class="java">public class Main {    public static void main(String[] args) {        final StrategyContext strategyContext = new StrategyContext();        strategyContext.pay(&quot;ALIPAY&quot;, BigDecimal.TEN);        strategyContext.pay(&quot;WXPAY&quot;, BigDecimal.ONE);    }}</code></pre><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>ç­–ç•¥æ¨¡å¼å¯èƒ½ç”¨æ¥å‡å°‘åˆ†æ”¯é€»è¾‘ï¼Œå°†ä¸åŒçš„ç®—æ³•åˆ†ç¦»å¼€æ¥ã€‚å¦‚æœé…åˆå·¥å‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ï¼Œå¯ä»¥æ›´åŠ çµæ´»çš„ä½¿ç”¨ã€‚å¦‚æœæ˜¯åœ¨ Spring å½“ä¸­ï¼Œå€ŸåŠ©è‡ªåŠ¨æ³¨å…¥ï¼Œä¸Šä¸‹æ–‡ç”šè‡³å¯ä»¥ä¸çŸ¥é“å…·ä½“ç­–ç•¥å®ç°ã€‚</p><p>æœ€è¿‘åˆšçœ‹åˆ°ä¸€å¥è¯ï¼Œâ€œæ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æâ€ã€‚åšæŒä¸‹å»ï¼Œæ¯å¤©å­¦ç‚¹æ–°ä¸œè¥¿ï¼Œç»™ç”Ÿæ´»åŠ ç‚¹è‰²å½©ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/Bpblou6RkZua4jE4gaZylA" target="_blank" rel="noopener">Java ä¸­çš„å•ä¾‹æ¨¡å¼ï¼ˆå®Œæ•´ç¯‡ï¼‰</a></li><li><a href="https://mp.weixin.qq.com/s/ynajBpu0xJYGzcgqaIDjMg" target="_blank" rel="noopener">è®¾è®¡æ¨¡å¼ï¼šå»ºé€ è€…æ¨¡å¼</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/strategy-pattern/">äººäººéƒ½ä¼šè®¾è®¡æ¨¡å¼ï¼šç­–ç•¥æ¨¡å¼</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/121347845" target="_blank" rel="noopener">äººäººéƒ½ä¼šè®¾è®¡æ¨¡å¼ï¼šç­–ç•¥æ¨¡å¼</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      å®šä¹‰ä¸€æ—ç®—æ³•ç±»ï¼Œå°†æ¯ä¸ªç®—æ³•åˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼å¯ä»¥ä½¿ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„å®¢æˆ·ç«¯ã€‚
    
    </summary>
    
    
      <category term="design pattern" scheme="https://www.howardliu.cn/categories/design-pattern/"/>
    
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="https://www.howardliu.cn/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>Java è¿›é˜¶ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½</title>
    <link href="https://www.howardliu.cn/java-lambda-powerful-comparation/"/>
    <id>https://www.howardliu.cn/java-lambda-powerful-comparation/</id>
    <published>2021-11-07T12:32:59.000Z</published>
    <updated>2021-11-07T12:32:59.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/cairn-g9fca0fd5f_1920.jpg" alt="Java è¿›é˜¶ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/mike_68-10359383/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6754295" target="_blank" rel="noopener">Michael Kleinsasser</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6754295" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><blockquote><p>æœ¬æ–‡è¢«<a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378&scene=126&devicetype=iOS15.0.2&version=18000f2a&lang=zh_CN&nettype=WIFI&ascene=59&session_us=gh_9bcfdc303e2f&fontScale=100&wx_header=1" target="_blank" rel="noopener">ã€ŠJava è¿›é˜¶ã€‹</a>ä¸“æ æ”¶å½•ï¼Œåœ¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œjavaâ€å¯è·å–æºç ã€‚</p></blockquote><p>æˆ‘ä»¬åœ¨ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®æ’åºæ˜¯å¾ˆå¸¸è§çš„åœºæ™¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹å¼ï¼š</p><a id="more"></a><ol><li>å€ŸåŠ©å­˜å‚¨ç³»ç»Ÿï¼ˆSQLã€NoSQLã€NewSQL éƒ½æ”¯æŒï¼‰çš„æ’åºåŠŸèƒ½ï¼ŒæŸ¥è¯¢çš„ç»“æœå³æ˜¯æ’å¥½åºçš„ç»“æœ</li><li>æŸ¥è¯¢ç»“æœä¸ºæ— åºæ•°æ®ï¼Œåœ¨å†…å­˜ä¸­æ’åºã€‚</li></ol><p>ä»Šå¤©è¦è¯´çš„æ˜¯ç¬¬äºŒç§æ’åºæ–¹å¼ï¼Œåœ¨å†…å­˜ä¸­å®ç°æ•°æ®æ’åºã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŸºç¡€ç±»ï¼Œåé¢æˆ‘ä»¬å°†æ ¹æ®è¿™ä¸ªåŸºç¡€ç±»æ¼”ç¤ºå¦‚ä½•åœ¨å†…å­˜ä¸­æ’åºã€‚</p><pre><code class="java">@Data@NoArgsConstructor@AllArgsConstructorpublic class Student {    private String name;    private int age;    @Override    public boolean equals(Object o) {        if (this == o) {            return true;        }        if (o == null || getClass() != o.getClass()) {            return false;        }        Student student = (Student) o;        return age == student.age &amp;&amp; Objects.equals(name, student.name);    }    @Override    public int hashCode() {        return Objects.hash(name, age);    }}</code></pre><h2 id="åŸºäºComparatoræ’åº"><a href="#åŸºäºComparatoræ’åº" class="headerlink" title="åŸºäºComparatoræ’åº"></a>åŸºäº<code>Comparator</code>æ’åº</h2><p>åœ¨ Java8 ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡å®ç°<code>Comparator</code>æ¥å£å®Œæˆæ’åºï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">new Comparator&lt;Student&gt;() {    @Override    public int compare(Student h1, Student h2) {        return h1.getName().compareTo(h2.getName());    }};</code></pre><p>è¿™é‡Œå±•ç¤ºçš„æ˜¯åŒ¿åå†…éƒ¨ç±»çš„å®šä¹‰ï¼Œå¦‚æœæ˜¯é€šç”¨çš„å¯¹æ¯”é€»è¾‘ï¼Œå¯ä»¥ç›´æ¥å®šä¹‰ä¸€ä¸ªå®ç°ç±»ã€‚ä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¦‚ä¸‹å°±æ˜¯åº”ç”¨ï¼š</p><pre><code class="java">@Testvoid baseSortedOrigin() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    Collections.sort(students, new Comparator&lt;Student&gt;() {        @Override        public int compare(Student h1, Student h2) {            return h1.getName().compareTo(h2.getName());        }    });    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><blockquote><p>è¿™é‡Œä½¿ç”¨äº† Junit5 å®ç°å•å…ƒæµ‹è¯•ï¼Œç”¨æ¥éªŒè¯é€»è¾‘éå¸¸é€‚åˆã€‚</p></blockquote><p>å› ä¸ºå®šä¹‰çš„<code>Comparator</code>æ˜¯ä½¿ç”¨<code>name</code>å­—æ®µæ’åºï¼Œåœ¨ Java ä¸­ï¼Œ<code>String</code>ç±»å‹çš„æ’åºæ˜¯é€šè¿‡å•å­—ç¬¦çš„ ASCII ç é¡ºåºåˆ¤æ–­çš„ï¼Œ<code>J</code>æ’åœ¨<code>T</code>çš„å‰é¢ï¼Œæ‰€ä»¥<code>Jerry</code>æ’åœ¨ç¬¬ä¸€ä¸ªã€‚</p><h2 id="ä½¿ç”¨-Lambda-è¡¨è¾¾å¼æ›¿æ¢ComparatoråŒ¿åå†…éƒ¨ç±»"><a href="#ä½¿ç”¨-Lambda-è¡¨è¾¾å¼æ›¿æ¢ComparatoråŒ¿åå†…éƒ¨ç±»" class="headerlink" title="ä½¿ç”¨ Lambda è¡¨è¾¾å¼æ›¿æ¢ComparatoråŒ¿åå†…éƒ¨ç±»"></a>ä½¿ç”¨ Lambda è¡¨è¾¾å¼æ›¿æ¢<code>Comparator</code>åŒ¿åå†…éƒ¨ç±»</h2><p>ä½¿ç”¨è¿‡ Java8 çš„ Lamdba çš„åº”è¯¥çŸ¥é“ï¼ŒåŒ¿åå†…éƒ¨ç±»å¯ä»¥ç®€åŒ–ä¸º Lambda è¡¨è¾¾å¼ä¸ºï¼š</p><pre><code class="java">Collections.sort(students, (Student h1, Student h2) -&gt; h1.getName().compareTo(h2.getName()));</code></pre><p>åœ¨ Java8 ä¸­ï¼Œ<code>List</code>ç±»ä¸­å¢åŠ äº†<code>sort</code>æ–¹æ³•ï¼Œæ‰€ä»¥<code>Collections.sort</code>å¯ä»¥ç›´æ¥æ›¿æ¢ä¸ºï¼š</p><pre><code class="java">students.sort((Student h1, Student h2) -&gt; h1.getName().compareTo(h2.getName()));</code></pre><p>æ ¹æ® Java8 ä¸­ Lambda çš„ç±»å‹æ¨æ–­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŒ‡å®šçš„<code>Student</code>ç±»å‹ç®€å†™ï¼š</p><pre><code class="java">students.sort((h1, h2) -&gt; h1.getName().compareTo(h2.getName()));</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æ•´æ®µæ’åºé€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><pre><code class="java">@Testvoid baseSortedLambdaWithInferring() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    students.sort((h1, h2) -&gt; h1.getName().compareTo(h2.getName()));    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><h2 id="é€šè¿‡é™æ€æ–¹æ³•æŠ½å–å…¬å…±çš„-Lambda-è¡¨è¾¾å¼"><a href="#é€šè¿‡é™æ€æ–¹æ³•æŠ½å–å…¬å…±çš„-Lambda-è¡¨è¾¾å¼" class="headerlink" title="é€šè¿‡é™æ€æ–¹æ³•æŠ½å–å…¬å…±çš„ Lambda è¡¨è¾¾å¼"></a>é€šè¿‡é™æ€æ–¹æ³•æŠ½å–å…¬å…±çš„ Lambda è¡¨è¾¾å¼</h2><p>æˆ‘ä»¬å¯ä»¥åœ¨<code>Student</code>ä¸­å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼š</p><pre><code class="java">public static int compareByNameThenAge(Student s1, Student s2) {    if (s1.name.equals(s2.name)) {        return Integer.compare(s1.age, s2.age);    } else {        return s1.name.compareTo(s2.name);    }}</code></pre><p>è¿™ä¸ªæ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ª<code>int</code>ç±»å‹å‚æ•°ï¼Œåœ¨ Java8 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Lambda ä¸­ä½¿ç”¨è¯¥æ–¹æ³•ï¼š</p><pre><code class="java">@Testvoid sortedUsingStaticMethod() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    students.sort(Student::compareByNameThenAge);    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><h2 id="å€ŸåŠ©Comparatorçš„comparingæ–¹æ³•"><a href="#å€ŸåŠ©Comparatorçš„comparingæ–¹æ³•" class="headerlink" title="å€ŸåŠ©Comparatorçš„comparingæ–¹æ³•"></a>å€ŸåŠ©<code>Comparator</code>çš„<code>comparing</code>æ–¹æ³•</h2><p>åœ¨ Java8 ä¸­ï¼Œ<code>Comparator</code>ç±»æ–°å¢äº†<code>comparing</code>æ–¹æ³•ï¼Œå¯ä»¥å°†ä¼ é€’çš„<code>Function</code>å‚æ•°ä½œä¸ºæ¯”è¾ƒå…ƒç´ ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">@Testvoid sortedUsingComparator() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    students.sort(Comparator.comparing(Student::getName));    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><h2 id="å¤šæ¡ä»¶æ’åº"><a href="#å¤šæ¡ä»¶æ’åº" class="headerlink" title="å¤šæ¡ä»¶æ’åº"></a>å¤šæ¡ä»¶æ’åº</h2><p>æˆ‘ä»¬åœ¨é™æ€æ–¹æ³•ä¸€èŠ‚ä¸­å±•ç¤ºäº†å¤šæ¡ä»¶æ’åºï¼Œè¿˜å¯ä»¥åœ¨<code>Comparator</code>åŒ¿åå†…éƒ¨ç±»ä¸­å®ç°å¤šæ¡ä»¶é€»è¾‘ï¼š</p><pre><code class="java">@Testvoid sortedMultiCondition() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12),            new Student(&quot;Jerry&quot;, 13)    );    students.sort((s1, s2) -&gt; {        if (s1.getName().equals(s2.getName())) {            return Integer.compare(s1.getAge(), s2.getAge());        } else {            return s1.getName().compareTo(s2.getName());        }    });    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><p>ä»é€»è¾‘æ¥çœ‹ï¼Œå¤šæ¡ä»¶æ’åºå°±æ˜¯å…ˆåˆ¤æ–­ç¬¬ä¸€çº§æ¡ä»¶ï¼Œå¦‚æœç›¸ç­‰ï¼Œå†åˆ¤æ–­ç¬¬äºŒçº§æ¡ä»¶ï¼Œä¾æ¬¡ç±»æ¨ã€‚åœ¨ Java8 ä¸­å¯ä»¥ä½¿ç”¨<code>comparing</code>å’Œä¸€ç³»åˆ—<code>thenComparing</code>è¡¨ç¤ºå¤šçº§æ¡ä»¶åˆ¤æ–­ï¼Œä¸Šé¢çš„é€»è¾‘å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><pre><code class="java">@Testvoid sortedMultiConditionUsingComparator() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12),            new Student(&quot;Jerry&quot;, 13)    );    students.sort(Comparator.comparing(Student::getName).thenComparing(Student::getAge));    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><p>è¿™é‡Œçš„<code>thenComparing</code>æ–¹æ³•æ˜¯å¯ä»¥æœ‰å¤šä¸ªçš„ï¼Œç”¨äºè¡¨ç¤ºå¤šçº§æ¡ä»¶åˆ¤æ–­ï¼Œè¿™ä¹Ÿæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ–¹ä¾¿ä¹‹å¤„ã€‚</p><h2 id="åœ¨Streamä¸­è¿›è¡Œæ’åº"><a href="#åœ¨Streamä¸­è¿›è¡Œæ’åº" class="headerlink" title="åœ¨Streamä¸­è¿›è¡Œæ’åº"></a>åœ¨<code>Stream</code>ä¸­è¿›è¡Œæ’åº</h2><p>Java8 ä¸­ï¼Œä¸ä½†å¼•å…¥äº† Lambda è¡¨è¾¾å¼ï¼Œè¿˜å¼•å…¥äº†ä¸€ä¸ªå…¨æ–°çš„æµå¼ APIï¼šStream APIï¼Œå…¶ä¸­ä¹Ÿæœ‰<code>sorted</code>æ–¹æ³•ç”¨äºæµå¼è®¡ç®—æ—¶æ’åºå…ƒç´ ï¼Œå¯ä»¥ä¼ å…¥<code>Comparator</code>å®ç°æ’åºé€»è¾‘ï¼š</p><pre><code class="java">@Testvoid streamSorted() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    final Comparator&lt;Student&gt; comparator = (h1, h2) -&gt; h1.getName().compareTo(h2.getName());    final List&lt;Student&gt; sortedStudents = students.stream()            .sorted(comparator)            .collect(Collectors.toList());    Assertions.assertEquals(sortedStudents.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Lambda ç®€åŒ–ä¹¦å†™ï¼š</p><pre><code class="java">@Testvoid streamSortedUsingComparator() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    final Comparator&lt;Student&gt; comparator = Comparator.comparing(Student::getName);    final List&lt;Student&gt; sortedStudents = students.stream()            .sorted(comparator)            .collect(Collectors.toList());    Assertions.assertEquals(sortedStudents.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><h2 id="å€’åºæ’åˆ—"><a href="#å€’åºæ’åˆ—" class="headerlink" title="å€’åºæ’åˆ—"></a>å€’åºæ’åˆ—</h2><h3 id="è°ƒè½¬æ’åºåˆ¤æ–­"><a href="#è°ƒè½¬æ’åºåˆ¤æ–­" class="headerlink" title="è°ƒè½¬æ’åºåˆ¤æ–­"></a>è°ƒè½¬æ’åºåˆ¤æ–­</h3><p>æ’åºå°±æ˜¯æ ¹æ®<code>compareTo</code>æ–¹æ³•è¿”å›çš„å€¼åˆ¤æ–­é¡ºåºï¼Œå¦‚æœæƒ³è¦å€’åºæ’åˆ—ï¼Œåªè¦å°†è¿”å›å€¼å–è¿”å³å¯ï¼š</p><pre><code class="java">@Testvoid sortedReverseUsingComparator2() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    final Comparator&lt;Student&gt; comparator = (h1, h2) -&gt; h2.getName().compareTo(h1.getName());    students.sort(comparator);    Assertions.assertEquals(students.get(0), new Student(&quot;Tom&quot;, 10));}</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­£åºæ’åˆ—çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯<code>h1.getName().compareTo(h2.getName())</code>ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å€’è½¬è¿‡æ¥ï¼Œä½¿ç”¨çš„æ˜¯<code>h2.getName().compareTo(h1.getName())</code>ï¼Œä¹Ÿå°±è¾¾åˆ°äº†å–åçš„æ•ˆæœã€‚åœ¨ Java çš„<code>Collections</code>ä¸­å®šä¹‰äº†ä¸€ä¸ª<code>java.util.Collections.ReverseComparator</code>å†…éƒ¨ç§æœ‰ç±»ï¼Œå°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼å®ç°å…ƒç´ åè½¬ã€‚</p><h3 id="å€ŸåŠ©Comparatorçš„reversedæ–¹æ³•å€’åº"><a href="#å€ŸåŠ©Comparatorçš„reversedæ–¹æ³•å€’åº" class="headerlink" title="å€ŸåŠ©Comparatorçš„reversedæ–¹æ³•å€’åº"></a>å€ŸåŠ©<code>Comparator</code>çš„<code>reversed</code>æ–¹æ³•å€’åº</h3><p>åœ¨ Java8 ä¸­æ–°å¢äº†<code>reversed</code>æ–¹æ³•å®ç°å€’åºæ’åˆ—ï¼Œç”¨èµ·æ¥ä¹Ÿæ˜¯å¾ˆç®€å•ï¼š</p><pre><code class="java">@Testvoid sortedReverseUsingComparator() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    final Comparator&lt;Student&gt; comparator = (h1, h2) -&gt; h1.getName().compareTo(h2.getName());    students.sort(comparator.reversed());    Assertions.assertEquals(students.get(0), new Student(&quot;Tom&quot;, 10));}</code></pre><h3 id="åœ¨Comparator-comparingä¸­å®šä¹‰æ’åºåè½¬"><a href="#åœ¨Comparator-comparingä¸­å®šä¹‰æ’åºåè½¬" class="headerlink" title="åœ¨Comparator.comparingä¸­å®šä¹‰æ’åºåè½¬"></a>åœ¨<code>Comparator.comparing</code>ä¸­å®šä¹‰æ’åºåè½¬</h3><p><code>comparing</code>æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªé‡è½½æ–¹æ³•ï¼Œ<code>java.util.Comparator#comparing(java.util.function.Function&lt;? super T,? extends U&gt;, java.util.Comparator&lt;? super U&gt;)</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±å¯ä»¥ä¼ å…¥<code>Comparator.reverseOrder()</code>ï¼Œå¯ä»¥å®ç°å€’åºï¼š</p><pre><code class="java">@Testvoid sortedUsingComparatorReverse() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    students.sort(Comparator.comparing(Student::getName, Comparator.reverseOrder()));    Assertions.assertEquals(students.get(0), new Student(&quot;Jerry&quot;, 12));}</code></pre><h3 id="åœ¨Streamä¸­å®šä¹‰æ’åºåè½¬"><a href="#åœ¨Streamä¸­å®šä¹‰æ’åºåè½¬" class="headerlink" title="åœ¨Streamä¸­å®šä¹‰æ’åºåè½¬"></a>åœ¨<code>Stream</code>ä¸­å®šä¹‰æ’åºåè½¬</h3><p>åœ¨<code>Stream</code>ä¸­çš„æ“ä½œä¸ç›´æ¥åˆ—è¡¨æ’åºç±»ä¼¼ï¼Œå¯ä»¥åè½¬<code>Comparator</code>å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>Comparator.reverseOrder()</code>åè½¬ã€‚å®ç°å¦‚ä¸‹ï¼š</p><pre><code class="java">@Testvoid streamReverseSorted() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    final Comparator&lt;Student&gt; comparator = (h1, h2) -&gt; h2.getName().compareTo(h1.getName());    final List&lt;Student&gt; sortedStudents = students.stream()            .sorted(comparator)            .collect(Collectors.toList());    Assertions.assertEquals(sortedStudents.get(0), new Student(&quot;Tom&quot;, 10));}@Testvoid streamReverseSortedUsingComparator() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(&quot;Tom&quot;, 10),            new Student(&quot;Jerry&quot;, 12)    );    final List&lt;Student&gt; sortedStudents = students.stream()            .sorted(Comparator.comparing(Student::getName, Comparator.reverseOrder()))            .collect(Collectors.toList());    Assertions.assertEquals(sortedStudents.get(0), new Student(&quot;Tom&quot;, 10));}</code></pre><h2 id="null-å€¼çš„åˆ¤æ–­"><a href="#null-å€¼çš„åˆ¤æ–­" class="headerlink" title="null å€¼çš„åˆ¤æ–­"></a>null å€¼çš„åˆ¤æ–­</h2><p>å‰é¢çš„ä¾‹å­ä¸­éƒ½æ˜¯æœ‰å€¼å…ƒç´ æ’åºï¼Œèƒ½å¤Ÿè¦†ç›–å¤§éƒ¨åˆ†åœºæ™¯ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬è¿˜æ˜¯ä¼šç¢°åˆ°å…ƒç´ ä¸­å­˜åœ¨<code>null</code>çš„æƒ…å†µï¼š</p><ol><li>åˆ—è¡¨ä¸­çš„å…ƒç´ æ˜¯ null</li><li>åˆ—è¡¨ä¸­çš„å…ƒç´ å‚ä¸æ’åºæ¡ä»¶çš„å­—æ®µæ˜¯ null</li></ol><p>å¦‚æœè¿˜æ˜¯ä½¿ç”¨å‰é¢çš„é‚£äº›å®ç°ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°<code>NullPointException</code>å¼‚å¸¸ï¼Œå³ NPEï¼Œç®€å•æ¼”ç¤ºä¸€ä¸‹ï¼š</p><pre><code class="java">@Testvoid sortedNullGotNPE() {    final List&lt;Student&gt; students = Lists.newArrayList(            null,            new Student(&quot;Snoopy&quot;, 12),            null    );    Assertions.assertThrows(NullPointerException.class,            () -&gt; students.sort(Comparator.comparing(Student::getName)));}</code></pre><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘è¿™äº›åœºæ™¯ã€‚</p><h3 id="å…ƒç´ æ˜¯-null-çš„ç¬¨æ‹™å®ç°"><a href="#å…ƒç´ æ˜¯-null-çš„ç¬¨æ‹™å®ç°" class="headerlink" title="å…ƒç´ æ˜¯ null çš„ç¬¨æ‹™å®ç°"></a>å…ƒç´ æ˜¯ null çš„ç¬¨æ‹™å®ç°</h3><p>æœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯åˆ¤ç©ºï¼š</p><pre><code class="java">@Testvoid sortedNullNoNPE() {    final List&lt;Student&gt; students = Lists.newArrayList(            null,            new Student(&quot;Snoopy&quot;, 12),            null    );    students.sort((s1, s2) -&gt; {        if (s1 == null) {            return s2 == null ? 0 : 1;        } else if (s2 == null) {            return -1;        }        return s1.getName().compareTo(s2.getName());    });    Assertions.assertNotNull(students.get(0));    Assertions.assertNull(students.get(1));    Assertions.assertNull(students.get(2));}</code></pre><p>æˆ‘ä»¬å¯ä»¥å°†åˆ¤ç©ºçš„é€»è¾‘æŠ½å–å‡ºä¸€ä¸ª<code>Comparator</code>ï¼Œé€šè¿‡ç»„åˆæ–¹å¼å®ç°ï¼š</p><pre><code class="java">class NullComparator&lt;T&gt; implements Comparator&lt;T&gt; {    private final Comparator&lt;T&gt; real;    NullComparator(Comparator&lt;? super T&gt; real) {        this.real = (Comparator&lt;T&gt;) real;    }    @Override    public int compare(T a, T b) {        if (a == null) {            return (b == null) ? 0 : 1;        } else if (b == null) {            return -1;        } else {            return (real == null) ? 0 : real.compare(a, b);        }    }}</code></pre><p>åœ¨ Java8 ä¸­å·²ç»ä¸ºæˆ‘ä»¬å‡†å¤‡äº†è¿™ä¸ªå®ç°ã€‚</p><h3 id="ä½¿ç”¨Comparator-nullsLastå’ŒComparator-nullsFirst"><a href="#ä½¿ç”¨Comparator-nullsLastå’ŒComparator-nullsFirst" class="headerlink" title="ä½¿ç”¨Comparator.nullsLastå’ŒComparator.nullsFirst"></a>ä½¿ç”¨<code>Comparator.nullsLast</code>å’Œ<code>Comparator.nullsFirst</code></h3><p>ä½¿ç”¨<code>Comparator.nullsLast</code>å®ç°<code>null</code>åœ¨ç»“å°¾ï¼š</p><pre><code class="java">@Testvoid sortedNullLast() {    final List&lt;Student&gt; students = Lists.newArrayList(            null,            new Student(&quot;Snoopy&quot;, 12),            null    );    students.sort(Comparator.nullsLast(Comparator.comparing(Student::getName)));    Assertions.assertNotNull(students.get(0));    Assertions.assertNull(students.get(1));    Assertions.assertNull(students.get(2));}</code></pre><p>ä½¿ç”¨<code>Comparator.nullsFirst</code>å®ç°<code>null</code>åœ¨å¼€å¤´ï¼š</p><pre><code class="java">@Testvoid sortedNullFirst() {    final List&lt;Student&gt; students = Lists.newArrayList(            null,            new Student(&quot;Snoopy&quot;, 12),            null    );    students.sort(Comparator.nullsFirst(Comparator.comparing(Student::getName)));    Assertions.assertNull(students.get(0));    Assertions.assertNull(students.get(1));    Assertions.assertNotNull(students.get(2));}</code></pre><p>æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹å¦‚ä½•å®ç°æ’åºæ¡ä»¶çš„å­—æ®µæ˜¯ null çš„é€»è¾‘ã€‚</p><h3 id="æ’åºæ¡ä»¶çš„å­—æ®µæ˜¯-null"><a href="#æ’åºæ¡ä»¶çš„å­—æ®µæ˜¯-null" class="headerlink" title="æ’åºæ¡ä»¶çš„å­—æ®µæ˜¯ null"></a>æ’åºæ¡ä»¶çš„å­—æ®µæ˜¯ null</h3><p>è¿™ä¸ªå°±æ˜¯å€ŸåŠ©<code>Comparator</code>çš„ç»„åˆäº†ï¼Œå°±åƒæ˜¯å¥—å¨ƒå®ç°äº†ï¼Œéœ€è¦ä½¿ç”¨ä¸¤æ¬¡<code>Comparator.nullsLast</code>ï¼Œè¿™é‡Œåˆ—å‡ºå®ç°ï¼š</p><pre><code class="java">@Testvoid sortedNullFieldLast() {    final List&lt;Student&gt; students = Lists.newArrayList(            new Student(null, 10),            new Student(&quot;Snoopy&quot;, 12),            null    );    final Comparator&lt;Student&gt; nullsLast = Comparator.nullsLast(            Comparator.nullsLast( // 1                    Comparator.comparing(                            Student::getName,                            Comparator.nullsLast( // 2                                    Comparator.naturalOrder() // 3                            )                    )            )    );    students.sort(nullsLast);    Assertions.assertEquals(students.get(0), new Student(&quot;Snoopy&quot;, 12));    Assertions.assertEquals(students.get(1), new Student(null, 10));    Assertions.assertNull(students.get(2));}</code></pre><p>ä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p><ol><li>ä»£ç  1 æ˜¯ç¬¬ä¸€å±‚ null-safe é€»è¾‘ï¼Œç”¨äºåˆ¤æ–­å…ƒç´ æ˜¯å¦ä¸º nullï¼›</li><li>ä»£ç  2 æ˜¯ç¬¬äºŒå±‚ null-safe é€»è¾‘ï¼Œç”¨äºåˆ¤æ–­å…ƒç´ çš„æ¡ä»¶å­—æ®µæ˜¯å¦ä¸º nullï¼›</li><li>ä»£ç  3 æ˜¯æ¡ä»¶<code>Comparator</code>ï¼Œè¿™é‡Œä½¿ç”¨äº†<code>Comparator.naturalOrder()</code>ï¼Œæ˜¯å› ä¸ºä½¿ç”¨äº†<code>String</code>æ’åºï¼Œä¹Ÿå¯ä»¥å†™ä¸º<code>String::compareTo</code>ã€‚å¦‚æœæ˜¯å¤æ‚åˆ¤æ–­ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæ›´åŠ å¤æ‚çš„<code>Comparator</code>ï¼Œç»„åˆæ¨¡å¼å°±æ˜¯è¿™ä¹ˆå¥½ç”¨ï¼Œä¸€å±‚ä¸å¤Ÿå†å¥—ä¸€å±‚ã€‚</li></ol><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡æ¼”ç¤ºäº†ä½¿ç”¨ Java8 ä¸­ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°å„ç§æ’åºé€»è¾‘ï¼Œæ–°å¢çš„è¯­æ³•ç³–çœŸé¦™ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/7f5dcjjKLdBYpzS5p7_v7Q" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 Stream ä¸­ Collectors çš„ 24 ä¸ªæ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/JOLrw7cbVh8z2czePEfLjw" target="_blank" rel="noopener">ä¸€æ–‡æŒæ¡ Java8 çš„ Optional çš„ 6 ç§æ“ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/Srv6733byTYDg7hTrW_tdw" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ1ï¼‰ï¼šä»‹ç» Java8 ä¸­çš„æ—¶é—´ç±»åŠå¸¸ç”¨ API</a></li><li><a href="https://mp.weixin.qq.com/s/LRydpL89GsjOeTrLrihyYQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ2ï¼‰ï¼šDate ä¸ LocalDate æˆ– LocalDateTime äº’ç›¸è½¬æ¢</a></li><li><a href="https://mp.weixin.qq.com/s/KmBMLG1y73IUwFuSfUKaEQ" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ3ï¼‰ï¼šå¼€å§‹ä½¿ç”¨ Java8 ä¸­çš„æ—¶é—´ç±»</a></li><li><a href="https://mp.weixin.qq.com/s/PxC0WQMReIeG0Tyl5WiK1Q" target="_blank" rel="noopener">Java8 çš„æ—¶é—´åº“ï¼ˆ4ï¼‰ï¼šæ£€æŸ¥æ—¥æœŸå­—ç¬¦ä¸²æ˜¯å¦åˆæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/4jVPnaOr-rve3GQdukDFmA" target="_blank" rel="noopener">JDK ä¸­å±…ç„¶ä¹Ÿæœ‰åæ¨¡å¼æ¥å£å¸¸é‡</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/java-lambda-powerful-comparation/">Java è¿›é˜¶ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">Java è¿›é˜¶ï¼šä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°è¶…å¼ºçš„æ’åºåŠŸèƒ½</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡æ¼”ç¤ºäº†ä½¿ç”¨ Java8 ä¸­ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®ç°å„ç§æ’åºé€»è¾‘ï¼Œæ–°å¢çš„è¯­æ³•ç³–çœŸé¦™ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="java" scheme="https://www.howardliu.cn/tags/java/"/>
    
      <category term="JDK8" scheme="https://www.howardliu.cn/tags/JDK8/"/>
    
      <category term="Comparator" scheme="https://www.howardliu.cn/tags/Comparator/"/>
    
  </entry>
  
  <entry>
    <title>çœ‹å±±èŠ Javaï¼šä»é›¶å®ç°â€œç™¾åº¦ç½‘ç›˜æ‰¹é‡é‡å‘½åâ€å·¥å…·</title>
    <link href="https://www.howardliu.cn/effective-java-tools-batch-rename-baiduwangpan/"/>
    <id>https://www.howardliu.cn/effective-java-tools-batch-rename-baiduwangpan/</id>
    <published>2021-10-25T15:16:13.000Z</published>
    <updated>2021-10-25T15:16:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20211025231948.jpeg" alt="çœ‹å±±èŠ Javaï¼šä»é›¶å®ç°â€œç™¾åº¦ç½‘ç›˜æ‰¹é‡é‡å‘½åâ€å·¥å…·"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/roshan_bhatia-17147583/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6693577" target="_blank" rel="noopener">Roshan Bhatia</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6693577" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å·¥å…·çš„å‘æ˜èƒ½å¤ŸèŠ‚çœä½“åŠ›ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘é‡å¤åŠ³åŠ¨ï¼Œè½¯ä»¶ä¹Ÿæ˜¯å·¥å…·çš„ä¸€ç§ã€‚ä»Šå¤©è¦è¯´çš„æ˜¯ï¼Œå¼•ç”¨ IT æŠ€æœ¯ï¼Œå‡å°‘å¤§é‡æ–‡ä»¶é‡å‘½åè¿™ç§é‡å¤çš„åŠ³åŠ¨ã€‚</p><a id="more"></a><p>ä¸€ç›´åœ¨ç”¨çš„å­˜å‚¨äº‘ç›˜æ˜¯ç™¾åº¦ç½‘ç›˜ï¼Œé‡Œé¢æ”¶é›†äº†å¤§é‡æ–‡ä»¶ã€‚å„ç§èµ„æ–™ã€ç”µå­ä¹¦ï¼Œä½¿ç”¨ç©ºé—´è¾¾åˆ°äº† 2500Gã€‚ä¹‹å‰è¿˜æ¸…ç†è¿‡ä¸€äº›ä½è´¨çš„ä¹¦ç±ï¼Œç»“æœä½¿ç”¨å·¥å…·å¯¼å‡ºå‘ç°ï¼Œåœ¨å¾…æ•´ç†ç›®å½•ä¸­ï¼Œå±…ç„¶æœ‰ 1942 æ¡ç”µå­ä¹¦çš„è®°å½•ã€‚å¦‚æœæœ‰å°ä¼™ä¼´æƒ³è¦ä»€ä¹ˆä¹¦ï¼Œå¯ä»¥ä»å…¬å·ç•™è¨€ï¼Œåªè¦ä¸æ˜¯å•†ç”¨ï¼Œæ— ç§å…±äº«ã€‚</p><h2 id="æå‡ºéœ€æ±‚"><a href="#æå‡ºéœ€æ±‚" class="headerlink" title="æå‡ºéœ€æ±‚"></a>æå‡ºéœ€æ±‚</h2><p>ä¹¦å½’æ­£ä¼ ï¼Œè¿™ä¹ˆå¤šçš„æ–‡ä»¶ï¼Œå‘½åæ ¼å¼åƒå¥‡ç™¾æ€ªï¼Œå› ä¸ºæœ‰ä¸€äº›èµ„æ–™æ˜¯ä»åˆ«äººçš„åˆ†äº«ä¸­ä¿å­˜çš„ï¼Œæœ‰çš„è¿˜ä¼šå¸¦ç½‘å€çš„ï¼Œå¯è§ç½‘ç«™è¿è¥ä¹Ÿæ˜¯æ— æ‰€ä¸ç”¨å…¶æäº†ã€‚ä»ç½‘ä¸Šæ‰¾åˆ°ä¸€äº›æ‰¹é‡æ”¹åçš„å·¥å…·ï¼Œå¤§å¤šæ˜¯ Windows ç‰ˆæœ¬çš„ï¼Œè€Œä¸”æ˜¯åŠ å‰ç¼€æˆ–è€…åç¼€ä¹‹ç±»çš„ï¼Œä¸å¤ªé€‚ç”¨ã€‚</p><p>æˆ‘æƒ³è¦çš„æ˜¯ï¼Œè‡ªå·±æŒ‡å®šæ–‡ä»¶åï¼Œç„¶åæ‰¹é‡æ‰§è¡Œã€‚å°±ç›¸å½“äºæœ‰ä¸€åŒæ‰‹ï¼Œå¸®æˆ‘åœ¨ç™¾åº¦ç½‘ç›˜ä¸­æ‰§è¡Œå®˜æ–¹æä¾›çš„é‡å‘½åã€‚ä¹‹æ‰€ä»¥ä¸ç”¨å®˜æ–¹çš„é‡å‘½åï¼Œæ˜¯å› ä¸ºå¤ªéš¾ç”¨ï¼Œè€Œä¸”æµªè´¹æ—¶é—´ï¼ˆåé¢ä¼šå…·ä½“è¯´ä¸€ä¸‹ç™¾åº¦ç½‘ç›˜çš„è¿™ä¸ªè®¾è®¡ï¼Œä¹Ÿæ˜¯å¯ä»¥å€Ÿé‰´çš„ï¼‰ã€‚</p><p>æƒ³è¦å®ç°è‡ªå·±çš„æƒ³æ³•ï¼Œéœ€è¦æœ‰ä¸¤æ­¥ï¼š</p><ol><li>ä»¥ Excel æ ¼å¼å¯¼å‡ºæ‰€æœ‰æ–‡ä»¶å</li><li>åœ¨å¯¼å‡ºçš„ Excel æ–‡ä»¶ä¸­ï¼Œå®šä¹‰ç›®æ ‡åç§°ï¼Œä¸éœ€è¦æ”¹åçš„å¯ä»¥ä¸ç”¨ä¿®æ”¹</li><li>å¯¼å…¥æ•´ç†åçš„æ–‡ä»¶ï¼Œæ£€æŸ¥æ˜¯å¦é‡å‘½åæˆåŠŸ</li></ol><h2 id="è®¾è®¡æ–¹æ¡ˆ"><a href="#è®¾è®¡æ–¹æ¡ˆ" class="headerlink" title="è®¾è®¡æ–¹æ¡ˆ"></a>è®¾è®¡æ–¹æ¡ˆ</h2><p>æ ¹æ®éœ€æ±‚ï¼Œæˆ‘ä»¬æ¥è®¾è®¡æ–¹æ¡ˆã€‚</p><h3 id="æ‰¾åˆ°å…³é”®æ¥å£"><a href="#æ‰¾åˆ°å…³é”®æ¥å£" class="headerlink" title="æ‰¾åˆ°å…³é”®æ¥å£"></a>æ‰¾åˆ°å…³é”®æ¥å£</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿå¯¼å‡ºæ‰€æœ‰çš„æ–‡ä»¶åã€‚</p><p>ç™¾åº¦ç½‘ç›˜æä¾›äº†ç½‘é¡µç‰ˆã€å®¢æˆ·ç«¯ç‰ˆï¼Œä¸ºäº†çœæ—¶çœäº‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ç½‘é¡µç‰ˆæ£€æŸ¥é€»è¾‘ã€‚æ‰“å¼€æ§åˆ¶å°ï¼Œå‘ç°è¿›å…¥ç›®å½•æ—¶ä¼šæœ‰ä¸€ä¸ª<code>/api/list</code>çš„è¯·æ±‚ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://static.howardliu.cn/20211024165119.png" alt="æŸ¥è¯¢ç›®å½•ä¸­æ–‡ä»¶åˆ—è¡¨"></p><p>æ ¹æ®å“åº”å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªæ¥å£å¯ä»¥è·å–æŒ‡å®šç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ã€‚è¿™ä¸ªè¯·æ±‚æ˜¯ Get è¯·æ±‚ï¼ŒåŒ…å«äº†å¥½å‡ ä¸ªå‚æ•°ï¼Œè¿˜ä¸å¤ªè¯·æ±‚å‚æ•°çš„ä½œç”¨ï¼Œå…ˆæ”¾è¿‡ã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œç®€å•çš„ç½‘ç»œè¯·æ±‚æ˜¯é€šè¿‡ Cookie é‰´æƒï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ— è„‘ä½¿ç”¨ Cookie äº†ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦æ‰¾åˆ°é‡å‘½åçš„è¯·æ±‚ï¼ŒåŒæ ·çš„ï¼Œæ‰§è¡Œç™¾åº¦ç½‘ç›˜æä¾›çš„é‡å‘½åå³å¯ï¼Œæ–°å¢äº†å“ªäº›è¯·æ±‚ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://static.howardliu.cn/20211024165729.png" alt="é‡å‘½åå¹¶æŸ¥è¯¢ç»“æœ"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„é‡å‘½ååˆ†ä¸ºäº†ä¸¤æ­¥ï¼š</p><ol><li>æäº¤é‡å‘½åä»»åŠ¡ï¼Œè¿”å›ä»»åŠ¡ id</li><li>ä½¿ç”¨ä»»åŠ¡ id æŸ¥è¯¢ä»»åŠ¡æ‰§è¡Œæƒ…å†µ</li></ol><p>è¿™å°±æ˜¯å‰é¢è¯´çš„å¯å€Ÿé‰´çš„åœ°æ–¹ã€‚å¯¹äºç™¾åº¦ç½‘ç›˜è¿™ç§åº”ç”¨ï¼Œè™½ç„¶ä¸‹è½½é™é€Ÿè¢«å„ç§è¯Ÿç—…ï¼Œè¿˜æœ‰é˜¿é‡Œäº‘ç›˜çš„å¼ºåŠ¿è¿½å‡»ï¼Œä½†æ˜¯ä¸å¾—ä¸è¯´ï¼Œç™¾åº¦ç½‘ç›˜è¿˜æ˜¯ç°åœ¨ç”¨çš„æ¯”è¾ƒå¤šçš„äº‘å­˜å‚¨å·¥å…·ã€‚å¿…é¡»æœ‰é’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼Œå°†æŸäº›äºŒçº§åŠŸèƒ½å¼‚æ­¥ä»»åŠ¡åŒ–ï¼Œæ¯”å¦‚é‡å‘½åã€‚</p><ol><li>å…ˆé€šè¿‡ä¸€ä¸ªè¯·æ±‚åˆ›å»ºé‡å‘½åä»»åŠ¡ï¼Œä»»åŠ¡åˆ›å»ºæˆåŠŸè¿”å›ä»»åŠ¡ IDã€‚è¿™ä¸ªæ—¶å€™ï¼Œç™¾åº¦ç½‘ç›˜åç«¯æœåŠ¡ç›‘å¬æ–°ä»»åŠ¡ï¼Œå¦‚æœåç«¯å‹åŠ›å¤§ï¼Œä»»åŠ¡å¯ä»¥ç¼“æ…¢æ‰§è¡Œæˆ–ä¸æ‰§è¡Œï¼›</li><li>æ—¢ç„¶æ˜¯å¼‚æ­¥ä»»åŠ¡åŒ–ï¼Œå®¢æˆ·ç«¯ï¼ˆåŒ…æ‹¬ç½‘é¡µæˆ–å®¢æˆ·ç«¯ï¼‰éœ€è¦æ£€æŸ¥ä»»åŠ¡æ‰§è¡Œæƒ…å†µã€‚ä»»åŠ¡æ‰§è¡Œæƒ…å†µæ ¹æ®çº¦å®šå¯ä»¥æœ‰è¿›è¡Œä¸­æˆ–è€…å®Œæˆï¼Œè¿˜å¯ä»¥æœ‰æ‹’ç»ã€å¤±è´¥ã€è¿‡æœŸç­‰å…¶ä»–æƒ…å†µã€‚</li></ol><h3 id="å¯¼å‡ºå¯¼å…¥æ–‡ä»¶"><a href="#å¯¼å‡ºå¯¼å…¥æ–‡ä»¶" class="headerlink" title="å¯¼å‡ºå¯¼å…¥æ–‡ä»¶"></a>å¯¼å‡ºå¯¼å…¥æ–‡ä»¶</h3><p>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©é˜¿é‡Œå¼€æºçš„ EasyExcel å¯¼å‡º Excel æ–‡ä»¶ï¼ˆå…·ä½“æ“ä½œï¼Œå¯ä»¥æŸ¥çœ‹ <a href="https://mp.weixin.qq.com/s/CYiY7wNuOnhVk4Mw5L8Wrw" target="_blank" rel="noopener">å†™æ–‡ä»¶</a>ã€<a href="https://mp.weixin.qq.com/s/edCvwrP1NYd8ryBHcp35fA" target="_blank" rel="noopener">å†™çš„å¥½çœ‹</a>ã€<a href="https://mp.weixin.qq.com/s/4QGSjKUSm_KAF009grd4hw" target="_blank" rel="noopener">å¡«å……æ–‡ä»¶</a> ä¸‰ç¯‡ï¼‰ã€‚</p><p>è¿™ä¸ªæ—¶å€™éœ€è¦å®šä¹‰å¯¼å‡ºæ–‡ä»¶çš„å†…å®¹ï¼Œæ ¹æ®é‡å‘½åçš„è¯·æ±‚æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬éœ€è¦æ–‡ä»¶è·¯å¾„ã€æ–‡ä»¶çš„æ–°åå­—ï¼Œä¸ºäº†æ“ä½œç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠåŸåä¹Ÿå¯¼å‡ºæ¥ã€‚ä¸ºäº†æ£€æŸ¥ç½‘ç›˜æ–‡ä»¶æ˜¯å¦æœ‰é‡å¤çš„ï¼Œæœ€å¥½æŠŠæ–‡ä»¶çš„æ‘˜è¦ç ä¹Ÿå¯¼å‡ºæ¥ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„éœ€æ±‚å’Œæ–¹æ¡ˆéƒ½è®¾è®¡å¥½äº†ï¼Œä¸‹é¢å°±å¼€å§‹ç¼–ç ã€‚</p><h2 id="å¼€å§‹ç¼–ç "><a href="#å¼€å§‹ç¼–ç " class="headerlink" title="å¼€å§‹ç¼–ç "></a>å¼€å§‹ç¼–ç </h2><p>å¼€å§‹ç¼–ç å‰ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸‹é‰´æƒå‚æ•°ï¼šcookieã€bdstokenï¼Œå†å®šä¹‰ä¸€ä¸ªæ‰©å±•å‚æ•° pathï¼Œæˆ‘ä»¬åªå¯¼å‡ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶åˆ—è¡¨ã€‚</p><h3 id="å®šä¹‰åŸºç¡€ç±»"><a href="#å®šä¹‰åŸºç¡€ç±»" class="headerlink" title="å®šä¹‰åŸºç¡€ç±»"></a>å®šä¹‰åŸºç¡€ç±»</h3><p>æ ¹æ®è®¾è®¡æ–¹æ¡ˆä¸­çš„å®šä¹‰ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºå¯¼å‡ºæ–‡ä»¶çš„åŸºç¡€ç±»ï¼š</p><pre><code class="java">@Datapublic class FileName {    @ExcelProperty(&quot;è·¯å¾„&quot;)    private String path;    @ExcelProperty(&quot;MD5&quot;)    private String md5;    @ExcelProperty(&quot;åŸåç§°&quot;)    private String originName;    @ExcelProperty(&quot;æ–°åç§°&quot;)    private String newName;}</code></pre><p>å› ä¸ºæ¶‰åŠåˆ°ç½‘ç»œè¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰è¯·æ±‚å‚æ•°ã€‚è¯·æ±‚æœ‰ä¸€äº›å…±åŒå‚æ•°ï¼š</p><pre><code class="java">@Datapublic abstract class BaseRequest {    protected String channel = &quot;chunlei&quot;;    protected String web = &quot;1&quot;;    protected String appId = &quot;250528&quot;;    protected String bdstoken = &quot;&quot;;    protected String logid = &quot;&quot;;    protected String clienttype = &quot;0&quot;;}</code></pre><p>æ–‡ä»¶åˆ—è¡¨å‚æ•°ä¸ºï¼š</p><pre><code class="java">@EqualsAndHashCode(callSuper = true)@Datapublic class FileListRequest extends BaseRequest {    private String order = &quot;name&quot;;    private String desc = &quot;0&quot;;    private String showempty = &quot;0&quot;;    private int page = 1;    private int num = 100;    private String dir = &quot;/&quot;;    private String t = &quot;&quot;;}</code></pre><p>é‡å‘½åå‚æ•°ä¸ºï¼š</p><pre><code class="java">@EqualsAndHashCode(callSuper = true)@Datapublic class FileRenameRequest extends BaseRequest {    private String opera = &quot;rename&quot;;    private String async = &quot;2&quot;;    private String onnest = &quot;fail&quot;;}</code></pre><p>æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæŸ¥è¯¢ä»»åŠ¡çŠ¶æ€çš„å‚æ•°ï¼š</p><pre><code class="java">@EqualsAndHashCode(callSuper = true)@Datapublic class TaskStatusRequest extends BaseRequest {    private Long taskid;}</code></pre><h3 id="å®šä¹‰è¯·æ±‚ç±»"><a href="#å®šä¹‰è¯·æ±‚ç±»" class="headerlink" title="å®šä¹‰è¯·æ±‚ç±»"></a>å®šä¹‰è¯·æ±‚ç±»</h3><p>å‰é¢æœ‰äº†åŸºç¡€ç±»å’Œè¯·æ±‚ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®šä¹‰è¯·æ±‚æ¥å£ï¼Œè¿™äº›ç±»å°±æ˜¯æ¨¡æ¿åŒ–çš„æ–¹æ³•äº†ï¼Œæˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ã€‚å¦‚æœæƒ³è¦è·å–æºç ï¼Œå…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤â€œjavaâ€è·å–æºç ã€‚</p><p>å…ˆå®šä¹‰æ–‡ä»¶åˆ—è¡¨è¯·æ±‚æ–¹æ³•ï¼š</p><pre><code class="java">private List&lt;FileListItem&gt; listFileCurrentPath(FileListRequest fileListRequest) {    final String body = HttpRequest.get(&quot;https://pan.baidu.com/api/list&quot;)            .form(fileListRequest.paramMap())            .header(this.headers)            .cookie(this.cookie)            .execute()            .body();    final FileListResponse response = JSONUtil.toBean(body, FileListResponse.class);    if (response.getErrno() == 0) {        return response.getList();    }    return Collections.emptyList();}</code></pre><p>åœ¨å®šä¹‰æ–‡ä»¶é‡å‘½åè¯·æ±‚æ–¹æ³•ï¼š</p><pre><code class="java">private Long rename(FileRenameRequest fileRenameRequest, String params) {    final String queryParam = HttpUtil.toParams(fileRenameRequest.paramMap());    final HttpRequest httpRequest = HttpRequest.post(&quot;https://pan.baidu.com/api/filemanager?&quot; + queryParam)            .header(this.headers)            .cookie(this.cookie)            .body(params);    final String body = httpRequest.execute().body();    final FileRenameResponse response = JSONUtil.toBean(body, FileRenameResponse.class);    if (response.getErrno() == 0) {        return response.getTaskid();    }    return -1L;}</code></pre><p>æœ€åå®šä¹‰æ£€æŸ¥ä»»åŠ¡çŠ¶æ€è¯·æ±‚æ–¹æ³•ï¼š</p><pre><code class="java">private TaskStatusResponse queryTaskStatus(TaskStatusRequest taskStatusRequest, String params) {    TaskStatusResponse response;    final String queryParam = HttpUtil.toParams(taskStatusRequest.paramMap());    do {        final String body = HttpRequest.post(&quot;https://pan.baidu.com/share/taskquery?&quot; + queryParam)                .header(this.headers)                .cookie(this.cookie)                .body(params)                .execute()                .body();        response = JSONUtil.toBean(body, TaskStatusResponse.class);    } while (response.getErrno() != 0 || StringUtils.equalsAny(response.getStatus(), &quot;running&quot;, &quot;pending&quot;));    return response;}</code></pre><h2 id="ä½“éªŒå‡çº§"><a href="#ä½“éªŒå‡çº§" class="headerlink" title="ä½“éªŒå‡çº§"></a>ä½“éªŒå‡çº§</h2><p>å…¨éƒ¨ç±»å®šä¹‰å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ IDE ä¸­è¿è¡Œã€‚ä½†æ˜¯ï¼Œæ—¢ç„¶æ˜¯å·¥å…·ï¼Œæ¯æ¬¡ä½¿ç”¨è¿˜å¾—æ‰“å¼€ IDEï¼Œæ˜¯ä¸æ˜¯æœ‰äº› low äº†ã€‚ä¸ºäº†å‡çº§ä½“éªŒï¼Œæˆ‘ä»¬å¯ä»¥æ‰“æˆ jar åŒ…ï¼Œä½¿ç”¨çš„æ—¶å€™ç›´æ¥è¿è¡Œ jar åŒ…å°±è¡Œäº†ã€‚å¯ä»¥å€ŸåŠ© maven æ’ä»¶<code>maven-assembly-plugin</code>å®ç°ï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¤ŸæŠŠæˆ‘ä»¬çš„æºç å’Œä¸‰æ–¹åº“éƒ½æ‰“åœ¨ä¸€ä¸ª jar åŒ…ä¸­ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ª FatJar èµ°å¤©ä¸‹äº†ã€‚</p><pre><code class="xml">&lt;plugin&gt;    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;    &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;    &lt;version&gt;2.3&lt;/version&gt;    &lt;configuration&gt;        &lt;appendAssemblyId&gt;false&lt;/appendAssemblyId&gt;        &lt;descriptorRefs&gt;            &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;        &lt;/descriptorRefs&gt;        &lt;archive&gt;            &lt;manifest&gt;                &lt;addClasspath&gt;true&lt;/addClasspath&gt;                &lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt;                &lt;mainClass&gt;cn.howardliu.effectjava.rename.TaskRunner&lt;/mainClass&gt;            &lt;/manifest&gt;        &lt;/archive&gt;    &lt;/configuration&gt;    &lt;executions&gt;        &lt;execution&gt;            &lt;id&gt;make-assembly&lt;/id&gt;            &lt;phase&gt;package&lt;/phase&gt;            &lt;goals&gt;                &lt;goal&gt;assembly&lt;/goal&gt;            &lt;/goals&gt;        &lt;/execution&gt;    &lt;/executions&gt;&lt;/plugin&gt;</code></pre><p>å¹²å®Œï¼Œæ‰‹å·¥ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»é›¶å¼€å§‹å®ç°åˆ¶ä½œä¸€ä¸ªç½‘ç»œå°å·¥å…·ï¼Œå®ç°ç™¾åº¦ç½‘ç›˜æ–‡ä»¶çš„æ‰¹é‡é‡å‘½åã€‚è¿™ä¸ªå·¥å…·æ˜¯è¿™ç±»å·¥å…·çš„ä¸€ä¸ªä»£è¡¨ï¼Œåªè¦æ˜¯ç½‘ç»œåº”ç”¨ï¼Œå­˜åœ¨ http è¯·æ±‚ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡è¿™ç±»æ–¹å¼å®ç°ç½‘ç»œå°å·¥å…·ã€‚</p><p>å¦‚æœæƒ³è¦è·å–æºç ï¼Œå…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤â€œjavaâ€è·å–æºç ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1841595569366974465#wechat_redirect" target="_blank" rel="noopener">SpringBoot å®æˆ˜ç³»åˆ—</a></li><li><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1732392238946533378#wechat_redirect" target="_blank" rel="noopener">Java è¿›é˜¶ç³»åˆ—</a></li><li><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=2051833877391818754#wechat_redirect" target="_blank" rel="noopener">å¾®æœåŠ¡æ¶æ„è®¾è®¡</a></li><li><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI4OTU5NTA1Ng==&action=getalbum&album_id=1750195552933199874#wechat_redirect" target="_blank" rel="noopener">ä¸€ä¸ªæ¶æ„å¸ˆçš„ç´ å…»ä¿®ç‚¼</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/effective-java-tools-batch-rename-baiduwangpan/">çœ‹å±±èŠ Javaï¼šä»é›¶å®ç°â€œç™¾åº¦ç½‘ç›˜æ‰¹é‡é‡å‘½åâ€å·¥å…·</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/121392246" target="_blank" rel="noopener">çœ‹å±±èŠ Javaï¼šä»é›¶å®ç°â€œç™¾åº¦ç½‘ç›˜æ‰¹é‡é‡å‘½åâ€å·¥å…·</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      å·¥å…·çš„å‘æ˜èƒ½å¤ŸèŠ‚çœä½“åŠ›ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‡å°‘é‡å¤åŠ³åŠ¨ï¼Œè½¯ä»¶ä¹Ÿæ˜¯å·¥å…·çš„ä¸€ç§ã€‚ä»Šå¤©è¦è¯´çš„æ˜¯ï¼Œå¼•ç”¨ IT æŠ€æœ¯ï¼Œå‡å°‘å¤§é‡æ–‡ä»¶é‡å‘½åè¿™ç§é‡å¤çš„åŠ³åŠ¨ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Effective Java" scheme="https://www.howardliu.cn/tags/Effective-Java/"/>
    
      <category term="å·¥å…·" scheme="https://www.howardliu.cn/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶</title>
    <link href="https://www.howardliu.cn/springboot-action-classpath-file-access/"/>
    <id>https://www.howardliu.cn/springboot-action-classpath-file-access/</id>
    <published>2021-10-24T02:34:08.000Z</published>
    <updated>2021-10-24T02:34:08.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20211024104517.jpeg" alt="SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶å†…å®¹"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/anramb-20789083/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6137612" target="_blank" rel="noopener">Marna Buys</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6137612" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>æœ¬æ–‡èŠä¸€èŠåœ¨ SpringBoot åº”ç”¨ä¸­ï¼Œè®¿é—®åŠ è½½ç±»è·¯å¾„ï¼ˆclasspathï¼‰ä¸­çš„æ–‡ä»¶å†…å®¹çš„å¤šç§æ–¹æ³•ã€‚</p><a id="more"></a><h2 id="é€šè¿‡Resourceæ¥å£"><a href="#é€šè¿‡Resourceæ¥å£" class="headerlink" title="é€šè¿‡Resourceæ¥å£"></a>é€šè¿‡<code>Resource</code>æ¥å£</h2><p><code>Resource</code>æ¥å£æŠ½è±¡å‡ºä¸€ç§æ›´åº•å±‚çš„æ–¹å¼ç®¡ç†èµ„æºï¼Œå¯ä»¥å®ç°é€šè¿‡ç»Ÿä¸€çš„æ–¹å¼å¤„ç†å„ç±»æ–‡ä»¶èµ„æºã€‚ä¸‹é¢æ˜¯å‡ ç§è·å–èµ„æºå®ä¾‹çš„æ–¹æ³•ã€‚</p><h3 id="æ‰‹åŠ¨åŠ è½½"><a href="#æ‰‹åŠ¨åŠ è½½" class="headerlink" title="æ‰‹åŠ¨åŠ è½½"></a>æ‰‹åŠ¨åŠ è½½</h3><p>è®¿é—®ç±»è·¯å¾„ä¸­çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>ClassPathResource</code>åŠ è½½å†…å®¹ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">new ClassPathResource(&quot;data/resource-data.txt&quot;);</code></pre><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ClassPathResource</code>ä¼šåœ¨çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å’Œé»˜è®¤ç³»ç»Ÿç±»åŠ è½½å™¨ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œä»¥åˆ é™¤æ ·æ¿æ–‡ä»¶ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®šç±»åŠ è½½å™¨ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">new ClassPathResource(&quot;data/resource-data.txt&quot;, this.getClass().getClassLoader());</code></pre><p>æˆ–è€…æ˜¯é€šè¿‡æŒ‡å®šç±»çš„ç±»åŠ è½½å™¨ï¼š</p><pre><code class="java">new ClassPathResource(&quot;data/resource-data.txt&quot;, Employee.class.getClassLoader());</code></pre><p>ä»<code>Resource</code>å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å°†å…¶è½¬æ¢ä¸º<code>InputStream</code>æˆ–<code>File</code>å¯¹è±¡ã€‚</p><p>ä¸Šé¢è¯´çš„æ–¹å¼éƒ½æ˜¯ç›¸å¯¹äºç±»è·¯å¾„çš„åœ°å€ã€‚å¦‚æœæƒ³è¦æŒ‡å®šæŸä¸ªç±»çš„ç›¸å¯¹è·¯å¾„ï¼Œæˆ‘ä»¬å’Œå¯ä»¥é€šè¿‡æŒ‡å®šå…·ä½“ç±»æ¥å®šä¹‰ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">new ClassPathResource(&quot;../../../data/resource-data.txt&quot;, Example.class).getFile();</code></pre><p>è¿™æ ·å°±æ˜¯ç›¸å¯¹äº<code>Example</code>çš„ç›¸å¯¹è·¯å¾„äº†ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸å¤ªå»ºè®®é€šè¿‡ç±»è·å–å…¶ç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶ã€‚è¿™æ ·ä¼šå°†ç±»ä¸æ–‡ä»¶çš„ç›¸å¯¹åæ ‡ç»‘å®šï¼Œå¦‚æœä¿®æ”¹äº†ç±»çš„åŒ…è·¯å¾„ï¼Œä½†æ˜¯å¿˜è®°ä¿®æ”¹æ–‡ä»¶ä½ç½®ï¼Œå°±ä¼šå‡ºç°é”™è¯¯ã€‚è€Œä¸”ï¼Œå¤§å®¶ç°åœ¨ä¸€èˆ¬æ˜¯ä½¿ç”¨ Maven ä¹‹ç±»çš„åŒ…ç®¡ç†å™¨ç®¡ç†ï¼Œå¯ä»¥ç›´æ¥åœ¨<code>resources</code>ç›®å½•ä¸­å®šä¹‰é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ç±»è·¯å¾„çš„ç›¸å¯¹åœ°å€åŠ è½½æ–‡ä»¶å³å¯ã€‚</p><h3 id="é€šè¿‡-Valueè‡ªåŠ¨è½¬æ¢"><a href="#é€šè¿‡-Valueè‡ªåŠ¨è½¬æ¢" class="headerlink" title="é€šè¿‡@Valueè‡ªåŠ¨è½¬æ¢"></a>é€šè¿‡<code>@Value</code>è‡ªåŠ¨è½¬æ¢</h3><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>@Value</code>ç›´æ¥æ³¨å…¥<code>Resource</code>å¯¹è±¡ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">@Value(&quot;classpath:data/resource-data.txt&quot;)Resource resourceFile;</code></pre><p><code>@Value</code>è¿˜èƒ½æ”¯æŒå…¶ä»–çš„åŠ è½½åè®®ï¼Œæ¯”å¦‚<code>file:</code>æˆ–<code>url:</code>ã€‚</p><h3 id="é€šè¿‡ResourceLoaderåŠ è½½"><a href="#é€šè¿‡ResourceLoaderåŠ è½½" class="headerlink" title="é€šè¿‡ResourceLoaderåŠ è½½"></a>é€šè¿‡<code>ResourceLoader</code>åŠ è½½</h3><p>æˆ‘ä»¬è¿˜èƒ½ä½¿ç”¨æ³¨å…¥<code>ResourceLoader</code>æ¥å®ç°èµ„æºçš„æ‡’åŠ è½½ï¼Œæ¯”å¦‚ï¼Œå…ˆæ³¨å…¥<code>ResourceLoader</code>å®ä¾‹ï¼š</p><pre><code class="java">@AutowiredResourceLoader resourceLoader;</code></pre><p>ç„¶ååœ¨æˆ‘ä»¬éœ€è¦çš„åœ°æ–¹ï¼Œé€šè¿‡<code>ResourceLoader</code>å®ä¾‹åŠ è½½èµ„æºï¼š</p><pre><code class="java">resourceLoader.getResource(&quot;classpath:data/resource-data.txt&quot;);</code></pre><p>åœ¨ Spring ä¸­ï¼Œ<code>ApplicationContext</code>å®ç°äº†<code>ResourceLoader</code>ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡<code>ApplicationContext</code>å®ä¾‹åŠ è½½èµ„æºï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">ApplicationContext context;public Resource loadEmployeesWithApplicationContext() {    return context.getResource(&quot;classpath:data/resource-data.txt&quot;);}</code></pre><h2 id="ä½¿ç”¨ResourceUtilsåŠ è½½èµ„æº"><a href="#ä½¿ç”¨ResourceUtilsåŠ è½½èµ„æº" class="headerlink" title="ä½¿ç”¨ResourceUtilsåŠ è½½èµ„æº"></a>ä½¿ç”¨<code>ResourceUtils</code>åŠ è½½èµ„æº</h2><p>åœ¨ Spring å†…éƒ¨ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªå·¥å…·ç±»<code>ResourceUtils</code>ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è·å–ç±»è·¯å¾„ä¸­é¢èµ„æºã€‚ä½†æ˜¯é€šè¿‡è¿™ä¸ªç±»çš„ Javadoc å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç±»ä¸»è¦æ˜¯åœ¨ Spring å†…éƒ¨ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¤ªæ¨èè¿™ç§ç”¨æ³•ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥äº†è§£ä¸€ä¸‹ï¼š</p><pre><code class="java">public File loadEmployeesWithSpringInternalClass()   throws FileNotFoundException {    return ResourceUtils.getFile(      &quot;classpath:data/resource-data.txt&quot;);}</code></pre><p>æˆ‘ä»¬å¯ä»¥äº†è§£å…¶å†…éƒ¨å®ç°ï¼Œä½†æ˜¯è¿˜æ˜¯å»ºè®®ä½¿ç”¨å…¶ä»–æ›´åŠ æ ‡å‡†çš„åšæ³•ã€‚</p><h2 id="è¯»å–èµ„æºä¸­çš„å†…å®¹"><a href="#è¯»å–èµ„æºä¸­çš„å†…å®¹" class="headerlink" title="è¯»å–èµ„æºä¸­çš„å†…å®¹"></a>è¯»å–èµ„æºä¸­çš„å†…å®¹</h2><p>ä¸Šé¢éƒ½æ˜¯é€šè¿‡å„ç§æ–¹å¼è·å–äº†<code>Resource</code>èµ„æºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±èŠèŠå¦‚æœè·å–èµ„æºå¯¹è±¡çš„æ•°æ®ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„èµ„æºæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code class="txt">ç«™ç‚¹ï¼šhttps://www.howardliu.cnä½œè€…ï¼šçœ‹å±±å…¬å·ï¼šçœ‹å±±çš„å°å±‹ (kanshanshuo)å…³æ³¨å…¬å·å¾—ç¦åˆ©ï¼šä¸çŸ¥é“å¤šå°‘ G çš„èµ„æ–™ï¼ˆç”µå­ä¹¦ã€è§†é¢‘ç­‰ç­‰ï¼‰</code></pre><h3 id="é€šè¿‡Fileå¯¹è±¡è¯»å–"><a href="#é€šè¿‡Fileå¯¹è±¡è¯»å–" class="headerlink" title="é€šè¿‡Fileå¯¹è±¡è¯»å–"></a>é€šè¿‡<code>File</code>å¯¹è±¡è¯»å–</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>getFile</code>æ–¹æ³•å¾—åˆ°<code>File</code>å®ä¾‹ï¼Œå°±å¯ä»¥ç”¨è¯»å–<code>File</code>å¯¹è±¡çš„æ–¹å¼è¯»å–æ–‡ä»¶äº†ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">@TestFile resource = new ClassPathResource(&quot;data/resource-data.txt&quot;).getFile();String content = new String(Files.readAllBytes(resource.toPath()));</code></pre><p>ä½†æ˜¯è¿™ç§æ–¹å¼ä¸é€‚ç”¨äºè¯»å– jar åŒ…ä¸­çš„æ–‡ä»¶ï¼Œé‰´äºç°åœ¨å¾ˆå¤šåº”ç”¨éƒ½æ˜¯é€šè¿‡ FatJar æ–¹å¼éƒ¨ç½²ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰¾æ‰¾å…¶ä»–æ–¹å¼ã€‚</p><h3 id="é€šè¿‡InputStreamå¯¹è±¡è¯»å–"><a href="#é€šè¿‡InputStreamå¯¹è±¡è¯»å–" class="headerlink" title="é€šè¿‡InputStreamå¯¹è±¡è¯»å–"></a>é€šè¿‡<code>InputStream</code>å¯¹è±¡è¯»å–</h3><p><code>File</code>å¯¹è±¡ä¸é€‚åˆ jar åŒ…ä¸­èµ„æºè¯»å–çš„åŸå› åœ¨äºæ–‡ä»¶è·¯å¾„æ ¼å¼ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†èµ„æºå†…å®¹è¯»å–ä¸ºæµçš„å½¢å¼ï¼Œè¿™æ ·å°±æ²¡æœ‰æ–‡ä»¶è·¯å¾„çš„é—®é¢˜äº†ã€‚æ¯”å¦‚ï¼š</p><pre><code class="java">InputStream resource = new ClassPathResource(&quot;data/resource-data.txt&quot;).getInputStream();try (BufferedReader reader = new BufferedReader(new InputStreamReader(resource))) {    String content = reader.lines().collect(Collectors.joining(&quot;\n&quot;));}</code></pre><p>è¯»å–å®Œæ¯•ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»åŠ è½½èµ„æºã€è¯»å–å†…å®¹ä¸¤ä¸ªæ–¹æ³•è®²è§£ï¼Œç»™å‡ºäº†å¤šç§è¯»å–æ–¹å¼ã€‚</p><p>ã€ŠSpringBoot å®æˆ˜ã€‹æ˜¯ä¸€ä¸ªç³»åˆ—ï¼Œæˆ‘ä¼šé€šè¿‡å®æˆ˜+åŸç†çš„æ–¹å¼å®Œæ•´æ•´ä¸ªä¸“æ ï¼Œå¯ä»¥å…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤ spring è·å–æºç ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response/">SpringBoot å®æˆ˜ï¼šä¸€æ‹›å®ç°ç»“æœçš„ä¼˜é›…å“åº”</a></li><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response-exception/">SpringBoot å®æˆ˜ï¼šå¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸</a></li><li><a href="https://www.howardliu.cn/spring-beanpostprocessor/">SpringBoot å®æˆ˜ï¼šé€šè¿‡ BeanPostProcessor åŠ¨æ€æ³¨å…¥ ID ç”Ÿæˆå™¨</a></li><li><a href="https://www.howardliu.cn/spring-request-recorder/">SpringBoot å®æˆ˜ï¼šè‡ªå®šä¹‰ Filter ä¼˜é›…è·å–è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœ</a></li><li><a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></li><li><a href="https://www.howardliu.cn/springboot-action-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/springboot-action-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120930968" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡èŠä¸€èŠåœ¨ SpringBoot åº”ç”¨ä¸­ï¼Œè®¿é—®åŠ è½½ç±»è·¯å¾„ï¼ˆclasspathï¼‰ä¸­çš„æ–‡ä»¶å†…å®¹çš„å¤šç§æ–¹æ³•ã€‚
    
    </summary>
    
    
      <category term="spring" scheme="https://www.howardliu.cn/categories/spring/"/>
    
    
      <category term="SpringBoot å®æˆ˜" scheme="https://www.howardliu.cn/tags/SpringBoot-%E5%AE%9E%E6%88%98/"/>
    
      <category term="Spring" scheme="https://www.howardliu.cn/tags/Spring/"/>
    
      <category term="SpringBoot" scheme="https://www.howardliu.cn/tags/SpringBoot/"/>
    
      <category term="Resource" scheme="https://www.howardliu.cn/tags/Resource/"/>
    
      <category term="InputStream" scheme="https://www.howardliu.cn/tags/InputStream/"/>
    
      <category term="File" scheme="https://www.howardliu.cn/tags/File/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘ä»¬å¦‚ä½•æ‹¿åˆ°è‡ªå·±æ»¡æ„çš„è–ªèµ„å‘¢ï¼Ÿè¿™äº›å¥—è·¯è¿˜æ˜¯éœ€è¦æŒæ¡çš„</title>
    <link href="https://www.howardliu.cn/we-should-know-when-changing-job/"/>
    <id>https://www.howardliu.cn/we-should-know-when-changing-job/</id>
    <published>2021-10-20T15:04:14.000Z</published>
    <updated>2021-10-20T15:04:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20211020230809.jpeg" alt="æˆ‘ä»¬å¦‚ä½•æ‹¿åˆ°è‡ªå·±æ»¡æ„çš„è–ªèµ„å‘¢ï¼Ÿè¿™äº›å¥—è·¯è¿˜æ˜¯éœ€è¦æŒæ¡çš„"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/eddiekphoto-23547624/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6680642" target="_blank" rel="noopener">Eddie K</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6680642" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å®åŠ›è¦æœ‰ï¼ŒæŠ€å·§ä¹Ÿè¦æœ‰ã€‚æˆ‘ä¸æ˜¯æ•™ä½ è¯ˆï¼Œè€Œæ˜¯æœ‰äº›æŠ€å·§ä½ éœ€è¦äº†è§£ã€‚</p><a id="more"></a><h2 id="å®šå¥½ç›®æ ‡å¾ˆé‡è¦"><a href="#å®šå¥½ç›®æ ‡å¾ˆé‡è¦" class="headerlink" title="å®šå¥½ç›®æ ‡å¾ˆé‡è¦"></a>å®šå¥½ç›®æ ‡å¾ˆé‡è¦</h2><p>æ—¢ç„¶æ˜¯è°ˆè–ªï¼Œé‚£å°±å¾—æœ‰è‡ªå·±çš„ä¸€ä¸ªæœŸæœ›è–ªèµ„ï¼Œè¿™ä¸ªæœŸæœ›è–ªèµ„ä¸æ˜¯æ‹è„‘è¢‹æƒ³å‡ºæ¥çš„ï¼Œè€Œæ˜¯éœ€è¦æœ‰ä¾æ®çš„ã€‚</p><p>è¯´åˆ°æ‹è„‘è¢‹ä¸€è¯ï¼Œå›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯åœ¨å·¥ä½œä¸­ç»å¸¸åæ§½ï¼Œâ€œé¢†å¯¼çš„æŸäº›æƒ³æ³•æ˜¯æ‹è„‘è¢‹æƒ³å‡ºæ¥çš„â€ã€‚è½®åˆ°æˆ‘ä»¬è‡ªå·±åšé‡å¤§å†³ç­–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯å¦åšåˆ°æœ‰ç†æœ‰æ®çš„ç†æ€§å¤„ç†å‘¢ï¼Ÿè¦æ±‚åˆ«äººæ€»æ˜¯å®¹æ˜“çš„ï¼Œè¦æ±‚è‡ªå·±è¿˜æ˜¯éœ€è¦ä¸€äº›åŠªåŠ›ã€‚</p><p>æ‰¯è¿œäº†ï¼Œç»§ç»­èŠè–ªèµ„ã€‚</p><h3 id="å…ˆè¦æ˜ç¡®è‡ªå·±å¿ƒæ„"><a href="#å…ˆè¦æ˜ç¡®è‡ªå·±å¿ƒæ„" class="headerlink" title="å…ˆè¦æ˜ç¡®è‡ªå·±å¿ƒæ„"></a>å…ˆè¦æ˜ç¡®è‡ªå·±å¿ƒæ„</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦ç¡®å®šç›®æ ‡æ”¶ç›Šã€‚è¿™ä¸ªæ”¶ç›ŠåŒ…æ‹¬è–ªèµ„ã€å…¬å¸ç¦åˆ©ã€ç¤¾ä¼šå£°èª‰ã€è‡ªä¸»æ—¶é—´ç­‰ä¸€äº›åˆ—çš„å› ç´ ã€‚</p><p>ç›®å‰ç¤¾ä¼šå‘å±•åŸºæœ¬ä¸Šå¯ä»¥è¾¾åˆ°é›¶è¾¹é™…æˆæœ¬ï¼Œç®€å•çš„è¯´å°±æ˜¯åˆ†å·¥æ˜ç¡®ã€‚åˆ†å·¥è¶Šæ˜¯æ˜ç¡®ï¼ŒæŸå²—ä½çš„æ”¶ç›Šæ€»å’Œä¸ä¼šå·®å¤ªå¤šã€‚æ¯”å¦‚ï¼ŒåŒæ˜¯ç ”å‘å²—ï¼Œäº’è”ç½‘å…¬å¸çš„è–ªèµ„æ™®éé«˜äºå›½ä¼ï¼Œä½†æ˜¯å…¶ä»–æ–¹é¢ï¼Œå›½ä¼ç›´æ¥ç¢¾å‹äº’è”ç½‘ã€‚äº’è”ç½‘è–ªèµ„é«˜ï¼Œä½†æ™®éè¦æ±‚ 996ï¼Œæœ‰æ—¶ç”šè‡³ 007ï¼Œåˆ°å“ªéƒ½å¾—èƒŒç€ç”µè„‘ï¼Œéšæ—¶åœ¨çº¿è§£å†³é—®é¢˜ã€‚å›½ä¼è–ªèµ„ç›¸å¯¹ä½ä¸€äº›ï¼Œä½†æ˜¯ç¦åˆ©å¾…é‡å¥½ï¼Œäººæ–‡å…³æ€€å¤šï¼Œå·¥ä½œæ—¶é—´åŸºæœ¬ä¸Šå¯ä»¥ä¿è¯ 965ï¼Œå‡ºå»ç©ä¸éœ€è¦å¸¦ç”µè„‘ï¼Œç¢°åˆ°é—®é¢˜èµ°æµç¨‹ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“è‡ªå·±æƒ³è¦ä»€ä¹ˆã€‚å…¨éƒ½è¦çš„å²—ä½ä¸æ˜¯æ²¡æœ‰ï¼Œè€Œæ˜¯å¤ªå°‘ï¼Œéœ€è¦æ‚é‡ä¸‹è‡ªå·±æ˜¯å¦å¤Ÿåˆ†é‡ã€‚</p><p>æ‰€ä»¥ï¼Œä¸–é—´å“ªå¾—åŒå…¨æ³•ï¼Œæ€»ä¼šæœ‰ä¸€äº›å–èˆã€‚åœ¨äº’è”ç½‘å…¬å¸ç¾¡æ…•å›½ä¼çš„æ—¶é—´è‡ªç”±ï¼Œåœ¨å›½ä¼åˆæƒ³è¦äº’è”ç½‘çš„é«˜è–ªã€‚äº‹ä¹‹ä¸å¦‚æ„åä¹‹å…«ä¹ï¼Œæƒ³æ¸…æ¥šç°åœ¨è¦çš„æ˜¯ä»€ä¹ˆï¼Œåˆ«åšå›´åŸä¸­çš„äººã€‚</p><p>æƒ³æ¸…æ¥šä¹‹åï¼Œå°±éœ€è¦ç¡®å®šç¬¦åˆè¿™ä¸ªæœŸæœ›çš„å…¬å¸èŒƒå›´ã€‚æ‰¾åˆ°è¿™äº›å…¬å¸çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼ŒæŸæ­Œæœã€æŸçœ¼æŸ¥ã€äº²æœ‹å¥½å‹æ‰“å¬ã€åŒå­¦åŒè¡Œå’¨è¯¢ã€‚è¿™äº›ä¿¡æ¯ä¼šæ¯”è¾ƒåºæ‚ï¼Œéœ€è¦ç­›é€‰å…¶ä¸­çš„æœ‰æ•ˆä¿¡æ¯ï¼Œæœ€å¥½æ˜¯èƒ½å¤Ÿæ‰¾åˆ°å®¢è§‚ä¿¡æ¯ã€‚ä¾é è¿™äº›ï¼Œå¯ä»¥æŠŠç›®æ ‡å…¬å¸åˆ†æˆå‡ ç±»ï¼š</p><ol><li>ç‰¹åˆ«æƒ³å»</li><li>æƒ³å»</li><li>ä¸å¤ªæƒ³å»</li><li>æ‰“æ­»ä¹Ÿä¸å»</li></ol><p>ç„¶åçœ‹çœ‹è¿™äº›å…¬å¸å²—ä½è¦æ±‚ï¼Œè¿™ä¸ªæ¯”è¾ƒå®¹æ˜“äº†ï¼Œä»æ‹›è˜ç½‘ç«™æ‰¾å°±è¡Œã€‚ç„¶åæ ¹æ®æ‹¿è‡ªå·±æ¡ä»¶ä¸ä¹‹åŒ¹é…ï¼Œåˆèƒ½æœ‰å‡ ç§æƒ…å†µï¼š</p><ol><li>å®Œå…¨ä¸è¾¾æ ‡</li><li>ç°åœ¨ä¸è¾¾æ ‡</li><li>è¾¾æ ‡</li></ol><p><img src="https://static.howardliu.cn/20211021081537.png" alt="èƒ½åŠ›åŒ¹é…æ¨¡å‹"></p><p>æ‹¿å…¬å¸åˆ†ç»„ä¸è‡ªå·±çš„èƒ½åŠ›åˆ†ç»„åšåŒ¹é…ï¼Œå¯ä»¥æ‰¾åˆ°æ¯”è¾ƒé€‚åˆçš„å…¬å¸æˆ–å²—ä½ã€‚</p><h3 id="å†è¦è¯„å®šå¸‚åœºä»·æ ¼"><a href="#å†è¦è¯„å®šå¸‚åœºä»·æ ¼" class="headerlink" title="å†è¦è¯„å®šå¸‚åœºä»·æ ¼"></a>å†è¦è¯„å®šå¸‚åœºä»·æ ¼</h3><p>ç¡®å®šäº†ç›®æ ‡å…¬å¸æˆ–è€…ç›®æ ‡å²—ä½ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦ææ¸…æ¥šå¯¹åº”çš„è–ªèµ„èŒƒå›´äº†ã€‚</p><p>ä¹‹æ‰€ä»¥åªèƒ½ææ¸…æ¥šèŒƒå›´ï¼Œæ˜¯å› ä¸ºå¤§éƒ¨åˆ†å…¬å¸éƒ½æ˜¯å¯†è–ªï¼Œæ˜æ–‡è§„å®šä¸¥ç¦åŒäº‹ä¹‹é—´è®¨è®ºè–ªèµ„ï¼Œç§ä¸‹è®¨è®ºçš„æƒ…å†µä¹Ÿå­˜åœ¨ï¼Œå¦‚æœä¸æ˜¯éå¸¸è¦å¥½çš„æœ‹å‹ï¼Œä½ åˆæ€çŸ¥ä»–è¯´çš„æ˜¯å¦æœ‰æ°´åˆ†ã€‚è¿˜ä¸€ä¸ªåŸå› ï¼Œè–ªèµ„ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œå·¥èµ„ã€å¹´ç»ˆå¥–ã€äº”é™©ä¸€é‡‘ã€æœŸæƒã€è‚¡ç¥¨ã€è¿‡èŠ‚è´¹ã€æˆ¿è¡¥ã€é¤è¡¥ã€åŠ ç­è´¹â€¦â€¦æ‰€ä»¥èƒ½å¤Ÿäº†è§£ä¸€ä¸ªèŒƒå›´ï¼Œå°±å·²ç»å¾ˆå¥½äº†ã€‚</p><p><img src="https://static.howardliu.cn/20211021081836.jpeg" alt="å†è¦è¯„å®šå¸‚åœºä»·æ ¼"></p><p>ä¸€èˆ¬æœ‰ä¸‹é¢å‡ ç§æ–¹å¼ï¼š</p><ol><li>å’¨è¯¢å‰åŒäº‹ã€‚å¦‚æœæœ‰ä¸€ä¸ªæ°å¥½åˆšè·³æ§½çš„åŒäº‹ï¼Œä»–è·³æ§½çš„å…¬å¸æ­£å¥½æ˜¯ä½ ç›®æ ‡å…¬å¸æˆ–è€…åŒç±»å…¬å¸ï¼Œé‚£å°±å¯ä»¥é—®ä»–äº†ï¼Œçº¦å‡ºæ¥æ’¸ä¸²åƒé¥­ï¼Œå‡ æ¯é…’ä¸‹è‚šï¼Œå¤§å®¶å°±æ˜¯å…„å¼Ÿã€‚è€Œä¸”è¿˜èƒ½èŠèŠåŸæ¥çš„è–ªèµ„ï¼Œå¦‚æœèŠå¾—å¥½ï¼Œè¿˜èƒ½çŸ¥é“å…¶ä»–åŒäº‹çš„è–ªèµ„ã€‚</li><li>æŸè„‰èŒè¨€æŒ–æ˜ä¿¡æ¯ã€‚ç›´æ¥æ‰¾åœ¨æŸè„‰çš„èŒè¨€é¢‘é“æ‰¾äººé—®ï¼Œæ€»ä¼šæ‰¾åˆ°é‚£ç§å–œæ¬¢èŠå¤©çš„è€¿ç›´ boyã€‚å¤šèŠå‡ ä¸ªï¼ŒèŠèŠåŸºæœ¬å·¥èµ„ï¼ŒèŠèŠå¹´ç»ˆå¥–ï¼ŒæœŸæƒå’Œè‚¡ç¥¨ä¼°è®¡æ˜¯é—®ä¸åˆ°äº†ã€‚</li><li>æŸè˜æ‰¾èŒä½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ‹›è˜å¹³å°å‘å¸ƒçš„èŒä½ä¿¡æ¯ï¼Œéƒ½æ˜¯æ ‡ç€è–ªèµ„é¢è®®ã€‚æœ‰çš„çŒå¤´å‘çš„èŒä½ä¼šæ ‡æ³¨è–ªèµ„èŒƒå›´ï¼Œå¯ä»¥ä½œä¸ºåˆ¤å®šä¾æ®ã€‚å¤šæ‰¾ä¸€äº›ç›¸ä¼¼å²—ä½ã€ç›¸ä¼¼é‡çº§çš„å…¬å¸å¯¹æ¯”ï¼Œé€šè¿‡å–äº¤é›†çš„æ–¹å¼ï¼Œèƒ½å¤Ÿç­›é€‰å‡ºä¸€ä¸ªå¤§æ¦‚çš„æ•°æ®èŒƒå›´ã€‚</li><li>æ ¹æ®è‡ªèº«è–ªèµ„å®šä½ã€‚å¦‚æœå‡†å¤‡æ˜¯ä»äº’è”ç½‘è·³äº’è”ç½‘ï¼Œæ¯”è¾ƒå¥½çš„æ˜¯å¯ä»¥æ ¹æ®è‡ªå·±çš„è–ªèµ„åšåˆ¤æ–­ã€‚ç›®å‰å¾ˆå¤šäººè–ªèµ„æ¶¨å¹…æ¯”ä¾‹æ˜¯ 20%ï¼Œèƒ½å¤Ÿè¾¾åˆ° 50%çš„å°±æ¯”è¾ƒå°‘äº†ï¼Œç›´æ¥æ¶¨å¹… 100%å°±æ›´å°‘äº†ã€‚è¿™ä¸ªæ¶¨å¹…æŒ‡çš„æ˜¯å·¥èµ„ï¼Œå…¶ä»–æ–¹é¢çš„æ¶¨å¹…å°±çœ‹ä¸ªäººäº†ã€‚</li></ol><p>æ˜ç¡®äº†å¿ƒæ„ï¼Œç¡®å®šäº†è–ªèµ„èŒƒå›´ã€‚é‚£å°±éœ€è¦ç»™è‡ªå·±å®šä¸€ä¸ªæ¯”è¾ƒé è°±çš„ç›®æ ‡äº†ï¼Œæ¯”å¦‚ï¼Œç›®æ ‡å…¬å¸æ˜¯ä»€ä¹ˆï¼ŒæœŸæœ›è–ªèµ„æ˜¯å¤šå°‘ï¼Œå‡†å¤‡äº‰å–å“ªç§å²—ä½ã€‚</p><h2 id="æŠ•é€’ç®€å†æ‰¾å‡†è·¯"><a href="#æŠ•é€’ç®€å†æ‰¾å‡†è·¯" class="headerlink" title="æŠ•é€’ç®€å†æ‰¾å‡†è·¯"></a>æŠ•é€’ç®€å†æ‰¾å‡†è·¯</h2><p>æ‰¾åˆ°å¿ƒä»ªçš„å…¬å¸ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æŠ•é€’ç®€å†ã€‚è¿™é‡Œä¼šæœ‰å‡ ç§æ“ä½œï¼š</p><ol><li>ç›´æ¥æŠ•é€’æ‹›è˜ä¿¡æ¯</li><li>æ‰¾æœ‹å‹å†…æ¨</li><li>è”ç³»çŒå¤´</li></ol><h3 id="è‡ªå·±æ•²é—¨æè´¹æ—¶"><a href="#è‡ªå·±æ•²é—¨æè´¹æ—¶" class="headerlink" title="è‡ªå·±æ•²é—¨æè´¹æ—¶"></a>è‡ªå·±æ•²é—¨æè´¹æ—¶</h3><p>åˆšæ¯•ä¸šæˆ–è€…å·¥ä½œ 1-3 å¹´çš„ï¼Œéƒ½ä¼šåœ¨æ‹›è˜ç½‘ç«™æ‰¾å·¥ä½œã€‚è¿™ä¸ªæ—¶å€™è‡ªå·±çš„å±¥å†ä¸€èˆ¬ï¼Œæ²¡æœ‰èƒ½å¤Ÿå¾ˆå¸å¼•äººçš„åœ°æ–¹ï¼ŒæŒ‚åœ¨ç½‘ä¸Šå¾ˆä¹…éƒ½ä¸ä¼šæœ‰äººçœ‹ï¼Œä¸»åŠ¨æŠ•é€’ä¹Ÿä¼šè¢«å¡è„–å­ã€‚å¦‚æœæœ‰å²—ä½æ¯”è¾ƒæ€¥çš„ï¼Œä»ç­›é€‰ç®€å†åˆ°é¢è¯•ä¼šè¿›è¡Œçš„å¾ˆå¿«ï¼Œå¦åˆ™å°±ç›´æ¥è¿›äººæ‰åº“ã€‚è¿™å°±æ˜¯å–æ–¹å¸‚åœºã€‚</p><p>3-5 å¹´ï¼Œä¼šå‡ºç°ç¬¬ä¸€ä¸ªåˆ†æ°´å²­ï¼Œæœ‰çš„äººç®€å†ä¸€æ—¦æŒ‚ä¸Šå»ï¼Œå°±ä¼šå¾ˆå¤šäººæ‰¾è¿‡æ¥ï¼›æœ‰çš„äººå´æ˜¯æ— äººé—®æ´¥ã€‚ç¬¬ä¸€ç§ï¼Œéšç€å·¥ä½œçš„æ·±å…¥ï¼Œç»å†çš„é¡¹ç›®å¤šäº†ï¼Œèƒ½åŠ›æœ‰äº†å¾ˆå¤§çš„æå‡ï¼Œæˆä¸ºäº†å¤§å®¶éƒ½å–œæ¬¢çš„é¦™é¥½é¥½ã€‚ç¬¬äºŒç§ï¼Œ5 å¹´å·¥ä½œ 1 å¹´ç»éªŒï¼Œä¸€ç›´åœ¨åšé‡å¤çš„å·¥ä½œï¼Œæ²¡æœ‰ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œåšçš„é¡¹ç›®ä¹Ÿéƒ½æ‹¿ä¸å‡ºæ‰‹ã€‚å¸‚åœºä¸ç¼ºæ™®é€šå·¥ï¼Œç¼ºçš„æ˜¯é«˜çº§å·¥ã€‚</p><p><img src="https://static.howardliu.cn/20211021081940.jpeg" alt="æŠ•é€’ç®€å†æ‰¾å‡†è·¯"></p><p>å› æ­¤ï¼Œç»™ 3-5 å¹´çš„å°ä¼™ä¼´ä¸€ä¸ªå»ºè®®ï¼Œä¸è¦è™šåº¦å…‰é˜´ï¼Œç°åœ¨çš„ä½ å·²ç»èƒ½å¤Ÿèƒœä»»å¤§éƒ¨åˆ†å·¥ä½œï¼Œé‚£å°±å»æŒ‘æˆ˜æ›´æœ‰éš¾åº¦çš„å·¥ä½œã€‚èµ°å¹³è·¯ç”šè‡³èµ°ä¸‹å¡è·¯æ˜¯æœ€çœäº‹çš„ï¼Œå‘ä¸Šæ”€çˆ¬æ˜¯è¾›è‹¦çš„ï¼Œâ€œä¸–ä¹‹å¥‡ä¼Ÿã€ç‘°æ€ªï¼Œéå¸¸ä¹‹è§‚ï¼Œå¸¸åœ¨äºé™©è¿œâ€ï¼Œä¸è¦åªæ˜¯ç¾¡æ…•åˆ«äººçœ‹åˆ°äº†ç¾ä¸½çš„é£æ™¯ï¼Œè‡ªå·±ä¹Ÿä¸Šå»çœ‹çœ‹ã€‚</p><p>5-10 å¹´åŠä»¥åï¼Œè‡ªå·±åˆ·ç®€å†æ‰¾å·¥ä½œæ¯”è¾ƒå°‘äº†ï¼Œä¸€èˆ¬ä¼šå€ŸåŠ©ç†Ÿäººå†…æ¨æˆ–è€…é€šè¿‡çŒå¤´äº†ã€‚</p><h3 id="ç†Ÿäººå†…æ¨æŒºé è°±"><a href="#ç†Ÿäººå†…æ¨æŒºé è°±" class="headerlink" title="ç†Ÿäººå†…æ¨æŒºé è°±"></a>ç†Ÿäººå†…æ¨æŒºé è°±</h3><p>ç†Ÿäººå†…æ¨æ˜¯æ¯”è¾ƒæ¨å´‡çš„ä¸€ç§ï¼Œé€‚åˆ 3 å¹´ä»¥åçš„åŒå­¦ã€‚ä¸€èˆ¬å…¬å¸éƒ½ä¼šé¼“åŠ±å†…æ¨ï¼Œç†ç”±æ˜¯â€œç‰©ä»¥ç±»èšäººä»¥ç¾¤åˆ†â€ï¼Œä¼˜ç§€çš„äººå‘¨å›´ä¸€èˆ¬ä¹Ÿæ˜¯ä¼˜ç§€çš„äººï¼Œæœ‰å¾ˆå¤§æ¦‚ç‡ï¼Œè¢«å†…æ¨çš„äººä¹Ÿæ˜¯èƒ½å¤Ÿèƒœä»»å·¥ä½œçš„ã€‚è€Œä¸”ï¼Œä¸ºäº†é¼“åŠ±æœ¬å…¬å¸å†…æ¨ï¼Œå¸®ç€å…¬å¸æŒ–äººï¼Œè¿˜è®¾ç½®äº†å†…æ¨å¥–ä¹‹ç±»çš„ã€‚</p><p>å‰å‡ å¹´æœ‰å¥è¯æ¯”è¾ƒæµè¡Œâ€œèŠ±è‹¥ç››å¼€ï¼Œè´è¶è‡ªæ¥â€ã€‚ä½ æ˜¯ä»€ä¹ˆæ ·çš„äººï¼Œå†³å®šäº†ä½ å‘¨å›´äººçš„æ ·å­ï¼ŒåŒæ ·çš„ï¼Œä½ å‘¨å›´æ˜¯ä»€ä¹ˆäººï¼Œä¹Ÿå†³å®šäº†ä½ çš„æ ·å­ã€‚æˆ‘ä»¬éƒ½ç”Ÿæ´»åœ¨ç¤¾ä¼šä¸­ï¼Œæ¯å¤©ä¸å¾ˆå¤šäººæ“¦è‚©è€Œè¿‡ï¼Œä¸å¾ˆå¤šäººåä½œå…±äº‹ï¼Œæˆ‘ä»¬æ‰€æ•£å‘çš„èƒ½é‡ï¼Œä¼šå¸å¼•ç›¸åŒé¢‘ç‡çš„äººã€‚ä¸è¦å»å¦„å›¾ç»“äº¤å¤§ä½¬ï¼ŒåŠ äº†å¾®ä¿¡å¥½å‹ï¼Œå¯èƒ½åªæ˜¯å¯¹æ–¹çš„å°å·ï¼Œäº¦æˆ–æ˜¯ç›´æ¥è¢«æ”¶è¿›æŸä¸ªç¾¤ç»„ã€æ‰“ä¸ŠæŸä¸ªæ ‡ç­¾ã€‚å½“è‡ªå·±æˆä¸ºäº†å¤§ä½¬ï¼Œä»–è‡ªç„¶ä¼šæ˜¯ä½ çš„æœ‹å‹ã€‚</p><p><img src="https://static.howardliu.cn/20211021082245.jpeg" alt="ç†Ÿäººå†…æ¨æŒºé è°±"></p><blockquote><p>è¯è¯´æƒ³è¦å†…æ¨çš„å¯ä»¥åå°ç•™è¨€ç»†èŠ</p></blockquote><h3 id="æ‰¾æ‰¾çŒå¤´ä¹Ÿä¸é”™"><a href="#æ‰¾æ‰¾çŒå¤´ä¹Ÿä¸é”™" class="headerlink" title="æ‰¾æ‰¾çŒå¤´ä¹Ÿä¸é”™"></a>æ‰¾æ‰¾çŒå¤´ä¹Ÿä¸é”™</h3><p>æ‰¾çŒå¤´ä¹Ÿæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå½“ç„¶éœ€è¦æœ‰ä¸€å®šèƒ½åŠ›åã€‚å¦‚æœæ˜¯å°ç™½ï¼Œé‚£è¿™ä¸€å•æˆåŠŸç‡ä¸é«˜ï¼ŒçŒå¤´è‡ªç„¶ä¸ä¼šå¾ˆä¸Šå¿ƒã€‚ä½†è¿™å¹¶ä¸å¦¨ç¢å°ç™½çš„æ—¶å€™å°±åŠ ä¸€äº›çŒå¤´å¥½å‹ï¼Œä½ èƒ½å¤Ÿä»ä»–çš„æœ‹å‹åœˆä¸€äº›ä¸šå†…åŠ¨æ€ã€‚è€Œä¸”ï¼Œå¯ä»¥å‘Šè¯‰ä»–è‡ªå·±çš„ä¸‹ä¸€ä¸ªç›®æ ‡ï¼Œé—®é—®æœ‰æ²¡æœ‰ä»€ä¹ˆè¦æ±‚ï¼ˆä¸€å®šä¼šæœ‰çš„ï¼‰ï¼Œç„¶åå°±å¯ä»¥æœ‰çš„æ”¾çŸ¢çš„æœç€é‚£ä¸ªæ–¹å‘ä½¿åŠ²äº†ã€‚</p><p>è¿™é‡Œç»™çŒå¤´åŒå­¦æ­£åï¼Œä¸è¦æŠŠä»–ä»¬å½“æˆå‡æƒ³æ•Œï¼Œå…¶å®ä½ å’ŒçŒå¤´æ‰æ˜¯ä¸€ä¼™çš„ã€‚å› ä¸ºæœ€åæ‹¿ææˆæ—¶ï¼ŒçŒå¤´çš„ææˆæ˜¯æ ¹æ®ä½ çš„èŒçº§å’Œè–ªèµ„ç¡®å®šçš„ã€‚æ˜ç™½äº†å§ï¼Œåœ¨ä½ æ‹¿åˆ° offer å…¥èŒä¹‹å‰ï¼Œä»–éƒ½ä¼šå¸®ä½ å¾ˆå¤šã€‚æˆ‘è®¤è¯†å¥½å‡ ä¸ªè¿™ä¹ˆä¼˜ç§€çš„çŒå¤´ï¼Œå¦‚æœéœ€è¦å¯ä»¥åŠ æˆ‘å¾®ä¿¡ï¼Œæ¨èç»™ä½ ã€‚</p><p><img src="https://static.howardliu.cn/20211021082447.jpeg" alt="æ‰¾æ‰¾çŒå¤´ä¹Ÿä¸é”™"></p><h2 id="é¢è¯•åšå¼ˆå°å¦™æ‹›"><a href="#é¢è¯•åšå¼ˆå°å¦™æ‹›" class="headerlink" title="é¢è¯•åšå¼ˆå°å¦™æ‹›"></a>é¢è¯•åšå¼ˆå°å¦™æ‹›</h2><p>å‰é¢éƒ½åšå¥½äº†ä¹‹åï¼Œå°±è¯¥è¿›å…¥åˆ°é¢è¯•ç¯èŠ‚ï¼Œé¢è¯•å°±æ˜¯çº¯çœ‹å®åŠ›å’Œè¿æ°”çš„è¿‡ç¨‹ï¼Œæ²¡æœ‰ä»€ä¹ˆå–å·§çš„å¦™æ‹›ï¼Œåªèƒ½ç¨³æ‰ç¨³æ‰“çš„å‡†å¤‡ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œåªæœ‰æ­£å¸¸é¢è¯• ok ä¹‹åçš„è°ˆè–ªæŠ€å·§ã€‚</p><h3 id="è°ˆè–ªåšå¼ˆå…ˆé”šå®š"><a href="#è°ˆè–ªåšå¼ˆå…ˆé”šå®š" class="headerlink" title="è°ˆè–ªåšå¼ˆå…ˆé”šå®š"></a>è°ˆè–ªåšå¼ˆå…ˆé”šå®š</h3><p>æœ‰çš„é¢è¯•æŠ€å·§ä¼šå‘Šè¯‰ä½ ï¼Œè¢«é—®åˆ°æœŸæœ›è–ªèµ„çš„æ—¶å€™ï¼Œè¦è¯´ä¸€ä¸ªèŒƒå›´ï¼Œä¸è¦ç›´æ¥è¯´å›ºå®šå€¼ï¼Œè¿™æ ·ä¹Ÿèƒ½æœ‰è¿‚å›çš„ç©ºé—´ã€‚ä½†æ˜¯ï¼Œæ˜¯å¦æœ‰æƒ³è¿‡ï¼Œä½ ç»™è‡ªå·±çš„è¿‚å›ç©ºé—´ï¼Œæ°æ°è®©å¯¹æ–¹çŸ¥é“äº†ä½ çš„åº•çº¿ã€‚æ¯”å¦‚ 5000-8000ï¼Œå¯¹æ–¹ç»™å‡º 5000 çš„è–ªèµ„ï¼Œè¿™ä¸ª offer ä½ æ˜¯æ¥è¿˜æ˜¯ä¸æ¥ï¼Œæ¥äº†å¿ƒç†ä¸èˆ’æœï¼Œä¸æ¥åˆåœ¨è‡ªå·±ç»™å‡ºçš„èŒƒå›´ã€‚æ‰€ä»¥ï¼Œç›´æ¥ç»™å‡ºä¸€ä¸ªè‡ªå·±çš„æœŸæœ›å€¼ï¼Œè¿™ä¸ªå€¼æ˜¯é«˜äºä½ çš„åº•çº¿çš„ã€‚</p><p>è¿™é‡Œéœ€è¦å¼ºè°ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬æ‰€ç»™å‡ºçš„æœŸæœ›è–ªèµ„ï¼Œä¸æ˜¯æ‹è„‘è¢‹çš„ï¼Œè€Œæ˜¯æ ¹æ®å‰æœŸçš„è°ƒç ”ç»™å‡ºçš„ç›¸å¯¹åˆç†çš„è–ªèµ„ã€‚æ¯”å¦‚å¸‚åœºæ™®éçš„èŒƒå›´åœ¨ 6000-9000ï¼Œä½ ç›´æ¥è¦ 10000ã€‚è¿™æ ·ä¸ä¼šè®©å¯¹æ–¹é«˜çœ‹ä½ ï¼Œåªæ˜¯ä»ä¾§é¢å‘Šè¯‰å¯¹æ–¹ä½ ä¸æ‡‚è¡Œæƒ…ï¼Œå¯ä»¥éšæ„å¿½æ‚ ä½ äº†ã€‚</p><p>å¿ƒç†å­¦ä¸Šæœ‰ä¸ªé”šå®šæ•ˆåº”ï¼Œç®€å•çš„è¯´ï¼Œç»“æœä¼šåå‘å…ˆæå‡ºæœŸæœ›å€¼çš„ä¸€æ–¹ã€‚</p><p><img src="https://static.howardliu.cn/20211021082535.jpeg" alt="è°ˆè–ªåšå¼ˆå…ˆé”šå®š"></p><p>è¿™é‡Œå†è¯´ä¸€ä¸ªæŠ€å·§ï¼Œå°±æ˜¯å‘Šè¯‰å¯¹æ–¹æœŸæœ›è–ªèµ„ä¹‹å‰ï¼Œè¦é—®ä¸€ä¸‹é¢è¯•å…¬å¸çš„è–ªé…¬ç»“æ„ã€äº”é™©ä¸€é‡‘ç¼´çº³æƒ…å†µã€ç¦åˆ©æƒ…å†µç­‰ï¼Œæœ€å¥½åœ¨çœ‰å¤´ç´§é”ï¼Œå‡è£…è‡ªå·±æ ¸ç®—ï¼ˆçœŸçš„ç®—ä¹Ÿè¡Œï¼Œä½†è¿™éœ€è¦ä¸€å®šçš„å¿ƒç®—èƒ½åŠ›ï¼‰ï¼Œç„¶åç»™å‡ºç»“æœã€‚æ˜¯ä¸æ˜¯æ˜¾å¾—å¾ˆä¸“ä¸šï¼Œæ˜¯ä¸æ˜¯è¿™æ ·çš„ç»“æœæ›´èƒ½è®©å¯¹æ–¹ä¿¡æœã€‚</p><h3 id="å…¥èŒæ—¶é—´ç•™å‡º-buffer"><a href="#å…¥èŒæ—¶é—´ç•™å‡º-buffer" class="headerlink" title="å…¥èŒæ—¶é—´ç•™å‡º buffer"></a>å…¥èŒæ—¶é—´ç•™å‡º buffer</h3><p>æœ‰æ—¶å€™ï¼Œåœ¨æœ€ç»ˆå‘ offer å‰ï¼Œé¢è¯•å®˜ä¼šé—®å…¥èŒæ—¶é—´ã€‚å‡è®¾ä½ ç°åœ¨æ˜¯ç¦»èŒçŠ¶æ€ï¼Œéå¸¸æ€¥ç€æ‰¾å·¥ä½œï¼Œä¹Ÿä¸è¦ç›´æ¥å›ç­”éšæ—¶ï¼Œå› ä¸ºä½ ä¸å¯èƒ½éšæ—¶ã€‚æˆ‘æ‰€é¢è¯•çš„å…¬å¸ï¼Œéƒ½ä¼šåœ¨å‘ offer ä¹‹åï¼Œè¦æ±‚èƒŒè°ƒï¼Œä¸€èˆ¬ä¼šå§”æ‰˜èƒŒè°ƒå…¬å¸è¿›è¡Œï¼Œæ—¶é—´å¤§çº¦åœ¨ 2-3 å¤©ã€‚ç„¶åå…¥èŒéœ€è¦çš„æ‰‹ç»­ã€è¯ä»¶ç­‰ï¼Œå…¬å¸è¿˜éœ€è¦æå‰å‡†å¤‡ï¼Œæ‰€ä»¥å®Œå…¨ä¸å¯èƒ½ä»Šå¤©å‘ offerï¼Œæ˜å¤©å°±èƒ½å…¥èŒã€‚</p><p>å›ç­”éšæ—¶ï¼Œåªä¼šè®©é¢è¯•å®˜æ„Ÿè§‰ä½ å¾ˆç€æ€¥å…¥èŒï¼Œå¯èƒ½åœ¨è–ªèµ„ä¸Šå†å‹ä¸€å‹ã€‚è¿™é‡Œå†ç»™ HR æ­£åï¼Œå‹è–ªèµ„çš„çœŸä¸ä¸€å®šæ˜¯ HRï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä½ çš„ä¸Šçº§é¢†å¯¼ã€‚ä¸Šçº§é¢†å¯¼éœ€è¦æ§äººåŠ›æˆæœ¬ï¼ŒHR è´Ÿè´£ä½ å…¥ç¦»èŒï¼Œæ‰€ä»¥ï¼Œè°æœ€æœ‰å¯èƒ½å‹ä½ çš„å·¥èµ„å‘¢ï¼Ÿ</p><p>å¦‚æœæ˜¯åœ¨èŒï¼Œæ ‡å‡†çš„å›ç­”æ˜¯ï¼šæ”¶åˆ° offer ä¹‹åï¼Œä¼šç«‹é©¬æäº¤ç¦»èŒä¿¡æ¯ï¼Œå‡†å¤‡äº¤æ¥å·¥ä½œï¼ŒæŒ‰ç…§è§„å®šï¼Œéœ€è¦ 1 ä¸ªæœˆçš„ç¦»èŒäº¤æ¥æ—¶é—´ï¼Œæˆ‘ä¼šäº‰å–èƒ½å¤Ÿæå‰ï¼Œæ‰€ä»¥æœˆå†…å¯ä»¥åˆ°å²—ã€‚</p><p>å¦‚æœæ˜¯ç¦»èŒçŠ¶æ€ï¼Œæ ‡å‡†å›ç­”æ˜¯ï¼šæ”¶åˆ° offer ä¹‹åï¼Œä¼šå¼€å§‹ä¸ºå…¥èŒåšå‡†å¤‡ï¼ŒåŒæ—¶ä¹Ÿä¼šåè°ƒå¥½è‡ªå·±çš„æ—¶é—´ï¼Œå¦‚æœå…¬å¸æ¯”è¾ƒç€æ€¥ï¼Œå¯ä»¥ 1 å‘¨å†…åˆ°å²—ã€‚</p><h3 id="æ™‹å‡è·¯å¾„é—®æ¸…æ¥š"><a href="#æ™‹å‡è·¯å¾„é—®æ¸…æ¥š" class="headerlink" title="æ™‹å‡è·¯å¾„é—®æ¸…æ¥š"></a>æ™‹å‡è·¯å¾„é—®æ¸…æ¥š</h3><p>è¿™æ˜¯ä¸€ä¸ªå»ºè®®ï¼Œæ˜¯å¯é€‰é¡¹ã€‚é—®æƒ…å†µæ™‹å‡è·¯å¾„ã€‚æˆ‘ä»¬å·¥ä½œè¯´ç™½äº†å°±æ˜¯å‡èŒåŠ è–ªï¼Œç„¶åå®ç°è‡ªæˆ‘ä»·å€¼ã€‚å¦‚æœä¸èƒ½å‡èŒï¼Œå¾ˆæœ‰å¯èƒ½åŠ è–ªæ— æœ›ã€‚æ‰€ä»¥ï¼Œä¸€å®šè¦çŸ¥é“å‡èŒçš„è·¯å¾„ã€‚</p><p><img src="https://static.howardliu.cn/20211021082714.jpeg" alt="æ™‹å‡è·¯å¾„é—®æ¸…æ¥š"></p><p>è¯´èµ·è¿™ä¸ªï¼Œå¥‰åŠä¸€ä¸‹å°ä¼™ä¼´ï¼Œæ¢å·¥ä½œï¼Œæˆ‘ä»¬ä¸èƒ½åªè€ƒè™‘åŠ è–ªï¼Œä¸è€ƒè™‘èŒä½ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨åŸå•ä½èŒä½å·²ç»è¾¾åˆ°ä¸€å®šç­‰çº§ï¼Œç„¶åå¼€å§‹æ‰¾åˆ°ä¸€ä¸ªè–ªèµ„ä¸é”™çš„å·¥ä½œï¼Œä½†æ˜¯èŒçº§é™äº†ã€‚å¦‚æœæ˜¯ä½ ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ</p><p>æˆ‘çš„å»ºè®®æ˜¯ï¼Œå¦‚æœåŸæ¥åªæ˜¯ä¸ªå°ç»„é•¿ï¼Œé™ä¸ºæ™®é€šç»„å‘˜ï¼Œé‚£æ— å…³ç—›ç—’ï¼Œè‡ªå·±çœ‹å¿ƒæƒ…å†³å®šã€‚ä½†æ˜¯å¦‚æœåŸæ¥æ˜¯æ€»ç›‘ï¼Œé™ä¸ºå°ç»„é•¿ï¼Œå°±éœ€è¦è€ƒè™‘ä¸€ä¸‹äº†ã€‚è¿™ç§å˜åŠ¨å·®è·å¤ªå¤§ï¼Œä½ çš„è¯è¯­æƒã€å†³ç­–æƒï¼Œç”šè‡³æ˜¯ä½ æ‰€èƒ½äº§ç”Ÿçš„èƒ½é‡ï¼Œéƒ½ç¼©å°å¤ªå¤šã€‚è¿™ä¸ªæ—¶å€™ä¸æ˜¯è€ƒè™‘æ˜¯å¦è¦æ¢å·¥ä½œï¼Œè€Œæ˜¯éœ€è¦è®¤çœŸæ€è€ƒè‡ªå·±çš„å®šä½æ˜¯å¦å‡†ç¡®ã€‚æ˜¯åŸæ¥çš„èŒä½å¤ªé«˜ï¼Œè¿˜æ˜¯è‡ªå·±é¢è¯•æ—¶å€™é™å¾—å¤ªä½ï¼Ÿå¦‚æœè¿™ç‚¹æ²¡æœ‰æƒ³æ¸…æ¥šï¼Œå»ºè®®è¿˜æ˜¯ä¸è¦ä¸€æ—¶å†²åŠ¨ã€‚</p><h2 id="ç¥å›æ—©æ—¥å¿ƒè‡ªç”±"><a href="#ç¥å›æ—©æ—¥å¿ƒè‡ªç”±" class="headerlink" title="ç¥å›æ—©æ—¥å¿ƒè‡ªç”±"></a>ç¥å›æ—©æ—¥å¿ƒè‡ªç”±</h2><p>æœ€åå°±æ˜¯ç¥ç¦ï¼Œå‡èŒåŠ è–ªï¼Œæ—©æ—¥å®ç°è‡ªç”±ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/when-to-leave-your-programming-job/">ç¨‹åºå‘˜ä»€ä¹ˆæ—¶å€™è¯¥è€ƒè™‘è¾èŒ</a></li><li><a href="https://www.howardliu.cn/why-it-is-difficult-to-get-high-salaries-for-iters/">IT äººä¸ºä»€ä¹ˆéš¾ä»¥æ‹¿é«˜è–ªï¼Ÿ</a></li><li><a href="https://www.howardliu.cn/we-should-know-when-changing-job/">æˆ‘ä»¬å¦‚ä½•æ‹¿åˆ°è‡ªå·±æ»¡æ„çš„è–ªèµ„å‘¢ï¼Ÿè¿™äº›å¥—è·¯è¿˜æ˜¯éœ€è¦æŒæ¡çš„</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/we-should-know-when-changing-job/">æˆ‘ä»¬å¦‚ä½•æ‹¿åˆ°è‡ªå·±æ»¡æ„çš„è–ªèµ„å‘¢ï¼Ÿè¿™äº›å¥—è·¯è¿˜æ˜¯éœ€è¦æŒæ¡çš„</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120896294" target="_blank" rel="noopener">æˆ‘ä»¬å¦‚ä½•æ‹¿åˆ°è‡ªå·±æ»¡æ„çš„è–ªèµ„å‘¢ï¼Ÿè¿™äº›å¥—è·¯è¿˜æ˜¯éœ€è¦æŒæ¡çš„</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      æˆ‘ä¸æ˜¯æ•™ä½ è¯ˆï¼Œè€Œæ˜¯æœ‰äº›æŠ€å·§éœ€è¦äº†è§£ã€‚
    
    </summary>
    
    
      <category term="é—²èŠ" scheme="https://www.howardliu.cn/categories/%E9%97%B2%E8%81%8A/"/>
    
    
      <category term="é—²èŠ" scheme="https://www.howardliu.cn/tags/%E9%97%B2%E8%81%8A/"/>
    
      <category term="è–ªèµ„" scheme="https://www.howardliu.cn/tags/%E8%96%AA%E8%B5%84/"/>
    
      <category term="æ¢å·¥ä½œ" scheme="https://www.howardliu.cn/tags/%E6%8D%A2%E5%B7%A5%E4%BD%9C/"/>
    
      <category term="å¥—è·¯" scheme="https://www.howardliu.cn/tags/%E5%A5%97%E8%B7%AF/"/>
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰</title>
    <link href="https://www.howardliu.cn/effective-java-easyexcel-action-fill/"/>
    <id>https://www.howardliu.cn/effective-java-easyexcel-action-fill/</id>
    <published>2021-10-10T07:38:15.000Z</published>
    <updated>2021-10-10T07:38:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20211010155846.jpeg" alt="é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/å®…-ken-21259066/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6674689" target="_blank" rel="noopener">å®…-KEN</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6674689" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write/">å‰æ–‡</a> è¯´äº†å†™æ“ä½œï¼Œå¯ä»¥å®ç°ç®€å•çš„åˆ—è¡¨å¯¼å‡ºï¼Œè¿˜èƒ½ <a href="https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/">å®šä¹‰æ ·å¼</a>ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¼å‡ºçš„ä¸€ä¸ªå¤§è¡¨å•ï¼Œæˆ–è€…æ˜¯è¡¨å•+åˆ—è¡¨çš„å½¢å¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å¡«å……åŠŸèƒ½ã€‚</p><a id="more"></a><p>å†…å®¹æ¯”è¾ƒå¤šï¼Œæ–‡å†…åªä¼šåˆ—å‡ºå…³é”®ä»£ç ï¼Œæƒ³è¦å®Œæ•´æºç ï¼Œå¯ä»¥å…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤â€œeasyexcelâ€è·å–ã€‚</p><p>åœ¨ EasyExcel ä¸­ï¼Œå†™æ“ä½œå¯ä»¥å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œï¼Œå¡«å……çš„ä¼˜åŠ¿åœ¨äºï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰æ ·å¼çš„ï¼Œåªè¦åœ¨æ¨¡æ¿ä¸­è®¾ç½®å¥½æ ·å¼ï¼Œå¡«å……çš„æ•°æ®å°±èƒ½å¤Ÿå¸¦ç€æ ·å¼ã€‚</p><h2 id="å…ˆå†™ä¸ªè¡¨å•"><a href="#å…ˆå†™ä¸ªè¡¨å•" class="headerlink" title="å…ˆå†™ä¸ªè¡¨å•"></a>å…ˆå†™ä¸ªè¡¨å•</h2><p>æ—¢ç„¶æ˜¯ä½¿ç”¨æ¨¡æ¿ï¼Œå†™æ¥å®šä¹‰ä¸€ä¸ªæ¨¡æ¿ã€‚</p><p><img src="https://static.howardliu.cn/20211010154155.png" alt="å…ˆå†™ä¸ªè¡¨å•"></p><p>åœ¨ EasyExcel çš„æ¨¡æ¿å¡«å……å®šä¹‰ä¸­ï¼Œä½¿ç”¨<code>{}</code>æ¥è¡¨ç¤ºä½ è¦ç”¨çš„å˜é‡ï¼Œå¦‚æœæœ¬æ¥å°±æœ‰â€{â€œ,â€}â€ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œè½¬ä¹‰ï¼Œç”¨â€{â€œ,â€}â€œä»£æ›¿ã€‚</p><h3 id="å†™å¯¹è±¡"><a href="#å†™å¯¹è±¡" class="headerlink" title="å†™å¯¹è±¡"></a>å†™å¯¹è±¡</h3><p>æ—¢ç„¶æ˜¯å†™å¯¹è±¡ï¼Œå…ˆå®šä¹‰ä¸€ä¸‹å¯¹è±¡ç»“æ„ã€‚</p><pre><code class="java">@Datapublic class Item {    private String name;    private double number;}</code></pre><p>ç„¶åå¼€å§‹å¡«å……ï¼š</p><pre><code class="java">private static void fillUseObject() {    String fileName = defaultFileName(&quot;fillUseObject&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_sample.xlsx&quot;;    Item item = new Item();    item.setName(&quot;æ³•å¤–ç‹‚å¾’å¼ ä¸‰&quot;);    item.setNumber(89757);    EasyExcelFactory.write(fileName)            .withTemplate(templateFile)            .sheet()            .doFill(item);}</code></pre><p>åœ¨å†™æ“ä½œä¸­æˆ‘ä»¬ä¹Ÿä½¿ç”¨è¿‡æ¨¡æ¿å†™åˆ—è¡¨ï¼Œè¿™é‡Œå¡«å……æ¨¡æ¿ï¼Œä½¿ç”¨çš„æ˜¯åŒæ ·çš„æ–¹æ³•ï¼š<code>com.alibaba.excel.write.builder.ExcelWriterBuilder#withTemplate(java.lang.String)</code>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå†é‡å¤ä¸€éã€‚withTemplate æ–¹æ³•æœ‰å‡ ä¸ªé‡è½½å®ç°ï¼š</p><ol><li>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è·¯å¾„<code>ExcelWriterBuilder#withTemplate(java.lang.String)</code></li><li>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶å¯¹è±¡<code>ExcelWriterBuilder#withTemplate(java.io.File)</code></li><li>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è¾“å…¥æµ<code>ExcelWriterBuilder#withTemplate(java.io.InputStream)</code></li></ol><p>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶å’Œæ¨¡æ¿æ–‡ä»¶å¯¹è±¡éƒ½æ˜¯æ“ä½œæ–‡ä»¶çš„ï¼Œéœ€è¦æœ‰æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è¾“å…¥æµæ˜¯åªè¦æ–‡ä»¶æµï¼Œè¿™ä¸ªå¯æ“ä½œæ€§ç©ºé—´å°±æ¯”è¾ƒå¤§äº†ã€‚æ¯”å¦‚ï¼Œæ¨¡æ¿æ–‡ä»¶æ˜¯å¯å˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºä¸€ä¸ªå¸¦å˜é‡çš„æ¨¡æ¿æ–‡ä»¶ï¼Œä½¿ç”¨å¡«å……å†™å…¥çš„æ–¹å¼åˆå§‹åŒ–æ¨¡æ¿æ–‡ä»¶ï¼Œç„¶åå†ç”¨æ¨¡æ¿å†™å…¥çš„æ–¹å¼ï¼Œå†™å…¥åˆ—è¡¨ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154224.png" alt="å†™å¯¹è±¡"></p><h3 id="å†™-Map"><a href="#å†™-Map" class="headerlink" title="å†™ Map"></a>å†™ Map</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ç”¨éå¾—åˆ›å»ºç±»ï¼Œç”¨ Map ä¹Ÿèƒ½å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚</p><pre><code class="java">private static void fillUseMap() {    String fileName = defaultFileName(&quot;fillUseMap&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_sample.xlsx&quot;;    Map&lt;String, Object&gt; data = new HashMap&lt;&gt;();    data.put(&quot;name&quot;, &quot;æ³•å¤–ç‹‚å¾’å¼ ä¸‰&quot;);    data.put(&quot;number&quot;, 89757);    EasyExcelFactory.write(fileName)            .withTemplate(templateFile)            .sheet()            .doFill(data);}</code></pre><p>è™½ç„¶ Map èƒ½å¤ŸåŠŸèƒ½ç›¸åŒï¼Œä¸è¿‡è¿˜æ˜¯å»ºè®®å®šä¹‰å…·ä½“çš„ç±»ã€‚å› ä¸ºç±»æ˜¯å¯æ ¡éªŒçš„ï¼ŒMap æ˜¯å¼±æ£€æµ‹æœºåˆ¶ï¼Œçº¯é çº¦å®šæˆ–è€…æµ‹è¯•ï¼Œä¸æ˜¯å¾ˆå®‰å…¨ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154251.png" alt="å†™ Map"></p><p>ä»æ•ˆæœä¸Šçœ‹ï¼Œç»“æœæ˜¯ç›¸åŒçš„ã€‚</p><h2 id="å†å†™ä¸ªåˆ—è¡¨"><a href="#å†å†™ä¸ªåˆ—è¡¨" class="headerlink" title="å†å†™ä¸ªåˆ—è¡¨"></a>å†å†™ä¸ªåˆ—è¡¨</h2><p>å…ˆå®šä¹‰æ¨¡æ¿ï¼š</p><p><img src="https://static.howardliu.cn/20211010154354.png" alt="å†å†™ä¸ªåˆ—è¡¨"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¡«å……åˆ—è¡¨çš„å‚æ•°å®šä¹‰ï¼Œä¸å¡«å……å¯¹è±¡çš„æœ‰äº›å·®åˆ«ï¼Œæ¨¡æ¿ä¸­<code>{.}</code>å¤šäº†ä¸ªç‚¹ã€‚</p><p>å¯¹äºè¡¨æ ¼çš„åœºæ™¯ï¼Œä»å¤§ä½“ä¸Šä¼šåˆ†ä¸ºå°‘é‡æ•°æ®å’Œå¤§é‡æ•°æ®ã€‚å¯¹äºå°‘é‡æ•°æ®ï¼Œç›´æ¥åœ¨å†…å­˜ä¸­æ“ä½œå³å¯ã€‚å¯¹äºå¤§é‡æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨åˆ†æ‰¹å†™å…¥ï¼Œå€ŸåŠ©æ–‡ä»¶ç¼“å­˜çš„æ–¹å¼èŠ‚çœå†…å­˜ã€‚</p><h3 id="å°‘é‡å†™"><a href="#å°‘é‡å†™" class="headerlink" title="å°‘é‡å†™"></a>å°‘é‡å†™</h3><p>ä¸Šä»£ç ï¼š</p><pre><code class="java">private static void fillListInMemory() {    String fileName = defaultFileName(&quot;fillListInMemory&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_list.xlsx&quot;;    EasyExcelFactory.write(fileName)            .withTemplate(templateFile)            .sheet()            .doFill(sampleItems());}</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå¡«å……åˆ—è¡¨ä¸å‰æ–‡è¯´åˆ°çš„å†™æ–‡ä»¶æ“ä½œåœ¨ä»£ç å®ç°ä¸Šæ²¡æœ‰å¤ªå¤§å·®å¼‚ï¼Œè¿™ä¹Ÿæ˜¯ EasyExcel æ¶æ„è®¾è®¡ä¸Šçš„å¼ºæ‚ã€‚é€šè¿‡å»ºé€ å™¨æ¨¡å¼çš„ fluent å†™æ³•ï¼Œå±è”½å•°å—¦çš„å†™å…¥ï¼ŒåŒæ—¶ä¹Ÿå±è”½ä¸åŒä¸šåŠ¡å®ç°å‚æ•°çš„å·®å¼‚ï¼Œåªåœ¨<code>doFill</code>çš„æ—¶å€™ï¼Œæ ¹æ®ä¸åŒå‚æ•°å®ç°ä¸åŒé€»è¾‘ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154428.png" alt="å°‘é‡å†™"></p><h3 id="å¤§é‡å†™"><a href="#å¤§é‡å†™" class="headerlink" title="å¤§é‡å†™"></a>å¤§é‡å†™</h3><p>æ¥ä¸‹æ¥å°±æ˜¯å¤§é‡æ•°æ®å¡«å……äº†ã€‚ä¸ä¸Šé¢çš„å·®å¼‚åœ¨äºéœ€è¦æ‰‹åŠ¨åˆ›å»º<code>ExcelWriter</code>å’Œ<code>WriteSheet</code>å¯¹è±¡ï¼Œç„¶åä½¿ç”¨<code>com.alibaba.excel.ExcelWriter.fill</code>æ–¹æ³•å¤šæ¬¡å†™å…¥æ•°æ®ã€‚</p><p><code>fill</code>æ–¹æ³•æ”¯æŒç›´æ¥å†™å…¥åˆ—è¡¨å’Œä½¿ç”¨ lambda å‡½æ•°æ–¹å¼ï¼Œæ³¨æ„æ˜¯<code>fill</code>ï¼Œä¸æ˜¯<code>doFill</code>ã€‚<code>doFill</code>ä¼šè°ƒç”¨<code>finish</code>æ–¹æ³•è‡ªåŠ¨å…³é—­æµï¼Œ<code>fill</code>æ–¹æ³•åªåšæ•°æ®å¡«å……ï¼Œéœ€è¦æ‰‹åŠ¨å…³é—­æµã€‚</p><p>ä»£ç ä¸ºï¼š</p><pre><code class="java">private static void fillListSegment() {    String fileName = defaultFileName(&quot;fillListSegment&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_list.xlsx&quot;;    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName).withTemplate(templateFile).build();    try {        final WriteSheet writeSheet = EasyExcelFactory.writerSheet().build();        excelWriter.fill(BaseFill::sampleItems, writeSheet);        excelWriter.fill(sampleItems(), writeSheet);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154502.png" alt="å¤§é‡å†™"></p><h2 id="æœ€åå†™ä¸ªè¡¨å•-åˆ—è¡¨"><a href="#æœ€åå†™ä¸ªè¡¨å•-åˆ—è¡¨" class="headerlink" title="æœ€åå†™ä¸ªè¡¨å•+åˆ—è¡¨"></a>æœ€åå†™ä¸ªè¡¨å•+åˆ—è¡¨</h2><p>æœ€åæ¥ä¸ªè¡¨å•ä¸åˆ—è¡¨çš„å½¢å¼ã€‚æ¯”å¦‚é”€å”®ç»Ÿè®¡ï¼Œè¡¨å¤´éœ€è¦å¡«å†™å‚æ•°ä¿¡æ¯ï¼Œæ¯”å¦‚åº—é“ºä¿¡æ¯ã€æ—¶é—´ç­‰ï¼Œç„¶åæ˜¯é”€å”®è®°å½•ï¼Œæœ€åéœ€è¦å¢åŠ ç±»ä¼¼åˆè®¡ä¹‹ç±»çš„ä¿¡æ¯ã€‚</p><p>è¿™ç§çš„è¯ï¼Œå¯ä»¥å®ç°çš„æ–¹å¼ä¹ŸæŒºå¤šï¼Œè¿™é‡Œä»‹ç»å›ºå®šåˆ—è¡¨çš„å®ç°ï¼Œåœ¨æŠ€å·§ç¯‡ä¸­ä¼šå†ä»‹ç»ä¸€ç§åŠ¨æ€åˆ—è¡¨çš„å®ç°ã€‚</p><h3 id="å¡«å……å¯¹è±¡-åˆ—è¡¨"><a href="#å¡«å……å¯¹è±¡-åˆ—è¡¨" class="headerlink" title="å¡«å……å¯¹è±¡+åˆ—è¡¨"></a>å¡«å……å¯¹è±¡+åˆ—è¡¨</h3><p>å…ˆå®šä¹‰æ¨¡æ¿ï¼š</p><p><img src="https://static.howardliu.cn/20211010154533.png" alt="å¡«å……å¯¹è±¡+åˆ—è¡¨"></p><p>ä»æ¨¡æ¿ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¤´æ˜¯æ—¶é—´ä¿¡æ¯ï¼Œç»“å°¾æœ‰ç»Ÿè®¡ä¿¡æ¯ï¼Œä¸­é—´æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p><p>ä¸Šä»£ç ï¼š</p><pre><code class="java">/** * å¡«å……å¯¹è±¡+åˆ—è¡¨ï¼Œå› ä¸ºåˆ—è¡¨ä¹‹åè¿˜æœ‰ä¸€ä¸ªå­—æ®µï¼Œæ‰€ä»¥éœ€è¦å°†{@link FillConfigBuilder#forceNewRow(Boolean)}è®¾ç½®ä¸º TRUE æ‰è¡Œã€‚ * &lt;p&gt; * è¿™æ ·ä¼šæœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼šæ‰€æœ‰æ•°æ®ä¼šåœ¨å†…å­˜ä¸­ï¼Œå³æ•°æ®é‡å¤§çš„æ—¶å€™ç‰¹åˆ«è€—å†…å­˜ã€‚ * &lt;p&gt; * æƒ³è¦è§£å†³æœ‰ä¸¤ç§æ–¹å¼ï¼š * * &lt;ul&gt; *     &lt;li&gt;list ä¹‹åæ²¡æœ‰æ•°æ®äº†ï¼Œ{@link FillConfigBuilder#forceNewRow(Boolean)}è®¾ç½®ä¸º FALSE&lt;/li&gt; *     &lt;li&gt;list å†™å®Œä¹‹åï¼Œæ‰‹åŠ¨å†™åé¢çš„æ•°æ®&lt;/li&gt; * &lt;/ul&gt; */private static void fillObjectAndListInMemory() {    String fileName = defaultFileName(&quot;fillObjectAndListInMemory&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_object_and_list.xlsx&quot;;    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName).withTemplate(templateFile).build();    try {        final WriteSheet writeSheet = EasyExcelFactory.writerSheet().build();        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();        map.put(&quot;date&quot;, DateTimeFormatter.ISO_LOCAL_DATE_TIME.format(LocalDateTime.now()));        map.put(&quot;total&quot;, System.currentTimeMillis());        excelWriter.fill(map, writeSheet);        FillConfig fillConfig = FillConfig.builder().forceNewRow(Boolean.TRUE).build();        excelWriter.fill(BaseFill::sampleItems, fillConfig, writeSheet);        excelWriter.fill(sampleItems(), fillConfig, writeSheet);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ–°å¢çš„é…ç½®ç±»ï¼š<code>FillConfig fillConfig = FillConfig.builder().forceNewRow(Boolean.TRUE).build()</code>ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å®šä¹‰å†™å…¥æ—¶çš„é…ç½®ä¿¡æ¯ã€‚é…ç½®ä¸º trueï¼Œä»£è¡¨åœ¨å†™å…¥åˆ—è¡¨çš„æ—¶å€™ï¼Œä¸ç®¡ä¸‹é¢æœ‰æ²¡æœ‰ç©ºè¡Œï¼Œéƒ½ä¼šåˆ›å»ºä¸€è¡Œï¼Œç„¶åä¸‹é¢çš„æ•°æ®å¾€åç§»åŠ¨ã€‚å¦‚æœä¸å®šä¹‰æˆ–è€…è®¾ç½®ä¸º falseï¼Œæœ€åé‚£è¡Œçš„ç»Ÿè®¡ä¿¡æ¯ä¼šè¢«è¦†ç›–ã€‚</p><p>ä½†æ˜¯åªè¦è®¾ç½®ä¸º true äº†ï¼Œæ•´ä¸ªå¡«å……æ“ä½œå°†éƒ½åœ¨å†…å­˜ä¸­æ“ä½œï¼Œæ¯”è¾ƒè€—è´¹å†…å­˜ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154632.png" alt="å¡«å……å¯¹è±¡+åˆ—è¡¨"></p><h3 id="å¡«å……å¯¹è±¡-åˆ—è¡¨ï¼ˆå¤§æ•°æ®é‡ï¼‰"><a href="#å¡«å……å¯¹è±¡-åˆ—è¡¨ï¼ˆå¤§æ•°æ®é‡ï¼‰" class="headerlink" title="å¡«å……å¯¹è±¡+åˆ—è¡¨ï¼ˆå¤§æ•°æ®é‡ï¼‰"></a>å¡«å……å¯¹è±¡+åˆ—è¡¨ï¼ˆå¤§æ•°æ®é‡ï¼‰</h3><p>å¦‚æœåˆ—è¡¨æ•°æ®æ¯”è¾ƒå¤§ï¼Œè¿˜åœ¨å†…å­˜ä¸­æ“ä½œå°±æ¯”è¾ƒå®¹æ˜“å†…å­˜æº¢å‡ºäº†ã€‚æ‰€ä»¥éœ€è¦ç‰¹æ®Šçš„æ“ä½œï¼š</p><ol><li>åˆ—è¡¨ä¹‹åæ²¡æœ‰è¡¨å•å¡«å……äº†ï¼Œè¿™ç§æœ€å®¹æ˜“å®ç°ï¼Œä¸€å¥è¯å®ç°ä¸äº†ï¼Œæ”¹éœ€æ±‚ã€‚</li><li>åªèƒ½åœ¨åˆ—è¡¨ä¹‹åæ‰‹åŠ¨å†™æ•°æ®</li></ol><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">private static void fillObjectAndListManual() {    String fileName = defaultFileName(&quot;fillObjectAndListManual&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_object_and_list_manual.xlsx&quot;;    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName).withTemplate(templateFile).build();    try {        final WriteSheet writeSheet = EasyExcelFactory.writerSheet().build();        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();        map.put(&quot;date&quot;, DateTimeFormatter.ISO_LOCAL_DATE_TIME.format(LocalDateTime.now()));        excelWriter.fill(map, writeSheet);        FillConfig fillConfig = FillConfig.builder().forceNewRow(Boolean.TRUE).build();        excelWriter.fill(BaseFill::sampleItems, fillConfig, writeSheet);        excelWriter.fill(sampleItems(), fillConfig, writeSheet);        // ä¸‹é¢æ˜¯çº¯æ‰‹å·¥å†™æ•°æ®        List&lt;List&lt;String&gt;&gt; totalListList = new ArrayList&lt;&gt;();        List&lt;String&gt; totalList = new ArrayList&lt;&gt;();        totalListList.add(totalList);        totalList.add(null);        totalList.add(&quot;ç»Ÿè®¡ï¼š1000&quot;);        excelWriter.write(totalListList, writeSheet);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154712.png" alt="å¡«å……å¯¹è±¡+åˆ—è¡¨ï¼ˆå¤§æ•°æ®é‡ï¼‰"></p><h3 id="æ¨ªå‘å¡«å……æ•°æ®"><a href="#æ¨ªå‘å¡«å……æ•°æ®" class="headerlink" title="æ¨ªå‘å¡«å……æ•°æ®"></a>æ¨ªå‘å¡«å……æ•°æ®</h3><p>å…ˆå®šä¹‰æ¨¡æ¿ï¼š</p><p><img src="https://static.howardliu.cn/20211010154752.png" alt="æ¨ªå‘å¡«å……æ•°æ®"></p><pre><code class="java">private static void fillObjectAndListHorizontal() {    String fileName = defaultFileName(&quot;fillObjectAndListHorizontal&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_list_horizontal.xlsx&quot;;    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName).withTemplate(templateFile).build();    try {        final WriteSheet writeSheet = EasyExcelFactory.writerSheet().build();        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();        map.put(&quot;date&quot;, DateTimeFormatter.ISO_LOCAL_DATE_TIME.format(LocalDateTime.now()));        excelWriter.fill(map, writeSheet);        FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();        excelWriter.fill(BaseFill::sampleItems, fillConfig, writeSheet);        excelWriter.fill(sampleItems(), fillConfig, writeSheet);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>è¿™é‡Œé…ç½®<code>FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build()</code>ï¼Œç”¨äºå®šä¹‰å†™å…¥æ–¹å‘ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154823.png" alt="æ¨ªå‘å¡«å……æ•°æ®"></p><h3 id="å¡«å……å¤šä¸ªè¡¨æ ¼"><a href="#å¡«å……å¤šä¸ªè¡¨æ ¼" class="headerlink" title="å¡«å……å¤šä¸ªè¡¨æ ¼"></a>å¡«å……å¤šä¸ªè¡¨æ ¼</h3><p>ä¸å†™æ“ä½œç›¸åŒï¼Œå¡«å……æ“ä½œä¹Ÿå¯ä»¥å®ç°å¤šè¡¨æ ¼çš„å†™å…¥ã€‚</p><p><img src="https://static.howardliu.cn/20211010154844.png" alt="å¡«å……å¤šä¸ªè¡¨æ ¼"></p><p>å¯¹äºå¤šè¡¨æ ¼å†™å…¥ï¼Œå®šä¹‰æ¨¡æ¿æ—¶ï¼Œå¿…é¡»æœ‰<code>{å‰ç¼€ã€‚}</code>ã€‚</p><pre><code class="java">private static void fillMultiList() {    String fileName = defaultFileName(&quot;fillMultiList&quot;);    String templateFile = getPath() + File.separator + &quot;template_fill_multi_list.xlsx&quot;;    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName).withTemplate(templateFile).build();    try {        final WriteSheet writeSheet = EasyExcelFactory.writerSheet().build();        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();        map.put(&quot;date&quot;, DateTimeFormatter.ISO_LOCAL_DATE_TIME.format(LocalDateTime.now()));        excelWriter.fill(map, writeSheet);        FillConfig fillConfig = FillConfig.builder().direction(WriteDirectionEnum.HORIZONTAL).build();        excelWriter.fill(new FillWrapper(&quot;data1&quot;, sampleItems()), fillConfig, writeSheet);        // data2 åˆ†æ‰¹å†™å…¥        excelWriter.fill(new FillWrapper(&quot;data2&quot;, sampleItems()), writeSheet);        excelWriter.fill(new FillWrapper(&quot;data3&quot;, sampleItems()), writeSheet);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>è¿™é‡Œç”¨åˆ°äº†<code>FillWrapper</code>ï¼Œç”¨æ¥åŒ…è£…å‰ç¼€ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211010154911.png" alt="å¡«å……å¤šä¸ªè¡¨æ ¼"></p><p>è‡³æ­¤ï¼Œå†™æ“ä½œå’Œå¡«å……æ“ä½œå…¨éƒ¨ä»‹ç»å®Œæˆã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»å®æˆ˜è§’åº¦è¯´äº†ä¸€ä¸‹ EasyExcel å¦‚æœå®ç°å¡«å……æ¨¡æ¿å¯¼å‡ºè¡¨æ ¼ï¼Œæœ‰äº†æ¨¡æ¿å¡«å……é€»è¾‘ï¼Œå†åŠ ä¸Šå†™é€»è¾‘ï¼Œæˆ‘ä»¬ä¼šæœ‰æ›´å¤šçš„ç©æ³•ï¼Œæ¥ä¸‹æ¥å°±ä¼šè¯´ä¸€ä¸‹è¿™äº›å¥½ç©çš„éªšæ“ä½œã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰</a></li><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰</a></li><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-fill/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/effective-java-easyexcel-action-fill/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120687567" target="_blank" rel="noopener">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      åœ¨ EasyExcel ä¸­ï¼Œå†™æ“ä½œå¯ä»¥å®Œæˆå¤§éƒ¨åˆ†å·¥ä½œï¼Œå¡«å……çš„ä¼˜åŠ¿åœ¨äºï¼Œå¯ä»¥å®ç°è‡ªå®šä¹‰æ ·å¼çš„ï¼Œåªè¦åœ¨æ¨¡æ¿ä¸­è®¾ç½®å¥½æ ·å¼ï¼Œå¡«å……çš„æ•°æ®å°±èƒ½å¤Ÿå¸¦ç€æ ·å¼ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Effective Java" scheme="https://www.howardliu.cn/tags/Effective-Java/"/>
    
      <category term="EasyExcel" scheme="https://www.howardliu.cn/tags/EasyExcel/"/>
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰</title>
    <link href="https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/"/>
    <id>https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/</id>
    <published>2021-10-07T07:50:47.000Z</published>
    <updated>2021-10-07T07:50:47.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20211007160914.jpeg" alt="é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/birgl-6508325/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5760752" target="_blank" rel="noopener">birgl</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5760752" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write/">å‰æ–‡</a> èŠäº† EasyExcel çš„å†…å®¹å¯¼å‡ºï¼Œæœ¬æ–‡ä¸»è¦è¯´ä¸€ä¸‹å¯¼å‡ºæ–‡ä»¶çš„æ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–åŒ…æ‹¬å·¥ä½œè¡¨/å•å…ƒæ ¼æ ·å¼å’Œå†…å®¹æ ¼å¼åŒ–ã€‚æ¯•ç«Ÿï¼Œæœ‰æ—¶å€™è¿˜æ˜¯è¦çœ‹è„¸ã€‚</p><a id="more"></a><p>å†…å®¹æ¯”è¾ƒå¤šï¼Œæ–‡å†…åªä¼šåˆ—å‡ºå…³é”®ä»£ç ï¼Œæƒ³è¦å®Œæ•´æºç ï¼Œå¯ä»¥å…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤â€œeasyexcelâ€è·å–ã€‚</p><h2 id="æ³¨è§£æ ¼å¼"><a href="#æ³¨è§£æ ¼å¼" class="headerlink" title="æ³¨è§£æ ¼å¼"></a>æ³¨è§£æ ¼å¼</h2><p>é€šè¿‡æ³¨è§£å®šä¹‰æ ¼å¼æ˜¯ EasyExcel å°è£…çš„é«˜çº§åŠŸèƒ½ï¼Œå¯ä»¥è®©æˆ‘ä»¬å¾ˆæ–¹ä¾¿çš„å®šä¹‰æ ¼å¼ã€‚</p><h3 id="æ ¼å¼åŒ–å†…å®¹"><a href="#æ ¼å¼åŒ–å†…å®¹" class="headerlink" title="æ ¼å¼åŒ–å†…å®¹"></a>æ ¼å¼åŒ–å†…å®¹</h3><p>å…ˆå®šä¹‰ä¸€ä¸ªä½¿ç”¨æ³¨è§£æ ¼å¼åŒ–å†…å®¹çš„å®ä½“ç±»ï¼š</p><pre><code class="java">@Datapublic class FormatContentItem {    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, converter = TitleFormatConverter.class)    private String string;    @DateTimeFormat(&quot;yyyy å¹´ MM æœˆ dd æ—¥ HH æ—¶ mm åˆ† ss ç§’&quot;)    @ExcelProperty(value = &quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @NumberFormat(&quot;0.000%&quot;)    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)    private Double doubleData;}</code></pre><p>å…¶ä¸­<code>DateTimeFormat</code>å’Œ<code>NumberFormat</code>ä¸¤ä¸ªæ³¨è§£éƒ½æ˜¯è‡ªå¸¦çš„æ³¨è§£ï¼Œç”¨äºæ ¼å¼åŒ–æ—¶é—´å’Œæ•°å­—ã€‚</p><p><code>DateTimeFormat</code>æ³¨è§£æœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªå±æ€§æ˜¯<code>value</code>ï¼Œç”¨æ¥å®šä¹‰æ—¶é—´æ ¼å¼ï¼Œå¯ä»¥å‚è€ƒ<code>java.text.SimpleDateFormat</code>ï¼›å¦ä¸€ä¸ªå±æ€§æ˜¯<code>use1904windowing</code>ï¼Œè¡¨ç¤ºä½¿ç”¨æ—¶é—´ä½¿ç”¨ 1904 æ—¶é—´ç³»ç»Ÿè¿˜æ˜¯ 1900 æ—¶é—´ç³»ç»Ÿï¼Œé»˜è®¤æ˜¯å¦ã€‚</p><p><code>NumberFormat</code>æ³¨è§£æœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªå±æ€§æ˜¯<code>value</code>ï¼Œç”¨æ¥å®šä¹‰æ•°å­—æ ¼å¼ï¼Œå¯ä»¥å‚è€ƒ<code>java.text.DecimalFormat</code>ï¼›å¦ä¸€ä¸ªå±æ€§æ˜¯<code>roundingMode</code>ï¼Œç”¨æ¥å®šä¹‰ä¿ç•™å°æ•°çš„æ–¹å¼ï¼Œä½¿ç”¨çš„æ˜¯<code>java.math.RoundingMode</code>æšä¸¾ã€‚</p><p>æƒ³è¦æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå¯ä»¥å€ŸåŠ©<code>ExcelProperty</code>çš„ converter å±æ€§ï¼Œè¿™ä¸ªå±æ€§ä¼ å…¥å®ç°<code>Converter</code>çš„ç±»ã€‚æ¯”å¦‚ç¤ºä¾‹ä¸­çš„<code>TitleFormatConverter</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">public class TitleFormatConverter implements Converter&lt;String&gt; {    @Override    public Class&lt;?&gt; supportJavaTypeKey() {        return String.class;    }    @Override    public CellDataTypeEnum supportExcelTypeKey() {        return CellDataTypeEnum.STRING;    }    @Override    public WriteCellData&lt;?&gt; convertToExcelData(String value, ExcelContentProperty contentProperty,            GlobalConfiguration globalConfiguration) {        return new WriteCellData&lt;&gt;(String.format(&quot;æ ‡é¢˜ï¼š%sï¼ˆè‡ªå®šä¹‰ï¼‰&quot;, value));    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155354.png" alt="æ ¼å¼åŒ–å†…å®¹"></p><h3 id="å®šä¹‰è¡Œé«˜ã€åˆ—å®½"><a href="#å®šä¹‰è¡Œé«˜ã€åˆ—å®½" class="headerlink" title="å®šä¹‰è¡Œé«˜ã€åˆ—å®½"></a>å®šä¹‰è¡Œé«˜ã€åˆ—å®½</h3><p>ä½¿ç”¨æ³¨è§£å®šä¹‰è¡Œé«˜çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨<code>HeadRowHeight</code>å®šä¹‰è¡¨å¤´é«˜åº¦ï¼Œä½¿ç”¨<code>ContentRowHeight</code>å®šä¹‰è¡¨ä½“é«˜åº¦ï¼Œè¿™ä¸ªæ³¨è§£å®šä¹‰ä¹‹åï¼Œæ‰€æœ‰è¡¨ä½“é«˜åº¦éƒ½æ˜¯ç›¸åŒçš„ã€‚åˆ—å®½å¯ä»¥ä½¿ç”¨<code>ColumnWidth</code>æ³¨è§£å®šä¹‰ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥å®šä¹‰åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºæ•´ä¸ªè¡¨æ ¼çš„åˆ—éƒ½ä¸€æ ·å®½ï¼Œä¹Ÿå¯ä»¥å®šä¹‰çš„å±æ€§ä¸Šï¼Œè¡¨ç¤ºæŒ‡å®šåˆ—çš„å®½åº¦ã€‚</p><pre><code class="java">@Data@HeadRowHeight(20)@ContentRowHeight(10)@ColumnWidth(25)public class FormatCellItem {    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)    private String string;    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @ColumnWidth(50)    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)    private Double doubleData;}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155431.png" alt="å®šä¹‰è¡Œé«˜ã€åˆ—å®½"></p><h3 id="å•å…ƒæ ¼å®šä¹‰æ ·å¼"><a href="#å•å…ƒæ ¼å®šä¹‰æ ·å¼" class="headerlink" title="å•å…ƒæ ¼å®šä¹‰æ ·å¼"></a>å•å…ƒæ ¼å®šä¹‰æ ·å¼</h3><p>æ§åˆ¶å•å…ƒæ ¼æ ·å¼æœ‰å››ä¸ªæ³¨è§£ï¼š<code>HeadStyle</code>ã€<code>HeadFontStyle</code>ã€<code>ContentStyle</code>ã€<code>ContentFontStyle</code>ï¼Œè¿™å››ä¸ªæ³¨è§£å¯ä»¥å®šä¹‰åœ¨ç±»ä¸Šä½œä¸ºå…¨å±€è¡¨æ ¼çš„æ ·å¼ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åœ¨å­—æ®µä¸Šï¼Œä½œä¸ºå½“å‰åˆ—çš„æ ·å¼ã€‚ä¸‹é¢åˆ†åˆ«è¯´ä¸€ä¸‹è¿™å‡ ä¸ªæ³¨è§£ä¸­æ¯”è¾ƒå¸¸ç”¨çš„é…ç½®ã€‚</p><ul><li>*Styleï¼šåˆ†ä¸º<code>HeadStyle</code>å’Œ<code>ContentStyle</code>ï¼Œåˆ†åˆ«å®šä¹‰è¡¨å¤´å’Œè¡¨ä½“æ ·å¼<ul><li>dataFormatï¼šè¡¨å¤´æ ¼å¼åŒ–ï¼Œshort æ ¼å¼ï¼Œæ˜¯<code>org.apache.poi.ss.usermodel.BuiltinFormats</code>ç±»ä¸­å·²å®šä¹‰æ ¼å¼çš„å°æ ‡</li><li>border*ï¼šåˆ†åˆ«æ˜¯ borderLeftã€borderRightã€borderTopã€borderBottom å››ä¸ªå±æ€§ï¼Œç±»å‹æ˜¯<code>com.alibaba.excel.enums.poi.BorderStyleEnum</code>æšä¸¾ï¼Œç”¨æ¥å®šä¹‰è¡¨å¤´å•å…ƒæ ¼è¾¹æ¡†æ ·å¼ã€‚è¾¹æ¡†çš„é¢œè‰²ä¹Ÿå¯ä»¥å®šä¹‰ï¼Œä½¿ç”¨ã€*BorderColor å®šä¹‰å³å¯ã€‚</li><li>fillPatternTypeï¼šå¡«å……ç±»å‹ï¼Œç±»å‹æ˜¯<code>com.alibaba.excel.enums.poi.FillPatternTypeEnum</code>æšä¸¾ï¼Œå¦‚æœæƒ³è¦å¡«å……èƒŒæ™¯è‰²ï¼Œè¿™ä¸ªå±æ€§éœ€è¦è®¾ç½®ä¸º<code>SOLID_FOREGROUND</code>ã€‚</li><li>fillForegroundColorï¼šå‰æ™¯è‰²ï¼Œç±»å‹æ˜¯ shortï¼Œå€¼å´æ˜¯ä½¿ç”¨çš„<code>org.apache.poi.ss.usermodel.IndexedColors</code>æšä¸¾çš„ idx å€¼ï¼Œåªä¸è¿‡ï¼Œä¸¤ä¸ªç±»å‹ä¸ä¸€è‡´ï¼Œä¸€ä¸ªæ˜¯ shortï¼Œä¸€ä¸ªæ˜¯ intï¼Œæ²¡æœ‰åŠæ³•ç›´æ¥å¼•ç”¨ã€‚å¯è§ java ä¸­çš„ä¾èµ–ä¹‹é—´ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šå‘çš„ã€‚</li><li>fillBackgroundColorï¼šèƒŒæ™¯è‰²ï¼ŒåŒ<code>fillForegroundColor</code>ã€‚</li><li>rotationï¼šå†…å®¹æ—‹è½¬è§’åº¦</li></ul></li><li>*FontStyleï¼šæœ‰<code>HeadFontStyle</code>å’Œ<code>ContentFontStyle</code>ï¼Œåˆ†åˆ«å®šä¹‰è¡¨å¤´å’Œè¡¨ä½“çš„å­—ä½“æ ·å¼ã€‚<ul><li>fontNameï¼šå®šä¹‰å­—ä½“åç§°ï¼Œç±»å‹å­—ç¬¦ä¸²</li><li>fontHeightInPointsï¼šå­—å·å¤§å°ï¼Œç±»å‹æ˜¯ short</li><li>italicï¼šæ˜¯å¦æ–œä½“ï¼Œç±»å‹æ˜¯<code>com.alibaba.excel.enums.BooleanEnum</code></li><li>boldï¼šæ˜¯å¦åŠ ç²—ï¼Œç±»å‹æ˜¯<code>com.alibaba.excel.enums.BooleanEnum</code></li><li>strikeoutï¼šæ˜¯å¦ä½¿ç”¨åˆ é™¤çº¿ï¼ˆè¿™ä¸ªè¯æœ¬æ„æ˜¯ä¸‰æŒ¯å‡ºå±€çš„æ„æ€ï¼Œåº”è¯¥æ˜¯ä¸æ£’çƒæœ‰å…³ï¼‰</li><li>colorï¼šæ–‡æœ¬é¢œè‰²ï¼Œå€¼ä½¿ç”¨çš„æ˜¯<code>org.apache.poi.ss.usermodel.IndexedColors</code>ï¼Œä¾ç„¶æœ‰ç±»å‹ä¸ä¸€è‡´çš„æƒ…å†µ</li><li>underlineï¼šä¸‹åˆ’çº¿ï¼Œç±»å‹æ˜¯ byteï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>Font.U_NONE</code>ã€<code>Font.U_SINGLE</code>ã€<code>Font.U_DOUBLE</code>ã€<code>Font.U_SINGLE_ACCOUNTING</code>ã€<code>Font.U_DOUBLE_ACCOUNTING</code>ã€‚</li></ul></li></ul><p>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®šä¹‰ï¼š</p><pre><code class="java">@Data// å¤´èƒŒæ™¯è®¾ç½®æˆçº¢è‰² IndexedColors.RED.getIndex()@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 10)// å¤´å­—ä½“è®¾ç½®æˆ 20@HeadFontStyle(fontHeightInPoints = 20)// å†…å®¹çš„èƒŒæ™¯è®¾ç½®æˆç»¿è‰² IndexedColors.GREEN.getIndex()@ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 17)// å†…å®¹å­—ä½“è®¾ç½®æˆ 20@ContentFontStyle(fontHeightInPoints = 20)public class FormatStyleCellItem {    // å­—ç¬¦ä¸²çš„å¤´èƒŒæ™¯è®¾ç½®æˆç²‰çº¢ IndexedColors.PINK.getIndex()    @HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 14)    // å­—ç¬¦ä¸²çš„å¤´å­—ä½“è®¾ç½®æˆ 20    @HeadFontStyle(fontHeightInPoints = 30)    // å­—ç¬¦ä¸²çš„å†…å®¹çš„èƒŒæ™¯è®¾ç½®æˆå¤©è“ IndexedColors.SKY_BLUE.getIndex()    @ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)    // å­—ç¬¦ä¸²çš„å†…å®¹å­—ä½“è®¾ç½®æˆ 20    @ContentFontStyle(fontHeightInPoints = 30)    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)    private String string;    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)    private Double doubleData;}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155504.png" alt="å•å…ƒæ ¼å®šä¹‰æ ·å¼"></p><h2 id="ç±»å¯¹è±¡å®šä¹‰æ ¼å¼"><a href="#ç±»å¯¹è±¡å®šä¹‰æ ¼å¼" class="headerlink" title="ç±»å¯¹è±¡å®šä¹‰æ ¼å¼"></a>ç±»å¯¹è±¡å®šä¹‰æ ¼å¼</h2><p>è¿™ç§æ–¹å¼å¯ä»¥è¯´æ˜¯çº¯æ‰‹å·¥ç»„è£…æ•°æ®äº†ï¼Œä½¿ç”¨çš„æ˜¯<code>com.alibaba.excel.metadata.data.WriteCellData</code>ç±»ï¼Œè¿™ä¸ªç±»ç›¸å½“äºæ˜¯å•å…ƒæ ¼çš„å®šä¹‰ï¼Œé€šè¿‡è®¾ç½®<code>com.alibaba.excel.enums.CellDataTypeEnum</code>æšä¸¾ç±»å‹çš„ type å±æ€§ï¼Œå¯ä»¥æŒ‡æ˜å½“å‰å•å…ƒæ ¼æ ¼å¼ã€‚</p><p>å®ˆæ’å®šå¾‹ä¸€ç›´å­˜åœ¨ã€‚è¿™ç§æ–¹å¼çµæ´»åº¦å¾ˆé«˜ï¼Œå¯ä»¥ç²¾ç»†åˆ°å…·ä½“çš„å•å…ƒæ ¼æ ¼å¼ï¼Œä½†æ˜¯ç¹çç¨‹åº¦ä¹Ÿå¢åŠ äº†ã€‚</p><h3 id="è¶…é“¾æ¥"><a href="#è¶…é“¾æ¥" class="headerlink" title="è¶…é“¾æ¥"></a>è¶…é“¾æ¥</h3><p>è¶…é“¾æ¥ä½¿ç”¨çš„æ˜¯<code>com.alibaba.excel.metadata.data.HyperlinkData</code>ç±»ï¼Œéœ€è¦è®¾ç½®åœ°å€ã€è¶…é“¾ç±»å‹ï¼ˆ<code>com.alibaba.excel.metadata.data.HyperlinkData.HyperlinkType</code>æšä¸¾ï¼‰ï¼Œç„¶åå°†å€¼å†™å…¥åˆ°<code>WriteCellData</code>å¯¹è±¡çš„<code>hyperlinkData</code>å±æ€§å³å¯ã€‚</p><pre><code class="java">// è®¾ç½®è¶…é“¾æ¥HyperlinkData hyperlinkData = new HyperlinkData();hyperlinkData.setAddress(&quot;https://www.howardliu.cn&quot;);hyperlinkData.setHyperlinkType(HyperlinkType.URL);WriteCellData&lt;String&gt; hyperlink = new WriteCellData&lt;&gt;(&quot;ç½‘ç«™&quot;);hyperlink.setHyperlinkData(hyperlinkData);</code></pre><h3 id="å¤‡æ³¨"><a href="#å¤‡æ³¨" class="headerlink" title="å¤‡æ³¨"></a>å¤‡æ³¨</h3><p>å¤‡æ³¨ä½¿ç”¨çš„æ˜¯<code>com.alibaba.excel.metadata.data.CommentData</code>ç±»ï¼Œéœ€è¦è®¾ç½®ä½œè€…ã€å¤‡æ³¨å†…å®¹ï¼ˆ<code>com.alibaba.excel.metadata.data.RichTextStringData</code>ç±»å‹ï¼‰ï¼Œå› ä¸ºå¤‡æ³¨çš„é»˜è®¤å¤§å°æ˜¯å•å…ƒæ ¼å¤§å°ï¼Œå¦‚æœæ„Ÿè§‰å¤ªå°ï¼Œè¿˜å¯ä»¥è®¾ç½®ç›¸å¯¹é«˜åº¦å’Œå®½åº¦ã€‚</p><pre><code class="java">// è®¾ç½®å¤‡æ³¨CommentData commentData = new CommentData();commentData.setAuthor(&quot;Howard Liu&quot;);commentData.setRichTextStringData(new RichTextStringData(&quot;è¿™æ˜¯ä¸€ä¸ªå¤‡æ³¨&quot;));// å¤‡æ³¨çš„é»˜è®¤å¤§å°æ˜¯æŒ‰ç…§å•å…ƒæ ¼çš„å¤§å° è¿™é‡Œæƒ³è°ƒæ•´åˆ° 4 ä¸ªå•å…ƒæ ¼é‚£ä¹ˆå¤§ æ‰€ä»¥å‘å å‘ä¸‹ å„é¢å¤–å ç”¨äº†ä¸€ä¸ªå•å…ƒæ ¼commentData.setRelativeLastColumnIndex(1);commentData.setRelativeLastRowIndex(1);WriteCellData&lt;String&gt; comment = new WriteCellData&lt;&gt;(&quot;å¤‡æ³¨çš„å•å…ƒæ ¼ä¿¡æ¯&quot;);comment.setCommentData(commentData);</code></pre><h3 id="å…¬å¼"><a href="#å…¬å¼" class="headerlink" title="å…¬å¼"></a>å…¬å¼</h3><p>å…¬å¼ä½¿ç”¨çš„æ˜¯<code>com.alibaba.excel.metadata.data.FormulaData</code>ç±»ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®<code>formulaValue</code>å…¬å¼ï¼Œä¸è¿‡å®˜æ–¹ä¸å¤ªæ¨èä½¿ç”¨å…¬å¼ã€‚</p><pre><code class="java">// è®¾ç½®å…¬å¼FormulaData formulaData = new FormulaData();// å°† 123456789 ä¸­çš„ç¬¬ä¸€ä¸ªæ•°å­—æ›¿æ¢æˆ 2// è¿™é‡Œåªæ˜¯ä¾‹å­ å¦‚æœçœŸçš„æ¶‰åŠåˆ°å…¬å¼ èƒ½å†…å­˜ç®—å¥½å°½é‡å†…å­˜ç®—å¥½ å…¬å¼èƒ½ä¸ç”¨å°½é‡ä¸ç”¨formulaData.setFormulaValue(&quot;REPLACE(123456789,1,1,2)&quot;);WriteCellData&lt;String&gt; formula = new WriteCellData&lt;&gt;();formula.setFormulaData(formulaData);</code></pre><h3 id="å•å…ƒæ ¼æ ¼å¼"><a href="#å•å…ƒæ ¼æ ¼å¼" class="headerlink" title="å•å…ƒæ ¼æ ¼å¼"></a>å•å…ƒæ ¼æ ¼å¼</h3><p>é€šè¿‡ç±»å®šä¹‰å•å…ƒæ ¼æ ¼å¼ï¼Œä¸é€šè¿‡æ³¨è§£å®šä¹‰æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥ä¸æ³¨è§£<code>HeadStyle</code>ã€<code>HeadFontStyle</code>ã€<code>ContentStyle</code>ã€<code>ContentFontStyle</code>å¯¹åº”ï¼Œè®¾ç½®å•å…ƒæ ¼æ ¼å¼çš„ç±»æ˜¯<code>WriteCellStyle</code>ï¼Œè®¾ç½®å­—ä½“çš„ç±»æ˜¯<code>WriteFont</code>ã€‚å…¶ä¸­è¿™äº›ç±»çš„å±æ€§ä¸æ³¨è§£çš„ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°å¤ªå¤šï¼Œç›´æ¥ä¸Šä¾‹å­ã€‚ï¼ˆå…¶å®æˆ‘è§‰å¾—ä½¿ç”¨ç±»å®šä¹‰æ ¼å¼çš„åœºæ™¯ä¸å¤šï¼ŒçœŸçš„ç¢°åˆ°äº†ï¼Œçœ‹çœ‹ç±»å®šä¹‰å°±æ˜ç™½äº†ï¼‰</p><pre><code class="java">// è®¾ç½®å•ä¸ªå•å…ƒæ ¼çš„æ ·å¼ å½“ç„¶æ ·å¼ å¾ˆå¤šçš„è¯ ä¹Ÿå¯ä»¥ç”¨æ³¨è§£ç­‰æ–¹å¼ã€‚WriteCellStyle writeCellStyleData = new WriteCellStyle();// è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸º FillPatternType.SOLID_FOREGROUND ä¸ç„¶æ— æ³•æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²ã€‚writeCellStyleData.setFillPatternType(FillPatternType.SOLID_FOREGROUND);// èƒŒæ™¯ç»¿è‰²writeCellStyleData.setFillForegroundColor(IndexedColors.GREEN.getIndex());WriteCellData&lt;String&gt; writeCellStyle = new WriteCellData&lt;&gt;(&quot;å•å…ƒæ ¼æ ·å¼&quot;);writeCellStyle.setWriteCellStyle(writeCellStyleData);writeCellStyle.setType(CellDataTypeEnum.STRING);// è®¾ç½®å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼RichTextStringData richTextStringData = new RichTextStringData();richTextStringData.setTextString(&quot;çº¢è‰²ç»¿è‰²é»˜è®¤&quot;);// å‰ 2 ä¸ªå­—çº¢è‰²WriteFont writeFont = new WriteFont();writeFont.setColor(IndexedColors.RED.getIndex());richTextStringData.applyFont(0, 2, writeFont);// æ¥ä¸‹æ¥ 2 ä¸ªå­—ç»¿è‰²writeFont = new WriteFont();writeFont.setColor(IndexedColors.GREEN.getIndex());richTextStringData.applyFont(2, 4, writeFont);WriteCellData&lt;String&gt; richTest = new WriteCellData&lt;&gt;();richTest.setType(CellDataTypeEnum.RICH_TEXT_STRING);richTest.setRichTextStringDataValue(richTextStringData);</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155542.png" alt="å•å…ƒæ ¼æ ¼å¼"></p><h2 id="æ‹¦æˆªå™¨å®šä¹‰æ ¼å¼"><a href="#æ‹¦æˆªå™¨å®šä¹‰æ ¼å¼" class="headerlink" title="æ‹¦æˆªå™¨å®šä¹‰æ ¼å¼"></a>æ‹¦æˆªå™¨å®šä¹‰æ ¼å¼</h2><p>é™¤äº†ç›´æ¥ä½¿ç”¨ç±»å®šä¹‰æ ¼å¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ©æ‹¦æˆªå™¨å®ç°ã€‚ï¼ˆè¿™é‡Œåœ¨åç§°ä¸Šä¼šæœ‰ä¸€äº›æ­§ä¹‰ï¼Œæ‰€ç”¨çš„ç±»å¯¹è±¡å‘½åéƒ½æ˜¯ xxxStrategyï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯ xxx ç­–ç•¥ï¼Œä½†æ˜¯å®˜æ–¹å¯¹å…¶å‘½åä¸ºæ‹¦æˆªå™¨ï¼‰</p><h3 id="å·²æœ‰æ‹¦æˆªå™¨"><a href="#å·²æœ‰æ‹¦æˆªå™¨" class="headerlink" title="å·²æœ‰æ‹¦æˆªå™¨"></a>å·²æœ‰æ‹¦æˆªå™¨</h3><p>å‰é¢ç¤ºä¾‹ä¸­ä½¿ç”¨<code>WriteCellStyle</code>ã€<code>WriteFont</code>å¯ä»¥å®ç°å•å…ƒæ ¼çš„æ ·å¼ï¼Œå¦‚æœæƒ³è¦å®ç°æ•´è¡Œæ•°æ®éƒ½æ˜¯ç›¸åŒçš„æ ¼å¼ï¼Œå¯ä»¥å€ŸåŠ©<code>com.alibaba.excel.write.style.HorizontalCellStyleStrategy</code>æ‹¦æˆªå™¨ã€‚</p><pre><code class="java">/** * ä½¿ç”¨å·²æœ‰ç­–ç•¥å®ç°è‡ªå®šä¹‰æ ·å¼ * * &lt;ul&gt; *     &lt;li&gt;HorizontalCellStyleStrategy æ¯ä¸€è¡Œçš„æ ·å¼éƒ½ä¸€æ · æˆ–è€…éš”è¡Œä¸€æ ·&lt;/li&gt; *     &lt;li&gt;AbstractVerticalCellStyleStrategy æ¯ä¸€åˆ—çš„æ ·å¼éƒ½ä¸€æ · éœ€è¦è‡ªå·±å›è°ƒæ¯ä¸€é¡µ&lt;/li&gt; * &lt;/ul&gt; */private static void writeByCellStyleStrategy() {    String fileName = defaultFileName(&quot;writeByCellStyleStrategy&quot;);    // è¡¨å¤´ç­–ç•¥    WriteCellStyle headWriteCellStyle = new WriteCellStyle();    // èƒŒæ™¯è®¾ç½®ä¸ºçº¢è‰²    headWriteCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());    WriteFont headWriteFont = new WriteFont();    headWriteFont.setFontHeightInPoints((short) 40);    headWriteCellStyle.setWriteFont(headWriteFont);    // è¡¨ä½“ç­–ç•¥    WriteCellStyle contentWriteCellStyle = new WriteCellStyle();    // è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸º FillPatternType.SOLID_FOREGROUND ä¸ç„¶æ— æ³•æ˜¾ç¤ºèƒŒæ™¯é¢œè‰²ã€‚è¡¨å¤´é»˜è®¤äº† FillPatternType æ‰€ä»¥å¯ä»¥ä¸æŒ‡å®š    contentWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);    // èƒŒæ™¯ç»¿è‰²    contentWriteCellStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex());    WriteFont contentWriteFont = new WriteFont();    // å­—ä½“å¤§å°    contentWriteFont.setFontHeightInPoints((short) 20);    contentWriteCellStyle.setWriteFont(contentWriteFont);    // è¿™ä¸ªç­–ç•¥æ˜¯ å¤´æ˜¯å¤´çš„æ ·å¼ å†…å®¹æ˜¯å†…å®¹çš„æ ·å¼ å…¶ä»–çš„ç­–ç•¥å¯ä»¥è‡ªå·±å®ç°    HorizontalCellStyleStrategy horizontalCellStyleStrategy =            new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);    // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ª class å»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ª sheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­    EasyExcelFactory.write(fileName)            .head(Item.class)            .registerWriteHandler(horizontalCellStyleStrategy)            .sheet()            .doWrite(sampleItems());}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155615.png" alt="å·²æœ‰æ‹¦æˆªå™¨"></p><p>æ­£å¦‚ä¸Šé¢çš„ç»“æœï¼Œå¦‚æœæˆ‘ä»¬æŸä¸ªå•å…ƒæ ¼æ•°æ®æ¯”è¾ƒé•¿ï¼Œå¯èƒ½ä¼šæœ‰é®æŒ¡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>com.alibaba.excel.write.style.column.LongestMatchColumnWidthStyleStrategy</code>å®ç°è‡ªåŠ¨åˆ—å®½è°ƒæ•´ã€‚ä¸è¿‡è¿™ä¸ªä¸å¤ªç²¾ç¡®ï¼Œä½†èŠèƒœäºæ— ã€‚</p><pre><code class="java">private static void writeUseLongestMatchColumnWidthStyleStrategy() {    String fileName = defaultFileName(&quot;writeUseLongestMatchColumnWidthStyleStrategy&quot;);    EasyExcelFactory.write(fileName)            .head(Item.class)            .registerWriteHandler(new LongestMatchColumnWidthStyleStrategy())            .sheet()            .doWrite(sampleItems());}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155646.png" alt="å·²æœ‰æ‹¦æˆªå™¨"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®ä¸å¤Ÿç²¾ç¡®ã€‚</p><h3 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨</h3><p>ä¸Šé¢å±•ç¤ºçš„æ‹¦æˆªå™¨ï¼Œéƒ½æ˜¯å®ç°äº†<code>com.alibaba.excel.write.handler.WriteHandler</code>æ¥å£ï¼Œç„¶åä½¿ç”¨<code>com.alibaba.excel.write.builder.AbstractExcelWriterParameterBuilder.registerWriteHandler</code>æ–¹æ³•æ³¨å†Œåˆ°å†™å‡½æ•°ä¸­ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯èƒ½æ ¹æ®éœ€è¦ï¼Œè‡ªå·±å®šä¹‰éœ€è¦çš„æ‹¦æˆªå™¨ã€‚</p><blockquote><p>è¿™ç§è‡ªå®šä¹‰æ‹¦æˆªå™¨å±äºä½çº§åŠŸèƒ½ï¼Œéœ€è¦äº†è§£å¾ˆå¤šåº•å±‚è®¾è®¡å’Œ APIï¼Œé‰´äºç¯‡å¹…ï¼Œæœ¬æ–‡æ²¡æœ‰åŠæ³•è¦†ç›–ï¼Œè¿™é‡Œåªç»™å‡ºä¾‹å­ã€‚å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥ç•™è¨€æ²Ÿé€šã€‚</p></blockquote><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æŸäº›å•å…ƒæ ¼è®¾ç½®æ•°æ®éªŒè¯ï¼Œå±•ç°å½¢å¼å°±æ˜¯ä¸‹æ‹‰èœå•ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š</p><pre><code class="java">public class ColumnValidationWriteHandler implements SheetWriteHandler {    @Override    public void afterSheetCreate(SheetWriteHandlerContext context) {        // åŒºé—´è®¾ç½® ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œçš„æ•°æ®ã€‚ç”±äºç¬¬ä¸€è¡Œæ˜¯å¤´ï¼Œæ‰€ä»¥ç¬¬ä¸€ã€äºŒè¡Œçš„æ•°æ®å®é™…ä¸Šæ˜¯ç¬¬äºŒä¸‰è¡Œ        CellRangeAddressList cellRangeAddressList = new CellRangeAddressList(1, 2, 0, 0);        DataValidationHelper helper = context.getWriteSheetHolder().getSheet().getDataValidationHelper();        DataValidationConstraint constraint = helper.createExplicitListConstraint(new String[] {&quot;æµ‹è¯• 1&quot;, &quot;æµ‹è¯• 2&quot;});        DataValidation dataValidation = helper.createValidation(constraint, cellRangeAddressList);        context.getWriteSheetHolder().getSheet().addValidationData(dataValidation);    }}</code></pre><p>å¦‚æœæˆ‘ä»¬éœ€è¦å°†æŸä¸ªå•å…ƒæ ¼çš„æ ¼å¼è®¾ç½®ä¸ºè¶…é“¾ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨ï¼š</p><pre><code class="java">public class CellStyleWriteHandler implements CellWriteHandler {    @Override    public void afterCellDispose(CellWriteHandlerContext context) {        Cell cell = context.getCell();        // è¿™é‡Œå¯ä»¥å¯¹ cell è¿›è¡Œä»»ä½•æ“ä½œ        if (BooleanUtils.isTrue(context.getHead()) &amp;&amp; cell.getColumnIndex() == 0) {            CreationHelper createHelper = context.getWriteSheetHolder().getSheet().getWorkbook().getCreationHelper();            Hyperlink hyperlink = createHelper.createHyperlink(HyperlinkType.URL);            hyperlink.setAddress(&quot;https://www.howardliu.cn&quot;);            cell.setHyperlink(hyperlink);        }    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155715.png" alt="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></p><h2 id="åˆå¹¶å•å…ƒæ ¼"><a href="#åˆå¹¶å•å…ƒæ ¼" class="headerlink" title="åˆå¹¶å•å…ƒæ ¼"></a>åˆå¹¶å•å…ƒæ ¼</h2><p>EasyExcel æä¾›çš„åˆå¹¶å•å…ƒæ ¼åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼šåŸºäºæ³¨è§£çš„åˆå¹¶ã€åŸºäºæ‹¦æˆªå™¨çš„åˆå¹¶ã€‚</p><h3 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h3><p>åŸºäºæ³¨è§£çš„åˆå¹¶å•å…ƒæ ¼æä¾›äº†ä¸¤ä¸ªæ³¨è§£ï¼š</p><ul><li><code>OnceAbsoluteMerge</code>æ³¨è§£å®ç°æŒ‡å®šä½ç½®çš„åˆå¹¶</li><li><code>ContentLoopMerge</code>è¿™ä¸ªæ˜¯å†…å®¹çš„å¾ªç¯åˆå¹¶ï¼ŒæŒ‡å®šæŸä¸€åˆ—æ¯å‡ è¡Œåˆå¹¶ã€‚</li></ul><pre><code class="java">// å°†ç¬¬ 6-7 è¡Œçš„ 2-3 åˆ—åˆå¹¶æˆä¸€ä¸ªå•å…ƒæ ¼@OnceAbsoluteMerge(firstRowIndex = 5, lastRowIndex = 6, firstColumnIndex = 1, lastColumnIndex = 2)@Datapublic class MergeCellItem {    @ContentLoopMerge(eachRow = 2)    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)    private String string;    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)    private Double doubleData;}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155745.png" alt="åˆå¹¶å•å…ƒæ ¼æ³¨è§£"></p><h3 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h3><p>æ‹¦æˆªå™¨åˆå¹¶ä¹Ÿæ˜¯æœ‰ä¸¤ç§ï¼Œå¯¹åº”ç€æ³¨è§£ï¼š</p><ul><li><code>OnceAbsoluteMergeStrategy</code>ï¼Œç›¸å¯¹ä½ç½®åˆå¹¶</li><li><code>LoopMergeStrategy</code>å¾ªç¯åˆå¹¶</li></ul><pre><code class="java">private static void writeMergeCellCustom() {    String fileName = defaultFileName(&quot;writeMergeCellCustom&quot;);    // æ¯éš” 2 è¡Œä¼šåˆå¹¶    // æŠŠ eachColumn è®¾ç½®æˆ 3 ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ•°æ®çš„é•¿åº¦ï¼Œæ‰€ä»¥å°±ç¬¬ä¸€åˆ—ä¼šåˆå¹¶ã€‚å½“ç„¶å…¶ä»–åˆå¹¶ç­–ç•¥ä¹Ÿå¯ä»¥è‡ªå·±å†™    LoopMergeStrategy loopMergeStrategy = new LoopMergeStrategy(2, 0);    EasyExcelFactory.write(fileName)            .head(Item.class)            .registerWriteHandler(loopMergeStrategy)            .sheet()            .doWrite(sampleItems());}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211007155820.png" alt="åˆå¹¶å•å…ƒæ ¼æ‹¦æˆªå™¨"></p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»å®æˆ˜è§’åº¦è¯´äº†ä¸€ä¸‹ EasyExcel å¦‚æœå®ç°å†™å‡ºå¥½çœ‹çš„è¡¨æ ¼ï¼ŒEasyExcelä¸­æä¾›äº†å¾ˆå¤šç”¨äºæ ¼å¼åŒ–çš„æ³¨è§£ã€æ‹¦æˆªå™¨ï¼Œå¯ä»¥å®ç°é€šç”¨çš„æ ¼å¼åŒ–è¾“å‡ºï¼Œå¦‚æœè¿˜æœ‰æ›´åŠ ä¸ªæ€§åŒ–çš„æ ¼å¼è¦æ±‚ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ‹¦æˆªå™¨å®ç°ã€‚æ¥ä¸‹æ¥èŠä¸€ä¸‹å¦‚ä½•å¡«å……æ¨¡æ¿ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰</a></li><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰</a></li><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-fill/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®©Excelå¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120637460" target="_blank" rel="noopener">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      æ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ã€‚æ¯•ç«Ÿï¼Œæœ‰æ—¶å€™è¿˜æ˜¯è¦çœ‹è„¸ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Effective Java" scheme="https://www.howardliu.cn/tags/Effective-Java/"/>
    
      <category term="EasyExcel" scheme="https://www.howardliu.cn/tags/EasyExcel/"/>
    
  </entry>
  
  <entry>
    <title>é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰</title>
    <link href="https://www.howardliu.cn/effective-java-easyexcel-action-write/"/>
    <id>https://www.howardliu.cn/effective-java-easyexcel-action-write/</id>
    <published>2021-10-03T22:40:34.000Z</published>
    <updated>2021-10-03T22:40:34.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20211004065308.jpeg" alt="é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/kimdaejeung-7703165/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6549208" target="_blank" rel="noopener">dae jeung kim</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6549208" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å¯¼å‡ºæ˜¯ä¸­åå°å¸¸è§çš„åŠŸèƒ½ï¼ŒExcelæ–‡ä»¶æ˜¯å¸¸è§çš„å¯¼å‡ºæ ¼å¼ã€‚</p><a id="more"></a><p>åœ¨Javaæ ˆä¸­ï¼Œå¸¸ç”¨çš„æ˜¯<a href="https://sourceforge.net/projects/jexcelapi/" target="_blank" rel="noopener">JXLï¼ˆç›®å‰æ”¹åä¸ºJExcelï¼‰</a>å’Œ<a href="http://poi.apache.org/" target="_blank" rel="noopener">Apache POI</a>ã€‚å…¶ä¸­jxlæœ€åçš„æ›´æ–°æ—¶é—´æ˜¯2012ï¼Œé™¤äº†è€ç³»ç»Ÿä¸­èƒ½çœ‹åˆ°å½±å­ï¼Œå‡ ä¹è§ä¸åˆ°è¸ªè¿¹äº†ã€‚ç›®å‰åŸºæœ¬ä¸Šæ˜¯POIä¸€ç»Ÿå¤©ä¸‹ã€‚</p><p>ä»Šå¤©è¦è¯´çš„EasyExcelé˜¿é‡Œå·´å·´å¼€æºçš„Excelå¯¼å‡ºç±»åº“ï¼Œæ˜¯å¯¹POIçš„å°è£…ï¼Œå®ç°äº†å¾ˆå¤šé«˜çº§åŠŸèƒ½ï¼Œå¹¶ä¸”ç•™å‡ºæ‰©å±•å£ï¼Œæ”¯æŒæ‰©å±•å®šåˆ¶åŒ–åŠŸèƒ½ã€‚æ‰“ä¸ªæ¯”å–»ï¼ŒPOIç›¸å½“äºä¹é«˜ç§¯æœ¨ï¼Œä¸€ä¸ªä¸ªçš„å°ç§¯æœ¨å¯ä»¥è‡ªç”±ç»„è£…ï¼Œåªèƒ½åŠ¨æ‰‹èƒ½åŠ›å¼ºï¼Œå°±å¯ä»¥éšå¿ƒæ‰€æ¬²çš„ç»„è£…ã€‚EasyExcelæ›´åƒæ˜¯æŠŠè¿™äº›å°ç§¯æœ¨æå‰ç»„è£…å¥½ï¼Œæƒ³è¦æ­å»ºæˆ¿å­ï¼Œå°±ç›´æ¥æ‰¾ç»„è£…å¥½çš„å±‹é¡¶ã€å›´å¢™å°±è¡Œã€‚å¦‚æœä»…ä»…å¦‚æ­¤ï¼Œé‚£EasyExcelä»…ä»…å°±æ˜¯ç®€å•çš„å·¥å…·åŒ…ï¼Œå…¶æ›´åŠ å¸å¼•äººçš„åœ°æ–¹æ˜¯å¯¹äºå†…å­˜çš„æ§åˆ¶ï¼Œå®ƒé€šè¿‡å‹ç¼©æ–‡ä»¶ã€åˆ†æ‰¹è¯»å–ã€æŠ›å¼ƒä¸é‡è¦æ•°æ®ã€æ–‡ä»¶ç¼“å­˜ç­‰å¤šç§æ–¹å¼ï¼Œé™ä½å†…å­˜æ¶ˆè€—ã€‚</p><p>å†…å®¹æ¯”è¾ƒå¤šï¼Œæ–‡å†…åªä¼šåˆ—å‡ºå…³é”®ä»£ç ï¼Œæƒ³è¦å®Œæ•´æºç ï¼Œå¯ä»¥å…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤â€œeasyexcelâ€è·å–ã€‚</p><h2 id="æœ€ç®€å•çš„å†™è¡¨æ ¼"><a href="#æœ€ç®€å•çš„å†™è¡¨æ ¼" class="headerlink" title="æœ€ç®€å•çš„å†™è¡¨æ ¼"></a>æœ€ç®€å•çš„å†™è¡¨æ ¼</h2><p>å¼€å§‹ä¹‹å‰ï¼Œå…ˆå®šä¹‰ä¸€ä¸‹åŸºç¡€ç±»ï¼Œè¿™ä¸ªç±»å°†è´¯ç©¿å…¨æ–‡ï¼Œæ‰€æœ‰çš„åŠŸèƒ½éƒ½æ˜¯åœ¨è¿™ä¸ªç±»çš„ç®€å•å˜å½¢ã€‚</p><pre><code class="java">@Datapublic class Item {    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)    private String string;    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)    private Double doubleData;    @ExcelIgnore    private String ignore;}</code></pre><h3 id="æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘ä¸€ä¸ªå·¥ä½œè¡¨ä¸­å†™ä¸€ä¸ªè¡¨æ ¼"><a href="#æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘ä¸€ä¸ªå·¥ä½œè¡¨ä¸­å†™ä¸€ä¸ªè¡¨æ ¼" class="headerlink" title="æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘ä¸€ä¸ªå·¥ä½œè¡¨ä¸­å†™ä¸€ä¸ªè¡¨æ ¼"></a>æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘ä¸€ä¸ªå·¥ä½œè¡¨ä¸­å†™ä¸€ä¸ªè¡¨æ ¼</h3><p>è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§å®ç°ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªå¯¹è±¡ç±»ï¼Œç„¶åè¯»å–æ•°æ®åˆ—è¡¨å³å¯ã€‚</p><pre><code class="java">/** * å€ŸåŠ©{@link com.alibaba.excel.write.builder.ExcelWriterSheetBuilder}è‡ªåŠ¨åˆ›å»º{@link com.alibaba.excel.ExcelWriter}å†™å…¥æ•°æ®ã€‚ * &lt;p&gt; * æä¾›åˆ—è¡¨å’Œå‡½æ•°ä½œä¸ºæ•°æ®æº */public static void writeAutoWriter() {    final String fileName = defaultFileName(&quot;writeAutoWriter&quot;);    EasyExcelFactory.write(fileName)            .head(Item.class)            .sheet(&quot;æ¨¡æ¿&quot;)            .doWrite(WriteSample::sampleItems);}</code></pre><p>EasyExcelæä¾›äº†<code>EasyExcelFactory</code>ç±»ï¼ŒAPIæ–¹æ³•ä¹Ÿæ˜¯fluentæ–¹å¼ï¼Œå¯ä»¥å¦‚ä¸èˆ¬é¡ºæ»‘çš„å®ç°ç”ŸæˆExcelæ–‡ä»¶ã€‚å¦‚æœæ„Ÿè§‰<code>EasyExcelFactory</code>å¤ªé•¿ï¼Œè¿˜å¯ä»¥ç›´æ¥å†™ä½œ<code>EasyExcel</code>ï¼Œè¿™æ˜¯<code>EasyExcelFactory</code>çš„å­ç±»ï¼Œç±»ä¼¼äºåˆ«åã€‚</p><blockquote><p>ä¸è¿‡ï¼Œè¿™ç§åˆ«åå®šä¹‰æ–¹å¼ï¼Œåœ¨æœ‰äº›è§„èŒƒä¸­å±äº<code>smell code</code>ï¼Œæ‰€ä»¥ï¼Œæ ¹æ®è‡ªå·±æˆ–è€…å…¬å¸è§„èŒƒé€‰æ‹©å§ã€‚</p></blockquote><p><code>com.alibaba.excel.EasyExcelFactory#write(java.lang.String)</code>æ–¹æ³•çš„å‚æ•°ä¼ çš„æ˜¯å¯¼å‡ºæ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¦‚æœå¹¶ä¸éœ€è¦ç”Ÿæˆæ–‡ä»¶ï¼Œåªéœ€è¦åˆ›å»ºæ–‡ä»¶æµï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªè¾“å‡ºæµ<code>OutputStream</code>ï¼Œè¿™æ ·å°±å¯ä»¥æ›´åŠ çµæ´»çš„å®ç°ç”Ÿæˆé€»è¾‘äº†ã€‚</p><p><code>com.alibaba.excel.metadata.AbstractParameterBuilder#head()</code>æ–¹æ³•æ˜¯å®šä¹‰è¡¨å¤´ï¼Œåªè¦ä¼ å…¥ä¸€ä¸ªç±»ï¼Œå°±ä¼šè¯»å–è¿™ä¸ªç±»çš„æ‰€æœ‰å­—æ®µä½œä¸ºè¡¨å¤´ã€‚å¦‚æœå­—æ®µä¸Š<code>com.alibaba.excel.annotation.ExcelProperty</code>æ³¨è§£ï¼Œå®šä¹‰äº†<code>value</code>ï¼Œå°±ä¼šå–<code>value</code>çš„å€¼ä½œä¸ºè¡¨å¤´ã€‚æ­¤å¤„è¿˜æœ‰å¾ˆå¤šæ“ä½œï¼Œæ¯”å¦‚ï¼Œ<code>value</code>æ˜¯æ•°ç»„ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªï¼Œå¦‚æœæ˜¯ç›¸é‚»å­—æ®µå®šä¹‰äº†ç›¸åŒçš„è¡¨å¤´ï¼Œä¼šåˆå¹¶å•å…ƒæ ¼ï¼Œè¡¨ä½“å†…å®¹ä¼šé€‰æ‹©ç¬¬ä¸€ä¸ªå•å…ƒæ ¼çš„å†…å®¹ã€‚è¿™ä¸ªæ³¨è§£è¿˜å¯ä»¥å®šä¹‰<code>index</code>ã€<code>order</code>ã€<code>converter</code>ç­‰ï¼Œåé¢ä¼šä¸€ä¸€ç»™å‡ºä¾‹å­ã€‚</p><p><code>com.alibaba.excel.write.builder.ExcelWriterBuilder#sheet()</code>æ–¹æ³•å®šä¹‰å·¥ä½œè¡¨ï¼Œæœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œå¯ä»¥å®šä¹‰<code>sheetNo</code>æŒ‡æ˜æ˜¯ç¬¬å‡ ä¸ªå·¥ä½œè¡¨ï¼Œå¯ä»¥ä¼ å…¥<code>sheetName</code>æŒ‡æ˜å·¥ä½œè¡¨åç§°ã€‚</p><p><code>com.alibaba.excel.write.builder.ExcelWriterSheetBuilder#doWrite()</code>æ–¹æ³•å°±æ˜¯å†™Excelæ–‡ä»¶äº†ï¼Œä¼ å…¥å…¨éƒ¨çš„åˆ—è¡¨æ•°æ®ï¼Œæˆ–è€…ä½¿ç”¨Java8+çš„<code>Supplier</code>å‡½æ•°ã€‚è¿˜å¯ä»¥å®ç°åˆ†é¡µå†™å…¥ï¼Œåé¢ä¼šç»™å‡ºä¾‹å­ã€‚è¿™ä¸ªæ–¹æ³•ä¼šè‡ªåŠ¨å…³é—­æ–‡ä»¶æµï¼ŒçœŸæ˜¯å¾ˆè´´å¿ƒã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065644.png" alt="æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘ä¸€ä¸ªå·¥ä½œè¡¨ä¸­å†™ä¸€ä¸ªè¡¨æ ¼"></p><h3 id="æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®"><a href="#æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®" class="headerlink" title="æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®"></a>æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®</h3><p>ä¸Šé¢æ˜¯å‘ä¸€ä¸ªå·¥ä½œè¡¨å†™æ•°æ®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å‘å¤šä¸ªå·¥ä½œè¡¨å†™æ•°æ®ã€‚</p><blockquote><p>è¿™ä¸ªä¾‹å­ä¼šæ¶‰åŠæ›´å¤šçš„å†…éƒ¨å¯¹è±¡ï¼Œæ¯”å¦‚ï¼šExcelWriterã€WriteSheetã€‚</p></blockquote><pre><code class="java">/** * æ‰‹åŠ¨åˆ›å»º{@link com.alibaba.excel.ExcelWriter}ï¼ŒæŒ‡å®šsheetå†™å…¥æ•°æ®ã€‚ * &lt;p&gt; * æä¾›åˆ—è¡¨å’Œå‡½æ•°ä½œä¸ºæ•°æ®æº */public static void writeManualWither() {    String fileName = defaultFileName(&quot;writeManualWriter&quot;);    ExcelWriter excelWriter = null;    try {        excelWriter = EasyExcelFactory.write(fileName)                .head(Item.class)                .build();        final WriteSheet writeSheet1 = EasyExcelFactory.writerSheet(&quot;æ¨¡æ¿1&quot;).build();        excelWriter.write(WriteSample::sampleItems, writeSheet1);        final WriteSheet writeSheet2 = EasyExcelFactory.writerSheet(&quot;æ¨¡æ¿2&quot;).build();        excelWriter.write(sampleItems(), writeSheet2);    } finally {        // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>å› ä¸ºæ˜¯æƒ³å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ç›´æ¥ä½¿ç”¨<code>doWrite</code>æ–¹æ³•äº†ã€‚</p><p><code>com.alibaba.excel.ExcelWriter</code>ç±»æ˜¯Excelå†™å¯¹è±¡ï¼Œç”¨æ¥åˆ›å»ºExcelå·¥ä½œç°¿çš„ã€‚<code>com.alibaba.excel.write.metadata.WriteSheet</code>ç±»æ˜¯Sheetå†™å¯¹è±¡ï¼Œç”¨æ¥åˆ›å»ºSheetå·¥ä½œè¡¨çš„ã€‚é€šè¿‡<code>com.alibaba.excel.ExcelWriter#write()</code>æ–¹æ³•ï¼ŒæŒ‡å®šå†™å…¥æ•°æ®å’Œå†™å…¥çš„ç›®æ ‡å·¥ä½œè¡¨ï¼Œå°±å¯ä»¥å®ç°å‘å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®çš„åŠŸèƒ½ã€‚</p><p>æ­¤å¤„éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨åˆ›å»º<code>ExcelWriter</code>å¯¹è±¡æ—¶ï¼Œè°ƒç”¨äº†<code>head()</code>æ–¹æ³•å®šä¹‰äº†è¡¨å¤´ï¼Œè¿™æ˜¯æ•´ä¸ªExcelçš„å®šä¹‰ï¼Œsheetä¼šç»§æ‰¿è¿™ä¸ªå®šä¹‰ã€‚è¿™æ ·ï¼Œæ•´ä¸ªExcelæ–‡ä»¶ä¸­çš„æ‰€æœ‰å·¥ä½œè¡¨ï¼Œè¡¨å¤´éƒ½æ˜¯ç›¸åŒçš„ã€‚ä¸è¦åœï¼Œåé¢ä¼šç»™å‡ºä¸åŒå·¥ä½œè¡¨å®šä¹‰ä¸åŒè¡¨å¤´çš„ç¤ºä¾‹ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065724.png" alt="æ ¹æ®å¤´å¯¹è±¡å’Œåˆ—è¡¨å‘å¤šä¸ªå·¥ä½œè¡¨ä¸­å†™æ•°æ®"></p><h2 id="æŒ‰ç…§å®šä¹‰æŒ‡å®šå¯¼å‡ºåˆ—"><a href="#æŒ‰ç…§å®šä¹‰æŒ‡å®šå¯¼å‡ºåˆ—" class="headerlink" title="æŒ‰ç…§å®šä¹‰æŒ‡å®šå¯¼å‡ºåˆ—"></a>æŒ‰ç…§å®šä¹‰æŒ‡å®šå¯¼å‡ºåˆ—</h2><p>åœ¨åå°ç³»ç»Ÿä¸­ï¼Œä¼šæœ‰è¡Œåˆ—æƒé™çš„æ§åˆ¶ã€‚è¡Œæƒé™ï¼Œé€šè¿‡æ•°æ®è¡Œå®ç°ï¼Œåªå¯¼å‡ºæœ‰æƒé™çš„è¡Œæ•°æ®å³å¯ã€‚åˆ—æƒé™ï¼Œå¯ä»¥é€šè¿‡åªå¯¼å‡ºæœ‰æƒé™çš„åˆ—ï¼Œæ’é™¤æ²¡æœ‰æƒé™çš„åˆ—ï¼ˆé€šå¸¸æ˜¯åˆ†ç­‰çº§çš„æ•æ„Ÿæ•°æ®ï¼‰ã€‚</p><p>æœ‰æ—¶å€™éœ€è¦å®šåˆ¶åŒ–å¯¼å‡ºï¼Œå¯¼å‡ºæ‰€æœ‰åˆ—è¡¨æ ¼æ¯”è¾ƒå¤§ï¼Œç”¨æˆ·æ ¹æ®éœ€è¦æŒ‡å®šéœ€è¦å¯¼å‡ºçš„åˆ—ã€‚</p><h3 id="æ’é™¤æŒ‡å®šåˆ—"><a href="#æ’é™¤æŒ‡å®šåˆ—" class="headerlink" title="æ’é™¤æŒ‡å®šåˆ—"></a>æ’é™¤æŒ‡å®šåˆ—</h3><pre><code class="java">private static void writeExcludeColumn() {    String fileName = defaultFileName(&quot;writeExcludeColumn&quot;);    Set&lt;String&gt; excludeColumnFiledNames = new HashSet&lt;&gt;();    excludeColumnFiledNames.add(&quot;date&quot;);    EasyExcelFactory.write(fileName)            .head(Item.class)            .excludeColumnFiledNames(excludeColumnFiledNames)            .sheet(&quot;æ¨¡æ¿&quot;)            .doWrite(WriteSample::sampleItems);}</code></pre><p>è¿™ä¸ªéœ€æ±‚ï¼Œéœ€è¦å€ŸåŠ©<code>com.alibaba.excel.write.builder.AbstractExcelWriterParameterBuilder#excludeColumnFiledNames</code>æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨<code>ExcelWriterBuilder</code>ã€<code>ExcelWriterSheetBuilder</code>ã€<code>ExcelWriterTableBuilder</code>çš„çˆ¶ç±»ä¸­å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥æ˜¯æ•´ä¸ªExcelå·¥ä½œç°¿éƒ½æ’é™¤æŒ‡å®šå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªsheetå·¥ä½œè¡¨æ’é™¤æŒ‡å®šå­—æ®µï¼Œè¿˜å¯ä»¥æ˜¯tableè¡¨æ ¼æ’é™¤æŒ‡å®šå­—æ®µã€‚</p><p>é™¤äº†<code>excludeColumnFiledNames</code>é€šè¿‡å­—æ®µåæ’é™¤å­—æ®µï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>excludeColumnIndexes</code>æŒ‡å®šå­—æ®µä¸‹æ ‡æ’é™¤åˆ—ï¼Œå¦‚æœéœ€è¦æ§åˆ¶ä¸‹æ ‡ï¼Œéœ€è¦åœ¨å­—æ®µä¸Šå®šä¹‰<code>ExcelProperty</code>æŒ‡æ˜indexå±æ€§ï¼Œè¿™æ ·ä¹Ÿèƒ½å¤Ÿæ›´å¥½çš„å›ºå®šå­—æ®µä¸‹æ ‡ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065753.png" alt="æ’é™¤æŒ‡å®šåˆ—"></p><h3 id="åªå¯¼å‡ºæŒ‡å®šåˆ—"><a href="#åªå¯¼å‡ºæŒ‡å®šåˆ—" class="headerlink" title="åªå¯¼å‡ºæŒ‡å®šåˆ—"></a>åªå¯¼å‡ºæŒ‡å®šåˆ—</h3><pre><code class="java">private static void writeIncludeColumn() {    String fileName = defaultFileName(&quot;writeIncludeColumn&quot;);    Set&lt;String&gt; includeColumnFiledNames = new HashSet&lt;&gt;();    includeColumnFiledNames.add(&quot;date&quot;);    EasyExcelFactory.write(fileName)            .head(Item.class)            .includeColumnFiledNames(includeColumnFiledNames)            .sheet(&quot;æ¨¡æ¿&quot;)            .doWrite(WriteSample::sampleItems);}</code></pre><p>è¿™ä¸ªéœ€æ±‚ï¼Œéœ€è¦å€ŸåŠ©<code>com.alibaba.excel.write.builder.AbstractExcelWriterParameterBuilder#includeColumnFiledNames</code>æ–¹æ³•ã€‚ä¸<code>excludeColumnFiledNames</code>æ˜¯ç›¸ä¼¼ï¼Œéƒ½æ˜¯å¯ä»¥åˆ†çº§å®šä¹‰ï¼Œç”¨èµ·æ¥ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡åŠŸèƒ½ç›¸åè€Œå·²ã€‚</p><p>åŒæ ·çš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>includeColumnIndexes</code>æ–¹æ³•ï¼Œé€šè¿‡æŒ‡å®šå­—æ®µä¸‹æ ‡æŒ‡å®šåˆ—ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065816.png" alt="åªå¯¼å‡ºæŒ‡å®šåˆ—"></p><h2 id="è¡¨å¤´"><a href="#è¡¨å¤´" class="headerlink" title="è¡¨å¤´"></a>è¡¨å¤´</h2><p>è¡¨å¤´çš„å®šä¹‰æ˜¯æ¯”è¾ƒå…³é”®çš„ï¼Œä¼šç›´æ¥å½±å“Excelæ–‡ä»¶çš„è´¨é‡ã€‚æ‰€ä»¥ï¼ŒEasyExcelæä¾›äº†æ¯”è¾ƒä¸°å¯Œçš„è¡¨å¤´å®šä¹‰æ–¹æ³•ã€‚</p><h3 id="åŸå§‹è¡¨å¤´"><a href="#åŸå§‹è¡¨å¤´" class="headerlink" title="åŸå§‹è¡¨å¤´"></a>åŸå§‹è¡¨å¤´</h3><p>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªæ–°çš„åŸºç¡€ç±»ï¼š<code>EmptyItem</code>ï¼Œä¸<code>Item</code>çš„åŒºåˆ«æ˜¯ç§»é™¤äº†<code>ExcelProperty</code>çš„å®šä¹‰ã€‚</p><pre><code class="java">@Datapublic class EmptyItem {    private String string;    private Date date;    private Double doubleData;}</code></pre><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šç›´æ¥ä½¿ç”¨<code>EmptyItem</code>å¯¹è±¡çš„å­—æ®µä½œä¸ºè¡¨å¤´åç§°ã€‚</p><pre><code class="java">private static void writeNoAnnotation() {    final String fileName = defaultFileName(&quot;writeNoAnnotation&quot;);    EasyExcelFactory.write(fileName)            .head(EmptyItem.class)            .sheet(&quot;æ¨¡æ¿&quot;)            .doWrite(WriteSample::sampleItems);}</code></pre><blockquote><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒEasyExcelå¯¹äºè¡¨å¤´å¯¹è±¡ã€è¡¨ä½“åˆ—è¡¨å¯¹è±¡ï¼Œæ²¡æœ‰å¼ºåˆ¶è¦æ±‚å¿…é¡»æ˜¯ç›¸åŒçš„å¯¹è±¡ï¼Œåªè¦å­—æ®µä¸€è‡´ï¼Œå°±èƒ½å¤Ÿæ­£å¸¸ç»„è£…æ•°æ®ã€‚</p></blockquote><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065847.png" alt="åŸå§‹è¡¨å¤´"></p><h3 id="è‡ªå®šä¹‰è¡¨å¤´"><a href="#è‡ªå®šä¹‰è¡¨å¤´" class="headerlink" title="è‡ªå®šä¹‰è¡¨å¤´"></a>è‡ªå®šä¹‰è¡¨å¤´</h3><p>ä½¿ç”¨å­—æ®µä½œä¸ºè¡¨å¤´æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼ŒEasyExcelæä¾›äº†<code>ExcelProperty</code>æ³¨è§£ï¼Œå¯ä»¥å®šä¹‰è¡¨å¤´çš„åç§°ã€‚è¿™ä¸ªæ³¨è§£è¿˜æä¾›äº†<code>index</code>ã€<code>order</code>ä¸¤ä¸ªå±æ€§ï¼Œå¯ä»¥å®šä¹‰åˆ—çš„ä½ç½®å’Œé¡ºåºã€‚</p><pre><code class="java">@Datapublic class IndexItem {    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, index = 1)    private String string;    @ExcelProperty(value = &quot;æ—¥æœŸæ ‡é¢˜&quot;, index = 3)    private Date date;    @ExcelProperty(value = &quot;æ•°å­—æ ‡é¢˜&quot;, index = 5)    private Double doubleData;}</code></pre><p>ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼š</p><pre><code class="java">private static void writeWithIndex() {    final String fileName = defaultFileName(&quot;writeWithIndex&quot;);    EasyExcelFactory.write(fileName)            .head(IndexItem.class)            .sheet(&quot;æ¨¡æ¿&quot;)            .doWrite(WriteSample::sampleItems);}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065911.png" alt="è‡ªå®šä¹‰è¡¨å¤´"></p><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œåœ¨ä½¿ç”¨<code>ExcelProperty</code>æ³¨è§£æ—¶ï¼Œindexè¡¨ç¤ºå­—æ®µæ”¾ç½®ç¬¬å‡ åˆ—ï¼Œorderè¡¨ç¤ºé¡ºåºã€‚</p><p>æ ¹æ®indexå’Œorderçš„ä¸åŒè¯­ä¹‰ï¼Œå¯¹ä¸¤è€…çš„æ§åˆ¶ä¸åŒã€‚å¦‚æœindexç›¸åŒï¼Œç›´æ¥ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºç¨‹åºæ— æ³•åˆ¤æ–­è¿™ä¸ªåˆ—æ”¾é‚£ä¸ªå­—æ®µã€‚å¦‚æœindexå€¼ä¸­é—´æœ‰ç©ºçš„æ•°å­—ï¼Œå°±ä¼šå‡ºç°ç©ºåˆ—ã€‚å¦‚æœorderå’ŒindexåŒæ—¶ä½¿ç”¨ï¼Œindexä¼˜å…ˆå æ®ä½ç½®ï¼Œorderåšæ’åºã€‚index=-1çš„è¯ï¼Œä½¿ç”¨javaé»˜è®¤æ’åºï¼Œorderå€¼è¶Šå°ï¼Œåˆ—è¶Šé å‰ã€‚</p><p><code>ExcelProperty</code>çš„valueå±æ€§æ˜¯å­—ç¬¦ä¸²æ•°ç»„ï¼Œç›¸å½“äºä¸€ä¸ªå­—æ®µå¯ä»¥å®šä¹‰å¤šä¸ªå¤´ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å¤šçº§è¡¨å¤´ã€‚åŒæ—¶ï¼Œå¦‚æœä½ç½®ç›¸é‚»çš„åˆ—å®šä¹‰åˆ—æ˜ç›¸åŒï¼Œè¿˜ä¼šåˆå¹¶åˆ—ã€‚æ¯”å¦‚ï¼š</p><pre><code class="java">@Datapublic class ComplexHeadItem {    @ExcelProperty({&quot;å¤§æ ‡é¢˜&quot;, &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;})    private String string;    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @ExcelProperty({&quot;å¤§æ ‡é¢˜&quot;, &quot;æ•°å­—æ ‡é¢˜0&quot;})    private Double doubleData;    @ExcelProperty({&quot;æ•°å­—æ ‡é¢˜&quot;})    private Double doubleData1;    @ExcelProperty({&quot;æ•°å­—æ ‡é¢˜&quot;})    private Double doubleData2 = 0.0;}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004065935.png" alt="è‡ªå®šä¹‰è¡¨å¤´-åˆå¹¶"></p><h3 id="åŠ¨æ€è¡¨å¤´ã€è¡¨ä½“"><a href="#åŠ¨æ€è¡¨å¤´ã€è¡¨ä½“" class="headerlink" title="åŠ¨æ€è¡¨å¤´ã€è¡¨ä½“"></a>åŠ¨æ€è¡¨å¤´ã€è¡¨ä½“</h3><p>å‰é¢çš„ä¾‹å­ä¸­ï¼Œè¡¨å¤´å®šä¹‰éƒ½æ˜¯ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡è§£æå¯¹è±¡çš„å±æ€§å­—æ®µï¼ŒæŠ½å–è¡¨å¤´å®šä¹‰ã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•æå‰å®šä¹‰è¡¨å¤´å¯¹è±¡ï¼Œæˆ–è€…è¯´ï¼Œè¡¨å¤´æ˜¯æ ¹æ®æ¡ä»¶ã€æƒé™ç­‰å› ç´ åŠ¨æ€å˜åŒ–çš„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨EasyExcelæä¾›çš„åŠ¨æ€è¡¨å¤´åŠŸèƒ½äº†ã€‚</p><pre><code class="java">/** * åŠ¨æ€è¡¨å¤´ï¼Œä¼ å…¥çš„æ˜¯{@code List&lt;List&lt;String&gt;&gt;}æ ¼å¼æ•°æ®ã€‚ * &lt;p&gt; * å¯ä»¥å®ç°å¤šå±‚è¡¨å¤´ã€‚ */private static void writeDynamicHead() {    String fileName = defaultFileName(&quot;writeDynamicHead&quot;);    EasyExcelFactory.write(fileName)            .head(dynamicHead())            .sheet()            .doWrite(sampleItems());}private static List&lt;List&lt;String&gt;&gt; dynamicHead() {    List&lt;List&lt;String&gt;&gt; heads = new ArrayList&lt;&gt;();    final List&lt;String&gt; head0 = new ArrayList&lt;&gt;(Arrays.asList(&quot;å¤´0&quot;, &quot;å­—ç¬¦ä¸²æ ‡é¢˜ã€åŠ¨æ€ã€‘&quot;));    heads.add(head0);    final List&lt;String&gt; head1 = new ArrayList&lt;&gt;(Arrays.asList(&quot;å¤´0&quot;, &quot;æ—¥æœŸæ ‡é¢˜ã€åŠ¨æ€ã€‘&quot;));    heads.add(head1);    final List&lt;String&gt; head2 = new ArrayList&lt;&gt;(Collections.singletonList(&quot;æ•°å­—æ ‡é¢˜ã€åŠ¨æ€ã€‘&quot;));    heads.add(head2);    return heads;}</code></pre><p>ä½¿ç”¨<code>com.alibaba.excel.metadata.AbstractParameterBuilder#head(java.util.List&lt;java.util.List&lt;java.lang.String&gt;&gt;)</code>æ–¹æ³•ï¼Œä¼ å…¥<code>List&lt;List&lt;String&gt;&gt;</code>ç±»å‹çš„æ•°æ®å³å¯ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070011.png" alt="åŠ¨æ€è¡¨å¤´ã€è¡¨ä½“"></p><p>å½“ç„¶ï¼Œè¿™æ ·åšè¿˜ä¸æ˜¯å½»åº•çš„åŠ¨æ€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>com.alibaba.excel.write.builder.ExcelWriterSheetBuilder#doWrite(java.util.Collection&lt;?&gt;)</code>å®ç°åŠ¨æ€è¡¨ä½“ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">private static void writeDynamicData() {    String fileName = defaultFileName(&quot;writeDynamicData&quot;);    EasyExcelFactory.write(fileName)            .head(dynamicHead())            .sheet()            .doWrite(dynamicData());}private static List&lt;List&lt;Object&gt;&gt; dynamicData() {    List&lt;List&lt;Object&gt;&gt; list = new ArrayList&lt;&gt;();    for (int i = 0; i &lt; 10; i++) {        List&lt;Object&gt; data = new ArrayList&lt;&gt;();        data.add(&quot;å­—ç¬¦ä¸²&quot; + i);        data.add(new Date());        data.add((i + 1) * 0.1);        list.add(data);    }    return list;}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070036.png" alt="åŠ¨æ€è¡¨å¤´ã€è¡¨ä½“"></p><h3 id="è¡¨å¤´å›½é™…åŒ–"><a href="#è¡¨å¤´å›½é™…åŒ–" class="headerlink" title="è¡¨å¤´å›½é™…åŒ–"></a>è¡¨å¤´å›½é™…åŒ–</h3><p>äº’è”ç½‘æ— å›½ç•Œï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å®ç°å›½é™…åŒ–ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€è¡¨å¤´åŠŸèƒ½ï¼Œä¼ å…¥ä¸åŒçš„è¡¨å¤´å®šä¹‰ï¼Œç”Ÿæˆä¸åŒçš„Excelæ–‡ä»¶ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æå‰å®šä¹‰è¡¨ä½“çš„æ ¼å¼ï¼Œä½¿ç”¨åŠ¨æ€è¡¨ä½“å¯ä»¥å®ç°ã€‚æœ‰æ²¡æœ‰æ›´åŠ ç®€å•æ–¹æ³•å‘¢ï¼Ÿå¿…é¡»æœ‰ã€‚</p><p>å…ˆå®šä¹‰æ ¼å¼åŒ–è¡¨å¤´å¯¹è±¡ï¼š</p><pre><code class="java">@Datapublic class FormatContentItem {    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, converter = TitleFormatConverter.class)    private String string;    @DateTimeFormat(&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;)    @ExcelProperty(value = &quot;æ—¥æœŸæ ‡é¢˜&quot;)    private Date date;    @NumberFormat(&quot;0.000%&quot;)    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)    private Double doubleData;}</code></pre><p>å†å®ç°å›½é™…åŒ–ï¼š</p><pre><code class="java">/** * å¯ä»¥åŒæ—¶è®¾ç½®headå‚æ•°ï¼š * {@link AbstractParameterBuilder#head(java.util.List)} * {@link AbstractParameterBuilder#head(java.lang.Class)} * &lt;p&gt; * å¯¹äºè¡¨å¤´è®¾ç½®ï¼Œæœ€ç»ˆèµ·ä½œç”¨çš„æ˜¯{@link AbstractParameterBuilder#head(java.util.List)}ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å›½é™…åŒ–çš„é…ç½®ã€‚ */private static void writeDynamicMultiHead() {    String fileName = defaultFileName(&quot;writeDynamicMultiHead&quot;);    EasyExcelFactory.write(fileName)            .head(dynamicHead())            .head(FormatContentItem.class)            .sheet()            .doWrite(sampleItems());}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070102.png" alt="è¡¨å¤´å›½é™…åŒ–"></p><h2 id="å¤šæ¬¡å†™å…¥"><a href="#å¤šæ¬¡å†™å…¥" class="headerlink" title="å¤šæ¬¡å†™å…¥"></a>å¤šæ¬¡å†™å…¥</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸­åå°çš„æ•°æ®é‡éƒ½ä¸å°ï¼Œæœ‰æ—¶å€™éœ€è¦ä¸€æ¬¡å¯¼å‡ºå‡ åä¸‡è¡Œæ•°æ®ï¼Œç”šè‡³æ›´å¤šï¼Œè€Œè¿™ç§æ“ä½œå¹¶ä¸æ˜¯å¸¸æ€ï¼Œå¦‚æœå†…å­˜é…ç½®æ¯”è¾ƒå¤§ï¼Œé‚£å¤§å¤šæ•°æ—¶é—´å†…å­˜éƒ½æ˜¯é—²ç½®çŠ¶æ€ã€‚æ­¤æ—¶ï¼Œå°±å¯ä»¥å€ŸåŠ©EasyExcelçš„æ–‡ä»¶ç¼“å­˜èƒ½åŠ›ï¼Œåˆ†æ‰¹å†™å…¥æ•°æ®ã€‚</p><h3 id="å‘åŒä¸€ä¸ªexcelåŒä¸€ä¸ªsheetä¸­å¤šæ¬¡å†™å…¥"><a href="#å‘åŒä¸€ä¸ªexcelåŒä¸€ä¸ªsheetä¸­å¤šæ¬¡å†™å…¥" class="headerlink" title="å‘åŒä¸€ä¸ªexcelåŒä¸€ä¸ªsheetä¸­å¤šæ¬¡å†™å…¥"></a>å‘åŒä¸€ä¸ªexcelåŒä¸€ä¸ªsheetä¸­å¤šæ¬¡å†™å…¥</h3><p>é¦–å…ˆæ˜¯æ¯”è¾ƒå¸¸è§çš„åœºæ™¯ï¼Œå‘ä¸€ä¸ªsheetå·¥ä½œè¡¨ä¸­åˆ†æ‰¹å†™å…¥æ•°æ®ã€‚</p><pre><code class="java">private static void writeOneSheet() {    String fileName = defaultFileName(&quot;writeOneSheet&quot;);    ExcelWriter excelWriter = null;    try {        excelWriter = EasyExcelFactory.write(fileName)                .head(Item.class)                .build();        final WriteSheet writeSheet = EasyExcelFactory.writerSheet(&quot;æ¨¡æ¿&quot;).build();        for (int i = 0; i &lt; 5; i++) {            excelWriter.write(sampleItems(), writeSheet);        }    } finally {        // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>é¦–å…ˆå®šä¹‰<code>ExcelWriter</code>å¯ä»¥æ“ä½œæ•´ä¸ªExcelå·¥ä½œç°¿ï¼Œç„¶åå®šä¹‰<code>ExcelWriter</code>sheetå·¥ä½œè¡¨ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¾ªç¯è°ƒç”¨<code>com.alibaba.excel.ExcelWriter.write(java.util.Collection&lt;?&gt;, com.alibaba.excel.write.metadata.WriteSheet)</code>æ–¹æ³•ï¼Œå°†æ•°æ®å†™å…¥åˆ°æŒ‡å®šçš„sheetå·¥ä½œè¡¨ä¸­ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ€åä¸€å®šè¦è°ƒç”¨<code>com.alibaba.excel.ExcelWriter.finish</code>æ–¹æ³•ï¼Œè¡¨ç¤ºåœæ­¢å†™å…¥å¹¶å…³é—­æµã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070128.png" alt="å‘åŒä¸€ä¸ªexcelåŒä¸€ä¸ªsheetä¸­å¤šæ¬¡å†™å…¥"></p><h3 id="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ç›¸åŒï¼‰"><a href="#å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ç›¸åŒï¼‰" class="headerlink" title="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ç›¸åŒï¼‰"></a>å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ç›¸åŒï¼‰</h3><p>è¿˜æœ‰ä¸€ç§åœºæ™¯æ˜¯æŒ‰æœˆå¯¼å‡ºå…¨å¹´çš„è®¢å•æ•°æ®ï¼Œæ¯ä¸ªæœˆä¸€ä¸ªsheetå·¥ä½œè¡¨ï¼Œè¿™ç§å¯¼å‡ºçš„æ–¹å¼ï¼Œè¡¨å¤´éƒ½æ˜¯ç›¸åŒçš„ã€‚æ ¹æ®ä¸Šé¢çš„ç»éªŒï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å¤šä¸ª<code>WriteSheet</code>å·¥ä½œè¡¨å¯¹è±¡ï¼Œç„¶åå‘è¯¥å¯¹è±¡ä¸­å†™æ•°æ®ã€‚</p><p>è¿™é‡Œè¿˜å¯èƒ½æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦åœ¨å¤šä¸ª<code>WriteSheet</code>å·¥ä½œè¡¨å¯¹è±¡ä¹‹é—´åˆ‡æ¢å†™å…¥ï¼Œä¸ºäº†ä¸ä¼šæ‰¾é”™å¯¹è±¡ï¼Œå¯ä»¥æŒ‡å®š<code>sheetNo</code>ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">private static void writeDiffSheetWithSameHead() {    String fileName = defaultFileName(&quot;writeDiffSheetWithSameHead&quot;);    ExcelWriter excelWriter = null;    try {        excelWriter = EasyExcelFactory.write(fileName)                .head(Item.class)                .build();        for (int i = 0; i &lt; 5; i++) {            final WriteSheet writeSheet = EasyExcelFactory.writerSheet(i, &quot;æ¨¡æ¿&quot; + i)                    .build();            excelWriter.write(sampleItems(), writeSheet);        }    } finally {        // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070152.png" alt="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ç›¸åŒï¼‰"></p><p><img src="https://static.howardliu.cn/20211004070212.png" alt="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ç›¸åŒï¼‰"></p><h3 id="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ä¸åŒï¼‰"><a href="#å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ä¸åŒï¼‰" class="headerlink" title="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ä¸åŒï¼‰"></a>å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ä¸åŒï¼‰</h3><p>è¿˜æœ‰ä¸€ç§åœºæ™¯ï¼Œå¯¼å‡ºæŒ‡å®šæ—¶é—´èŒƒå›´çš„è®¢å•ä¿¡æ¯ï¼Œä¸€ä¸ªsheetå·¥ä½œè¡¨æ”¾å…·ä½“çš„å•†å“ä¿¡æ¯ï¼Œå¦ä¸€ä¸ªsheetå·¥ä½œè¡¨æ”¾è®¢å•æ”¶è´§åœ°å€ä¿¡æ¯ã€‚è¿™ç§åœºæ™¯å°±éœ€è¦ä¸åŒçš„è¡¨å¤´ï¼Œæ ¹æ®å‰é¢çš„è®²è§£ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåªéœ€è¦åœ¨å®šä¹‰<code>WriteSheet</code>å¯¹è±¡æ—¶æŒ‡å®šä¸åŒçš„è¡¨å¤´å¯¹è±¡å³å¯ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">private static void writeDiffSheetWithDiffHead() {    String fileName = defaultFileName(&quot;writeDiffSheetWithDiffHead&quot;);    ExcelWriter excelWriter = null;    try {        excelWriter = EasyExcelFactory.write(fileName)                .build();        final WriteSheet writeSheet0 = EasyExcelFactory.writerSheet(0, &quot;æ¨¡æ¿1&quot;)                .head(Item.class)                .build();        excelWriter.write(sampleItems(), writeSheet0);        final WriteSheet writeSheet1 = EasyExcelFactory.writerSheet(1, &quot;æ¨¡æ¿2&quot;)                .head(ComplexHeadItem.class)                .build();        excelWriter.write(sampleItems(), writeSheet1);    } finally {        // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070229.png" alt="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ä¸åŒï¼‰"></p><p><img src="https://static.howardliu.cn/20211004070246.png" alt="å‘åŒä¸€ä¸ªexcelä¸åŒsheetä¸­å¤šæ¬¡å†™å…¥ï¼ˆè¡¨å¤´ä¸åŒï¼‰"></p><h2 id="å®ç°å¤šè¡¨"><a href="#å®ç°å¤šè¡¨" class="headerlink" title="å®ç°å¤šè¡¨"></a>å®ç°å¤šè¡¨</h2><p>EasyExcelå¯¹äºExcelæ–‡ä»¶å®šä¹‰åˆ†æˆäº†ä¸‰å±‚ï¼Œ</p><ol><li>å·¥ä½œç°¿ï¼Œä¹Ÿå°±æ˜¯Excelæ–‡ä»¶</li><li>å·¥ä½œè¡¨ï¼Œå¯¹åº”æ˜¯Excelæ–‡ä»¶ä¸­çš„Sheet</li><li>è¡¨æ ¼ï¼Œå¯¹åº”æ˜¯Sheetä¸­çš„æœ‰è¡¨å¤´ã€è¡¨ä½“çš„ç»„åˆ</li></ol><p>è¿™é‡Œæ‰€è¯´çš„åŠŸèƒ½å°±æ˜¯åœ¨ä¸€ä¸ªSheetä¸­åˆ›å»ºå¤šä¸ªè¡¨æ ¼ã€‚</p><h3 id="åŒä¸€è¡¨å•ä¸­åˆ›å»ºè¡¨æ ¼"><a href="#åŒä¸€è¡¨å•ä¸­åˆ›å»ºè¡¨æ ¼" class="headerlink" title="åŒä¸€è¡¨å•ä¸­åˆ›å»ºè¡¨æ ¼"></a>åŒä¸€è¡¨å•ä¸­åˆ›å»ºè¡¨æ ¼</h3><p>è¿™ä¸ªæ˜¯å¼€èƒƒèœï¼Œæ¼”ç¤ºä¸€ä¸‹æ€ä¹ˆå•ç‹¬æŒ‡å®šè¡¨æ ¼ã€‚</p><pre><code class="java">private static void writeTable() {    String fileName = defaultFileName(&quot;writeTable&quot;);    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName)            .head(Item.class)            .build();    try {        // æŠŠsheetè®¾ç½®ä¸ºä¸éœ€è¦å¤´ ä¸ç„¶ä¼šè¾“å‡ºsheetçš„å¤´ è¿™æ ·çœ‹èµ·æ¥ç¬¬ä¸€ä¸ªtable å°±æœ‰2ä¸ªå¤´äº†        WriteSheet writeSheet = EasyExcelFactory.writerSheet()                .needHead(Boolean.FALSE)                .build();        // è¿™é‡Œå¿…é¡»æŒ‡å®šéœ€è¦å¤´ï¼Œtable ä¼šç»§æ‰¿sheetçš„é…ç½®ï¼Œsheeté…ç½®äº†ä¸éœ€è¦ï¼Œtable é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦        WriteTable writeTable0 = EasyExcelFactory.writerTable(0)                .needHead(Boolean.TRUE)                .build();        excelWriter.write(sampleItems(), writeSheet, writeTable0);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†å‰é¢æè¿‡çš„<code>ExcelWriter</code>å’Œ<code>WriteSheet</code>ï¼Œè¿™é‡Œè¿˜ç”¨åˆ°äº†<code>WriteTable</code>ï¼Œè¿™ä¸ªå°±æ˜¯è¡¨æ ¼çš„å†™å¯¹è±¡ã€‚æœ‰äº†è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬åªè¦å¤šåˆ›å»ºå‡ ä¸ªï¼Œå°±èƒ½å¤Ÿå®ç°åœ¨ä¸€ä¸ªSheetå·¥ä½œè¡¨ä¸­ï¼Œåˆ›å»ºå¤šä¸ªè¡¨æ ¼çš„åŠŸèƒ½ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070309.png" alt="åŒä¸€è¡¨å•ä¸­åˆ›å»ºè¡¨æ ¼"></p><p>ä¸å‰é¢çš„ä¾‹å­å®Œå…¨æ²¡æœ‰å·®åˆ«ï¼Œæ¡æ¡å¤§è·¯é€šç½—é©¬ã€‚</p><h3 id="åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆç›¸åŒè¡¨å¤´ï¼‰"><a href="#åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆç›¸åŒè¡¨å¤´ï¼‰" class="headerlink" title="åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆç›¸åŒè¡¨å¤´ï¼‰"></a>åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆç›¸åŒè¡¨å¤´ï¼‰</h3><p>æœ‰äº†ä¸Šé¢çš„é“ºå«ï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šä»£ç ï¼š</p><pre><code class="java">private static void writeTables() {    String fileName = defaultFileName(&quot;writeTables&quot;);    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName)            .build();    try {        // æŠŠsheetè®¾ç½®ä¸ºä¸éœ€è¦å¤´ ä¸ç„¶ä¼šè¾“å‡ºsheetçš„å¤´ è¿™æ ·çœ‹èµ·æ¥ç¬¬ä¸€ä¸ªtable å°±æœ‰2ä¸ªå¤´äº†        WriteSheet writeSheet = EasyExcelFactory.writerSheet()                .head(Item.class)                .needHead(Boolean.FALSE)                .build();        // è¿™é‡Œå¿…é¡»æŒ‡å®šéœ€è¦å¤´ï¼Œtable ä¼šç»§æ‰¿sheetçš„é…ç½®ï¼Œsheeté…ç½®äº†ä¸éœ€è¦ï¼Œtable é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦        WriteTable writeTable0 = EasyExcelFactory.writerTable(0)                .needHead(Boolean.TRUE)                .build();        WriteTable writeTable1 = EasyExcelFactory.writerTable(1)                .needHead(Boolean.TRUE)                .build();        // ç¬¬ä¸€æ¬¡å†™å…¥ä¼šåˆ›å»ºå¤´        excelWriter.write(sampleItems(), writeSheet, writeTable0);        // ç¬¬äºŒæ¬¡å†™å¦‚ä¹Ÿä¼šåˆ›å»ºå¤´ï¼Œç„¶ååœ¨ç¬¬ä¸€æ¬¡çš„åé¢å†™å…¥æ•°æ®        excelWriter.write(sampleItems(), writeSheet, writeTable1);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>å› ä¸ºä½¿ç”¨çš„æ˜¯ç›¸åŒçš„è¡¨å¤´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨<code>WriteSheet</code>ä¸­å®šä¹‰è¡¨å¤´å¯¹è±¡ï¼Œé€šè¿‡ç»§æ‰¿çš„æ–¹å¼ï¼Œå®ç°ä¸¤ä¸ªè¡¨æ ¼çš„è¡¨å¤´æ˜¯ç›¸åŒçš„ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œ<code>WriteSheet</code>æ„å»ºæ—¶ï¼Œè®¾ç½®<code>needHead(Boolean.FALSE)</code>ï¼Œå¦‚æœä¸è®¾ç½®æˆ–è€…è®¾ç½®ä¸ºtrueï¼Œé‚£ç¬¬ä¸€ä¸ªè¡¨æ ¼å°±ä¼šæœ‰ä¸¤ä¸ªè¡¨å¤´ã€‚</p><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070331.png" alt="åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆç›¸åŒè¡¨å¤´ï¼‰"></p><h3 id="åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆä¸åŒè¡¨å¤´ï¼‰"><a href="#åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆä¸åŒè¡¨å¤´ï¼‰" class="headerlink" title="åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆä¸åŒè¡¨å¤´ï¼‰"></a>åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆä¸åŒè¡¨å¤´ï¼‰</h3><p>ä¸¾ä¸€åä¸‰ï¼Œå¯¹äºä¸åŒè¡¨å¤´ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸º<code>WriteTable</code>å¯¹è±¡è®¾ç½®ä¸åŒè¡¨å¤´å³å¯ï¼š</p><pre><code class="java">private static void writeTablesWithDiffHead() {    String fileName = defaultFileName(&quot;writeTablesWithDiffHead&quot;);    final ExcelWriter excelWriter = EasyExcelFactory.write(fileName)            .build();    try {        WriteSheet writeSheet = EasyExcelFactory.writerSheet()                .build();        WriteTable writeTable0 = EasyExcelFactory.writerTable(0)                .head(Item.class)                .build();        excelWriter.write(sampleItems(), writeSheet, writeTable0);        WriteTable writeTable1 = EasyExcelFactory.writerTable(1)                .head(ComplexHeadItem.class)                .build();        excelWriter.write(sampleItems(), writeSheet, writeTable1);    } finally {        if (excelWriter != null) {            excelWriter.finish();        }    }}</code></pre><p>ç»“æœä¸ºï¼š</p><p><img src="https://static.howardliu.cn/20211004070353.png" alt="åŒä¸€è¡¨å•ä¸­åˆ›å»ºä¸åŒè¡¨æ ¼ï¼ˆä¸åŒè¡¨å¤´ï¼‰"></p><h2 id="å†™å…¥æ¨¡æ¿æ–‡ä»¶ï¼ˆéå¡«å……ï¼‰"><a href="#å†™å…¥æ¨¡æ¿æ–‡ä»¶ï¼ˆéå¡«å……ï¼‰" class="headerlink" title="å†™å…¥æ¨¡æ¿æ–‡ä»¶ï¼ˆéå¡«å……ï¼‰"></a>å†™å…¥æ¨¡æ¿æ–‡ä»¶ï¼ˆéå¡«å……ï¼‰</h2><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§æŸç§æ¨¡æ¿å¯¼å‡ºæ•°æ®ï¼Œè¿™ç±»æ¨¡æ¿æ–‡ä»¶å±äºå›ºå®šæ ·å¼ï¼Œæ²¡æœ‰åŠ¨æ€æ•°æ®ã€‚æ¯”å¦‚å‰é¢å‡ è¡Œæ˜¯æ ‡é¢˜ã€æƒé™å£°æ˜ã€è´£ä»»å£°æ˜ä¹‹ç±»çš„ï¼Œç´§è·Ÿç€å°±æ˜¯åˆ—è¡¨æ•°æ®ã€‚å¦‚æœå…¨é æ‰‹å·¥æ‹¼å†™æ•°æ®æ¯”è¾ƒç¹çï¼ŒEasyExcelæä¾›äº†å†™å…¥æ¨¡æ¿æ–‡ä»¶çš„æ–¹å¼ã€‚å…ˆçœ‹ä»£ç ï¼š</p><pre><code class="java">private static void writeByTemplate() {    String fileName = defaultFileName(&quot;writeByTemplate&quot;);    String templateFile = getPath() + File.separator + &quot;template_write_after_fill.xlsx&quot;;    EasyExcelFactory.write(fileName)            .withTemplate(templateFile)            .head(Item.class)            .sheet()            .doWrite(sampleItems());}</code></pre><p>éœ€è¦ä½¿ç”¨<code>com.alibaba.excel.write.builder.ExcelWriterBuilder#withTemplate(java.lang.String)</code>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è·¯å¾„ã€‚withTemplateæ–¹æ³•æœ‰å‡ ä¸ªé‡è½½å®ç°ï¼š</p><ol><li>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è·¯å¾„<code>ExcelWriterBuilder#withTemplate(java.lang.String)</code></li><li>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶å¯¹è±¡<code>ExcelWriterBuilder#withTemplate(java.io.File)</code></li><li>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è¾“å…¥æµ<code>ExcelWriterBuilder#withTemplate(java.io.InputStream)</code></li></ol><p>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶å’Œæ¨¡æ¿æ–‡ä»¶å¯¹è±¡éƒ½æ˜¯æ“ä½œæ–‡ä»¶çš„ï¼Œéœ€è¦æœ‰æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>æŒ‡å®šæ¨¡æ¿æ–‡ä»¶è¾“å…¥æµæ˜¯åªè¦æ–‡ä»¶æµï¼Œè¿™ä¸ªå¯æ“ä½œæ€§ç©ºé—´å°±æ¯”è¾ƒå¤§äº†ã€‚æ¯”å¦‚ï¼Œæ¨¡æ¿æ–‡ä»¶æ˜¯å¯å˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºä¸€ä¸ªå¸¦å˜é‡çš„æ¨¡æ¿æ–‡ä»¶ï¼Œä½¿ç”¨å¡«å……å†™å…¥çš„æ–¹å¼åˆå§‹åŒ–æ¨¡æ¿æ–‡ä»¶ï¼Œç„¶åå†ç”¨æ¨¡æ¿å†™å…¥çš„æ–¹å¼ï¼Œå†™å…¥åˆ—è¡¨ã€‚ï¼ˆè¿™ä¸ªä¼šåœ¨æŠ€å·§ç¯‡ä¸­è¯¦ç»†è¯´æ˜ï¼‰</p><p>ä»£ç ä¸­çš„æ¨¡æ¿æ–‡ä»¶å†…å®¹ï¼š</p><p><img src="https://static.howardliu.cn/20211004070420.png" alt="å†™å…¥æ¨¡æ¿æ–‡ä»¶ï¼ˆéå¡«å……ï¼‰"></p><p>å¯¼å‡ºæ–‡ä»¶çš„å†…å®¹ï¼š</p><p><img src="https://static.howardliu.cn/20211004070440.png" alt="å†™å…¥æ¨¡æ¿æ–‡ä»¶ï¼ˆéå¡«å……ï¼‰"></p><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™ç§æ–¹å¼å†™å…¥çš„åˆ—è¡¨æ˜¯ä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥ï¼ŒåŸæœ‰çš„æ¨¡æ¿å†…å®¹ä¸ä¼šä¿®æ”¹ï¼Œä¼šä»ç¬¬ä¸€è¡Œç©ºç™½è¡Œå¼€å§‹å†™åˆ—è¡¨ä¿¡æ¯ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä»å®æˆ˜è§’åº¦è¯´äº†ä¸€ä¸‹ EasyExcel å¦‚æœå®ç°å†™è¡¨æ ¼ï¼Œæ¥ä¸‹æ¥ä¼šè®²è§£ä¸€ä¸‹å¦‚ä½•æ›´å¥½çœ‹çš„å†™ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰</a></li><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-write-pretty/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆæ—¢è¦èƒ½å†™ï¼Œè¿˜è¦å†™çš„å¥½çœ‹ï¼‰</a></li><li><a href="https://www.howardliu.cn/effective-java-easyexcel-action-fill/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®©Excelå¯¼å‡ºä¸å†å¤æ‚ï¼ˆå¡«å……æ¨¡æ¿çš„ä½¿ç”¨æŒ‡å—ï¼‰</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/effective-java-easyexcel-action-write/">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120600688" target="_blank" rel="noopener">é˜¿é‡Œå¼€æºçš„è¿™ä¸ªåº“ï¼Œè®© Excel å¯¼å‡ºä¸å†å¤æ‚ï¼ˆç®€ç®€å•å•çš„å†™ï¼‰</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      ä»Šå¤©è¦è¯´çš„EasyExcelé˜¿é‡Œå·´å·´å¼€æºçš„Excelå¯¼å‡ºç±»åº“ï¼Œæ˜¯å¯¹POIçš„å°è£…ï¼Œå®ç°äº†å¾ˆå¤šé«˜çº§åŠŸèƒ½ï¼Œå¹¶ä¸”ç•™å‡ºæ‰©å±•å£ï¼Œæ”¯æŒæ‰©å±•å®šåˆ¶åŒ–åŠŸèƒ½ã€‚æ‰“ä¸ªæ¯”å–»ï¼ŒPOIç›¸å½“äºä¹é«˜ç§¯æœ¨ï¼Œä¸€ä¸ªä¸ªçš„å°ç§¯æœ¨å¯ä»¥è‡ªç”±ç»„è£…ï¼Œåªèƒ½åŠ¨æ‰‹èƒ½åŠ›å¼ºï¼Œå°±å¯ä»¥éšå¿ƒæ‰€æ¬²çš„ç»„è£…ã€‚EasyExcelæ›´åƒæ˜¯æŠŠè¿™äº›å°ç§¯æœ¨æå‰ç»„è£…å¥½ï¼Œæƒ³è¦æ­å»ºæˆ¿å­ï¼Œå°±ç›´æ¥æ‰¾ç»„è£…å¥½çš„å±‹é¡¶ã€å›´å¢™å°±è¡Œã€‚å¦‚æœä»…ä»…å¦‚æ­¤ï¼Œé‚£EasyExcelä»…ä»…å°±æ˜¯ç®€å•çš„å·¥å…·åŒ…ï¼Œå…¶æ›´åŠ å¸å¼•äººçš„åœ°æ–¹æ˜¯å¯¹äºå†…å­˜çš„æ§åˆ¶ï¼Œå®ƒé€šè¿‡å‹ç¼©æ–‡ä»¶ã€åˆ†æ‰¹è¯»å–ã€æŠ›å¼ƒä¸é‡è¦æ•°æ®ã€æ–‡ä»¶ç¼“å­˜ç­‰å¤šç§æ–¹å¼ï¼Œé™ä½å†…å­˜æ¶ˆè€—ã€‚
    
    </summary>
    
    
      <category term="java" scheme="https://www.howardliu.cn/categories/java/"/>
    
    
      <category term="Effective Java" scheme="https://www.howardliu.cn/tags/Effective-Java/"/>
    
      <category term="EasyExcel" scheme="https://www.howardliu.cn/tags/EasyExcel/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</title>
    <link href="https://www.howardliu.cn/data-consistency-in-microservices/"/>
    <id>https://www.howardliu.cn/data-consistency-in-microservices/</id>
    <published>2021-09-17T14:29:58.000Z</published>
    <updated>2021-09-17T14:29:58.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/20200714212210.png" alt="å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“"></p><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>ä»å•ä½“æ¶æ„åˆ°åˆ†å¸ƒå¼æ¶æ„ï¼Œä»å·¨çŸ³æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ã€‚ç³»ç»Ÿä¹‹é—´çš„äº¤äº’è¶Šæ¥è¶Šå¤æ‚ï¼Œç³»ç»Ÿé—´çš„æ•°æ®äº¤äº’é‡çº§ä¹Ÿæ˜¯æŒ‡æ•°çº§å¢é•¿ã€‚ä½œä¸ºä¸€ä¸ªç³»ç»Ÿï¼Œæˆ‘ä»¬è¦ä¿è¯é€»è¾‘çš„è‡ªæ´½å’Œæ•°æ®çš„è‡ªæ´½ã€‚</p><a id="more"></a><p>æ•°æ®è‡ªæ´½æœ‰ä¸¤æ–¹é¢è¦æ±‚ï¼š</p><ol><li>æŠ›å¼€ä»£ç ï¼Œæ•°æ®èƒ½å¤Ÿè‡ªå·±éªŒè¯è‡ªå·±çš„å‡†ç¡®æ€§ï¼Œä¹Ÿå°±æ˜¯æ•°æ®å½¼æ­¤ä¹‹é—´ä¸çŸ›ç›¾</li><li>æ‰€æœ‰æ•°æ®å‡†ç¡®ä¸”ç¬¦åˆæœŸæœ›</li></ol><p>ä¸ºäº†å®ç°è¿™ä¸¤ç‚¹ï¼Œéœ€è¦å®ç°æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä¸ºäº†å®ç°ä¸€è‡´æ€§ï¼Œå°±éœ€è¦ç”¨åˆ°äº‹åŠ¡ã€‚</p><p>éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œæœ¬æ–‡æ‰€è®¾è®¡çš„æ•°æ®ä¸€è‡´æ€§ï¼Œä¸æ˜¯å¤šæ•°æ®å‰¯æœ¬ä¹‹é—´ä¿æŒæ•°æ®ä¸€è‡´æ€§ï¼Œè€Œæ˜¯ç³»ç»Ÿä¹‹é—´çš„ä¸šåŠ¡æ•°æ®ä¿æŒä¸€è‡´æ€§ã€‚</p><h2 id="æœ¬åœ°äº‹åŠ¡"><a href="#æœ¬åœ°äº‹åŠ¡" class="headerlink" title="æœ¬åœ°äº‹åŠ¡"></a>æœ¬åœ°äº‹åŠ¡</h2><p>åœ¨æ—©æœŸçš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…³ç³»å‹æ•°æ®åº“çš„äº‹åŠ¡ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚è¿™ç§äº‹åŠ¡æœ‰å››ä¸ªåŸºæœ¬è¦ç´ ï¼šACIDã€‚</p><ul><li>Aï¼ˆAtomicityï¼ŒåŸå­æ€§ï¼‰ï¼šæ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä¸å¯èƒ½åœæ»åœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ã€‚</li><li>Cï¼ˆConsistencyï¼Œä¸€è‡´æ€§ï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡å¯ä»¥å°è£…çŠ¶æ€æ”¹å˜ï¼ˆé™¤éå®ƒæ˜¯ä¸€ä¸ªåªè¯»çš„ï¼‰ã€‚äº‹åŠ¡å¿…é¡»å§‹ç»ˆä¿æŒç³»ç»Ÿå¤„äºä¸€è‡´çš„çŠ¶æ€ï¼Œä¸ç®¡åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´å¹¶å‘äº‹åŠ¡æœ‰å¤šå°‘ã€‚</li><li>Iï¼ˆIsolationï¼Œéš”ç¦»æ€§ï¼‰ï¼šéš”ç¦»çŠ¶æ€æ‰§è¡Œäº‹åŠ¡ï¼Œä½¿å®ƒä»¬å¥½åƒæ˜¯ç³»ç»Ÿåœ¨ç»™å®šæ—¶é—´å†…æ‰§è¡Œçš„å”¯ä¸€æ“ä½œã€‚å¦‚æœæœ‰ä¸¤ä¸ªäº‹åŠ¡ï¼Œè¿è¡Œåœ¨ç›¸åŒçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œç›¸åŒçš„åŠŸèƒ½ï¼Œäº‹åŠ¡çš„éš”ç¦»æ€§å°†ç¡®ä¿æ¯ä¸€äº‹åŠ¡åœ¨ç³»ç»Ÿä¸­è®¤ä¸ºåªæœ‰è¯¥äº‹åŠ¡åœ¨ä½¿ç”¨ç³»ç»Ÿã€‚è¿™ç§å±æ€§æœ‰æ—¶ç§°ä¸ºä¸²è¡ŒåŒ–ï¼Œä¸ºäº†é˜²æ­¢äº‹åŠ¡æ“ä½œé—´çš„æ··æ·†ï¼Œå¿…é¡»ä¸²è¡ŒåŒ–æˆ–åºåˆ—åŒ–è¯·æ±‚ï¼Œä½¿å¾—åœ¨åŒä¸€æ—¶é—´ä»…æœ‰ä¸€ä¸ªè¯·æ±‚ç”¨äºåŒä¸€æ•°æ®ã€‚</li><li>Dï¼ˆDurabilityï¼ŒæŒä¹…æ€§ï¼‰ï¼šåœ¨äº‹åŠ¡å®Œæˆä»¥åï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€ä½œçš„æ›´æ”¹ä¾¿æŒä¹…çš„ä¿å­˜åœ¨æ•°æ®åº“ä¹‹ä¸­ï¼Œå¹¶ä¸ä¼šè¢«å›æ»šã€‚</li></ul><p>è¿™å››ä¸ªè¦ç´ æ˜¯å…³ç³»å‹æ•°æ®åº“çš„æ ¹æœ¬ã€‚æ— è®ºç³»ç»Ÿå¤šä¹ˆå¤æ‚ï¼Œåªè¦ä½¿ç”¨åŒä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚åŸºäºå¯¹å…³ç³»å‹æ•°æ®åº“çš„ä¿¡ä»»ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæœ¬åœ°äº‹åŠ¡æ˜¯å¯é çš„ï¼Œå¼€å‘è¿‡ç¨‹ä¸­ä¸éœ€è¦é¢å¤–çš„å·¥ä½œã€‚ä»æ¶æ„çš„è§’åº¦ï¼Œå…³ç³»å‹æ•°æ®åº“ä¹Ÿæ˜¯ä¸€ä¸ªå•ç‹¬çš„ç³»ç»Ÿï¼Œé‚£å…³ç³»å‹æ•°æ®åº“ä¸åº”ç”¨ä¹‹é—´ä¹Ÿæ˜¯å½¢æˆäº†åˆ†å¸ƒå¼ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆç ”ç©¶ä¸€ä¸‹è¿™ç§ç®€å•çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¦‚ä½•å®ç° ACIDã€‚</p><p>é¦–å…ˆï¼ŒAï¼ˆåŸå­æ€§ï¼‰å’Œ Dï¼ˆæŒä¹…æ€§ï¼‰æ˜¯å½¼æ­¤ä¹‹é—´å¯†ä¸å¯åˆ†çš„ä¸¤ä¸ªå±æ€§ï¼šåŸå­æ€§ä¿è¯äº†äº‹åŠ¡çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä¸å¯èƒ½åœæ»åœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ï¼›æŒä¹…æ€§ä¿è¯äº†ä¸€æ—¦äº‹åŠ¡å®Œæˆï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æ‰€ä½œçš„æ›´æ”¹ä¾¿æŒä¹…çš„ä¿å­˜åœ¨æ•°æ®åº“ä¹‹ä¸­ï¼Œä¸ä¼šå› ä¸ºä»»ä½•åŸå› è€Œå¯¼è‡´å…¶ä¿®æ”¹çš„å†…å®¹è¢«æ’¤é”€æˆ–ä¸¢å¤±ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæ•°æ®å¿…é¡»å†™å…¥åˆ°ç£ç›˜åæ‰èƒ½ä¿è¯æŒä¹…åŒ–ï¼Œä»…ä»…ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä¸€æ—¦å‡ºç°ç³»ç»Ÿå´©æºƒã€ä¸»æœºæ–­ç”µç­‰æƒ…å†µï¼Œæ•°æ®å°±ä¼šä¸¢å¤±ã€‚æ‰€ä»¥ï¼Œå…³é”®æ˜¯â€œå†™å…¥ç£ç›˜â€è¦å®ç°åŸå­æ€§å’ŒæŒä¹…æ€§ï¼Œç„¶è€Œè¿™ä¸ªåŠ¨ä½œå­˜åœ¨ä¸­é—´æ€ï¼šæ­£åœ¨å†™å…¥ã€‚æ‰€ä»¥ï¼Œç°ä»£çš„å…³ç³»å‹æ•°æ®åº“é€šå¸¸é‡‡ç”¨è¿½åŠ æ—¥å¿—è®°å½•çš„æ–¹å¼ã€‚å°†ä¿®æ”¹æ•°æ®æ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ï¼ˆåŒ…æ‹¬ä¿®æ”¹ä»€ä¹ˆæ•°æ®ã€æ•°æ®ç‰©ç†ä¸Šä½äºå“ªä¸ªå†…å­˜é¡µå’Œç£ç›˜å—ä¸­ã€ä»ä»€ä¹ˆå€¼æ”¹æˆä»€ä¹ˆå€¼ï¼Œç­‰ç­‰ï¼‰ï¼Œä»¥é¡ºåºè¿½åŠ çš„å½¢å¼è®°å½•åˆ°ç£ç›˜ä¸­ã€‚åªæœ‰åœ¨æ—¥å¿—è®°å½•å…¨éƒ¨è½ç›˜ï¼Œæ•°æ®åº“åœ¨æ—¥å¿—ä¸­çœ‹åˆ°ä»£è¡¨äº‹åŠ¡æˆåŠŸæäº¤çš„â€œæäº¤è®°å½•â€åï¼Œæ‰ä¼šæ ¹æ®æ—¥å¿—ä¸Šçš„ä¿¡æ¯å¯¹çœŸæ­£çš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ”¹å®Œæˆåï¼Œå†åœ¨æ—¥å¿—ä¸­åŠ å…¥ä¸€æ¡â€œç»“æŸè®°å½•â€è¡¨ç¤ºäº‹åŠ¡å·²å®ŒæˆæŒä¹…åŒ–ï¼Œè¿™ç§äº‹åŠ¡å®ç°æ–¹æ³•è¢«ç§°ä¸ºâ€œæäº¤æ—¥å¿—â€ã€‚</p><p><img src="https://static.howardliu.cn/20210917175145.png" alt="æœ¬åœ°äº‹åŠ¡"></p><p>æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ—¥å¿—ä¿è¯ä¸€ä¸ªäº‹åŠ¡çš„åŸå­æ€§å’ŒæŒä¹…æ€§ï¼Œé‚£å¦‚æœå‡ºç°å¤šä¸ªäº‹åŠ¡è®¿é—®åŒä¸€ä¸ªèµ„æºå‘¢ï¼Ÿä½œä¸ºç¨‹åºçŒ¿éƒ½çŸ¥é“ï¼Œå¤šä¸ªçº¿ç¨‹/è¿›ç¨‹è®¿é—®åŒä¸€ä¸ªèµ„æºï¼Œè¿™ä¸ªèµ„æºå°±ç§°ä¸ºä¸´ç•Œèµ„æºï¼Œæƒ³è¦è§£å†³ä¸´ç•Œèµ„æºå ç”¨å†²çªçš„æ–¹å¼å¾ˆç®€å•ï¼Œå°±æ˜¯åŠ é”ã€‚å…³ç³»å‹æ•°æ®åº“ä¸ºæˆ‘ä»¬å‡†å¤‡äº†ä¸‰ç§é”ï¼š</p><ul><li>å†™é”ï¼ˆWrite Lockï¼‰ï¼šåŒä¸€ä¸ªæ—¶åˆ»ï¼Œåªæœ‰æœ‰ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ®åŠ å†™é”ï¼Œæ‰€ä»¥å†™é”ä¹Ÿè¢«ç§°ä¸ºæ’å®ƒé”ï¼ˆexclusive Lockï¼‰ã€‚æ•°æ®è¢«åŠ äº†å†™é”åï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å†™å…¥æ•°æ®ï¼Œä¹Ÿä¸èƒ½å¯¹å…¶æ·»åŠ è¯»é”ï¼ˆæ³¨æ„ï¼Œæ˜¯ä¸èƒ½åŠ è¯»é”ï¼Œä½†æ˜¯å¯ä»¥è¯»å–æ•°æ®ï¼‰ã€‚</li><li>è¯»é”ï¼ˆRead Lockï¼‰ï¼šåŒä¸€æ—¶åˆ»ï¼Œå¤šä¸ªäº‹åŠ¡å¯ä»¥å¯¹æ•°æ®æ·»åŠ è¯»é”ï¼Œæ‰€ä»¥è¯»é”ä¹Ÿè¢«ç§°ä¸ºå…±äº«é”ï¼ˆShared Lockï¼‰ã€‚æ•°æ®åº“è¢«æ·»åŠ è¯»é”åï¼Œæ•°æ®ä¸èƒ½è¢«æ·»åŠ å†™é”ã€‚</li><li>èŒƒå›´é”ï¼ˆRange Lockï¼‰ï¼šå¯¹ä¸€ä¸ªèŒƒå›´çš„æ•°æ®æ·»åŠ å†™é”ï¼Œè¿™ä¸ªèŒƒå›´çš„æ•°æ®ä¸èƒ½è¢«å†™å…¥ã€‚ä¹Ÿå¯ä»¥ç®—ä½œå†™é”çš„æ‰¹é‡è¡Œä¸ºã€‚</li></ul><p>æ ¹æ®è¿™ä¸‰ç§é”çš„ä¸åŒç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å››ç§ä¸åŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p><ul><li>å¯ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ï¼šå†™å…¥çš„æ—¶å€™åŠ å†™é”ï¼Œè¯»å–çš„æ—¶å€™åŠ è¯»é”ï¼ŒèŒƒå›´è¯»å†™çš„æ—¶å€™åŠ èŒƒå›´é”ã€‚</li><li>å¯é‡å¤åº¦ï¼ˆRepeatable Readï¼‰ï¼šå†™å…¥çš„æ—¶å€™åŠ å†™é”ï¼Œè¯»å–çš„æ—¶å€™åŠ è¯»é”ï¼ŒèŒƒå›´è¯»å†™çš„æ—¶å€™ä¸åŠ é”ï¼Œè¿™æ ·ä¼šå‡ºç°è¯»å–ç›¸åŒèŒƒå›´æ•°æ®çš„æ—¶å€™ï¼Œè¿”å›ç»“æœä¸åŒï¼Œå³å¹»è¯»ï¼ˆPhantom Readï¼‰ã€‚</li><li>è¯»å·²æäº¤ï¼ˆRead Committedï¼‰ï¼šå†™å…¥çš„æ—¶å€™åŠ å†™é”ï¼Œè¯»å–çš„æ—¶å€™åŠ è¯»é”ï¼Œè¯»å–å®Œæˆåç«‹é©¬é‡Šæ”¾è¯»é”ã€‚è¿™æ ·ä¼šå‡ºç°åŒä¸€ä¸ªäº‹åŠ¡å¤šæ¬¡è¯»å–ç›¸åŒæ•°æ®ï¼Œè¿”å›ç»“æœä¸åŒï¼Œå³ä¸å¯é‡å¤è¯»ï¼ˆNon-Repeatable Readï¼‰ã€‚</li><li>è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰ï¼šå†™å…¥çš„æ—¶å€™åŠ å†™é”ï¼Œè¯»å–çš„æ—¶å€™ä¸åŠ é”ã€‚è¿™æ ·å°±ä¼šè¯»å–åˆ°å¦ä¸€ä¸ªè¿˜æœªæäº¤çš„äº‹åŠ¡å†™å…¥çš„æ•°æ®ï¼Œå³è„è¯»ï¼ˆDirty Readï¼‰ã€‚</li></ul><h2 id="å…¨å±€äº‹åŠ¡"><a href="#å…¨å±€äº‹åŠ¡" class="headerlink" title="å…¨å±€äº‹åŠ¡"></a>å…¨å±€äº‹åŠ¡</h2><p>éšç€ç³»ç»Ÿè§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œä¸šåŠ¡é‡ä¸æ–­å¢åŠ ã€‚å•ä½“åº”ç”¨ä¸å†æ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬ä¼šæ‹†åˆ†ç³»ç»Ÿï¼Œç„¶åæ‹†åˆ†æ•°æ®åº“ã€‚æ­¤æ—¶ï¼ŒåŒä¸€ä¸ªè¯·æ±‚ä¸­ï¼Œå°±ä¼šå‡ºç°åŒæ—¶è®¿é—®å¤šä¸ªæ•°æ®åº“çš„æƒ…å†µã€‚ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µçš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ŒX/Open ç»„ç»‡åœ¨ 1991 å¹´ï¼ˆé‚£ä¸ªæ—¶å€™æˆ‘è¿˜å°ï¼‰æå‡ºäº†ä¸€å¥— X/Open XA çš„å¤„ç†äº‹åŠ¡çš„æ¶æ„ã€‚XA çš„æ ¸å¿ƒå†…å®¹æ˜¯å®šä¹‰äº†å…¨å±€çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransaction Managerï¼Œç”¨äºåè°ƒå…¨å±€äº‹åŠ¡ï¼‰å’Œå±€éƒ¨çš„èµ„æºç®¡ç†å™¨ï¼ˆResource Managerï¼Œç”¨äºé©±åŠ¨æœ¬åœ°äº‹åŠ¡ï¼‰ä¹‹é—´çš„é€šä¿¡æ¥å£ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨å’Œå¤šä¸ªèµ„æºç®¡ç†å™¨ï¼ˆResource Managerï¼‰ä¹‹é—´å½¢æˆé€šä¿¡æ¡¥æ¢ï¼Œé€šè¿‡åè°ƒå¤šä¸ªæ•°æ®æºçš„ä¸€è‡´åŠ¨ä½œï¼Œå®ç°å…¨å±€äº‹åŠ¡çš„ç»Ÿä¸€æäº¤æˆ–è€…ç»Ÿä¸€å›æ»šã€‚ä¸ XA æ¶æ„é…å¥—çš„æ˜¯ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼ŒTwo Phase Commitment Protocolï¼‰ã€‚åœ¨è¿™ä¸ªåè®®ä¸­ï¼Œæœ€å…³é”®çš„ç‚¹å°±æ˜¯ï¼Œå¤šä¸ªæ•°æ®åº“çš„æ´»åŠ¨ï¼Œå‡ç”±ä¸€ä¸ªäº‹åŠ¡åè°ƒå™¨çš„ç»„ä»¶æ¥æ§åˆ¶ã€‚å…·ä½“çš„åˆ†ä¸º 5 ä¸ªæ­¥éª¤ï¼š</p><ol><li>åº”ç”¨ç¨‹åºè°ƒç”¨äº‹åŠ¡ç®¡ç†å™¨ä¸­çš„æäº¤æ–¹æ³•</li><li>äº‹åŠ¡ç®¡ç†å™¨å°†è”ç»œäº‹åŠ¡ä¸­æ¶‰åŠçš„æ¯ä¸ªæ•°æ®åº“ï¼Œå¹¶é€šçŸ¥å®ƒä»¬å‡†å¤‡æäº¤äº‹åŠ¡ï¼ˆè¿™æ˜¯ç¬¬ä¸€é˜¶æ®µçš„å¼€å§‹ï¼‰</li><li>æ¥æ”¶åˆ°å‡†å¤‡æäº¤äº‹åŠ¡é€šçŸ¥åï¼Œæ•°æ®åº“å¿…é¡»ç¡®ä¿èƒ½åœ¨è¢«è¦æ±‚æäº¤äº‹åŠ¡æ—¶æäº¤äº‹åŠ¡ï¼Œæˆ–åœ¨è¢«è¦æ±‚å›æ»šäº‹åŠ¡æ—¶å›æ»šäº‹åŠ¡ã€‚å¦‚æœæ•°æ®åº“æ— æ³•å‡†å¤‡äº‹åŠ¡ï¼Œå®ƒä¼šä»¥ä¸€ä¸ªå¦å®šå“åº”æ¥å›åº”äº‹åŠ¡ç®¡ç†å™¨ã€‚</li><li>äº‹åŠ¡ç®¡ç†å™¨æ”¶é›†æ¥è‡ªå„æ•°æ®åº“çš„æ‰€æœ‰å“åº”ã€‚</li><li>åœ¨ç¬¬äºŒé˜¶æ®µï¼Œäº‹åŠ¡ç®¡ç†å™¨å°†äº‹åŠ¡çš„ç»“æœé€šçŸ¥ç»™æ¯ä¸ªæ•°æ®åº“ã€‚å¦‚æœä»»ä¸€æ•°æ®åº“åšå‡ºå¦å®šå“åº”ï¼Œåˆ™äº‹åŠ¡ç®¡ç†å™¨ä¼šå°†ä¸€ä¸ªå›æ»šå‘½ä»¤å‘é€ç»™äº‹åŠ¡ä¸­æ¶‰åŠçš„æ‰€æœ‰æ•°æ®åº“ã€‚å¦‚æœæ•°æ®åº“éƒ½åšå‡ºè‚¯å®šå“åº”ï¼Œåˆ™äº‹åŠ¡ç®¡ç†å™¨ä¼šæŒ‡ç¤ºæ‰€æœ‰çš„èµ„æºç®¡ç†å™¨æäº¤äº‹åŠ¡ã€‚ä¸€æ—¦é€šçŸ¥æ•°æ®åº“æäº¤ï¼Œæ­¤åçš„äº‹åŠ¡å°±ä¸èƒ½å¤±è´¥äº†ã€‚é€šè¿‡ä»¥è‚¯å®šçš„æ–¹å¼å“åº”ç¬¬ä¸€é˜¶æ®µï¼Œæ¯ä¸ªèµ„æºç®¡ç†å™¨å‡å·²ç¡®ä¿ï¼Œå¦‚æœä»¥åé€šçŸ¥å®ƒæäº¤äº‹åŠ¡ï¼Œåˆ™äº‹åŠ¡ä¸ä¼šå¤±è´¥ã€‚</li></ol><p><img src="https://static.howardliu.cn/20210917181732.png" alt="2PC"></p><p>ä¸¤é˜¶æ®µæäº¤åè®®å®ç°ç®€å•ï¼Œä½†å­˜åœ¨å‡ ä¸ªæ˜æ˜¾ç¼ºé™·ï¼š</p><ul><li>å•ç‚¹é—®é¢˜ï¼šäº‹åŠ¡ç®¡ç†å™¨åœ¨ä¸¤æ®µæäº¤ä¸­å…·æœ‰ä¸¾è¶³è½»é‡çš„ä½œç”¨ï¼Œäº‹åŠ¡ç®¡ç†å™¨ç­‰å¾…èµ„æºç®¡ç†å™¨å›å¤æ—¶å¯ä»¥æœ‰è¶…æ—¶æœºåˆ¶ï¼Œå…è®¸èµ„æºç®¡ç†å™¨å®•æœºï¼Œä½†èµ„æºç®¡ç†å™¨ç­‰å¾…äº‹åŠ¡ç®¡ç†å™¨æŒ‡ä»¤æ—¶æ— æ³•åšè¶…æ—¶å¤„ç†ã€‚ä¸€æ—¦å®•æœºçš„ä¸æ˜¯å…¶ä¸­æŸä¸ªèµ„æºç®¡ç†å™¨ï¼Œè€Œæ˜¯äº‹åŠ¡ç®¡ç†å™¨çš„è¯ï¼Œæ‰€æœ‰èµ„æºç®¡ç†å™¨éƒ½ä¼šå—åˆ°å½±å“ã€‚å¦‚æœäº‹åŠ¡ç®¡ç†å™¨ä¸€ç›´æ²¡æœ‰æ¢å¤ï¼Œæ²¡æœ‰æ­£å¸¸å‘é€ Commit æˆ–è€… Rollback çš„æŒ‡ä»¤ï¼Œé‚£æ‰€æœ‰èµ„æºç®¡ç†å™¨éƒ½å¿…é¡»ä¸€ç›´ç­‰å¾…ã€‚</li><li>æ€§èƒ½é—®é¢˜ï¼šä¸¤æ®µæäº¤è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰èµ„æºç®¡ç†å™¨ç›¸å½“äºè¢«ç»‘å®šæˆä¸ºä¸€ä¸ªç»Ÿä¸€è°ƒåº¦çš„æ•´ä½“ï¼ŒæœŸé—´è¦ç»è¿‡ä¸¤æ¬¡è¿œç¨‹æœåŠ¡è°ƒç”¨ï¼Œä¸‰æ¬¡æ•°æ®æŒä¹…åŒ–ï¼ˆå‡†å¤‡é˜¶æ®µå†™é‡åšæ—¥å¿—ï¼Œäº‹åŠ¡ç®¡ç†å™¨åšçŠ¶æ€æŒä¹…åŒ–ï¼Œæäº¤é˜¶æ®µåœ¨æ—¥å¿—å†™å…¥ Commit Recordï¼‰ï¼Œæ•´ä¸ªè¿‡ç¨‹å°†æŒç»­åˆ°èµ„æºç®¡ç†å™¨é›†ç¾¤ä¸­æœ€æ…¢çš„é‚£ä¸€ä¸ªå¤„ç†æ“ä½œç»“æŸä¸ºæ­¢ï¼Œè¿™å†³å®šäº†ä¸¤æ®µå¼æäº¤çš„æ€§èƒ½é€šå¸¸éƒ½è¾ƒå·®ã€‚</li><li>ä¸€è‡´æ€§é£é™©ï¼šå°½ç®¡æäº¤é˜¶æ®µæ—¶é—´å¾ˆçŸ­ï¼Œä½†è¿™ä»æ˜¯ä¸€æ®µæ˜ç¡®å­˜åœ¨çš„å±é™©æœŸã€‚å¦‚æœäº‹åŠ¡ç®¡ç†å™¨åœ¨å‘å‡ºå‡†å¤‡æŒ‡ä»¤åï¼Œæ ¹æ®æ”¶åˆ°å„ä¸ªèµ„æºç®¡ç†å™¨å‘å›çš„ä¿¡æ¯ç¡®å®šäº‹åŠ¡çŠ¶æ€æ˜¯å¯ä»¥æäº¤çš„ï¼Œäº‹åŠ¡ç®¡ç†å™¨ä¼šå…ˆæŒä¹…åŒ–äº‹åŠ¡çŠ¶æ€ï¼Œå¹¶æäº¤è‡ªå·±çš„äº‹åŠ¡ï¼Œå¦‚æœè¿™æ—¶å€™ç½‘ç»œæ–­å¼€ï¼Œæ— æ³•å†é€šè¿‡ç½‘ç»œå‘æ‰€æœ‰èµ„æºç®¡ç†å™¨å‘å‡º Commit æŒ‡ä»¤çš„è¯ï¼Œå°±ä¼šå¯¼è‡´éƒ¨åˆ†æ•°æ®ï¼ˆäº‹åŠ¡ç®¡ç†å™¨çš„ï¼‰å·²æäº¤ï¼Œä½†éƒ¨åˆ†æ•°æ®ï¼ˆèµ„æºç®¡ç†å™¨çš„ï¼‰æ—¢æœªæäº¤ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•å›æ»šï¼Œäº§ç”Ÿäº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li></ul><p>èƒ½å¤Ÿå‘ç°é—®é¢˜ï¼Œå°±èƒ½å¤Ÿæƒ³åˆ°åŠæ³•è§£å†³ã€‚æˆ‘ä»¬é«˜ä¸­è€å¸ˆè¯´äº†ï¼Œåªè¦æ„è¯†ä¸æ»‘å¡ï¼ŒåŠæ³•æ€»æ¯”å›°éš¾å¤šã€‚æ‰€ä»¥åˆå‘å±•å‡ºäº†ä¸‰é˜¶æ®µæäº¤åè®®ï¼ˆ3PCï¼ŒThree Phase Commitment Protocolï¼‰ï¼Œèƒ½å¤Ÿç¼“è§£å•ç‚¹é—®é¢˜å’Œå‡†å¤‡é˜¶æ®µçš„æ€§èƒ½é—®é¢˜ã€‚è¿™ä¸ªåè®®æŠŠ 2PC ä¸­çš„å‡†å¤‡é˜¶æ®µæ‹†åˆ†ä¸º CanCommit å’Œ PreCommitï¼ŒæŠŠæäº¤é˜¶æ®µæ”¹åä¸º DoCommitã€‚CanCommit æ˜¯è¯¢é—®é˜¶æ®µï¼Œè®©æ¯ä¸ªèµ„æºç®¡ç†å™¨æ ¹æ®è‡ªèº«æƒ…å†µåˆ¤æ–­è¯¥äº‹åŠ¡æ˜¯å¦æœ‰å¯èƒ½å®Œæˆã€‚</p><p>3PC æœ¬è´¨æ˜¯é€šè¿‡ä¸€æ¬¡é—®è¯¢ï¼Œå¦‚æœå¤§å®¶éƒ½è¯´è‡ªå·±å¯ä»¥ï¼Œé‚£æˆäº‹çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œå‡å°‘äº†å‡†å¤‡é˜¶æ®µç›´æ¥é”å®šèµ„æºçš„é‡æ“ä½œã€‚ç”±äºäº‹åŠ¡å¤±è´¥å›æ»šæ¦‚ç‡å˜å°çš„åŸå› ï¼Œåœ¨ä¸‰æ®µå¼æäº¤ä¸­ï¼Œå¦‚æœåœ¨ PreCommit é˜¶æ®µä¹‹åå‘ç”Ÿäº†äº‹åŠ¡ç®¡ç†å™¨å®•æœºï¼Œå³èµ„æºç®¡ç†å™¨æ²¡æœ‰èƒ½ç­‰åˆ° DoCommit çš„æ¶ˆæ¯çš„è¯ï¼Œé»˜è®¤çš„æ“ä½œç­–ç•¥å°†æ˜¯æäº¤äº‹åŠ¡è€Œä¸æ˜¯å›æ»šäº‹åŠ¡æˆ–è€…æŒç»­ç­‰å¾…ï¼Œè¿™å°±ç›¸å½“äºé¿å…äº†äº‹åŠ¡ç®¡ç†å™¨å•ç‚¹é—®é¢˜çš„é£é™©ã€‚</p><p><img src="https://static.howardliu.cn/20210917181759.png" alt="3PC"></p><h2 id="åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡"></a>åˆ†å¸ƒå¼äº‹åŠ¡</h2><p>è¯´åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œä¸å¾—ä¸æ CAP ç†è®ºï¼šä»»ä½•åˆ†å¸ƒå¼ç³»ç»Ÿåªå¯åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰ä¸­çš„ä¸¤ç‚¹ï¼Œæ²¡æ³•ä¸‰è€…å…¼é¡¾ã€‚</p><p><img src="https://static.howardliu.cn/20210917184402.png" alt="CAP ç†è®º"></p><ul><li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šæ•°æ®åœ¨ä»»ä½•æ—¶åˆ»ã€ä»»ä½•åˆ†å¸ƒå¼èŠ‚ç‚¹ä¸­æ‰€çœ‹åˆ°çš„éƒ½æ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚</li><li>å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼šç³»ç»Ÿä¸é—´æ–­åœ°æä¾›æœåŠ¡çš„èƒ½åŠ›ï¼Œå¯ç”¨æ€§æ˜¯ç”±å¯é æ€§ï¼ˆReliabilityï¼‰å’Œå¯ç»´æŠ¤æ€§ï¼ˆServiceabilityï¼‰è®¡ç®—å¾—å‡ºçš„æ¯”ä¾‹å€¼ã€‚å¯é æ€§é€šè¿‡å¹³å‡æ— æ•…éšœæ—¶é—´ï¼ˆMean Time Between Failureï¼ŒMTBFï¼‰æ¥åº¦é‡ï¼›å¯ç»´æŠ¤æ€§é€šè¿‡å¹³å‡å¯ä¿®å¤æ—¶é—´ï¼ˆMean Time To Repairï¼ŒMTTRï¼‰æ¥åº¦é‡ã€‚å¯ç”¨æ€§è¡¡é‡ç³»ç»Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨çš„æ—¶é—´ä¸æ€»æ—¶é—´ä¹‹æ¯”ï¼Œå…¬å¼ä¸ºï¼šA=MTBF/(MTBF+MTTR)ã€‚</li><li>åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸­éƒ¨åˆ†èŠ‚ç‚¹å› ç½‘ç»œåŸå› è€Œå½¼æ­¤å¤±è”åï¼Œç³»ç»Ÿä»èƒ½æ­£ç¡®åœ°æä¾›æœåŠ¡çš„èƒ½åŠ›ã€‚</li></ul><blockquote><p>CAP ç†è®ºå®šä¹‰æ˜¯ç»è¿‡å‡ æ¬¡ä¿®æ”¹çš„ï¼Œä¿®æ”¹åçš„å®šä¹‰æœ¬è´¨æ²¡æœ‰åŒºåˆ«ï¼Œåªæ˜¯åœ¨é€»è¾‘ä¸Šæ›´åŠ ä¸¥è°¨ã€‚æœ¬æ–‡ä¸ºäº†å¥½ç†è§£ï¼Œä½¿ç”¨äº†æœ€å®¹æ˜“è®©å¤§ä¼—æ¥æ”¶å¹¶ç†è§£çš„å®šä¹‰ã€‚</p></blockquote><p>æ—¢ç„¶ CAP ä¸èƒ½å…¼é¡¾ï¼Œé‚£æˆ‘ä»¬æ¥çœ‹çœ‹ç¼ºå°‘å…¶ä¸­ä¸€ç¯ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼š</p><ul><li>é€‰æ‹© CA æ”¾å¼ƒ Pï¼šå³æˆ‘ä»¬è®¤ä¸ºç½‘ç»œå¯é ä¸ä¼šå‡ºç°åˆ†åŒºæƒ…å†µï¼Œè¿™ç§å¯é æ˜¯å„ä¸ªèŠ‚ç‚¹ä¹‹é—´ä¸ä¼šå‡ºç°ç½‘ç»œå»¶è¿Ÿã€ä¸­æ–­ç­‰æƒ…å†µï¼Œæ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ã€‚</li><li>é€‰æ‹© CP æ”¾å¼ƒ Aï¼šè¿™æ ·åšå°±æ˜¯æŠ›å¼ƒäº†å¯ç”¨æ€§ï¼Œä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œä¸€æ—¦å‡ºç°ç½‘ç»œå¼‚å¸¸ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„ä¿¡æ¯åŒæ­¥æ—¶é—´å¯ä»¥æ— é™åˆ¶åœ°å»¶é•¿ã€‚ä½¿ç”¨ CP ç»„åˆçš„ä¸€èˆ¬ç”¨äºå¯¹æ•°æ®è´¨é‡è¦æ±‚å¾ˆé«˜çš„åœºåˆï¼Œä¹Ÿå°±æ˜¯ä¸ºäº†ä¿è¯æ•°æ®å®Œå…¨ä¸€è‡´ï¼Œæš‚æ—¶ä¸æä¾›æœåŠ¡ï¼Œç›´åˆ°ç½‘ç»œå®Œå…¨æ¢å¤ï¼Œè¿™å¯èƒ½æŒç»­ä¸€ä¸ªä¸ç¡®å®šçš„æ—¶é—´ï¼Œå°¤å…¶æ˜¯åœ¨ç³»ç»Ÿå·²ç»è¡¨ç°å‡ºé«˜å»¶è¿Ÿæ—¶æˆ–è€…ç½‘ç»œæ•…éšœå¯¼è‡´å¤±å»è¿æ¥æ—¶ã€‚</li><li>é€‰æ‹© AP æ”¾å¼ƒ Cï¼šæ„å‘³ç€ä¸€æ—¦å‘ç”Ÿç½‘ç»œåˆ†åŒºï¼Œä¼˜å…ˆæä¾›æœåŠ¡å¯ç”¨ï¼Œæ”¾å¼ƒæ•°æ®ä¸€è‡´æ€§ã€‚è¿™æ˜¯ç›®å‰åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸»æµé€‰æ‹©ï¼Œå› ä¸ºç½‘ç»œæœ¬èº«å°±æ˜¯é“¾æ¥ä¸åŒåŒºåŸŸçš„æœåŠ¡å™¨çš„ï¼Œç½‘ç»œåˆæ˜¯ä¸å¯é çš„ï¼Œæ‰€ä»¥ P ä¸èƒ½è¢«èˆå¼ƒã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å®ç°åˆ†å¸ƒå¼ç³»ç»Ÿå°±æ˜¯ä¸ºäº†æé«˜å¯ç”¨æ€§ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„ç›®çš„ï¼Œä¸èƒ½èˆå¼ƒã€‚</li></ul><p>è¿™é‡Œéœ€è¦å†è¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬é€‰æ‹© AP æ”¾å¼ƒ C ä¸æ˜¯æ”¾å¼ƒæ•°æ®ä¸€è‡´ï¼Œè€Œæ˜¯æš‚æ—¶æ”¾å¼ƒå¼ºä¸€è‡´æ€§ï¼ˆStrong Consistencyï¼‰ï¼Œè€Œæ˜¯é€‰æ‹©å¼±ä¸€è‡´æ€§ï¼Œå³æœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventual Consistencyï¼‰ï¼šç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®å‰¯æœ¬ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œæœ€ç»ˆèƒ½å¤Ÿè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚è¿™é‡Œæ‰€è¯´çš„ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿè¦æ˜¯ç”¨æˆ·å¯æ¥å—èŒƒå›´å†…çš„ä¸€æ®µæ—¶é—´ã€‚</p><p>æœ€ç»ˆä¸€è‡´æ€§ä¹Ÿæœ‰ä¸€ä¸ªç†è®ºæ”¯æ’‘ï¼šBASE ç†è®ºï¼ˆä¸å¾—ä¸è¯´ï¼Œç†è®ºç•Œçš„ç¼©å†™çœŸç‰›å•Šï¼ŒACID æ˜¯é…¸ï¼ŒCAP æ˜¯å¸½å­ï¼ŒBASE æ˜¯ç¢±ï¼‰ï¼Œå†…å®¹ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>åŸºæœ¬å¯ç”¨ï¼ˆ<strong>B</strong>asically <strong>A</strong>vailableï¼‰ï¼šå½“ç³»ç»Ÿåœ¨å‡ºç°ä¸å¯é¢„çŸ¥æ•…éšœçš„æ—¶å€™ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ã€‚æ¯”å¦‚ï¼Œå…è®¸å“åº”æ—¶é—´å¢é•¿ï¼Œå…è®¸éƒ¨åˆ†éå…³é”®æ¥å£é™çº§æˆ–ç†”æ–­ç­‰ã€‚</li><li>è½¯çŠ¶æ€ï¼ˆ<strong>S</strong>oft <strong>S</strong>tateï¼‰ï¼šè½¯çŠ¶æ€ä¹Ÿç§°ä¸ºå¼±çŠ¶æ€ï¼Œå’Œç¡¬çŠ¶æ€ç›¸å¯¹ã€‚æ˜¯æŒ‡å…è®¸ç³»ç»Ÿä¸­çš„æ•°æ®å­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œå¹¶è®¤ä¸ºè¯¥ä¸­é—´çŠ¶æ€çš„å­˜åœ¨ä¸ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“å¯ç”¨æ€§ï¼Œå³å…è®¸ç³»ç»Ÿåœ¨ä¸åŒèŠ‚ç‚¹çš„æ•°æ®å‰¯æœ¬ä¹‹é—´è¿›è¡Œæ•°æ®åŒæ­¥çš„è¿‡ç¨‹å­˜åœ¨å»¶æ—¶ã€‚</li><li>æœ€ç»ˆä¸€è‡´æ€§ï¼ˆ<strong>E</strong>ventually Consistentï¼‰ï¼šæœ€ç»ˆä¸€è‡´æ€§å¼ºè°ƒçš„æ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ•°æ®å‰¯æœ¬ï¼Œåœ¨ç»è¿‡ä¸€æ®µæ—¶é—´çš„åŒæ­¥åï¼Œæœ€ç»ˆèƒ½å¤Ÿè¾¾åˆ°ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œæœ€ç»ˆä¸€è‡´æ€§çš„æœ¬è´¨æ˜¯éœ€è¦ç³»ç»Ÿä¿è¯æœ€ç»ˆæ•°æ®èƒ½å¤Ÿè¾¾åˆ°ä¸€è‡´ï¼Œè€Œä¸éœ€è¦å®æ—¶ä¿è¯ç³»ç»Ÿæ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚</li></ul><p>åœ¨å·¥ç¨‹å®è·µä¸­ï¼Œæœ€ç»ˆä¸€è‡´æ€§åˆ†ä¸º 5 ç§ï¼Œè¿™ 5 ç§æ–¹å¼ä¼šç»“åˆä½¿ç”¨ï¼Œå…±åŒå®ç°æœ€ç»ˆä¸€è‡´æ€§ï¼š</p><ul><li>å› æœä¸€è‡´æ€§ï¼ˆCausal consistencyï¼‰ï¼šå¦‚æœèŠ‚ç‚¹ A åœ¨æ›´æ–°å®ŒæŸä¸ªæ•°æ®åé€šçŸ¥äº†èŠ‚ç‚¹ Bï¼Œé‚£ä¹ˆèŠ‚ç‚¹ B ä¹‹åå¯¹è¯¥æ•°æ®çš„è®¿é—®å’Œä¿®æ”¹éƒ½æ˜¯åŸºäº A æ›´æ–°åçš„å€¼ã€‚äºæ­¤åŒæ—¶ï¼Œå’ŒèŠ‚ç‚¹ A æ— å› æœå…³ç³»çš„èŠ‚ç‚¹ C çš„æ•°æ®è®¿é—®åˆ™æ²¡æœ‰è¿™æ ·çš„é™åˆ¶ã€‚</li><li>è¯»å·±ä¹‹æ‰€å†™ï¼ˆRead your writesï¼‰ï¼šèŠ‚ç‚¹ A æ›´æ–°ä¸€ä¸ªæ•°æ®åï¼Œå®ƒè‡ªèº«æ€»æ˜¯èƒ½è®¿é—®åˆ°è‡ªèº«æ›´æ–°è¿‡çš„æœ€æ–°å€¼ï¼Œè€Œä¸ä¼šçœ‹åˆ°æ—§å€¼ã€‚</li><li>ä¼šè¯ä¸€è‡´æ€§ï¼ˆSession consistencyï¼‰ï¼šä¼šè¯ä¸€è‡´æ€§å°†å¯¹ç³»ç»Ÿæ•°æ®çš„è®¿é—®è¿‡ç¨‹æ¡†å®šåœ¨äº†ä¸€ä¸ªä¼šè¯å½“ä¸­ï¼Œç³»ç»Ÿèƒ½ä¿è¯åœ¨åŒä¸€ä¸ªæœ‰æ•ˆçš„ä¼šè¯ä¸­å®ç°â€œè¯»å·±ä¹‹æ‰€å†™â€çš„ä¸€è‡´æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œæ›´æ–°æ“ä½œä¹‹åï¼Œå®¢æˆ·ç«¯èƒ½å¤Ÿåœ¨åŒä¸€ä¸ªä¼šè¯ä¸­å§‹ç»ˆè¯»å–åˆ°è¯¥æ•°æ®é¡¹çš„æœ€æ–°å€¼ã€‚</li><li>å•è°ƒè¯»ä¸€è‡´æ€§ï¼ˆMonotonic read consistencyï¼‰ï¼šå¦‚æœä¸€ä¸ªèŠ‚ç‚¹ä»ç³»ç»Ÿä¸­è¯»å–å‡ºä¸€ä¸ªæ•°æ®é¡¹çš„æŸä¸ªå€¼åï¼Œé‚£ä¹ˆç³»ç»Ÿå¯¹äºè¯¥èŠ‚ç‚¹åç»­çš„ä»»ä½•æ•°æ®è®¿é—®éƒ½ä¸åº”è¯¥è¿”å›æ›´æ—§çš„å€¼ã€‚</li><li>å•è°ƒå†™ä¸€è‡´æ€§ï¼ˆMonotonic write consistencyï¼‰ï¼šä¸€ä¸ªç³»ç»Ÿè¦èƒ½å¤Ÿä¿è¯æ¥è‡ªåŒä¸€ä¸ªèŠ‚ç‚¹çš„å†™æ“ä½œè¢«é¡ºåºçš„æ‰§è¡Œã€‚</li></ul><p><img src="https://static.howardliu.cn/20210917182909.png" alt="ä¸€è‡´æ€§å…³ç³»æ¨¡å‹"></p><p>æœ‰äº†ç†è®ºä¹‹åï¼Œæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹å®ç°æœ€ç»ˆä¸€è‡´æ€§çš„å‡ ç§æ¨¡å¼ã€‚</p><h3 id="å¯é äº‹ä»¶æ¨¡å¼"><a href="#å¯é äº‹ä»¶æ¨¡å¼" class="headerlink" title="å¯é äº‹ä»¶æ¨¡å¼"></a>å¯é äº‹ä»¶æ¨¡å¼</h3><p>å¯é äº‹ä»¶æ¨¡å¼å±äºäº‹ä»¶é©±åŠ¨æ¶æ„ï¼šå½“æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œä¾‹å¦‚æ›´æ–°ä¸€ä¸ªä¸šåŠ¡å®ä½“ï¼ŒæœåŠ¡ä¼šå‘æ¶ˆæ¯ä»£ç†å‘å¸ƒä¸€ä¸ªäº‹ä»¶ã€‚æ¶ˆæ¯ä»£ç†ä¼šå‘è®¢é˜…äº‹ä»¶çš„æœåŠ¡æ¨é€äº‹ä»¶ï¼Œå½“è®¢é˜…è¿™äº›äº‹ä»¶çš„æœåŠ¡æ¥æ”¶æ­¤äº‹ä»¶æ—¶ï¼Œå°±å¯ä»¥å®Œæˆè‡ªå·±çš„ä¸šåŠ¡ï¼Œä¹Ÿå¯èƒ½ä¼šå¼•å‘æ›´å¤šçš„äº‹ä»¶å‘å¸ƒã€‚</p><p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹è¿™ç§æ¨¡å¼ï¼Œç”¨æˆ·ä¸‹å•æˆåŠŸåï¼Œè®¢å•ç³»ç»Ÿéœ€è¦é€šçŸ¥åº“å­˜ç³»ç»Ÿå‡åº“å­˜ã€‚</p><p><img src="https://static.howardliu.cn/20210917181828.png" alt="å¯é äº‹ä»¶æ¨¡å¼"></p><ol><li>è®¢å•ç³»ç»Ÿæ ¹æ®ç”¨æˆ·æ“ä½œå®Œæˆä¸‹å•æ“ä½œã€‚æ­¤æ—¶ä¼šä½¿ç”¨åŒä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¿å­˜è®¢å•ä¿¡æ¯å’Œå†™å…¥äº‹ä»¶ã€‚</li><li>å¦å¤–ä¸€ä¸ªæ¶ˆæ¯æœåŠ¡ä¼šè½®è¯¢äº‹ä»¶è¡¨ï¼Œå°†çŠ¶æ€æ˜¯â€œè¿›è¡Œä¸­â€çš„äº‹ä»¶ä»¥æ¶ˆæ¯å½¢å¼å‘é€åˆ°æ¶ˆæ¯æœåŠ¡ä¸­ã€‚å¦‚æœå‘é€å¤±è´¥ï¼Œå› ä¸ºæ˜¯è½®è¯¢ä»»åŠ¡ï¼Œä¼šåœ¨ä¸‹ä¸€æ¬¡è½®è¯¢çš„æ—¶å€™å†æ¬¡å‘é€ã€‚ï¼ˆæ­¤å¤„æœ‰ä¸€äº›ä¼˜åŒ–ç‚¹ï¼Œæœ¬ä¾‹ä¸ºäº†ç®€åŒ–æ¨¡å‹ï¼Œä¸å±•å¼€ï¼‰</li><li>æ¶ˆæ¯æœåŠ¡å‘è®¢é˜…ä¸‹å•æ¶ˆæ¯çš„åº“å­˜æœåŠ¡å‘é€ä¸‹å•æˆåŠŸæ¶ˆæ¯ï¼Œåº“å­˜æœåŠ¡å¼€å§‹å¤„ç†ã€‚æ­¤æ—¶ä¼šæœ‰è¿™ä¹ˆé›†ä¸­æƒ…å†µï¼š<ol><li>åº“å­˜æœåŠ¡æ‰£å‡åº“å­˜æˆåŠŸï¼Œæ¶ˆæ¯æœåŠ¡æ¥æ”¶åˆ°å¤„ç†æˆåŠŸå“åº”ã€‚æ¶ˆæ¯æœåŠ¡å°†å“åº”ç»“æœè¿”å›ç»™è®¢å•æœåŠ¡ï¼Œè®¢å•æœåŠ¡ä¸­äº‹ä»¶æ¥æ”¶å™¨å°†äº‹ä»¶ä¿®æ”¹ä¸ºâ€œå·²å®Œæˆâ€ã€‚</li><li>åº“å­˜æœåŠ¡æ‰£å‡åº“å­˜å¤±è´¥ï¼Œæ¶ˆæ¯æœåŠ¡æ¥æ”¶åˆ°å¤„ç†å¤±è´¥å“åº”ã€‚æ­¤æ—¶æ¶ˆæ¯æœåŠ¡ä¼šå†æ¬¡å‘åº“å­˜æœåŠ¡å‘é€æ¶ˆæ¯ï¼Œç›´åˆ°å¾—åˆ°æˆåŠŸå“åº”ã€‚å¦‚æœå¤±è´¥æ¬¡æ•°è¾¾åˆ°é˜ˆå€¼ï¼Œå¯ä»¥å‘Šè­¦é€šçŸ¥äººå·¥ä»‹å…¥ã€‚</li><li>æ¶ˆæ¯æœåŠ¡ç»™è®¢å•æœåŠ¡è¿”å›ç»“æœæ—¶ï¼Œå‘ç”Ÿå¤±è´¥ï¼Œè®¢å•æœåŠ¡æ²¡æœ‰æ¥æ”¶åˆ°æˆåŠŸå“åº”ã€‚è¿™ä¸ªæ—¶å€™ï¼Œäº‹ä»¶è½®è¯¢é€»è¾‘ä¼šå†æ¬¡å°†äº‹ä»¶å‘é€ç»™æ¶ˆæ¯æœåŠ¡ã€‚è¿™æ ·ï¼Œåº“å­˜æœåŠ¡ä¼šé‡å¤æ”¶åˆ°æ‰£å‡åº“å­˜çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥è¦æ±‚åº“å­˜æœåŠ¡åšå¥½å¹‚ç­‰ã€‚åº“å­˜æœåŠ¡å‘ç°æ¶ˆæ¯å·²ç»å¤„ç†è¿‡ï¼Œç›´æ¥è¿”å›æˆåŠŸã€‚</li></ol></li></ol><p>è¿™ç§é ç€æŒç»­é‡è¯•æ¥ä¿è¯å¯é æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œå«åšâ€œæœ€å¤§åŠªåŠ›äº¤ä»˜â€ï¼ˆBest-Effort Deliveryï¼‰ï¼Œä¹Ÿæ˜¯â€œå¯é â€ä¸¤ä¸ªå­—çš„æ¥æºã€‚</p><p>å¯é äº‹ä»¶æ¨¡å¼è¿˜æœ‰ä¸€ç§æ›´æ™®é€šçš„å½¢å¼ï¼Œè¢«ç§°ä¸ºâ€œæœ€å¤§åŠªåŠ›ä¸€æ¬¡æäº¤â€ï¼ˆBest-Effort 1PCï¼‰ï¼ŒæŒ‡çš„å°±æ˜¯å°†æœ€æœ‰å¯èƒ½å‡ºé”™æˆ–æœ€æ ¸å¿ƒçš„ä¸šåŠ¡ä»¥æœ¬åœ°äº‹åŠ¡çš„æ–¹å¼å®Œæˆåï¼Œé‡‡ç”¨ä¸æ–­é‡è¯•çš„æ–¹å¼ï¼ˆä¸é™äºæ¶ˆæ¯æœåŠ¡ï¼‰æ¥ä¿ƒä½¿åŒä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ä¸­çš„å…¶ä»–å…³è”ä¸šåŠ¡å…¨éƒ¨å®Œæˆã€‚æ‰¾åˆ°æœ€å¯èƒ½å‡ºé”™çš„æ–¹å¼æ˜¯æå‰åšå¥½å‡ºé”™æ¦‚ç‡çš„å…ˆéªŒè¯„ä¼°ï¼Œæ‰èƒ½å¤ŸçŸ¥é“å“ªå—æœ€å®¹æ˜“å‡ºé”™ã€‚æ‰¾åˆ°æœ€æ ¸å¿ƒçš„ä¸šåŠ¡çš„æ–¹å¼æ˜¯æ‰¾åˆ°é‚£ç§åªè¦æˆåŠŸï¼Œå…¶ä»–ä¸šåŠ¡å¿…é¡»æˆåŠŸçš„é‚£å—ä¸šåŠ¡ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å†è¡¥å……ä¸¤ä¸ªæ¦‚å¿µï¼š</p><ul><li>ä¸šåŠ¡å¼‚å¸¸ï¼šä¸šåŠ¡é€»è¾‘äº§ç”Ÿé”™è¯¯çš„æƒ…å†µï¼Œæ¯”å¦‚è´¦æˆ·ä½™é¢ä¸è¶³ã€å•†å“åº“å­˜ä¸è¶³ç­‰ã€‚</li><li>æŠ€æœ¯å¼‚å¸¸ï¼šéä¸šåŠ¡é€»è¾‘äº§ç”Ÿçš„å¼‚å¸¸ï¼Œå¦‚ç½‘ç»œè¿æ¥å¼‚å¸¸ã€ç½‘ç»œè¶…æ—¶ç­‰ã€‚</li></ul><h3 id="TCC-æ¨¡å¼"><a href="#TCC-æ¨¡å¼" class="headerlink" title="TCC æ¨¡å¼"></a>TCC æ¨¡å¼</h3><p>TCCï¼ˆTry-Confirm-Cancelï¼‰æ˜¯ä¸€ç§<strong>ä¸šåŠ¡ä¾µå…¥å¼</strong>è¾ƒå¼ºçš„äº‹åŠ¡æ–¹æ¡ˆï¼Œè¦æ±‚ä¸šåŠ¡å¤„ç†è¿‡ç¨‹å¿…é¡»æ‹†åˆ†ä¸ºâ€œé¢„ç•™ä¸šåŠ¡èµ„æºâ€å’Œâ€œç¡®è®¤/é‡Šæ”¾æ¶ˆè´¹èµ„æºâ€ä¸¤ä¸ªå­è¿‡ç¨‹ï¼Œç”±ç»Ÿä¸€çš„æœåŠ¡åè°ƒè°ƒåº¦ä¸åŒä¸šåŠ¡ç³»ç»Ÿçš„å­è¿‡ç¨‹ã€‚åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>Tryï¼šå°è¯•æ‰§è¡Œé˜¶æ®µï¼Œå®Œæˆæ‰€æœ‰ä¸šåŠ¡å¯æ‰§è¡Œæ€§çš„æ£€æŸ¥ï¼ˆä¿éšœä¸€è‡´æ€§ï¼‰ï¼Œå¹¶ä¸”é¢„ç•™å¥½å…¨éƒ¨éœ€è¦ç”¨åˆ°çš„ä¸šåŠ¡èµ„æºï¼ˆä¿éšœéš”ç¦»æ€§ï¼‰ã€‚</li><li>Confirmï¼šç¡®è®¤æ‰§è¡Œé˜¶æ®µï¼Œä¸è¿›è¡Œä»»ä½•ä¸šåŠ¡æ£€æŸ¥ï¼Œç›´æ¥ä½¿ç”¨ Try é˜¶æ®µå‡†å¤‡çš„èµ„æºæ¥å®Œæˆä¸šåŠ¡å¤„ç†ã€‚Confirm é˜¶æ®µå¯èƒ½ä¼šé‡å¤æ‰§è¡Œï¼Œéœ€è¦æ»¡è¶³å¹‚ç­‰æ€§ã€‚</li><li>Cancelï¼šå–æ¶ˆæ‰§è¡Œé˜¶æ®µï¼Œé‡Šæ”¾ Try é˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºã€‚Cancel é˜¶æ®µå¯èƒ½ä¼šé‡å¤æ‰§è¡Œï¼Œéœ€è¦æ»¡è¶³å¹‚ç­‰æ€§ã€‚</li></ul><p><img src="https://static.howardliu.cn/20210917181847.png" alt="TCC æ¨¡å¼"></p><ol><li>è®¢å•ç³»ç»Ÿåˆ›å»ºäº‹åŠ¡ï¼Œç”Ÿæˆäº‹åŠ¡ IDï¼ˆç”¨äºä½œä¸ºè¯†åˆ«è¯·æ±‚å¹‚ç­‰çš„æ ‡è¯†ï¼‰ï¼Œé€šè¿‡æ´»åŠ¨ç®¡ç†å™¨è®°å½•æ´»åŠ¨æ—¥å¿—ã€‚</li><li>è¿›å…¥ Try é˜¶æ®µ<ol><li>è°ƒç”¨è´¦æˆ·ç³»ç»Ÿï¼Œæ£€æŸ¥è´¦æˆ·ä½™é¢æ˜¯å¦å……è¶³ï¼Œå¦‚æœå……è¶³ï¼Œå†»ç»“éœ€è¦çš„é‡‘é¢ï¼Œæ­¤æ—¶è´¦æˆ·ä½™é¢æ˜¯ä¸´ç•Œèµ„æºï¼Œéœ€è¦é€šè¿‡æ’å®ƒé”æˆ–ä¹è§‚é”ä¿è¯å†»ç»“æ“ä½œçš„å®‰å…¨æ€§ã€‚</li><li>è°ƒç”¨åº“å­˜ç³»ç»Ÿï¼Œæ£€æŸ¥å•†å“åº“å­˜æ˜¯å¦å……è¶³ï¼Œå¦‚æœå……è¶³ï¼Œé”å®šéœ€è¦çš„åº“å­˜ï¼Œé”åº“æ“ä½œä¹Ÿéœ€è¦åŠ é”ä¿è¯å®‰å…¨</li></ol></li><li>å¦‚æœæ‰€æœ‰ä¸šåŠ¡è¿”å›æˆåŠŸï¼Œè®°å½•æ´»åŠ¨æ—¥å¿—ä¸º Confirmï¼Œè¿›å…¥ Confirm é˜¶æ®µï¼š<ol><li>è°ƒç”¨è´¦æˆ·ç³»ç»Ÿï¼Œæ‰£å‡å†»ç»“çš„é‡‘é¢</li><li>è°ƒç”¨åº“å­˜ç³»ç»Ÿï¼Œæ‰£å‡é”å®šçš„åº“å­˜</li></ol></li><li>ç¬¬ 3 æ­¥æ“ä½œä¸­å¦‚æœå…¨éƒ¨å®Œæˆï¼Œäº‹åŠ¡å®£å‘Šç»“æŸã€‚å¦‚æœç¬¬ 3 æ­¥ä¸­ä»»ä½•ä¸€æ–¹å‡ºç°å¼‚å¸¸ï¼Œéƒ½ä¼šæ ¹æ®æ´»åŠ¨æ—¥å¿—ä¸­çš„è®°å½•ï¼Œé‡å¤æ‰§è¡Œ Confirm æ“ä½œï¼Œå³è¿›è¡Œæœ€å¤§åŠªåŠ›äº¤ä»˜ã€‚æ‰€ä»¥å„ä¸šåŠ¡ç³»ç»Ÿçš„ Confirm æ“ä½œéœ€è¦å®ç°å¹‚ç­‰æ€§ã€‚</li><li>å¦‚æœç¬¬ 2 æ­¥æœ‰ä»»ä½•ä¸€æ–¹å¤±è´¥ï¼ˆåŒ…æ‹¬ä¸šåŠ¡å¼‚å¸¸å’ŒæŠ€æœ¯å¼‚å¸¸ï¼‰ï¼Œå°†æ´»åŠ¨æ—¥å¿—è®°å½•ä¸º Cancelï¼Œè¿›å…¥ Cancel é˜¶æ®µï¼š<ol><li>è°ƒç”¨è´¦æˆ·ç³»ç»Ÿï¼Œé‡Šæ”¾å†»ç»“çš„é‡‘é¢</li><li>è°ƒç”¨åº“å­˜ç³»ç»Ÿï¼Œé‡Šæ”¾é”å®šçš„åº“å­˜</li></ol></li><li>ç¬¬ 5 æ­¥æ“ä½œä¸­å¦‚æœå…¨éƒ¨å®Œæˆï¼Œäº‹åŠ¡å®£å‘Šå¤±è´¥ã€‚å¦‚æœç¬¬ 5 æ­¥ä¸­ä»»ä½•ä¸€æ–¹å‡ºç°å¼‚å¸¸ï¼ˆåŒ…æ‹¬ä¸šåŠ¡å¼‚å¸¸å’ŒæŠ€æœ¯å¼‚å¸¸ï¼‰ï¼Œéƒ½ä¼šæ ¹æ®æ´»åŠ¨æ—¥å¿—ä¸­çš„è®°å½•ï¼Œé‡å¤æ‰§è¡Œ Cacel æ“ä½œï¼Œå³æœ€å¤§åŠªåŠ›äº¤ä»˜ã€‚æ‰€ä»¥å„ä¸šåŠ¡ç³»ç»Ÿçš„ Cancel æ“ä½œä¹Ÿéœ€è¦å®ç°å¹‚ç­‰æ€§ã€‚</li></ol><p>æ˜¯ä¸æ˜¯æ„Ÿè§‰ TCC ä¸ 2PC çš„å¾ˆåƒï¼Œä¸¤è€…çš„åŒºåˆ«åœ¨äºï¼ŒTCC ä½äºä¸šåŠ¡ä»£ç å±‚é¢ï¼Œå±äºç™½ç›’ï¼Œ2PC ä½äºåŸºç¡€è®¾æ–½å±‚é¢ï¼Œå±äºé»‘ç›’ã€‚æ‰€ä»¥ TCC æœ‰æ›´é«˜çš„çµæ´»æ€§ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ï¼Œè°ƒæ•´èµ„æºé”å®šçš„ç²’åº¦ã€‚</p><p>TCC åœ¨ä¸šåŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥é¢„ç•™èµ„æºï¼Œè§£å†³äº†å¯é äº‹ä»¶æ¨¡å¼çš„èµ„æºéš”ç¦»é—®é¢˜ã€‚ä½†æ˜¯ï¼ŒTCC è¿˜æœ‰ä¸¤ä¸ªæ˜æ˜¾ç¼ºç‚¹ï¼š</p><ol><li>TCC å°†åŸºç¡€è®¾æ–½å±‚çš„é€»è¾‘ä¸Šç§»åˆ°ä¸šåŠ¡ä»£ç ï¼Œå¯¹ä¸šåŠ¡æœ‰å¾ˆé«˜çš„ä¾µå…¥æ€§ï¼Œéœ€è¦æ›´é«˜çš„å¼€å‘æˆæœ¬ï¼Œå¼€å‘æˆæœ¬æå‡ï¼Œç›¸å¯¹åº”çš„ç»´æŠ¤æˆæœ¬ã€å¼€å‘äººå‘˜çš„ç´ è´¨ç­‰ï¼Œéƒ½ä¼šæœ‰æ›´é«˜çš„è¦æ±‚ã€‚</li><li>TCC è¦æ±‚èµ„æºå¯ä»¥é”å®šã€å ç”¨æˆ–é‡Šæ”¾ï¼Œä½†æ˜¯æœ‰çš„èµ„æºå±äºå¤–éƒ¨ç³»ç»Ÿï¼Œæ²¡æœ‰åŠæ³•å®ç°é”å®šã€‚</li></ol><p>é‰´äºä¸Šé¢çš„ä¸¤ä¸ªç¼ºç‚¹ï¼Œæˆ‘ä»¬çœ‹çœ‹ SAGA æ˜¯å¦å¯ä»¥å¼¥è¡¥ã€‚</p><h3 id="SAGA-æ¨¡å¼"><a href="#SAGA-æ¨¡å¼" class="headerlink" title="SAGA æ¨¡å¼"></a>SAGA æ¨¡å¼</h3><p>SAGA åœ¨è‹±æ–‡ä¸­æ˜¯â€œé•¿ç¯‡æ•…äº‹ã€é•¿ç¯‡è®°å™ã€ä¸€é•¿ä¸²äº‹ä»¶â€çš„æ„æ€ã€‚SAGA æ¨¡å¼çš„æå‡ºè¿œæ—©äºåˆ†å¸ƒå¼äº‹åŠ¡æ¦‚å¿µçš„æå‡ºï¼ˆå†æ¬¡å¯¹å‰è¾ˆå¤§ä½¬ä½©æœçš„äº”ä½“æŠ•åœ°ï¼‰ï¼Œå®ƒæºäº 1987 å¹´æ™®æ—æ–¯é¡¿å¤§å­¦çš„ Hector Garcia-Molina å’Œ Kenneth Salem åœ¨ ACM å‘è¡¨çš„ä¸€ç¯‡è®ºæ–‡ã€ŠSAGASã€‹ã€‚æ–‡ä¸­æå‡ºäº†ä¸€ç§æå‡â€œé•¿æ—¶é—´äº‹åŠ¡â€ï¼ˆLong Lived Transactionï¼‰è¿ä½œæ•ˆç‡çš„æ–¹æ³•ï¼Œå¤§è‡´æ€è·¯æ˜¯æŠŠä¸€ä¸ªå¤§äº‹åŠ¡åˆ†è§£ä¸ºå¯ä»¥äº¤é”™è¿è¡Œçš„ä¸€ç³»åˆ—å­äº‹åŠ¡é›†åˆï¼Œåæ¥å‘å±•æˆå°†ä¸€ä¸ªåˆ†å¸ƒå¼ç¯å¢ƒä¸­çš„å¤§äº‹åŠ¡åˆ†è§£ä¸ºä¸€ç³»åˆ—æœ¬åœ°äº‹åŠ¡çš„è®¾è®¡æ¨¡å¼ã€‚åœ¨æœ‰çš„æ–‡ç« ä¸­ï¼Œå°†è¿™ç§æ¨¡å¼ç§°ä¸ºä¸šåŠ¡è¡¥å¿æ¨¡å¼ï¼ŒSAGA æ˜¯å¯¹äº‹åŠ¡å½¢å¼çš„æè¿°ï¼Œä¸šåŠ¡è¡¥å¿æ˜¯å¯¹äº‹åŠ¡è¡Œä¸ºçš„æè¿°ï¼Œå…¶æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚</p><p>SAGA æ¨¡å¼æœ‰ä¸¤ç§å®ç°ï¼š</p><ul><li>æ­£å‘æ¢å¤ï¼ˆForward Recoveryï¼‰ï¼šé¡ºåºæ‰§è¡Œå„ä¸ªå­äº‹åŠ¡ï¼Œå¦‚æœé‡åˆ°æŸä¸ªå­äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå°†ä¸€ç›´é‡è¯•è¯¥æ“ä½œï¼ŒçŸ¥é“æˆåŠŸï¼Œç„¶åç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªå­äº‹åŠ¡ã€‚æ¯”å¦‚ç”¨æˆ·ä¸‹å•æ”¯ä»˜æˆåŠŸäº†ï¼Œå°±ä¸€å®šè¦æ‰£å‡åº“å­˜ã€‚</li><li>åå‘æ¢å¤ï¼ˆBackward Recoveryï¼‰ï¼šé¡ºåºæ‰§è¡Œå„ä¸ªå­äº‹åŠ¡ï¼Œå¦‚æœé‡åˆ°æŸä¸ªå­äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå°†æ‰§è¡Œè¯¥å­äº‹åŠ¡çš„è¡¥å¿æ“ä½œï¼ˆé¿å…å› ä¸ºæŠ€æœ¯å¼‚å¸¸é€ æˆçš„å¤±è´¥ï¼Œè¡¥å¿æ“ä½œéœ€è¦å¹‚ç­‰ï¼‰ï¼Œç„¶åå€’åºæ‰§è¡Œå·²ç»æˆåŠŸçš„å­äº‹åŠ¡çš„è¡¥å¿æ“ä½œã€‚è¿™ç§ä¸€èˆ¬æ˜¯å¯å–æ¶ˆçš„æ‰¹é‡æ“ä½œï¼Œæ¯”å¦‚å‡ºè¡Œè®¢ç¥¨ï¼Œéœ€è¦è´­ä¹°é£æœºç¥¨ã€è®¢é…’åº—ã€ä¹°é—¨ç¥¨ï¼Œå¦‚æœä¹°é—¨ç¥¨å¤±è´¥äº†ï¼Œé£æœºç¥¨å’Œé…’åº—å°±å¯ä»¥å–æ¶ˆäº†ã€‚</li></ul><p><img src="https://static.howardliu.cn/20210917181908.png" alt="SAGA æ¨¡å¼"></p><p>æ ¹æ®è¿™ä¸¤ç§å®ç°ï¼ŒSAGA å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ul><li>å­äº‹åŠ¡ï¼ˆNormal Transactionsï¼‰ï¼šå¤§äº‹åŠ¡æ‹†åˆ†è‹¥å¹²ä¸ªå°äº‹åŠ¡ï¼Œå°†æ•´ä¸ªäº‹åŠ¡ T åˆ†è§£ä¸º n ä¸ªå­äº‹åŠ¡ï¼Œå‘½åä¸º T<sub>1</sub>ã€T<sub>2</sub>ã€â€¦ã€T<sub>n</sub>ã€‚æ¯ä¸ªå­äº‹åŠ¡éƒ½åº”è¯¥æ˜¯æˆ–è€…èƒ½è¢«è§†ä¸ºæ˜¯åŸå­è¡Œä¸ºã€‚å¦‚æœåˆ†å¸ƒå¼äº‹åŠ¡èƒ½å¤Ÿæ­£å¸¸æäº¤ï¼Œå…¶å¯¹æ•°æ®çš„å½±å“ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰åº”ä¸è¿ç»­æŒ‰é¡ºåºæˆåŠŸæäº¤ Ti ç­‰ä»·ã€‚</li><li>è¡¥å¿äº‹åŠ¡ï¼ˆCompensating Transactionsï¼‰ï¼šæ¯ä¸ªå­äº‹åŠ¡å¯¹åº”çš„è¡¥å¿åŠ¨ä½œï¼Œå‘½åä¸º C<sub>1</sub>ã€C<sub>2</sub>ã€â€¦ã€C<sub>n</sub>ã€‚</li></ul><p>å­äº‹åŠ¡ä¸è¡¥å¿åŠ¨ä½œéœ€è¦æ»¡è¶³ä¸€äº›æ¡ä»¶ï¼š</p><ol><li>T<sub>i</sub>ä¸ C<sub>i</sub>å¿…é¡»å¯¹åº”</li><li>è¡¥å¿åŠ¨ä½œ C<sub>i</sub>ä¸€å®šä¼šæ‰§è¡ŒæˆåŠŸï¼Œå³éœ€è¦å®ç°æœ€å¤§åŠªåŠ›äº¤ä»˜ã€‚</li><li>T<sub>i</sub>ä¸ C<sub>i</sub>éœ€è¦å…·å¤‡å¹‚ç­‰æ€§</li></ol><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦æ€»ç»“äº†æœ¬åœ°äº‹åŠ¡ã€å…¨å±€äº‹åŠ¡ã€æœ€ç»ˆä¸€è‡´æ€§ç­‰æ–¹å¼å®ç°æ•°æ®è‡ªæ´½ã€‚é‡ç‚¹ä»‹ç»äº†å®ç°æœ€ç»ˆä¸€è‡´æ€§çš„é›†ä¸­æ¨¡å¼ï¼šå¯é äº‹ä»¶æ¨¡å¼ã€TCC æ¨¡å¼ã€SAGA æ¨¡å¼ç­‰ã€‚æ•°æ®çš„ä¸€è‡´æ€§ä¸€ç›´æ˜¯ä¸ªéš¾é¢˜ï¼Œéšç€å¾®æœåŠ¡åŒ–ä¹‹åï¼Œæ•°æ®ä¸€è‡´æ€§æ›´åŠ å›°éš¾ï¼Œæœ‰å›°éš¾ä¸æ€•ï¼Œåªè¦ä¸æ”¾å¼ƒï¼Œæ€»ä¼šè§£å†³çš„ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://mp.weixin.qq.com/s/09ILTzijUr3knHBj13t_kQ" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/n1eKTlLP_BbyBkKG4OyLSw" target="_blank" rel="noopener">å¾®æœåŠ¡ç¼–ç¨‹èŒƒå¼</a></li><li><a href="https://mp.weixin.qq.com/s/sRkYdrAwvn8UrGSraAURpA" target="_blank" rel="noopener">å¾®æœåŠ¡çš„åŸºå»ºå·¥ä½œ</a></li><li><a href="https://mp.weixin.qq.com/s/sRX04UhPiFWSDOazTSXuXw" target="_blank" rel="noopener">å¾®æœåŠ¡ä¸­æœåŠ¡æ³¨å†Œå’Œå‘ç°çš„å¯è¡Œæ€§æ–¹æ¡ˆ</a></li><li><a href="https://mp.weixin.qq.com/s/NcftJ1jNAd-DHpzBXKk8RA" target="_blank" rel="noopener">ä»å•ä½“æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„</a></li><li><a href="https://mp.weixin.qq.com/s/M0sla4LVvp2lEiFpzwyVrA" target="_blank" rel="noopener">å¦‚ä½•åœ¨å¾®æœåŠ¡å›¢é˜Ÿä¸­é«˜æ•ˆä½¿ç”¨ Git ç®¡ç†ä»£ç ï¼Ÿ</a></li><li><a href="https://mp.weixin.qq.com/s/apHFXB2cUqDALpJJebNp9A" target="_blank" rel="noopener">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a></li><li><a href="https://mp.weixin.qq.com/s/AE0n4d_zRZOEeYEQt-rSKw" target="_blank" rel="noopener">å®ç°DevOpsçš„ä¸‰æ­¥å·¥ä½œæ³•</a></li><li><a href="https://mp.weixin.qq.com/s/mMjbafRIhia3u9DmXPSfPQ" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹å¦‚ä½•è®¾è®¡ä¸€ä¸ªçŸ­é“¾æœåŠ¡</a></li><li><a href="https://mp.weixin.qq.com/s/mtt_wsUChGIwnR-Nz5BE4g" target="_blank" rel="noopener">ç³»ç»Ÿè®¾è®¡ç³»åˆ—ä¹‹ä»»åŠ¡é˜Ÿåˆ—</a></li><li><a href="https://mp.weixin.qq.com/s/_PI5jRP99ktPs3lxCbBLSg" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-ç¼“å­˜æŠ€æœ¯</a></li><li><a href="https://mp.weixin.qq.com/s/668L2NK7LWo3c8U8ZI_1ng" target="_blank" rel="noopener">è½¯ä»¶æ¶æ„-äº‹ä»¶é©±åŠ¨æ¶æ„</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://icyfenix.cn/architect-perspective/general-architecture/transaction/" target="_blank" rel="noopener">äº‹åŠ¡å¤„ç†</a></li><li><a href="https://kanshan.blog.csdn.net/article/details/51867631" target="_blank" rel="noopener">å¾®æœåŠ¡æ¶æ„ä¸‹çš„æ•°æ®ä¸€è‡´æ€§ï¼šæ¦‚å¿µåŠç›¸å…³æ¨¡å¼</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/data-consistency-in-microservices/">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120358607" target="_blank" rel="noopener">å…³äºå¾®æœåŠ¡ç³»ç»Ÿä¸­æ•°æ®ä¸€è‡´æ€§çš„æ€»ç»“</a></p><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      ä»å•ä½“æ¶æ„åˆ°åˆ†å¸ƒå¼æ¶æ„ï¼Œä»å·¨çŸ³æ¶æ„åˆ°å¾®æœåŠ¡æ¶æ„ã€‚ç³»ç»Ÿä¹‹é—´çš„äº¤äº’è¶Šæ¥è¶Šå¤æ‚ï¼Œç³»ç»Ÿé—´çš„æ•°æ®äº¤äº’é‡çº§ä¹Ÿæ˜¯æŒ‡æ•°çº§å¢é•¿ã€‚ä½œä¸ºä¸€ä¸ªç³»ç»Ÿï¼Œæˆ‘ä»¬è¦ä¿è¯é€»è¾‘çš„è‡ªæ´½å’Œæ•°æ®çš„è‡ªæ´½ã€‚æ•°æ®è‡ªæ´½æœ‰ä¸¤æ–¹é¢è¦æ±‚ï¼šæŠ›å¼€ä»£ç ï¼Œæ•°æ®èƒ½å¤Ÿè‡ªå·±éªŒè¯è‡ªå·±çš„å‡†ç¡®æ€§ï¼Œä¹Ÿå°±æ˜¯æ•°æ®å½¼æ­¤ä¹‹é—´ä¸çŸ›ç›¾ï¼›æ‰€æœ‰æ•°æ®å‡†ç¡®ä¸”ç¬¦åˆæœŸæœ›ã€‚
    
    </summary>
    
    
      <category term="microservice" scheme="https://www.howardliu.cn/categories/microservice/"/>
    
    
      <category term="å¾®æœåŠ¡" scheme="https://www.howardliu.cn/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"/>
    
      <category term="æ•°æ®ä¸€è‡´æ€§" scheme="https://www.howardliu.cn/tags/%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7/"/>
    
      <category term="äº‹åŠ¡" scheme="https://www.howardliu.cn/tags/%E4%BA%8B%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</title>
    <link href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/"/>
    <id>https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/</id>
    <published>2021-09-11T14:30:27.000Z</published>
    <updated>2021-09-11T14:30:27.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/coffee-beans-6603499_1920.jpg" alt="SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/nickype-10327513/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6603499" target="_blank" rel="noopener">NickyPe</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6603499" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>ä»Šå¤©èŠèŠå¦‚ä½•åœ¨ SpringBoot ä¸­é›†æˆ Junit5ã€MockMvcã€Mocktioã€‚Junit5 æ˜¯åœ¨ Java æ ˆä¸­åº”ç”¨æœ€å¹¿çš„æµ‹è¯•æ¡†æ¶ï¼ŒJunit4 ä¸€åº¦éœ¸æ¦œã€‚</p><a id="more"></a><p>å‡çº§åˆ° Junit5 ä¹‹åï¼Œé™¤äº†å¢åŠ  Java8 çš„å¾ˆå¤šç‰¹æ€§ï¼Œåšäº†å¾ˆå¤šåŠŸèƒ½å¢å¼ºï¼Œåœ¨ç»“æ„ä¸Šåšäº†ä¼˜åŒ–è°ƒæ•´ï¼Œæ‹†åˆ†äº†å¾ˆå¤šä¸åŒçš„æ¨¡å—ï¼Œå¯ä»¥æŒ‰éœ€å¼•å…¥ï¼Œæ¯”å¦‚ï¼š</p><ul><li>JUnit Platform - åœ¨ JVM ä¸Šå¯åŠ¨æµ‹è¯•æ¡†æ¶</li><li>JUnit Jupiter - åœ¨ JUnit5 ä¸­ç¼–å†™æµ‹è¯•å’Œæ‰©å±•</li><li>JUnit Vintage - æä¾›è¿è¡ŒåŸºäº JUnit3 å’Œ JUnit4 çš„æµ‹è¯•å¼•æ“</li></ul><p>ä» SpringBoot 2.2.0 ä¹‹åï¼ŒJunit5 å·²ç»æˆä¸ºäº†é»˜è®¤çš„ Junit ç‰ˆæœ¬ã€‚æœ‰äº† JUnit Vintageï¼Œä» Junit4 è¿ç§»åˆ° Junit5 çš„æˆæœ¬æä½ã€‚æ‰€ä»¥æœ¬æ–‡å°±ç›´æ¥é’ˆå¯¹ Junit5 å¼€å§‹äº†ã€‚</p><h2 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="headerlink" title="ç‰ˆæœ¬"></a>ç‰ˆæœ¬</h2><p>å…ˆè¯´ç‰ˆæœ¬ï¼Œæ˜¯ä¸ºäº†é¿å…å› ä¸ºç‰ˆæœ¬å·®å¼‚å‡ºç°å„ç§å¥‡æ€ªçš„é—®é¢˜ï¼š</p><ul><li>JDKï¼šjdk8ï¼ˆå°ç‰ˆæœ¬å¯ä»¥å¿½ç•¥ï¼‰</li><li>SpringBootï¼š2.5.2<ul><li>ç»§æ‰¿<code>spring-boot-starter-parent</code></li><li>ä¾èµ–<code>spring-boot-starter-web</code></li><li>ä¾èµ–<code>spring-boot-starter-test</code></li></ul></li><li>JUnitï¼š5.7.2</li><li>Mockitoï¼š3.9.0</li><li>hamcrestï¼š2.2</li></ul><p>SpringBoot çš„å¥½å¤„åœ¨äºï¼Œåªè¦ç»§æ‰¿<code>spring-boot-starter-parent</code>æˆ–å¼•å…¥<code>spring-boot-pom-dependencies</code>ï¼Œç„¶åæ·»åŠ <code>spring-boot-starter-test</code>ä¾èµ–å³å¯ã€‚å®šä¹‰çš„ POM å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;    &lt;parent&gt;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;        &lt;version&gt;2.5.2&lt;/version&gt;    &lt;/parent&gt;    &lt;groupId&gt;cn.howardliu.effective.spring&lt;/groupId&gt;    &lt;artifactId&gt;springboot-junit5-mockito&lt;/artifactId&gt;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;    &lt;name&gt;springboot-junit5-mockio&lt;/name&gt;    &lt;dependencies&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;            &lt;scope&gt;runtime&lt;/scope&gt;            &lt;optional&gt;true&lt;/optional&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;            &lt;artifactId&gt;lombok&lt;/artifactId&gt;            &lt;optional&gt;true&lt;/optional&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;            &lt;scope&gt;test&lt;/scope&gt;        &lt;/dependency&gt;    &lt;/dependencies&gt;    &lt;build&gt;        &lt;plugins&gt;            &lt;plugin&gt;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;            &lt;/plugin&gt;        &lt;/plugins&gt;    &lt;/build&gt;&lt;/project&gt;</code></pre><p>å› ä¸ºç»§æ‰¿äº†<code>spring-boot-starter-parent</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾èµ–çš„<code>spring-boot-starter-test</code>ä¸éœ€è¦å†™å…·ä½“çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥é›†æˆçˆ¶çº§çš„ç‰ˆæœ¬å®šä¹‰ã€‚å…¶ä¸­ï¼Œ<code>spring-boot-starter-web</code>æ˜¯ç”¨äºæä¾› REST API çš„ web å®¹å™¨ï¼Œ<code>spring-boot-starter-test</code>å¯ä»¥æä¾›å„ç§æµ‹è¯•æ¡†æ¶çš„ï¼Œ<code>spring-boot-maven-plugin</code>æ˜¯å°† SpringBoot åº”ç”¨æ‰“åŒ…ä¸ºå¯æ‰§è¡Œ jar çš„æ’ä»¶ã€‚</p><h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><p>å› ä¸ºæ˜¯ DEMO ç¤ºä¾‹ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ª Echo æ¥å£ï¼Œèƒ½å¤Ÿæ¥æ”¶è¯·æ±‚å‚æ•°ï¼Œå¹¶è¿”å›åŠ å·¥åçš„å­—ç¬¦ä¸²ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‡èƒ½çš„<code>Hello, World!</code>ã€‚</p><p>æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code class="txt">â”œâ”€â”€ pom.xmlâ””â”€â”€ src    â”œâ”€â”€ main    â”‚   â”œâ”€â”€ java    â”‚   â”‚   â””â”€â”€ cn    â”‚   â”‚       â””â”€â”€ howardliu    â”‚   â”‚           â””â”€â”€ effective    â”‚   â”‚               â””â”€â”€ spring    â”‚   â”‚                   â””â”€â”€ springbootjunit5mockio    â”‚   â”‚                       â”œâ”€â”€ SpringbootJunit5MockioApplication.java    â”‚   â”‚                       â”œâ”€â”€ controller    â”‚   â”‚                       â”‚   â””â”€â”€ EchoController.java    â”‚   â”‚                       â””â”€â”€ service    â”‚   â”‚                           â”œâ”€â”€ EchoService.java    â”‚   â”‚                           â””â”€â”€ impl    â”‚   â”‚                               â””â”€â”€ EchoServiceImpl.java    â”‚   â””â”€â”€ resources    â”‚       â””â”€â”€ application.yaml    â””â”€â”€ test        â””â”€â”€ java            â””â”€â”€ cn                â””â”€â”€ howardliu                    â””â”€â”€ effective                        â””â”€â”€ spring                            â””â”€â”€ springbootjunit5mockio                                â””â”€â”€ controller                                    â”œâ”€â”€ EchoControllerMockTest.java                                    â””â”€â”€ EchoControllerNoMockitoTest.java</code></pre><ul><li>SpringbootJunit5MockioApplicationï¼šSpringBoot åº”ç”¨å¯åŠ¨å…¥å£</li><li>EchoControllerï¼šæ¥å£å®šä¹‰</li><li>EchoServiceï¼šå®ç°ä¸šåŠ¡é€»è¾‘æ¥å£</li><li>EchoServiceImplï¼šæ¥å£å®ç°</li><li>EchoControllerMockTestï¼šä½¿ç”¨ Mock ä»£ç† EchoService å®ç°</li><li>EchoControllerNoMockitoTestï¼šç›´æ¥æµ‹è¯•æ¥å£å®ç°</li></ul><h3 id="EchoServiceImpl"><a href="#EchoServiceImpl" class="headerlink" title="EchoServiceImpl"></a>EchoServiceImpl</h3><p>æˆ‘ä»¬çœ‹ä¸‹<code>EchoService</code>çš„å®ç°ï¼Œè¿™å°†æ˜¯æˆ‘ä»¬ DEMO çš„æ ¸å¿ƒå®ç°ï¼š</p><pre><code class="java">@Servicepublic class EchoServiceImpl implements EchoService {    @Override    public String echo(String foo) {        return &quot;Hello, &quot; + foo;    }}</code></pre><h3 id="EchoControllerNoMockitoTest"><a href="#EchoControllerNoMockitoTest" class="headerlink" title="EchoControllerNoMockitoTest"></a>EchoControllerNoMockitoTest</h3><p>æˆ‘ä»¬å…ˆä½¿ç”¨ Junit5+MockMvc å®ç° Controller æ¥å£çš„æ™®é€šè°ƒç”¨ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">@SpringBootTest(classes = SpringbootJunit5MockioApplication.class)@AutoConfigureMockMvcclass EchoControllerNoMockitoTest {    @Autowired    private MockMvc mockMvc;    @Test    void echo() throws Exception {        final String result = mockMvc.perform(                MockMvcRequestBuilders.get(&quot;/echo/&quot;)                        .param(&quot;name&quot;, &quot;çœ‹å±±&quot;)        )                .andExpect(MockMvcResultMatchers.status().isOk())                .andDo(MockMvcResultHandlers.print())                .andReturn()                .getResponse()                .getContentAsString(StandardCharsets.UTF_8);        Assertions.assertEquals(&quot;Hello, çœ‹å±±&quot;, result);    }}</code></pre><p>æˆ‘ä»¬é€šè¿‡<code>SpringBootTest</code>æ³¨è§£å®šä¹‰è¿™æ˜¯ä¸€ä¸ª SpringBoot åº”ç”¨çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç„¶åé€šè¿‡<code>AutoConfigureMockMvc</code>å¯åŠ¨æµ‹è¯•å®¹å™¨ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥ç›´æ¥æ³¨å…¥<code>MockMvc</code>å®ä¾‹æµ‹è¯• Controller æ¥å£ã€‚</p><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹ä¼šè®©å†™<code>@ExtendWith({SpringExtension.class})</code>è¿™æ ·ä¸€ä¸ªæ³¨è§£ï¼Œå…¶å®å®Œå…¨æ²¡æœ‰å¿…è¦ã€‚é€šè¿‡æºç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ<code>SpringBootTest</code>æ³¨è§£å·²ç»æ·»åŠ äº†<code>ExtendWith</code>ã€‚</p><h3 id="EchoControllerMockTest"><a href="#EchoControllerMockTest" class="headerlink" title="EchoControllerMockTest"></a>EchoControllerMockTest</h3><p>è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ Mockito ç»„ä»¶ä»£ç†<code>EchoService</code>çš„<code>echo</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">@SpringBootTest(classes = SpringbootJunit5MockioApplication.class)@ExtendWith(MockitoExtension.class)@AutoConfigureMockMvcclass EchoControllerMockTest {    @Autowired    private MockMvc mockMvc;    @MockBean    private EchoService echoService;    @BeforeEach    void setUp() {        Mockito.when(echoService.echo(Mockito.any()))                .thenReturn(&quot;çœ‹å±±è¯´ï¼š&quot; + System.currentTimeMillis());    }    @Test    void echo() throws Exception {        final String result = mockMvc.perform(                MockMvcRequestBuilders.get(&quot;/echo/&quot;)                        .param(&quot;name&quot;, &quot;çœ‹å±±çš„å°å±‹&quot;)        )                .andExpect(MockMvcResultMatchers.status().isOk())                .andDo(MockMvcResultHandlers.print())                .andReturn()                .getResponse()                .getContentAsString(StandardCharsets.UTF_8);        Assertions.assertTrue(result.startsWith(&quot;çœ‹å±±&quot;));    }}</code></pre><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„<code>@ExtendWith(MockitoExtension.class)</code>æ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£æ˜¯ç”¨äºå¼•å…¥<code>MockBean</code>çš„ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹<code>echo</code>æ–¹æ³•çš„æ‹¦æˆªï¼Œä½¿å…¶è¿”å›æˆ‘ä»¬å®šä¹‰å¥½çš„å“åº”ç»“æœã€‚è¿™ç§æ–¹å¼æ˜¯ä¸ºäº†åœ¨å¤šç³»ç»Ÿæˆ–è€…å¤šåŠŸèƒ½æµ‹è¯•æ—¶ï¼Œä¸éœ€è¦çœŸæ­£è°ƒç”¨æ¥å£ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦è·å–ç”¨æˆ·æ‰‹æœºå·ï¼Œé€šå¸¸åœ¨æ¥å£ä¸­ä¼šæ ¡éªŒç”¨æˆ·æœ‰æ²¡æœ‰ç™»å½•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Mockito çš„èƒ½åŠ›ä»£ç†ç™»å½•éªŒè¯ï¼Œä½¿ç»“æœæ°¸è¿œæ˜¯ trueã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº† SpringBoot é›†æˆ Junit5ã€MockMvcã€Mockito çš„ç¤ºä¾‹ã€‚æƒ³è¦è·å–æºç ï¼Œåªéœ€è¦å…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤<code>spring</code>å³å¯ã€‚</p><p>å¾ˆå¤šåŒå­¦æ„Ÿè§‰å•å…ƒæµ‹è¯•æ²¡æœ‰ç¼–å†™çš„å¿…è¦ï¼Œç›´æ¥ä½¿ç”¨ Swagger æˆ–è€… Postman ä¹‹ç±»çš„å·¥å…·å°±èƒ½å¾ˆå¥½çš„æµ‹è¯•æ¥å£ã€‚ç¡®å®å¦‚æ­¤ï¼Œå¯¹äºç®€å•çš„ CRUD æ¥å£ï¼Œå†™å•å…ƒæµ‹è¯•çš„å¿…è¦æ€§ä¸å¤ªé«˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¤æ‚æ¥å£å‘¢ï¼Ÿæ¥å£å‚æ•°æœ‰å¾ˆå¤šçš„ç»„åˆï¼Œå“åº”ç»“æœä¹Ÿéœ€è¦å„ç§éªŒè¯ï¼Œå¦‚æœä½¿ç”¨ä¸€æ¬¡æ€§çš„å·¥å…·ï¼Œæ¯æ¬¡æµ‹è¯•ç»„åˆå‚æ•°å°±å·²ç»è®©äººå´©æºƒäº†ï¼Œè€Œä¸”ç»„åˆå‚æ•°ä¸èƒ½å­˜ç•™ç”šè‡³ä¸èƒ½åœ¨å¤šäººé—´ä¼ æ‰¿ï¼Œå°±ä¼šæµªè´¹å¾ˆå¤šçš„äººåŠ›ã€‚</p><p>æ­¤æ—¶ï¼Œå•å…ƒæµ‹è¯•çš„æ•ˆæœå°±ä¼šæ˜¾ç°ã€‚æˆ‘ä»¬åªéœ€è¦ç¼–å†™ä¸€æ¬¡å‚æ•°ç»„åˆï¼Œæ”¾åœ¨ csv ä¹‹ç±»çš„æ–‡ä»¶ä¸­ï¼Œé€šè¿‡å•å…ƒæµ‹è¯•çš„å‚æ•°åŒ–æµ‹è¯•æ–¹å¼ï¼Œå³å¯å¤šæ¬¡è¿è¡Œï¼ŒéªŒè¯æ¥å£çš„æ­£ç¡®æ€§ã€‚</p><p>æˆ–è€…ï¼Œå½“æˆ‘ä»¬æ„Ÿè§‰ç³»ç»Ÿå·²ç»è‡­å‘³å¼¥æ¼«ï¼Œå¯¹å…¶é‡æ„ä¹‹åï¼Œä¸ºäº†éªŒè¯æ¥å£åŠŸèƒ½ä¸å˜ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨åŸæ¥çš„æµ‹è¯•ç”¨ä¾‹åŠ ä»¥éªŒè¯ã€‚</p><p>ç»¼ä¸Šï¼Œè™½ç„¶æµ‹è¯•ç”¨ä¾‹ç¼–å†™éº»çƒ¦ï¼Œä½†æ˜¯å¦™ç”¨æ— ç©·ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response/">SpringBoot å®æˆ˜ï¼šä¸€æ‹›å®ç°ç»“æœçš„ä¼˜é›…å“åº”</a></li><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response-exception/">SpringBoot å®æˆ˜ï¼šå¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸</a></li><li><a href="https://www.howardliu.cn/spring-beanpostprocessor/">SpringBoot å®æˆ˜ï¼šé€šè¿‡ BeanPostProcessor åŠ¨æ€æ³¨å…¥ ID ç”Ÿæˆå™¨</a></li><li><a href="https://www.howardliu.cn/spring-request-recorder/">SpringBoot å®æˆ˜ï¼šè‡ªå®šä¹‰ Filter ä¼˜é›…è·å–è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœ</a></li><li><a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></li><li><a href="https://www.howardliu.cn/spring-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶å†…å®¹</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ï¼Œå…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹ï¼Œ10 å¹´è€çŒ¿ï¼Œå¼€æºè´¡çŒ®è€…ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120244720" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨ä¸ªäººå…¬ä¼—å·ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      ä»Šå¤©èŠèŠå¦‚ä½•åœ¨ SpringBoot ä¸­é›†æˆ Junit5ã€MockMvcã€Mocktioã€‚Junit5 æ˜¯åœ¨ Java æ ˆä¸­åº”ç”¨æœ€å¹¿çš„æµ‹è¯•æ¡†æ¶ï¼ŒJunit4 ä¸€åº¦éœ¸æ¦œã€‚
    
    </summary>
    
    
      <category term="springboot" scheme="https://www.howardliu.cn/categories/springboot/"/>
    
    
      <category term="SpringBoot å®æˆ˜" scheme="https://www.howardliu.cn/tags/SpringBoot-%E5%AE%9E%E6%88%98/"/>
    
      <category term="å®æˆ˜" scheme="https://www.howardliu.cn/tags/%E5%AE%9E%E6%88%98/"/>
    
      <category term="SpringBoot" scheme="https://www.howardliu.cn/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</title>
    <link href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/"/>
    <id>https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/</id>
    <published>2021-08-28T08:39:56.000Z</published>
    <updated>2021-08-28T08:39:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://static.howardliu.cn/lesser-sand-plover-6535531_1920.jpg" alt="SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/johnnys_pic-21062476/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6535531" target="_blank" rel="noopener">Johnnys_pic</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6535531" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>åœ¨<a href="https://www.howardliu.cn/springboot-enum-params-principle/">ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a>ä¸­æˆ‘ä»¬èŠè¿‡ï¼ŒSpringå¯¹äºä¸åŒçš„å‚æ•°å½¢å¼ï¼Œä¼šé‡‡ç”¨ä¸åŒçš„å¤„ç†ç±»å¤„ç†å‚æ•°ï¼Œè¿™ç§å½¢å¼ï¼Œæœ‰äº›ç±»ä¼¼äºç­–ç•¥æ¨¡å¼ã€‚å°†é’ˆå¯¹ä¸åŒå‚æ•°å½¢å¼çš„å¤„ç†é€»è¾‘ï¼Œæ‹†åˆ†åˆ°ä¸åŒå¤„ç†ç±»ä¸­ï¼Œå‡å°‘è€¦åˆå’Œå„ç§if-elseé€»è¾‘ã€‚æœ¬æ–‡å°±æ¥æ‰’ä¸€æ‰’ï¼ŒRequestBodyå‚æ•°ä¸­ä½¿ç”¨æšä¸¾å‚æ•°çš„åŸç†ã€‚</p><a id="more"></a><h2 id="æ‰¾å…¥å£"><a href="#æ‰¾å…¥å£" class="headerlink" title="æ‰¾å…¥å£"></a>æ‰¾å…¥å£</h2><p>å¯¹ Spring æœ‰ä¸€å®šåŸºç¡€çš„åŒå­¦ä¸€å®šçŸ¥é“ï¼Œè¯·æ±‚å…¥å£æ˜¯<code>DispatcherServlet</code>ï¼Œæ‰€æœ‰çš„è¯·æ±‚æœ€ç»ˆéƒ½ä¼šè½åˆ°<code>doDispatch</code>æ–¹æ³•ä¸­çš„<code>ha.handle(processedRequest, response, mappedHandler.getHandler())</code>é€»è¾‘ã€‚æˆ‘ä»¬ä»è¿™é‡Œå‡ºå‘ï¼Œä¸€å±‚ä¸€å±‚å‘é‡Œæ‰’ã€‚</p><p>è·Ÿç€ä»£ç æ·±å…¥ï¼Œæˆ‘ä»¬ä¼šæ‰¾åˆ°<code>org.springframework.web.method.support.InvocableHandlerMethod#invokeForRequest</code>çš„é€»è¾‘ï¼š</p><pre><code class="java">public Object invokeForRequest(NativeWebRequest request, @Nullable ModelAndViewContainer mavContainer,        Object... providedArgs) throws Exception {    Object[] args = getMethodArgumentValues(request, mavContainer, providedArgs);    if (logger.isTraceEnabled()) {        logger.trace(&quot;Arguments: &quot; + Arrays.toString(args));    }    return doInvoke(args);}</code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œé¢é€šè¿‡<code>getMethodArgumentValues</code>æ–¹æ³•å¤„ç†å‚æ•°ï¼Œç„¶åè°ƒç”¨<code>doInvoke</code>æ–¹æ³•è·å–è¿”å›å€¼ã€‚<code>getMethodArgumentValues</code>æ–¹æ³•å†…éƒ¨åˆæ˜¯é€šè¿‡<code>HandlerMethodArgumentResolverComposite</code>å®ä¾‹å¤„ç†å‚æ•°ã€‚è¿™ä¸ªç±»å†…éƒ¨æ˜¯ä¸€ä¸ª<code>HandlerMethodArgumentResolver</code>å®ä¾‹åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­æ˜¯Springå¤„ç†å‚æ•°é€»è¾‘çš„é›†åˆï¼Œè·Ÿéšä»£ç Debugï¼Œå¯ä»¥çœ‹åˆ°æœ‰27ä¸ªå…ƒç´ ã€‚è¿™äº›ç±»ä¹Ÿæ˜¯å¯ä»¥å®šåˆ¶æ‰©å±•ï¼Œå®ç°è‡ªå·±çš„å‚æ•°è§£æé€»è¾‘ï¼Œè¿™éƒ¨åˆ†å†…å®¹åç»­å†åšä»‹ç»ã€‚</p><h2 id="é€‰æ‹©Resolver"><a href="#é€‰æ‹©Resolver" class="headerlink" title="é€‰æ‹©Resolver"></a>é€‰æ‹©Resolver</h2><p>è¿™ä¸ªResolveråˆ—è¡¨ä¸­ï¼ŒåŒ…å«æˆ‘ä»¬å¸¸ç”¨çš„å‡ ä¸ªå¤„ç†ç±»ã€‚Getè¯·æ±‚çš„æ™®é€šå‚æ•°æ˜¯é€šè¿‡<code>RequestParamMethodArgumentResolver</code>å¤„ç†å‚æ•°ï¼ŒåŒ…è£…ç±»é€šè¿‡<code>ModelAttributeMethodProcessor</code>å¤„ç†å‚æ•°ï¼ŒRequestBodyå½¢å¼çš„å‚æ•°ï¼Œåˆ™æ˜¯é€šè¿‡<code>RequestResponseBodyMethodProcessor</code>å¤„ç†å‚æ•°ã€‚è¿™æ®µå°±æ˜¯Springä¸­ç­–ç•¥æ¨¡å¼çš„ä½¿ç”¨ï¼Œé€šè¿‡å®ç°<code>org.springframework.web.method.support.HandlerMethodArgumentResolver#supportsParameter</code>æ–¹æ³•ï¼Œåˆ¤æ–­è¾“å…¥å‚æ•°æ˜¯å¦å¯ä»¥è§£æã€‚ä¸‹é¢è´´ä¸Š<code>RequestResponseBodyMethodProcessor</code>çš„å®ç°ï¼š</p><pre><code class="java">public boolean supportsParameter(MethodParameter parameter) {    return parameter.hasParameterAnnotation(RequestBody.class);}</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>RequestResponseBodyMethodProcessor</code>æ˜¯é€šè¿‡åˆ¤æ–­å‚æ•°æ˜¯å¦å¸¦æœ‰<code>RequestBody</code>æ³¨è§£æ¥åˆ¤æ–­ï¼Œå½“å‰å‚æ•°æ˜¯å¦å¯ä»¥è§£æã€‚</p><h2 id="è§£æå‚æ•°"><a href="#è§£æå‚æ•°" class="headerlink" title="è§£æå‚æ•°"></a>è§£æå‚æ•°</h2><p><code>RequestResponseBodyMethodProcessor</code>ç»§æ‰¿è‡ª<code>AbstractMessageConverterMethodArgumentResolver</code>ï¼ŒçœŸæ­£è§£æ<code>RequestBody</code>å‚æ•°çš„é€»è¾‘åœ¨<code>org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodArgumentResolver#readWithMessageConverters</code>æ–¹æ³•ä¸­ã€‚æˆ‘ä»¬çœ‹ä¸‹æºç ï¼ˆå› ä¸ºæºç æ¯”è¾ƒé•¿ï¼Œæ–‡ä¸­ä»…ç•™ä¸‹æ ¸å¿ƒé€»è¾‘ã€‚ï¼‰ï¼š</p><pre><code class="java">protected &lt;T&gt; Object readWithMessageConverters(HttpInputMessage inputMessage, MethodParameter parameter,        Type targetType) throws IOException, HttpMediaTypeNotSupportedException, HttpMessageNotReadableException {    MediaType contentType = inputMessage.getHeaders().getContentType();// 1    Class&lt;?&gt; contextClass = parameter.getContainingClass();// 2    Class&lt;T&gt; targetClass = (targetType instanceof Class ? (Class&lt;T&gt;) targetType : null);// 3    Object body = NO_VALUE;    EmptyBodyCheckingHttpInputMessage message = new EmptyBodyCheckingHttpInputMessage(inputMessage);// 4    for (HttpMessageConverter&lt;?&gt; converter : this.messageConverters) {// 5        Class&lt;HttpMessageConverter&lt;?&gt;&gt; converterType = (Class&lt;HttpMessageConverter&lt;?&gt;&gt;) converter.getClass();        GenericHttpMessageConverter&lt;?&gt; genericConverter =                (converter instanceof GenericHttpMessageConverter ? (GenericHttpMessageConverter&lt;?&gt;) converter : null);        if (genericConverter != null ? genericConverter.canRead(targetType, contextClass, contentType) :                (targetClass != null &amp;&amp; converter.canRead(targetClass, contentType))) {            if (message.hasBody()) {                HttpInputMessage msgToUse =                        getAdvice().beforeBodyRead(message, parameter, targetType, converterType);                body = (genericConverter != null ? genericConverter.read(targetType, contextClass, msgToUse) :                        ((HttpMessageConverter&lt;T&gt;) converter).read(targetClass, msgToUse));// 6                body = getAdvice().afterBodyRead(body, msgToUse, parameter, targetType, converterType);            }            else {                body = getAdvice().handleEmptyBody(null, message, parameter, targetType, converterType);            }            break;        }    }    return body;}</code></pre><p>è·Ÿç€ä»£ç è¯´æ˜ä¸€ä¸‹å„éƒ¨åˆ†ç”¨é€”ï¼š</p><ol><li>è·å–è¯·æ±‚content-type</li><li>è·å–å‚æ•°å®¹å™¨ç±»</li><li>è·å–ç›®æ ‡å‚æ•°ç±»å‹</li><li>å°†è¯·æ±‚å‚æ•°è½¬æ¢ä¸º<code>EmptyBodyCheckingHttpInputMessage</code>ç±»å‹</li><li>å¾ªç¯å„ç§RequestBodyå‚æ•°è§£æå™¨ï¼Œè¿™äº›è§£æå™¨éƒ½æ˜¯<code>HttpMessageConverter</code>æ¥å£çš„å®ç°ç±»ã€‚Springå¯¹å„ç§æƒ…å†µåšäº†å…¨é‡è¦†ç›–ï¼Œæ€»æœ‰ä¸€æ¬¾é€‚åˆçš„ã€‚æ–‡æœ«ç»™å‡º<code>HttpMessageConverter</code>å„ä¸ªæ‰©å±•ç±»çš„ç±»å›¾ã€‚</li><li>forå¾ªç¯ä½“ä¸­å°±æ˜¯é€‰æ‹©ä¸€æ¬¾é€‚åˆçš„ï¼Œè¿›è¡Œè§£æ<ol><li>é¦–å…ˆè°ƒç”¨<code>canRead</code>æ–¹æ³•åˆ¤æ–­æ˜¯å¦å¯ç”¨</li><li>åˆ¤æ–­è¯·æ±‚è¯·æ±‚å‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™é€šè¿‡AOPçš„<code>advice</code>å¤„ç†ä¸€ä¸‹ç©ºè¯·æ±‚ä½“ï¼Œç„¶åè¿”å›</li><li>ä¸ä¸ºç©ºï¼Œå…ˆé€šè¿‡AOPçš„<code>advice</code>åšå‰ç½®å¤„ç†ï¼Œç„¶åè°ƒç”¨<code>read</code>æ–¹æ³•è½¬æ¢å¯¹è±¡ï¼Œåœ¨é€šè¿‡<code>advice</code>åšåç½®å¤„ç†</li></ol></li></ol><blockquote><p>Springçš„AOPä¸åœ¨æœ¬æ–‡èŒƒå›´å†…ï¼Œæ‰€ä»¥ä¸€ç¬”å¸¦è¿‡ã€‚åç»­æœ‰ä¸“é¢˜è¯´æ˜ã€‚</p></blockquote><p>æœ¬ä¾‹ä¸­ï¼Œ<code>HttpMessageConverter</code>ä½¿ç”¨çš„æ˜¯<code>MappingJackson2HttpMessageConverter</code>ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª<code>AbstractJackson2HttpMessageConverter</code>ã€‚çœ‹åç§°å°±çŸ¥é“ï¼Œè¿™ä¸ªç±»æ˜¯ä½¿ç”¨Jacksonå¤„ç†è¯·æ±‚å‚æ•°ã€‚å…¶ä¸­<code>read</code>æ–¹æ³•ä¹‹åï¼Œä¼šè°ƒç”¨å†…éƒ¨ç§æœ‰æ–¹æ³•<code>readJavaType</code>ï¼Œä¸‹é¢ç»™å‡ºè¯¥æ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼š</p><pre><code class="java">private Object readJavaType(JavaType javaType, HttpInputMessage inputMessage) throws IOException {    MediaType contentType = inputMessage.getHeaders().getContentType();// 1    Charset charset = getCharset(contentType);    ObjectMapper objectMapper = selectObjectMapper(javaType.getRawClass(), contentType);// 2    Assert.state(objectMapper != null, &quot;No ObjectMapper for &quot; + javaType);    boolean isUnicode = ENCODINGS.containsKey(charset.name()) ||            &quot;UTF-16&quot;.equals(charset.name()) ||            &quot;UTF-32&quot;.equals(charset.name());// 3    try {        if (isUnicode) {            return objectMapper.readValue(inputMessage.getBody(), javaType);// 4        } else {            Reader reader = new InputStreamReader(inputMessage.getBody(), charset);            return objectMapper.readValue(reader, javaType);        }    }    catch (InvalidDefinitionException ex) {        throw new HttpMessageConversionException(&quot;Type definition error: &quot; + ex.getType(), ex);    }    catch (JsonProcessingException ex) {        throw new HttpMessageNotReadableException(&quot;JSON parse error: &quot; + ex.getOriginalMessage(), ex, inputMessage);    }}</code></pre><p>è·Ÿç€ä»£ç è¯´æ˜ä¸€ä¸‹å„éƒ¨åˆ†ç”¨é€”ï¼š</p><ol><li>è·å–è¯·æ±‚çš„<code>content-type</code>ï¼Œè¿™ä¸ªæ˜¯Springå®ç°çš„æ‰©å±•é€»è¾‘ï¼Œæ ¹æ®ä¸åŒçš„<code>content-type</code>å¯ä»¥é€‰æ‹©ä¸åŒçš„<code>ObjectMapper</code>å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯ç¬¬2æ­¥çš„é€»è¾‘</li><li>æ ¹æ®<code>content-type</code>å’Œç›®æ ‡ç±»å‹ï¼Œé€‰æ‹©<code>ObjectMapper</code>å®ä¾‹ã€‚æœ¬ä¾‹ä¸­ç›´æ¥è¿”å›çš„æ˜¯é»˜è®¤çš„ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡<code>Jackson2ObjectMapperBuilder.cbor().build()</code>æ–¹æ³•åˆ›å»ºçš„ã€‚</li><li>æ£€æŸ¥è¯·æ±‚æ˜¯å¦æ˜¯unicodeå­—ç¬¦ï¼Œç›®å‰æ¥è¯´ï¼Œå¤§å®¶ç”¨çš„éƒ½æ˜¯<code>UTF-8</code>çš„</li><li>é€šè¿‡<code>ObjectMapper</code>å°†è¯·æ±‚jsonè½¬æ¢ä¸ºå¯¹è±¡ã€‚å…¶å®è¿™éƒ¨åˆ†è¿˜æœ‰ä¸€æ®µåˆ¤æ–­<code>inputMessage</code>æ˜¯å¦æ˜¯<code>MappingJacksonInputMessage</code>å®ä¾‹çš„ï¼Œè€ƒè™‘åˆ°å¤§å®¶ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œè¿™éƒ¨åˆ†å°±ä¸è¯´äº†ã€‚</li></ol><p>è‡³æ­¤ï¼ŒSpringçš„é€»è¾‘å…¨éƒ¨ç»“æŸï¼Œä¼¼ä¹è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°æˆ‘ä»¬ä½¿ç”¨çš„<code>JsonCreator</code>æ³¨è§£æˆ–è€…<code>JsonDeserialize</code>çš„é€»è¾‘ã€‚ä¸è¿‡ä¹Ÿèƒ½æƒ³åˆ°ï¼Œè¿™ä¸¤ä¸ªéƒ½æ˜¯Jacksonçš„ç±»ï¼Œé‚£å¿…ç„¶åº”è¯¥æ˜¯Jacksonçš„é€»è¾‘ã€‚æ¥ä¸‹æ¥ï¼Œå°±æ‰’ä¸€æ‰’Jacksonçš„è½¬æ¢é€»è¾‘äº†ã€‚</p><h2 id="æ·±å…¥Jacksonçš„ObjectMapperé€»è¾‘"><a href="#æ·±å…¥Jacksonçš„ObjectMapperé€»è¾‘" class="headerlink" title="æ·±å…¥Jacksonçš„ObjectMapperé€»è¾‘"></a>æ·±å…¥Jacksonçš„ObjectMapperé€»è¾‘</h2><p>ç‰µæ‰¯Jacksonçš„é€»è¾‘ä¸»è¦åˆ†å¸ƒåœ¨<code>AbstractMessageConverterMethodArgumentResolver#readWithMessageConverters</code>å’Œ<code>ObjectMapper#readValue</code>è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ã€‚å…ˆè¯´ä¸€ä¸‹<code>ObjectMapper#readValue</code>æ–¹æ³•çš„é€»è¾‘ï¼Œè¿™é‡Œé¢ä¼šè°ƒç”¨<code>GenderIdCodeEnum#create</code>æ–¹æ³•ï¼Œå®Œæˆç±»å‹è½¬æ¢ã€‚</p><p><code>ObjectMapper#readValue</code>æ–¹æ³•ç›´æ¥è°ƒç”¨äº†å½“å‰ç±»ä¸­çš„<code>_readMapAndClose</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢æ¯”è¾ƒå…³é”®çš„æ˜¯<code>ctxt.readRootValue(p, valueType, _findRootDeserializer(ctxt, valueType), null)</code>ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯å°†è¾“å…¥jsonè½¬æ¢ä¸ºå¯¹è±¡ã€‚å’±ä»¬å†ç»§ç»­æ·±å…¥ï¼Œå¯ä»¥æ‰¾åˆ°Jacksonå†…éƒ¨æ˜¯é€šè¿‡<code>BeanDeserializer</code>è¿™ä¸ªç±»è½¬æ¢å¯¹è±¡çš„ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯<code>deserializeFromObject</code>æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼ˆåˆ é™¤ä¸€ä¸‹ä¸å¤ªé‡è¦çš„ä»£ç ï¼‰ï¼š</p><pre><code class="java">public Object deserializeFromObject(JsonParser p, DeserializationContext ctxt) throws IOException{    // è¿™é‡Œæ ¹æ®ä¸Šä¸‹æ–‡ä¸­ç›®æ ‡ç±»å‹ï¼Œåˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œå…¶ä¸­ _valueInstantiator æ˜¯ StdValueInstantiator å®ä¾‹ã€‚    final Object bean = _valueInstantiator.createUsingDefault(ctxt);    // [databind#631]: Assign current value, to be accessible by custom deserializers    p.setCurrentValue(bean);    if (p.hasTokenId(JsonTokenId.ID_FIELD_NAME)) {        String propName = p.currentName();        do {            p.nextToken();            // æ ¹æ®å­—æ®µåæ‰¾åˆ° å±æ€§å¯¹è±¡ï¼Œå¯¹äºgenderå­—æ®µï¼Œç±»å‹æ˜¯ MethodPropertyã€‚            SettableBeanProperty prop = _beanProperties.find(propName);            if (prop != null) { // normal case                try {                    // å¼€å§‹è¿›è¡Œè§£ç æ“ä½œï¼Œå¹¶å°†è§£ç ç»“æœå†™å…¥åˆ°å¯¹è±¡ä¸­                    prop.deserializeAndSet(p, ctxt, bean);                } catch (Exception e) {                    wrapAndThrow(e, bean, propName, ctxt);                }                continue;            }            handleUnknownVanilla(p, ctxt, bean, propName);        } while ((propName = p.nextFieldName()) != null);    }    return bean;}</code></pre><p>å’±ä»¬çœ‹ä¸€ä¸‹<code>MethodProperty#deserializeAndSet</code>çš„é€»è¾‘ï¼ˆåªä¿ç•™å…³é”®ä»£ç ï¼‰ï¼š</p><pre><code class="java">public void deserializeAndSet(JsonParser p, DeserializationContext ctxt,        Object instance) throws IOException{    Object value;    // è°ƒç”¨ FactoryBasedEnumDeserializer å®ä¾‹çš„è§£ç æ–¹æ³•    value = _valueDeserializer.deserialize(p, ctxt);    // é€šè¿‡åå°„å°†å€¼å†™å…¥å¯¹è±¡ä¸­    _setter.invoke(instance, value);}</code></pre><p>å…¶ä¸­<code>_valueDeserializer</code>æ˜¯<code>FactoryBasedEnumDeserializer</code>å®ä¾‹ï¼Œå¿«è¦æ¥è¿‘ç›®æ ‡äº†ï¼Œçœ‹ä¸‹è¿™æ®µé€»è¾‘ï¼š</p><pre><code class="java">public Object deserialize(JsonParser p, DeserializationContext ctxt) throws IOException{    // è·å–jsonä¸­çš„å€¼    Object value = _deser.deserialize(p, ctxt);    // è°ƒç”¨ GenderIdCodeEnum#create æ–¹æ³•    return _factory.callOnWith(_valueClass, value);}</code></pre><p><code>_factory</code>æ˜¯<code>AnnotatedMethod</code>å®ä¾‹ï¼Œä¸»è¦æ˜¯å¯¹<code>JsonCreator</code>æ³¨è§£å®šä¹‰çš„æ–¹æ³•çš„åŒ…è£…ï¼Œç„¶å<code>callOnWith</code>ä¸­è°ƒç”¨<code>java.lang.reflect.Method#invoke</code>åå°„æ–¹æ³•ï¼Œæ‰§è¡Œ<code>GenderIdCodeEnum#create</code>ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ç»ˆäºä¸²èµ·æ¥æ‰€æœ‰é€»è¾‘ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡é€šè¿‡ä¸€ä¸ªç¤ºä¾‹ä¸²èµ·æ¥<code>@JsonCreator</code>æ³¨è§£èµ·ä½œç”¨çš„é€»è¾‘ï¼Œ<code>JsonDeserializer</code>æ¥å£çš„é€»è¾‘ä¸ä¹‹ç±»å‹ï¼Œå¯ä»¥è€å¿ƒdebugä¸€ç•ªã€‚ä¸‹é¢ç»™å‡ºä¸»è¦ç±»çš„ç±»å›¾ï¼š</p><p><img src="https://static.howardliu.cn/RequestResponseBodyMethodProcessor.png" alt="SpringBootå‚æ•°è§£æç±»å›¾"></p><p><img src="https://static.howardliu.cn/HttpMessageConverter.png" alt="HttpMessageConverter"></p><p><img src="https://static.howardliu.cn/ObjectMapper.png" alt="ObjectMapper"></p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response/">SpringBoot å®æˆ˜ï¼šä¸€æ‹›å®ç°ç»“æœçš„ä¼˜é›…å“åº”</a></li><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response-exception/">SpringBoot å®æˆ˜ï¼šå¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸</a></li><li><a href="https://www.howardliu.cn/spring-beanpostprocessor/">SpringBoot å®æˆ˜ï¼šé€šè¿‡ BeanPostProcessor åŠ¨æ€æ³¨å…¥ ID ç”Ÿæˆå™¨</a></li><li><a href="https://www.howardliu.cn/spring-request-recorder/">SpringBoot å®æˆ˜ï¼šè‡ªå®šä¹‰ Filter ä¼˜é›…è·å–è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœ</a></li><li><a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></li><li><a href="https://www.howardliu.cn/spring-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶å†…å®¹</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/120052842" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨ä¸ªäººå…¬ä¼—å·ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      Springå¯¹äºä¸åŒçš„å‚æ•°å½¢å¼ï¼Œä¼šé‡‡ç”¨ä¸åŒçš„å¤„ç†ç±»å¤„ç†å‚æ•°ï¼Œè¿™ç§å½¢å¼ï¼Œæœ‰äº›ç±»ä¼¼äºç­–ç•¥æ¨¡å¼ã€‚å°†é’ˆå¯¹ä¸åŒå‚æ•°å½¢å¼çš„å¤„ç†é€»è¾‘ï¼Œæ‹†åˆ†åˆ°ä¸åŒå¤„ç†ç±»ä¸­ï¼Œå‡å°‘è€¦åˆå’Œå„ç§if-elseé€»è¾‘ã€‚æœ¬æ–‡å°±æ¥æ‰’ä¸€æ‰’ï¼ŒRequestBodyå‚æ•°ä¸­ä½¿ç”¨æšä¸¾å‚æ•°çš„åŸç†ã€‚
    
    </summary>
    
    
      <category term="spring" scheme="https://www.howardliu.cn/categories/spring/"/>
    
    
      <category term="SpringBoot å®æˆ˜" scheme="https://www.howardliu.cn/tags/SpringBoot-%E5%AE%9E%E6%88%98/"/>
    
      <category term="spring" scheme="https://www.howardliu.cn/tags/spring/"/>
    
      <category term="enum" scheme="https://www.howardliu.cn/tags/enum/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</title>
    <link href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/"/>
    <id>https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/</id>
    <published>2021-08-22T07:45:44.000Z</published>
    <updated>2021-08-22T07:45:44.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://static.howardliu.cn/macroperspective-6558526_1920.jpg" alt="SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/christian_crowd-22911196/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6558526" target="_blank" rel="noopener">Christian_Crowd</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6558526" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>å‰æ–‡è¯´åˆ° <a href="https://www.howardliu.cn/spring-enum-params/">ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a> å’Œ <a href="https://www.howardliu.cn/springboot-enum-params-principle/">å®ç°åŸç†</a>ï¼Œæœ¬æ–‡ç»§ç»­è¯´ä¸€ä¸‹å¦‚ä½•åœ¨ RequestBody ä¸­ä¼˜é›…ä½¿ç”¨æšä¸¾ã€‚</p><p>æœ¬æ–‡å…ˆä¸Šå®æˆ˜ï¼Œè¯´ä¸€ä¸‹å¦‚ä½•å®ç°ã€‚åœ¨ <a href="https://www.howardliu.cn/spring-enum-params/">ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a> ä»£ç çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ç»§ç»­å®ç°ã€‚å¦‚æœæƒ³è¦è·å–æºç ï¼Œå¯ä»¥å…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤ spring å³å¯ã€‚</p><a id="more"></a><h2 id="ç¡®è®¤éœ€æ±‚"><a href="#ç¡®è®¤éœ€æ±‚" class="headerlink" title="ç¡®è®¤éœ€æ±‚"></a>ç¡®è®¤éœ€æ±‚</h2><p>éœ€æ±‚ä¸å‰æ–‡ç±»ä¼¼ï¼Œåªä¸è¿‡è¿™é‡Œéœ€è¦æ˜¯åœ¨ RequestBody ä¸­ä½¿ç”¨ã€‚ä¸å‰æ–‡ä¸åŒçš„æ˜¯ï¼Œè¿™ç§è¯·æ±‚æ˜¯é€šè¿‡ Http Body çš„æ–¹å¼ä¼ è¾“åˆ°åç«¯ï¼Œé€šå¸¸æ˜¯ json æˆ– xml æ ¼å¼ï¼ŒSpring é»˜è®¤å€ŸåŠ© Jackson ååºåˆ—åŒ–ä¸ºå¯¹è±¡ã€‚</p><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æšä¸¾ä¸­å®šä¹‰ int ç±»å‹çš„ idã€String ç±»å‹çš„ codeï¼Œid å–å€¼ä¸é™äºåºå·ï¼ˆå³ä» 0 å¼€å§‹çš„ orinal æ•°æ®ï¼‰ï¼Œcode ä¸é™äº nameã€‚å®¢æˆ·ç«¯è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä¼  idï¼Œå¯ä»¥ä¼  codeï¼Œä¹Ÿå¯ä»¥ä¼  nameã€‚æœåŠ¡ç«¯åªéœ€è¦åœ¨å¯¹è±¡ä¸­å®šä¹‰ä¸€ä¸ªæšä¸¾å‚æ•°ï¼Œä¸éœ€è¦é¢å¤–çš„è½¬æ¢ï¼Œå³å¯å¾—åˆ°æšä¸¾å€¼ã€‚</p><p>å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸‹æšä¸¾å¯¹è±¡ã€‚</p><h2 id="å®šä¹‰æšä¸¾å’Œå¯¹è±¡"><a href="#å®šä¹‰æšä¸¾å’Œå¯¹è±¡" class="headerlink" title="å®šä¹‰æšä¸¾å’Œå¯¹è±¡"></a>å®šä¹‰æšä¸¾å’Œå¯¹è±¡</h2><p>å…ˆå®šä¹‰æˆ‘ä»¬çš„æšä¸¾ç±»<code>GenderIdCodeEnum</code>ï¼ŒåŒ…å« id å’Œ code ä¸¤ä¸ªå±æ€§ï¼š</p><pre><code class="java">public enum GenderIdCodeEnum implements IdCodeBaseEnum {    MALE(1, &quot;male&quot;),    FEMALE(2, &quot;female&quot;);    private final Integer id;    private final String code;    GenderIdCodeEnum(Integer id, String code) {        this.id = id;        this.code = code;    }    @Override    public String getCode() {        return code;    }    @Override    public Integer getId() {        return id;    }}</code></pre><p>è¿™ä¸ªæšä¸¾ç±»çš„è¦æ±‚ä¸å‰æ–‡ä¸€è‡´ï¼Œä¸æ¸…æ¥šçš„å¯ä»¥å†å»çœ‹ä¸€ä¸‹ã€‚</p><p>åœ¨å®šä¹‰ä¸€ä¸ªåŒ…è£…ç±»<code>GenderIdCodeRequestBody</code>ï¼Œç”¨äºæ¥æ”¶ json æ•°æ®çš„è¯·æ±‚ä½“ï¼š</p><pre><code class="java">@Datapublic class GenderIdCodeRequestBody {    private String name;    private GenderIdCodeEnum gender;    private long timestamp;}</code></pre><p>é™¤äº†<code>GenderIdCodeEnum</code>å‚æ•°å¤–ï¼Œå…¶ä»–éƒ½æ˜¯ç¤ºä¾‹ï¼Œæ‰€ä»¥éšä¾¿å®šä¹‰ä¸€ä¸‹ã€‚</p><h2 id="å®ç°è½¬æ¢é€»è¾‘"><a href="#å®ç°è½¬æ¢é€»è¾‘" class="headerlink" title="å®ç°è½¬æ¢é€»è¾‘"></a>å®ç°è½¬æ¢é€»è¾‘</h2><p>å‰å¥é“ºå«å¥½ï¼Œæ¥ä¸‹æ¥å…¥æ­£é¢˜äº†ã€‚Jackson æä¾›äº†ä¸¤ç§æ–¹æ¡ˆï¼š</p><ul><li>æ–¹æ¡ˆä¸€ï¼šç²¾å‡†æ”»å‡»ï¼ŒæŒ‡å®šéœ€è¦è½¬æ¢çš„å­—æ®µï¼Œä¸å½±å“å…¶ä»–ç±»å¯¹è±¡ä¸­çš„å­—æ®µ</li><li>æ–¹æ¡ˆäºŒï¼šå…¨èŒƒå›´æ”»å‡»ï¼Œæ‰€æœ‰å€ŸåŠ© Jackson ååºåˆ—åŒ–çš„æšä¸¾å­—æ®µï¼Œå…¨éƒ¨å…·å¤‡è‡ªåŠ¨è½¬æ¢åŠŸèƒ½</li></ul><h3 id="æ–¹æ¡ˆä¸€ï¼šç²¾å‡†æ”»å‡»"><a href="#æ–¹æ¡ˆä¸€ï¼šç²¾å‡†æ”»å‡»" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šç²¾å‡†æ”»å‡»"></a>æ–¹æ¡ˆä¸€ï¼šç²¾å‡†æ”»å‡»</h3><p>è¿™ç§æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å®ç°<code>JsonDeserialize</code>æŠ½è±¡ç±»ï¼š</p><pre><code class="java">public class IdCodeToEnumDeserializer extends JsonDeserializer&lt;BaseEnum&gt; {    @Override    public BaseEnum deserialize(JsonParser jsonParser, DeserializationContext deserializationContext)            throws IOException {        final String param = jsonParser.getText();// 1        final JsonStreamContext parsingContext = jsonParser.getParsingContext();// 2        final String currentName = parsingContext.getCurrentName();// 3        final Object currentValue = parsingContext.getCurrentValue();// 4        try {            final Field declaredField = currentValue.getClass().getDeclaredField(currentName);// 5            final Class&lt;?&gt; targetType = declaredField.getType();// 6            final Method createMethod = targetType.getDeclaredMethod(&quot;create&quot;, Object.class);// 7            return (BaseEnum) createMethod.invoke(null, param);// 8        } catch (NoSuchMethodException | InvocationTargetException | IllegalAccessException | NoSuchFieldException e) {            throw new CodeBaseException(ErrorResponseEnum.PARAMS_ENUM_NOT_MATCH, new Object[] {param}, &quot;&quot;, e);        }    }}</code></pre><p>ç„¶ååœ¨æŒ‡å®šæšä¸¾å­—æ®µä¸Šå®šä¹‰<code>@JsonDeserialize</code>æ³¨è§£ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="java">@JsonDeserialize(using = IdCodeToEnumDeserializer.class)private GenderIdCodeEnum gender;</code></pre><p>å…·ä½“è¯´ä¸€ä¸‹æ¯è¡Œçš„ä½œç”¨ï¼š</p><ol><li>è·å–å‚æ•°å€¼ã€‚æ ¹æ®éœ€è¦ï¼Œæ­¤å¤„å¯èƒ½æ˜¯ idã€code æˆ– nameï¼Œä¹Ÿå°±æ˜¯æºå€¼ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºæšä¸¾ï¼›</li><li>è·å–è½¬æ¢ä¸Šçº¿æ–‡ï¼Œè¿™ä¸ªæ˜¯ä¸º 3ã€4 æ­¥åšå‡†å¤‡çš„ï¼›</li><li>è·å–æ ‡è®°<code>@JsonDeserialize</code>æ³¨è§£çš„å­—æ®µï¼Œæ­¤æ—¶<code>currentName</code>çš„å€¼æ˜¯<code>gender</code>ï¼›</li><li>è·å–åŒ…è£…å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯<code>GenderIdCodeRequestBody</code>å¯¹è±¡ï¼›</li><li>æ ¹æ®åŒ…è£…å¯¹è±¡çš„<code>Class</code>å¯¹è±¡ï¼Œä»¥åŠå­—æ®µå<code>gender</code>è·å–<code>Field</code>å¯¹è±¡ï¼Œä¸ºç¬¬ 5 æ­¥åšå‡†å¤‡ï¼›</li><li>è·å–<code>gender</code>å­—æ®µå¯¹åº”çš„æšä¸¾ç±»å‹ï¼Œä¹Ÿå³æ˜¯<code>GenderIdCodeEnum</code>ã€‚ä¹‹æ‰€ä»¥è¿™æ ·åšï¼Œæ˜¯è¦å®ç°ä¸€ä¸ªé€šç”¨çš„ååºåˆ—åŒ–ç±»ï¼›</li><li>è¿™é‡Œæ˜¯å†™æ­»çš„ä¸€ç§å®ç°ï¼Œå°±æ˜¯åœ¨æšä¸¾ç±»ä¸­ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ–¹æ³•åæ˜¯<code>create</code>ï¼Œè¯·æ±‚å‚æ•°æ˜¯<code>Object</code>ï¼›</li><li>é€šè¿‡åå°„è°ƒç”¨<code>create</code>æ–¹æ³•ï¼Œå°†ç¬¬ä¸€æ­¥è·å–çš„è¯·æ±‚å‚æ•°ä¼ å…¥ã€‚</li></ol><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æšä¸¾ç±»ä¸­å®šä¹‰çš„<code>create</code>æ–¹æ³•ï¼š</p><pre><code class="java">public static GenderIdCodeEnum create(Object code) {    final String stringCode = code.toString();    final Integer intCode = BaseEnum.adapter(stringCode);    for (GenderIdCodeEnum item : values()) {        if (Objects.equals(stringCode, item.name())) {            return item;        }        if (Objects.equals(item.getCode(), stringCode)) {            return item;        }        if (Objects.equals(item.getId(), intCode)) {            return item;        }    }    return null;}</code></pre><p>ä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œæˆ‘ä»¬å¯ä»¥æå‰å®šä¹‰ä¸‰ç»„ mapï¼Œåˆ†åˆ«ä»¥ idã€codeã€name ä¸º keyï¼Œä»¥æšä¸¾å€¼ä¸º valueï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ O(1) çš„æ—¶é—´å¤æ‚åº¦è¿”å›äº†ã€‚å¯ä»¥å‚è€ƒå‰æ–‡çš„<code>Converter</code>ç±»çš„å®ç°é€»è¾‘ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°ç²¾å‡†è½¬æ¢äº†ã€‚</p><h3 id="æ–¹æ¡ˆäºŒï¼šå…¨èŒƒå›´æ”»å‡»"><a href="#æ–¹æ¡ˆäºŒï¼šå…¨èŒƒå›´æ”»å‡»" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šå…¨èŒƒå›´æ”»å‡»"></a>æ–¹æ¡ˆäºŒï¼šå…¨èŒƒå›´æ”»å‡»</h3><p>è¿™ç§æ–¹æ¡ˆæ˜¯å…¨èŒƒå›´æ”»å‡»äº†ï¼Œåªè¦æ˜¯ Jackson å‚ä¸çš„ååºåˆ—åŒ–ï¼Œåªè¦å…¶ä¸­æœ‰ç›®æ ‡æšä¸¾å‚æ•°ï¼Œå°±ä¼šå—åˆ°è¿™ç§è¿›å…¥è¿™ç§æ–¹æ¡ˆçš„é€»è¾‘ä¸­ã€‚è¿™ç§æ–¹æ¡ˆæ˜¯åœ¨æšä¸¾ç±»ä¸­å®šä¹‰ä¸€ä¸ªé™æ€è½¬æ¢æ–¹æ³•ï¼Œé€šè¿‡<code>@JsonCreator</code>æ³¨è§£æ³¨é‡Šï¼ŒJackson å°±ä¼šè‡ªåŠ¨è½¬æ¢äº†ã€‚</p><p>è¿™ä¸ªæ–¹æ³•çš„å®šä¹‰ä¸æ–¹æ¡ˆä¸€ä¸­çš„<code>create</code>æ–¹æ³•å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨<code>create</code>æ–¹æ³•ä¸ŠåŠ ä¸Šæ³¨è§£å³å¯ï¼š</p><pre><code class="java">@JsonCreator(mode = Mode.DELEGATING)public static GenderIdCodeEnum create(Object code) {    final String stringCode = code.toString();    final Integer intCode = BaseEnum.adapter(stringCode);    for (GenderIdCodeEnum item : values()) {        if (Objects.equals(stringCode, item.name())) {            return item;        }        if (Objects.equals(item.getCode(), stringCode)) {            return item;        }        if (Objects.equals(item.getId(), intCode)) {            return item;        }    }    return null;}</code></pre><p>å…¶ä¸­<code>Mode</code>ç±»æœ‰å››ä¸ªå€¼ï¼š<code>DEFAULT</code>ã€<code>DELEGATING</code>ã€<code>PROPERTIES</code>ã€<code>DISABLED</code>ï¼Œè¿™å››ç§çš„å·®åˆ«ä¼šåœ¨åŸç†ç¯‡ä¸­è¯´æ˜ã€‚è¿˜æ˜¯é‚£å¥è¯ï¼Œå¯¹äºåº”ç”¨ç±»æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçŸ¥å…¶ç„¶ï¼Œå†çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œä¹Ÿä¸€å®šè¦çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚</p><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>å…ˆå®šä¹‰ä¸€ä¸ª controller æ–¹æ³•ï¼š</p><pre><code class="java">@PostMapping(&quot;gender-id-code-request-body&quot;)public GenderIdCodeRequestBody bodyGenderIdCode(@RequestBody GenderIdCodeRequestBody genderRequest) {    genderRequest.setTimestamp(System.currentTimeMillis());    return genderRequest;}</code></pre><p>ç„¶åå®šä¹‰æµ‹è¯•ç”¨ä¾‹ï¼Œè¿˜æ˜¯å€ŸåŠ© JUnit5ï¼š</p><pre><code class="java">@ParameterizedTest@ValueSource(strings = {&quot;\&quot;MALE\&quot;&quot;, &quot;\&quot;male\&quot;&quot;, &quot;\&quot;1\&quot;&quot;, &quot;1&quot;})void postGenderIdCode(String gender) throws Exception {    final String result = mockMvc.perform(            MockMvcRequestBuilders.post(&quot;/echo/gender-id-code-request-body&quot;)                    .contentType(MediaType.APPLICATION_JSON_UTF8)                    .accept(MediaType.APPLICATION_JSON_UTF8)                    .content(&quot;{\&quot;gender\&quot;: &quot; + gender + &quot;, \&quot;name\&quot;: \&quot;çœ‹å±±\&quot;}&quot;)    )            .andExpect(MockMvcResultMatchers.status().isOk())            .andDo(MockMvcResultHandlers.print())            .andReturn()            .getResponse()            .getContentAsString();    ObjectMapper objectMapper = new ObjectMapper();    final GenderIdCodeRequestBody genderRequest = objectMapper.readValue(result, GenderIdCodeRequestBody.class);    Assertions.assertEquals(GenderIdCodeEnum.MALE, genderRequest.getGender());    Assertions.assertEquals(&quot;çœ‹å±±&quot;, genderRequest.getName());    Assertions.assertTrue(genderRequest.getTimestamp() &gt; 0);}</code></pre><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦è¯´æ˜äº†å¦‚ä½•åœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼Œå€ŸåŠ©äº† Jackson çš„ååºåˆ—åŒ–æ‰©å±•ï¼Œå¯ä»¥å®šåˆ¶ç±»å‹è½¬æ¢é€»è¾‘ã€‚ç¢äºæ–‡ç« ç¯‡å¹…ï¼Œæ²¡æœ‰ç½—åˆ—å¤§æ®µä»£ç ã€‚å…³æ³¨å…¬å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤ spring å¯ä»¥è·å–æºç ã€‚å…³æ³¨æˆ‘ï¼Œä¸‹ä¸€ç¯‡æˆ‘ä»¬è¿›å…¥åŸç†ç¯‡ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response/">SpringBoot å®æˆ˜ï¼šä¸€æ‹›å®ç°ç»“æœçš„ä¼˜é›…å“åº”</a></li><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response-exception/">SpringBoot å®æˆ˜ï¼šå¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸</a></li><li><a href="https://www.howardliu.cn/spring-beanpostprocessor/">SpringBoot å®æˆ˜ï¼šé€šè¿‡ BeanPostProcessor åŠ¨æ€æ³¨å…¥ ID ç”Ÿæˆå™¨</a></li><li><a href="https://www.howardliu.cn/spring-request-recorder/">SpringBoot å®æˆ˜ï¼šè‡ªå®šä¹‰ Filter ä¼˜é›…è·å–è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœ</a></li><li><a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></li><li><a href="https://www.howardliu.cn/spring-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶å†…å®¹</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨ä¸ªäººå…¬ä¼—å·ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      æœ¬æ–‡ç»§ç»­è¯´ä¸€ä¸‹å¦‚ä½•åœ¨ RequestBody ä¸­ä¼˜é›…ä½¿ç”¨æšä¸¾ã€‚
    
    </summary>
    
    
      <category term="spring" scheme="https://www.howardliu.cn/categories/spring/"/>
    
    
      <category term="SpringBoot å®æˆ˜" scheme="https://www.howardliu.cn/tags/SpringBoot-%E5%AE%9E%E6%88%98/"/>
    
      <category term="spring" scheme="https://www.howardliu.cn/tags/spring/"/>
    
      <category term="enum" scheme="https://www.howardliu.cn/tags/enum/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</title>
    <link href="https://www.howardliu.cn/springboot-enum-params-principle/"/>
    <id>https://www.howardliu.cn/springboot-enum-params-principle/</id>
    <published>2021-08-13T13:30:21.000Z</published>
    <updated>2021-08-13T13:30:21.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://static.howardliu.cn/cover/wheat-6536039_1920.jpg" alt="SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/minka2507-3728206/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6536039" target="_blank" rel="noopener">minka2507</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6536039" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p><a href="https://howardliu.cn/spring-enum-params/" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a> ä¸­èŠäº†æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼Œæœ¬æ–‡å°±æ¥æ‰’ä¸€æ‰’ Spring æ˜¯å¦‚ä½•æ‰¾åˆ°å¯¹åº”è½¬æ¢å™¨ Converter çš„ã€‚</p><a id="more"></a><h2 id="æ‰¾å…¥å£"><a href="#æ‰¾å…¥å£" class="headerlink" title="æ‰¾å…¥å£"></a>æ‰¾å…¥å£</h2><p>å¯¹ Spring æœ‰ä¸€å®šåŸºç¡€çš„åŒå­¦ä¸€å®šçŸ¥é“ï¼Œè¯·æ±‚å…¥å£æ˜¯<code>DispatcherServlet</code>ï¼Œæ‰€æœ‰çš„è¯·æ±‚æœ€ç»ˆéƒ½ä¼šè½åˆ°<code>doDispatch</code>æ–¹æ³•ä¸­çš„<code>ha.handle(processedRequest, response, mappedHandler.getHandler())</code>é€»è¾‘ã€‚æˆ‘ä»¬ä»è¿™é‡Œå‡ºå‘ï¼Œä¸€å±‚ä¸€å±‚å‘é‡Œæ‰’ã€‚</p><p>è·Ÿç€ä»£ç æ·±å…¥ï¼Œæˆ‘ä»¬ä¼šæ‰¾åˆ°<code>org.springframework.web.method.support.InvocableHandlerMethod#invokeForRequest</code>çš„é€»è¾‘ï¼š</p><pre><code class="java">public Object invokeForRequest(NativeWebRequest request, @Nullable ModelAndViewContainer mavContainer,        Object... providedArgs) throws Exception {    Object[] args = getMethodArgumentValues(request, mavContainer, providedArgs);    if (logger.isTraceEnabled()) {        logger.trace(&quot;Arguments: &quot; + Arrays.toString(args));    }    return doInvoke(args);}</code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œé¢é€šè¿‡<code>getMethodArgumentValues</code>æ–¹æ³•å¤„ç†å‚æ•°ï¼Œç„¶åè°ƒç”¨<code>doInvoke</code>æ–¹æ³•è·å–è¿”å›å€¼ã€‚</p><p>ç»§ç»­æ·±å…¥ï¼Œèƒ½å¤Ÿæ‰¾åˆ°<code>org.springframework.web.method.annotation.RequestParamMethodArgumentResolver#resolveArgument</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯è§£æå‚æ•°çš„é€»è¾‘ã€‚</p><p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯æˆ‘ä»¬è‡ªå·±å®ç°è¿™æ®µé€»è¾‘ï¼Œä¼šæ€ä¹ˆåšå‘¢ï¼Ÿ</p><ol><li>è·å–è¾“å…¥å‚æ•°</li><li>æ‰¾åˆ°ç›®æ ‡å‚æ•°</li><li>æ£€æŸ¥æ˜¯å¦éœ€è¦ç‰¹æ®Šè½¬æ¢é€»è¾‘</li><li>å¦‚æœéœ€è¦ï¼Œè¿›è¡Œè½¬æ¢</li><li>å¦‚æœä¸éœ€è¦ï¼Œç›´æ¥è¿”å›</li></ol><p><img src="http://static.howardliu.cn/spring/spring-resolveArgument.jpg" alt="è§£æå‚æ•°"></p><p>è·å–è¾“å…¥å‚æ•°çš„é€»è¾‘åœ¨<code>org.springframework.web.method.annotation.RequestParamMethodArgumentResolver#resolveName</code>ï¼Œå•å‚æ•°è¿”å›çš„æ˜¯ String ç±»å‹ï¼Œå¤šå‚æ•°è¿”å› String æ•°ç»„ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">String[] paramValues = request.getParameterValues(name);if (paramValues != null) {    arg = (paramValues.length == 1 ? paramValues[0] : paramValues);}</code></pre><p>æ‰€ä»¥è¯´ï¼Œæ— è®ºæˆ‘ä»¬çš„ç›®æ ‡å‚æ•°æ˜¯ä»€ä¹ˆï¼Œè¾“å…¥å‚æ•°éƒ½æ˜¯ String ç±»å‹æˆ– String æ•°ç»„ï¼Œç„¶å Spring æŠŠå®ƒä»¬è½¬æ¢ä¸ºæˆ‘ä»¬æœŸæœ›çš„ç±»å‹ã€‚</p><p>æ‰¾åˆ°ç›®æ ‡å‚æ•°çš„é€»è¾‘åœ¨<code>DispatcherServlet</code>ä¸­ï¼Œæ ¹æ® uri æ‰¾åˆ°å¯¹åº”çš„ Controller å¤„ç†æ–¹æ³•ï¼Œæ‰¾åˆ°æ–¹æ³•å°±æ‰¾åˆ°äº†ç›®æ ‡å‚æ•°ç±»å‹ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ£€æŸ¥æ˜¯å¦éœ€è¦è½¬æ¢é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯<code>org.springframework.validation.DataBinder#convertIfNecessary</code>ï¼Œé¡¾åæ€ä¹‰ï¼Œå¦‚æœéœ€è¦å°±è½¬æ¢ï¼Œå°†å­—ç¬¦ä¸²ç±»å‹è½¬æ¢ä¸ºç›®æ ‡ç±»å‹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå°±æ˜¯å°† String è½¬æ¢ä¸ºæšä¸¾å€¼ã€‚</p><h2 id="æŸ¥æ‰¾è½¬æ¢å™¨"><a href="#æŸ¥æ‰¾è½¬æ¢å™¨" class="headerlink" title="æŸ¥æ‰¾è½¬æ¢å™¨"></a>æŸ¥æ‰¾è½¬æ¢å™¨</h2><p>ç»§ç»­æ·±æ‰’ï¼Œä¼šåœ¨<code>org.springframework.beans.TypeConverterDelegate#convertIfNecessary</code>æ–¹æ³•ä¸­æ‰¾åˆ°è¿™ä¹ˆä¸€æ®µé€»è¾‘ï¼š</p><pre><code class="java">if (conversionService.canConvert(sourceTypeDesc, typeDescriptor)) {    try {        return (T) conversionService.convert(newValue, sourceTypeDesc, typeDescriptor);    }    catch (ConversionFailedException ex) {        // fallback to default conversion logic below        conversionAttemptEx = ex;    }}</code></pre><p>è¿™æ®µé€»è¾‘ä¸­ï¼Œè°ƒç”¨äº†<code>org.springframework.core.convert.support.GenericConversionService#canConvert</code>æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦å¯è½¬æ¢ï¼Œå¦‚æœå¯ä»¥è½¬æ¢ï¼Œå°†ä¼šæ‰§è¡Œç±»å‹è½¬æ¢é€»è¾‘ã€‚</p><p>æ£€æŸ¥æ˜¯å¦å¯è½¬æ¢çš„æœ¬è´¨å°±æ˜¯æ£€æŸ¥æ˜¯å¦èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„è½¬æ¢å™¨ã€‚å¦‚æœèƒ½æ‰¾åˆ°ï¼Œå°±ç”¨æ‰¾åˆ°çš„è½¬æ¢å™¨å¼€å§‹è½¬æ¢é€»è¾‘ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£å°±æ˜¯ä¸èƒ½è½¬æ¢ï¼Œèµ°å…¶ä»–é€»è¾‘ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹æŸ¥æ‰¾è½¬æ¢å™¨çš„ä»£ç <code>org.springframework.core.convert.support.GenericConversionService#getConverter</code>ï¼Œå¯ä»¥å¯¹æˆ‘ä»¬è‡ªå·±å†™ä»£ç æœ‰ä¸€äº›å¯å‘ï¼š</p><pre><code class="java">private final Map&lt;ConverterCacheKey, GenericConverter&gt; converterCache = new ConcurrentReferenceHashMap&lt;&gt;(64);protected GenericConverter getConverter(TypeDescriptor sourceType, TypeDescriptor targetType) {    ConverterCacheKey key = new ConverterCacheKey(sourceType, targetType);    GenericConverter converter = this.converterCache.get(key);    if (converter != null) {        return (converter != NO_MATCH ? converter : null);    }    converter = this.converters.find(sourceType, targetType);    if (converter == null) {        converter = getDefaultConverter(sourceType, targetType);    }    if (converter != null) {        this.converterCache.put(key, converter);        return converter;    }    this.converterCache.put(key, NO_MATCH);    return null;}</code></pre><p>è½¬æ¢ä¸ºä¼ªä»£ç å°±æ˜¯ï¼š</p><ol><li>æ ¹æ®å‚æ•°ç±»å‹å’Œç›®æ ‡ç±»å‹ï¼Œæ„é€ ç¼“å­˜ key</li><li>æ ¹æ®ç¼“å­˜ keyï¼Œä»ç¼“å­˜ä¸­æŸ¥è¯¢è½¬æ¢å™¨</li><li>å¦‚æœèƒ½æ‰¾åˆ°ä¸”ä¸æ˜¯ NO_MATCHï¼Œè¿”å›è½¬æ¢å™¨ï¼›å¦‚æœæ˜¯ NO_MATCHï¼Œè¿”å› nullï¼›å¦‚æœæœªæ‰¾åˆ°ï¼Œç»§ç»­</li><li>é€šè¿‡<code>org.springframework.core.convert.support.GenericConversionService.Converters#find</code>æŸ¥è¯¢è½¬æ¢å™¨</li><li>å¦‚æœæœªæ‰¾åˆ°ï¼Œæ£€æŸ¥æºç±»å‹å’Œç›®æ ‡ç±»å‹æ˜¯å¦å¯ä»¥å¼ºè½¬ï¼Œä¹Ÿå°±æ˜¯ç±»å‹ä¸€è‡´ã€‚å¦‚æœæ˜¯ï¼Œè¿”å› NoOpConverterï¼Œå¦‚æœå¦ï¼Œè¿”å› nullã€‚</li><li>æ£€æŸ¥æ‰¾åˆ°çš„è½¬æ¢å™¨æ˜¯å¦ä¸º nullï¼Œå¦‚æœä¸æ˜¯ï¼Œå°†è½¬æ¢å™¨åŠ å…¥åˆ°ç¼“å­˜ä¸­ï¼Œè¿”å›è¯¥è½¬æ¢å™¨</li><li>å¦‚æœå¦ï¼Œåœ¨ç¼“å­˜ä¸­æ·»åŠ  NO_MATCH æ ‡è¯†ï¼Œè¿”å› null</li></ol><p><img src="http://static.howardliu.cn/spring/spring-find-converter.jpg" alt="æŸ¥æ‰¾è½¬æ¢å™¨"></p><p>Spring å†…éƒ¨ä½¿ç”¨<code>Map</code>ä½œä¸ºç¼“å­˜ï¼Œç”¨æ¥å­˜å‚¨é€šç”¨è½¬æ¢å™¨æ¥å£<code>GenericConverter</code>ï¼Œè¿™ä¸ªæ¥å£ä¼šæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰è½¬æ¢å™¨çš„åŒ…è£…ç±»ã€‚æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼Œè½¬æ¢å™¨ç¼“å­˜ç”¨çš„æ˜¯<code>ConcurrentReferenceHashMap</code>ï¼Œè¿™ä¸ªç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥ä¿è¯å¹¶å‘æƒ…å†µä¸‹ï¼Œä¸ä¼šå‡ºç°å¼‚å¸¸å­˜å‚¨ã€‚ä½†æ˜¯<code>getConverter</code>æ–¹æ³•æ²¡æœ‰ä½¿ç”¨åŒæ­¥é€»è¾‘ã€‚æ¢å¥è¯è¯´ï¼Œå¹¶å‘è¯·æ±‚æ—¶ï¼Œå¯èƒ½å­˜åœ¨æ€§èƒ½æŸè€—ã€‚ä¸è¿‡ï¼Œå¯¹äº web è¯·æ±‚åœºæ™¯ï¼Œå¹¶å‘æŸè€—å¥½è¿‡é˜»å¡ç­‰å¾…ã€‚</p><p>æˆ‘ä»¬åœ¨çœ‹ä¸‹ Spring æ˜¯å¦‚ä½•æŸ¥æ‰¾è½¬æ¢å™¨çš„ï¼Œåœ¨<code>org.springframework.core.convert.support.GenericConversionService.Converters#find</code>ä¸­å°±æ˜¯æ‰¾åˆ°å¯¹åº”è½¬æ¢å™¨çš„æ ¸å¿ƒé€»è¾‘ï¼š</p><pre><code class="java">private final Map&lt;ConvertiblePair, ConvertersForPair&gt; converters = new ConcurrentHashMap&lt;&gt;(256);@Nullablepublic GenericConverter find(TypeDescriptor sourceType, TypeDescriptor targetType) {    // Search the full type hierarchy    List&lt;Class&lt;?&gt;&gt; sourceCandidates = getClassHierarchy(sourceType.getType());    List&lt;Class&lt;?&gt;&gt; targetCandidates = getClassHierarchy(targetType.getType());    for (Class&lt;?&gt; sourceCandidate : sourceCandidates) {        for (Class&lt;?&gt; targetCandidate : targetCandidates) {            ConvertiblePair convertiblePair = new ConvertiblePair(sourceCandidate, targetCandidate);            GenericConverter converter = getRegisteredConverter(sourceType, targetType, convertiblePair);            if (converter != null) {                return converter;            }        }    }    return null;}@Nullableprivate GenericConverter getRegisteredConverter(TypeDescriptor sourceType,        TypeDescriptor targetType, ConvertiblePair convertiblePair) {    // Check specifically registered converters    ConvertersForPair convertersForPair = this.converters.get(convertiblePair);    if (convertersForPair != null) {        GenericConverter converter = convertersForPair.getConverter(sourceType, targetType);        if (converter != null) {            return converter;        }    }    // Check ConditionalConverters for a dynamic match    for (GenericConverter globalConverter : this.globalConverters) {        if (((ConditionalConverter) globalConverter).matches(sourceType, targetType)) {            return globalConverter;        }    }    return null;}</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒSpring æ˜¯é€šè¿‡æºç±»å‹å’Œç›®æ ‡ç±»å‹ç»„åˆèµ·æ¥ï¼ŒæŸ¥æ‰¾å¯¹åº”çš„è½¬æ¢å™¨ã€‚è€Œä¸”ï¼ŒSpring è¿˜é€šè¿‡<code>getClassHierarchy</code>æ–¹æ³•ï¼Œå°†æºç±»å‹å’Œç›®æ ‡ç±»å‹çš„å®¶æ—æ—è°±å…¨éƒ¨åˆ—å‡ºæ¥ï¼Œç”¨åŒå±‚ for å¾ªç¯éå†æŸ¥æ‰¾ã€‚</p><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>matches</code>æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œè°ƒç”¨äº†<code>ConverterFactory#getConverter</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨è¿™ä¸ªå·¥å‚æ–¹æ³•ï¼Œåˆ›å»ºäº†æŒ‡å®šç±»å‹çš„è½¬æ¢å™¨ã€‚</p><pre><code class="java">private final ConverterFactory&lt;Object, Object&gt; converterFactory;public boolean matches(TypeDescriptor sourceType, TypeDescriptor targetType) {    boolean matches = true;    if (this.converterFactory instanceof ConditionalConverter) {        matches = ((ConditionalConverter) this.converterFactory).matches(sourceType, targetType);    }    if (matches) {        Converter&lt;?, ?&gt; converter = this.converterFactory.getConverter(targetType.getType());        if (converter instanceof ConditionalConverter) {            matches = ((ConditionalConverter) converter).matches(sourceType, targetType);        }    }    return matches;}</code></pre><h2 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h2><p>ç»è¿‡ä¸Šé¢çš„é€»è¾‘ï¼Œå·²ç»æ‰¾åˆ°åˆ¤æ–­å¯ä»¥è¿›è¡Œè½¬æ¢ã€‚å…¶æ ¸å¿ƒé€»è¾‘å°±æ˜¯å·²ç»æ‰¾åˆ°å¯¹åº”çš„è½¬æ¢å™¨äº†ï¼Œä¸‹é¢å°±æ˜¯è½¬æ¢é€»è¾‘ï¼Œåœ¨<code>org.springframework.core.convert.support.GenericConversionService#convert</code>ä¸­ï¼š</p><pre><code class="java">public Object convert(@Nullable Object source, @Nullable TypeDescriptor sourceType, TypeDescriptor targetType) {    Assert.notNull(targetType, &quot;Target type to convert to cannot be null&quot;);    if (sourceType == null) {        Assert.isTrue(source == null, &quot;Source must be [null] if source type == [null]&quot;);        return handleResult(null, targetType, convertNullSource(null, targetType));    }    if (source != null &amp;&amp; !sourceType.getObjectType().isInstance(source)) {        throw new IllegalArgumentException(&quot;Source to convert from must be an instance of [&quot; +                sourceType + &quot;]; instead it was a [&quot; + source.getClass().getName() + &quot;]&quot;);    }    GenericConverter converter = getConverter(sourceType, targetType);    if (converter != null) {        Object result = ConversionUtils.invokeConverter(converter, source, sourceType, targetType);        return handleResult(sourceType, targetType, result);    }    return handleConverterNotFound(source, sourceType, targetType);}</code></pre><p>å…¶ä¸­çš„<code>GenericConverter converter = getConverter(sourceType, targetType)</code>å°±æ˜¯å‰æ–‡ä¸­<code>getConverter</code>æ–¹æ³•ã€‚æ­¤å¤„è¿˜æ˜¯å¯ä»¥ç»™æˆ‘ä»¬ç¼–ç ä¸Šçš„ä¸€äº›å€Ÿé‰´çš„ï¼š<code>getConverter</code>æ–¹æ³•åœ¨<code>canConvert</code>ä¸­è°ƒç”¨äº†ä¸€æ¬¡ï¼Œç„¶ååœ¨åç»­çœŸæ­£è½¬æ¢çš„æ—¶å€™åˆè°ƒç”¨ä¸€æ¬¡ï¼Œè¿™æ˜¯å‚æ•°è½¬æ¢é€»è¾‘ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆä¼˜åŒ–è¿™ç§åŒä¸€è¯·æ±‚å†…å¤šæ¬¡è°ƒç”¨ç›¸åŒé€»è¾‘æˆ–è€…è¯·æ±‚ç›¸åŒå‚æ•°å‘¢ï¼Ÿé‚£å°±æ˜¯ä½¿ç”¨ç¼“å­˜ã€‚ä¸ºäº†ä¿æŒä¸€æ¬¡è¯·æ±‚ä¸­å‰åä¸¤æ¬¡æ•°æ®çš„ä¸€è‡´æ€§å’Œè¯·æ±‚çš„é«˜æ•ˆï¼Œæ¨èä½¿ç”¨å†…å­˜ç¼“å­˜ã€‚</p><p>æ‰§è¡Œåˆ°è¿™é‡Œï¼Œç›´æ¥è°ƒç”¨<code>ConversionUtils.invokeConverter(converter, source, sourceType, targetType)</code>è½¬æ¢ï¼Œå…¶å†…éƒ¨æ˜¯ä½¿ç”¨<code>org.springframework.core.convert.support.GenericConversionService.ConverterFactoryAdapter#convert</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="java">public Object convert(@Nullable Object source, TypeDescriptor sourceType, TypeDescriptor targetType) {    if (source == null) {        return convertNullSource(sourceType, targetType);    }    return this.converterFactory.getConverter(targetType.getObjectType()).convert(source);}</code></pre><p>è¿™é‡Œå°±æ˜¯è°ƒç”¨<code>ConverterFactory</code>å·¥å‚ç±»æ„å»ºè½¬æ¢å™¨ï¼ˆå³<code>IdCodeToEnumConverterFactory</code>ç±»çš„<code>getConverter</code>æ–¹æ³•ï¼‰ï¼Œç„¶åè°ƒç”¨è½¬æ¢å™¨çš„<code>conver</code>æ–¹æ³•ï¼ˆå³<code>IdCodeToEnumConverter</code>ç±»çš„<code>convert</code>æ–¹æ³•ï¼‰ï¼Œå°†è¾“å…¥å‚æ•°è½¬æ¢ä¸ºç›®æ ‡ç±»å‹ã€‚å…·ä½“å®ç°å¯ä»¥çœ‹ä¸€ä¸‹å®æˆ˜ç¯‡ä¸­çš„ä»£ç ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬æŠŠæ•´ä¸ªè·¯ç¨‹é€šäº†ä¸‹æ¥ã€‚</p><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è·Ÿéšæºç æ‰¾åˆ°è‡ªå®šä¹‰è½¬æ¢å™¨å·¥å‚ç±»å’Œè½¬æ¢å™¨ç±»çš„å®ç°é€»è¾‘ã€‚è¿™é‡Œéœ€è¦å¼ºè°ƒä¸€ä¸‹çš„æ˜¯ï¼Œç”±äºå®æˆ˜ç¯‡ä¸­æˆ‘ä»¬ç”¨åˆ°çš„ä¾‹å­æ˜¯ç®€å•å‚æ•°çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯<code>Controller</code>çš„æ–¹æ³•å‚æ•°éƒ½æ˜¯ç›´æ¥å‚æ•°ï¼Œæ²¡æœ‰åŒ…è£…æˆå¯¹è±¡ã€‚è¿™æ ·çš„è¯ï¼ŒSpring æ˜¯é€šè¿‡<code>RequestParamMethodArgumentResolver</code>å¤„ç†å‚æ•°ã€‚å¦‚æœæ˜¯åŒ…è£…æˆå¯¹è±¡ï¼Œä¼šä½¿ç”¨<code>ModelAttributeMethodProcessor</code>å¤„ç†å‚æ•°ã€‚è¿™ä¸¤ä¸ªå¤„ç†ç±»ä¸­æŸ¥æ‰¾ç±»å‹è½¬æ¢å™¨é€»è¾‘éƒ½æ˜¯ç›¸åŒçš„ã€‚</p><p>æ— è®ºæ˜¯<code>GET</code>è¯·æ±‚ï¼Œè¿˜æ˜¯ä¼ å‚å¼çš„<code>POST</code>è¯·æ±‚ï¼ˆå³<code>Form</code>æ¨¡å¼ï¼‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹å¼ï¼Œå®ç°æšä¸¾å‚æ•°çš„ç±»å‹è½¬æ¢ã€‚ä½†æ˜¯æ˜¯ HTTP Body æ–¹å¼å´ä¸è¡Œï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>Spring å¯¹äº body å‚æ•°æ˜¯é€šè¿‡<code>RequestResponseBodyMethodProcessor</code>å¤„ç†çš„ï¼Œå…¶å†…éƒ¨ä½¿ç”¨äº†<code>MappingJackson2HttpMessageConverter</code>è½¬æ¢å™¨ï¼Œé€»è¾‘å®Œå…¨ä¸åŒã€‚æ‰€ä»¥ï¼Œæƒ³è¦å®ç° body çš„ç±»å‹è½¬æ¢ï¼Œè¿˜éœ€è¦èµ°å¦å¤–ä¸€ç§æ–¹å¼ã€‚å°†åœ¨ä¸‹ä¸€ç¯‡ä¸­ç»™å‡ºã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response/">SpringBoot å®æˆ˜ï¼šä¸€æ‹›å®ç°ç»“æœçš„ä¼˜é›…å“åº”</a></li><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response-exception/">SpringBoot å®æˆ˜ï¼šå¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸</a></li><li><a href="https://www.howardliu.cn/spring-beanpostprocessor/">SpringBoot å®æˆ˜ï¼šé€šè¿‡ BeanPostProcessor åŠ¨æ€æ³¨å…¥ ID ç”Ÿæˆå™¨</a></li><li><a href="https://www.howardliu.cn/spring-request-recorder/">SpringBoot å®æˆ˜ï¼šè‡ªå®šä¹‰ Filter ä¼˜é›…è·å–è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœ</a></li><li><a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></li><li><a href="https://www.howardliu.cn/spring-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶å†…å®¹</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€å…³æ³¨ã€‚æˆ‘è¿˜æ•´ç†äº†ä¸€äº›ç²¾å“å­¦ä¹ èµ„æ–™ï¼Œå…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€ï¼Œå›å¤â€œèµ„æ–™â€å³å¯è·å¾—ã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/119725983" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨ä¸ªäººå…¬ä¼—å·ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ä¸­èŠäº†æ€ä¹ˆä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼Œæœ¬æ–‡å°±æ¥æ‰’ä¸€æ‰’ Spring æ˜¯å¦‚ä½•æ‰¾åˆ°å¯¹åº”è½¬æ¢å™¨ Converter çš„ã€‚
    
    </summary>
    
    
      <category term="spring" scheme="https://www.howardliu.cn/categories/spring/"/>
    
    
      <category term="SpringBoot å®æˆ˜" scheme="https://www.howardliu.cn/tags/SpringBoot-%E5%AE%9E%E6%88%98/"/>
    
      <category term="spring" scheme="https://www.howardliu.cn/tags/spring/"/>
    
      <category term="enum" scheme="https://www.howardliu.cn/tags/enum/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</title>
    <link href="https://www.howardliu.cn/spring-enum-params/"/>
    <id>https://www.howardliu.cn/spring-enum-params/</id>
    <published>2021-08-10T14:40:04.000Z</published>
    <updated>2021-08-10T14:40:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://static.howardliu.cn/cover/scarlet-lily-beetle-6389888_1920.jpg" alt="SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°"></p><blockquote><p>è¯¥å›¾ç‰‡ç”±<a href="https://pixabay.com/zh/users/sinousxl-7554155/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6389888" target="_blank" rel="noopener">Sinousxl</a>åœ¨<a href="https://pixabay.com/zh/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=6389888" target="_blank" rel="noopener">Pixabay</a>ä¸Šå‘å¸ƒ</p></blockquote><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ã€‚</p><p>æ¥å£å¼€å‘è¿‡ç¨‹ä¸­ä¸å…æœ‰è¡¨ç¤ºç±»å‹çš„å‚æ•°ï¼Œæ¯”å¦‚ 0 è¡¨ç¤ºæœªçŸ¥ï¼Œ1 è¡¨ç¤ºç”·ï¼Œ2 è¡¨ç¤ºå¥³ã€‚é€šå¸¸æœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ç”¨æ•°å­—è¡¨ç¤ºï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨æšä¸¾å®ç°ã€‚</p><a id="more"></a><p>ä½¿ç”¨æ•°å­—è¡¨ç¤ºå°±æ˜¯é€šè¿‡å¥‘çº¦å½¢å¼ï¼Œçº¦å®šæ¯ä¸ªæ•°å­—è¡¨ç¤ºçš„å«ä¹‰ï¼Œæ¥å£æ¥æ”¶åˆ°å‚æ•°ï¼Œå°±æŒ‰ç…§çº¦å®šå¯¹ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œæ¥å£ç»´æŠ¤æˆæœ¬æ¯”è¾ƒå¤§ã€‚</p><p>åœ¨ Spring ä½“ç³»ä¸­ï¼Œä½¿ç”¨æšä¸¾è¡¨ç¤ºï¼Œæ˜¯å€ŸåŠ© Spring çš„ Converter æœºåˆ¶ï¼Œå¯ä»¥å°†æ•°å­—æˆ–å­—ç¬¦ä¸²å¯¹åº”åˆ°æšä¸¾çš„åºå·æˆ–è€… nameï¼Œç„¶åå°†å‰ç«¯çš„è¾“å…¥è½¬æ¢ä¸ºæšä¸¾ç±»å‹ã€‚</p><p>åœ¨åœºæ™¯ä¸å¤æ‚çš„åœºæ™¯ä¸­ï¼Œæšä¸¾å¯ä»¥è½»æ¾èƒœä»»ã€‚</p><p>äºæ˜¯ï¼Œè¿…é€Ÿå®ç°é€»è¾‘ï¼Œå‡†å¤‡ææµ‹ã€‚è¿™ä¸ªæ—¶å€™éœ€æ±‚å˜äº†ï¼Œä¸å…è®¸é€‰æ‹©æœªçŸ¥æ€§åˆ«ï¼Œåªèƒ½é€‰ç”·æˆ–å¥³ï¼Œå°±æ²¡æœ‰ 0 å€¼ã€‚è¿™æ ·ï¼Œå› ä¸ºå–å€¼æ˜¯ä» 1 å¼€å§‹ï¼Œè€Œæšä¸¾çš„åºå·æ˜¯ä» 0 å¼€å§‹ï¼Œå°±ä¼šäº§ç”Ÿå†²çªã€‚</p><p>è¿˜æœ‰ä¸€äº›ä¸å¤ªå¤šçš„åœºæ™¯ï¼Œå°±æ˜¯å‰ç«¯ä¸æœŸæœ›ç±»å‹éƒ½æ˜¯ç”¨æ•°å­—ï¼Œå¯èƒ½æœŸæœ›ç”¨ä¸€äº›æœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ä½†æ˜¯æŒ‰ç…§å‰ç«¯è§„èŒƒï¼Œéœ€è¦ç”¨å°å†™æˆ–è€…é©¼å³°å‘½åã€‚ä½†æ˜¯åç«¯çš„è§„èŒƒä¸­ï¼Œæšä¸¾å¿…é¡»æ˜¯å¤§å†™ï¼Œåˆæ˜¯å†²çªã€‚</p><p>éœ€æ±‚åˆä¸åˆç†æš‚ä¸”ä¸è®ºï¼Œæˆ‘ä»¬è¦ä¿å­˜å¯¹æŠ€æœ¯çš„æ¢ç´¢ç²¾ç¥ã€‚</p><h2 id="ç¡®è®¤éœ€æ±‚"><a href="#ç¡®è®¤éœ€æ±‚" class="headerlink" title="ç¡®è®¤éœ€æ±‚"></a>ç¡®è®¤éœ€æ±‚</h2><p>é¦–å…ˆç¡®è®¤éœ€æ±‚ã€‚æˆ‘ä»¬æœŸæœ›å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»ä½œä¸ºå‚æ•°ï¼Œæ¥å£è®¿é—®çš„æ—¶å€™ï¼Œå¯ä»¥æ˜¯ int ç±»å‹çš„ idï¼Œid å–å€¼ä¸é™äºæšä¸¾çš„åºå·ï¼›ä¹Ÿå¯ä»¥æ˜¯ String ç±»å‹çš„ codeï¼Œcode å–å€¼ä¸é™äºæšä¸¾çš„ nameã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæšä¸¾æœ‰ä¸ª id å’Œ codeï¼Œéšæ„å®šä¹‰ï¼Œåªè¦æ¥å£ä¼ è¿‡æ¥åŒ¹é…ä¸Šï¼Œå°±èƒ½å¤Ÿè‡ªåŠ¨è½¬æˆæšä¸¾ç±»å‹ã€‚</p><p>æ—¢ç„¶è¿™æ ·ï¼Œæˆ‘ä»¬å°±è§„èŒƒä¸‹ id å’Œ code å–å€¼ã€‚ä¸ºäº†æ‰©å±•ï¼Œå®šä¹‰ä¸‰ä¸ªæ¥å£ï¼šIdBaseEnumã€CodeBaseEnum ä»¥åŠ IdCodeBaseEnumã€‚</p><pre><code class="java">public interface IdBaseEnum {    Integer getId();}public interface CodeBaseEnum {    String getCode();}public interface IdCodeBaseEnum extends IdBaseEnum, CodeBaseEnum {}</code></pre><p>æ¥ä¸‹æ¥å°±è¯¥å®šä¹‰æˆ‘ä»¬çš„ä¸»è§’äº†ã€‚</p><h2 id="å®šä¹‰æšä¸¾"><a href="#å®šä¹‰æšä¸¾" class="headerlink" title="å®šä¹‰æšä¸¾"></a>å®šä¹‰æšä¸¾</h2><p>å‰é¢å®šä¹‰äº†ä¸‰ä¸ªæ¥å£ï¼Œåˆ†åˆ«æ˜¯å•ç‹¬ idã€å•ç‹¬ codeï¼Œå’Œæœ‰ id å’Œ code çš„ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ä¸‰ç§æšä¸¾ï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ä¸ªæ¥å£ã€‚ä¸‰ç§æ–¹å¼ç±»ä¼¼ï¼Œæ‰€ä»¥å°±ä¸åœ¨æ–‡ä¸­é‡å¤åˆ—ä¸¾äº†ã€‚æ„Ÿå…´è¶£çš„å¯ä»¥å…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤ spring è·å–æºç ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ€§åˆ«æšä¸¾ï¼Œæšä¸¾åŒ…å« id å’Œ code ä¸¤ä¸ªå±æ€§ã€‚</p><pre><code class="java">public enum GenderIdCodeEnum implements IdCodeBaseEnum {    MALE(1, &quot;male&quot;),    FEMALE(2, &quot;female&quot;);    private final Integer id;    private final String code;    GenderIdCodeEnum(Integer id, String code) {        this.id = id;        this.code = code;    }    @Override    public String getCode() {        return code;    }    @Override    public Integer getId() {        return id;    }}</code></pre><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œid å’Œ code ä¸èƒ½é‡å¤ã€‚</p><ol><li>id ä¸ idã€code ä¸ code ä¸èƒ½é‡å¤ï¼Œæ¯”å¦‚ MAIL å®šä¹‰ id æ˜¯ 1ï¼ŒFAMLE å°±ä¸èƒ½å®šä¹‰ id æ˜¯ 1 äº†ã€‚</li><li>id ä¸ code ä¹‹é—´ä¹Ÿä¸èƒ½é‡å¤ï¼Œæ¯”å¦‚ï¼ŒMALE å®šä¹‰ id æ˜¯ 1001ï¼ŒFEMALE å®šä¹‰ code æ˜¯ 1001ã€‚</li></ol><p>è¿™æ˜¯ç”±äº Spring åœ¨è½¬æ¢å‚æ•°çš„æ—¶å€™ï¼Œå°†è¾“å…¥å‚æ•°å…¨éƒ¨è§†ä¸º String ç±»å‹ã€‚è™½ç„¶æˆ‘ä»¬å®šä¹‰ id å’Œ code ç±»å‹ä¸åŒï¼Œä½†æ˜¯åœ¨åŒ¹é…çš„æ—¶å€™ï¼Œéƒ½æ˜¯æŒ‰ç…§å­—ç¬¦ä¸²åŒ¹é…çš„ã€‚å¦‚æœå­˜åœ¨ç›¸åŒå€¼ï¼Œå°±ä¼šäº§ç”Ÿæ­§ä¹‰ã€‚</p><h2 id="Converter-å’Œ-ConverterFactory"><a href="#Converter-å’Œ-ConverterFactory" class="headerlink" title="Converter å’Œ ConverterFactory"></a>Converter å’Œ ConverterFactory</h2><p>æ ¹æ®è§„èŒƒï¼Œæ¥ä¸‹æ¥å®šä¹‰ä¸€ä¸‹ Converter å’Œ ConverterFactoryã€‚è¿™äº›æ˜¯ Spring ç•™ç»™æˆ‘ä»¬çš„æ‰©å±•å£ï¼ŒæŒ‰ç…§è§„èŒƒå®šä¹‰å³å¯ã€‚</p><p>Converter ç±»ï¼š</p><pre><code class="java">public class IdCodeToEnumConverter&lt;T extends IdCodeBaseEnum&gt; implements Converter&lt;String, T&gt; {    private final Map&lt;String, T&gt; idEnumMap = Maps.newHashMap();    private final Map&lt;String, T&gt; codeEnumMap = Maps.newHashMap();    public IdCodeToEnumConverter(Class&lt;T&gt; enumType) {        Arrays.stream(enumType.getEnumConstants())                .forEach(x -&gt; {                    idEnumMap.put(x.getId().toString(), x);                    codeEnumMap.put(x.getCode(), x);                });    }    @Override    public T convert(String source) {        return Optional.of(source)                .map(codeEnumMap::get)                .orElseGet(() -&gt; Optional.of(source)                        .map(idEnumMap::get)                        .orElseThrow(() -&gt; new CodeBaseException(ErrorResponseEnum.PARAMS_ENUM_NOT_MATCH)));    }}</code></pre><p>ConverterFactory ç±»ï¼š</p><pre><code class="java">public class IdCodeToEnumConverterFactory implements ConverterFactory&lt;String, IdCodeBaseEnum&gt; {    @SuppressWarnings(&quot;rawtypes&quot;)    private static final Map&lt;Class, Converter&gt; CONVERTERS = Maps.newHashMap();    @Override    public &lt;T extends IdCodeBaseEnum&gt; Converter&lt;String, T&gt; getConverter(Class&lt;T&gt; targetType) {        //noinspection unchecked        Converter&lt;String, T&gt; converter = CONVERTERS.get(targetType);        if (converter == null) {            converter = new IdCodeToEnumConverter&lt;&gt;(targetType);            CONVERTERS.put(targetType, converter);        }        return converter;    }}</code></pre><p>è¿™ä¸¤ä¸ªå°±æ˜¯è½¬æ¢çš„æ ¸å¿ƒäº†ï¼Œæˆ‘ä»¬åªè¦å°†ä»–ä»¬è£…é…åˆ° Spring çš„ç±»å‹è½¬æ¢å™¨ä¸­ï¼Œå°±èƒ½å¤Ÿå®ç°æšä¸¾ç±»å‹çš„è‡ªåŠ¨è½¬åŒ–äº†ã€‚</p><h2 id="åŠ è½½é…ç½®"><a href="#åŠ è½½é…ç½®" class="headerlink" title="åŠ è½½é…ç½®"></a>åŠ è½½é…ç½®</h2><p>å°†æˆ‘ä»¬å®šä¹‰çš„ Converter å’Œ ConverterFactory æ³¨å†Œåˆ° Spring çš„ç±»å‹è½¬æ¢å™¨ä¸­ã€‚</p><pre><code class="java">@Configurationpublic class WebConfig implements WebMvcConfigurer {    @Override    public void addFormatters(FormatterRegistry registry) {        registry.addConverterFactory(new IdCodeToEnumConverterFactory());        registry.addConverterFactory(new CodeToEnumConverterFactory());        registry.addConverterFactory(new IdToEnumConverterFactory());    }}</code></pre><p>è‡³æ­¤ï¼Œæ ¸å¿ƒå®šä¹‰å…¨éƒ¨ç»“æŸã€‚</p><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>å†™ä¸€ä¸ª Controller ä½œä¸ºæµ‹è¯•å…¥å£ï¼š</p><pre><code class="java">@RestController@RequestMapping(&quot;echo&quot;)public class EchoController {    @GetMapping(&quot;gender-id-code&quot;)    public String genderIdCode(@RequestParam(&quot;gender&quot;) GenderIdCodeEnum gender) {        return gender.name();    }}</code></pre><p>å‡†å¤‡æµ‹è¯•ç”¨ä¾‹æµ‹è¯•ï¼š</p><pre><code class="java">@SpringBootTest(classes = SpringEnumParamApplication.class)@AutoConfigureMockMvcclass EchoControllerTest {    @Autowired    private MockMvc mockMvc;    @ParameterizedTest    @ValueSource(strings = {&quot;MALE&quot;, &quot;male&quot;, &quot;1&quot;})    void genderIdCode(String gender) throws Exception {        final String result = mockMvc.perform(                MockMvcRequestBuilders.get(&quot;/echo/gender-id-code&quot;)                        .param(&quot;gender&quot;, gender)        )                .andExpect(MockMvcResultMatchers.status().isOk())                .andDo(MockMvcResultHandlers.print())                .andReturn()                .getResponse()                .getContentAsString();        Assertions.assertEquals(&quot;MALE&quot;, result);    }}</code></pre><h2 id="æ–‡æœ«æ€»ç»“"><a href="#æ–‡æœ«æ€»ç»“" class="headerlink" title="æ–‡æœ«æ€»ç»“"></a>æ–‡æœ«æ€»ç»“</h2><p>å®ç°æšä¸¾å‚æ•°å¹¶ä¸éš¾ï¼Œåªè¦æŒ‰ç…§ Spring çš„æ‰©å±•è§„èŒƒå®ç°å³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ³¨æ„æšä¸¾ç±»ä¸­å”¯ä¸€çš„ id å’Œ codeã€‚</p><p>æœ¬æ–‡æ˜¯åº”ç”¨ï¼Œä¸‹ç¯‡è¯´ä¸€ä¸‹åŸç†ã€‚ä»¥åŠ http body å½¢å¼è¯·æ±‚çš„æšä¸¾è½¬æ¢é€»è¾‘ã€‚</p><p>å…³æ³¨å…¬ä¼—å·ã€Œçœ‹å±±çš„å°å±‹ã€å›å¤ spring è·å–æºç ã€‚æºç ä¸­å®Œæ•´å®šä¹‰äº†ä¸‰ç§æšä¸¾å½¢å¼ã€‚</p><h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><ul><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response/">SpringBoot å®æˆ˜ï¼šä¸€æ‹›å®ç°ç»“æœçš„ä¼˜é›…å“åº”</a></li><li><a href="https://www.howardliu.cn/springboot-action-gracefully-response-exception/">SpringBoot å®æˆ˜ï¼šå¦‚ä½•ä¼˜é›…çš„å¤„ç†å¼‚å¸¸</a></li><li><a href="https://www.howardliu.cn/spring-beanpostprocessor/">SpringBoot å®æˆ˜ï¼šé€šè¿‡ BeanPostProcessor åŠ¨æ€æ³¨å…¥ ID ç”Ÿæˆå™¨</a></li><li><a href="https://www.howardliu.cn/spring-request-recorder/">SpringBoot å®æˆ˜ï¼šè‡ªå®šä¹‰ Filter ä¼˜é›…è·å–è¯·æ±‚å‚æ•°å’Œå“åº”ç»“æœ</a></li><li><a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-enum-params-principle/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></li><li><a href="https://www.howardliu.cn/springboot-action-enum-params-in-requestbody-principle/">SpringBoot å®æˆ˜ï¼šåœ¨ RequestBody ä¸­ä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°ï¼ˆåŸç†ç¯‡ï¼‰</a></li><li><a href="https://www.howardliu.cn/springboot-action-junit5-mockmvc-mockito/">SpringBoot å®æˆ˜ï¼šJUnit5+MockMvc+Mockito åšå¥½å•å…ƒæµ‹è¯•</a></li><li><a href="https://www.howardliu.cn/spring-classpath-file-access/">SpringBoot å®æˆ˜ï¼šåŠ è½½å’Œè¯»å–èµ„æºæ–‡ä»¶å†…å®¹</a></li></ul><hr><p>ä½ å¥½ï¼Œæˆ‘æ˜¯çœ‹å±±ï¼Œå…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹ï¼Œ10 å¹´è€çŒ¿ï¼Œå¼€æºè´¡çŒ®è€…ã€‚æ¸¸äºç ç•Œï¼Œæˆäº«äººç”Ÿã€‚</p><p>ä¸ªäººä¸»é¡µï¼š<a href="https://www.howardliu.cn">https://www.howardliu.cn</a><br>ä¸ªäººåšæ–‡ï¼š<a href="https://www.howardliu.cn/spring-enum-params/">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a><br>CSDN ä¸»é¡µï¼š<a href="https://kanshan.blog.csdn.net/" target="_blank" rel="noopener">https://kanshan.blog.csdn.net/</a><br>CSDN åšæ–‡ï¼š<a href="https://kanshan.blog.csdn.net/article/details/119581202" target="_blank" rel="noopener">SpringBoot å®æˆ˜ï¼šä¼˜é›…çš„ä½¿ç”¨æšä¸¾å‚æ•°</a></p><center><b>ğŸ‘‡ğŸ»æ¬¢è¿å…³æ³¨ä¸ªäººå…¬ä¼—å·ï¼Œé¢†å–ç²¾é€‰èµ„æ–™ğŸ‘‡ğŸ»</b></center><p><img src="http://static.howardliu.cn/about/kanshanshuo.png" alt="å…¬ä¼—å·ï¼šçœ‹å±±çš„å°å±‹"></p>]]></content>
    
    <summary type="html">
    
      æ¥å£å¼€å‘è¿‡ç¨‹ä¸­ä¸å…æœ‰è¡¨ç¤ºç±»å‹çš„å‚æ•°ï¼Œæ¯”å¦‚ 0 è¡¨ç¤ºæœªçŸ¥ï¼Œ1 è¡¨ç¤ºç”·ï¼Œ2 è¡¨ç¤ºå¥³ã€‚é€šå¸¸æœ‰ä¸¤ç§åšæ³•ï¼Œä¸€ç§æ˜¯ç”¨æ•°å­—è¡¨ç¤ºï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨æšä¸¾å®ç°ã€‚
    
    </summary>
    
    
      <category term="spring" scheme="https://www.howardliu.cn/categories/spring/"/>
    
    
      <category term="SpringBoot å®æˆ˜" scheme="https://www.howardliu.cn/tags/SpringBoot-%E5%AE%9E%E6%88%98/"/>
    
      <category term="spring" scheme="https://www.howardliu.cn/tags/spring/"/>
    
      <category term="enum" scheme="https://www.howardliu.cn/tags/enum/"/>
    
  </entry>
  
</feed>
